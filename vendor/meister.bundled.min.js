!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var r in n)("object"==typeof exports?exports:e)[r]=n[r]}}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/",t(t.s=391)}([function(e,t,n){"use strict";var r=n(2),i=n(22),o=n(12),a=n(13),s=n(19),l=function e(t,n,l){var u,d,c,f,h=t&e.F,p=t&e.G,m=t&e.S,g=t&e.P,y=t&e.B,v=p?r:m?r[n]||(r[n]={}):(r[n]||{}).prototype,_=p?i:i[n]||(i[n]={}),b=_.prototype||(_.prototype={});p&&(l=n);for(u in l)d=!h&&v&&void 0!==v[u],c=(d?v:l)[u],f=y&&d?s(c,r):g&&"function"==typeof c?s(Function.call,c):c,v&&a(v,u,c,t&e.U),_[u]!=c&&o(_,u,f),g&&b[u]!=c&&(b[u]=c)};r.core=i,l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,e.exports=l},function(e,t,n){"use strict";var r=n(4);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},function(e,t,n){"use strict";var r=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},function(e,t,n){"use strict";e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports=function(e){return"object"===(void 0===e?"undefined":r(e))?null!==e:"function"==typeof e}},function(e,t,n){"use strict";var r=n(61)("wks"),i=n(42),o=n(2).Symbol,a="function"==typeof o;(e.exports=function(e){return r[e]||(r[e]=a&&o[e]||(a?o:i)("Symbol."+e))}).store=r},function(e,t,n){"use strict";e.exports=!n(3)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t,n){"use strict";var r=n(1),i=n(104),o=n(26),a=Object.defineProperty;t.f=n(6)?Object.defineProperty:function(e,t,n){if(r(e),t=o(t,!0),r(n),i)try{return a(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){"use strict";var r=n(25),i=Math.min;e.exports=function(e){return e>0?i(r(e),9007199254740991):0}},function(e,t,n){"use strict";var r=n(23);e.exports=function(e){return Object(r(e))}},function(e,t,n){"use strict";e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,n){"use strict";var r={}.hasOwnProperty;e.exports=function(e,t){return r.call(e,t)}},function(e,t,n){"use strict";var r=n(7),i=n(38);e.exports=n(6)?function(e,t,n){return r.f(e,t,i(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){"use strict";var r=n(2),i=n(12),o=n(11),a=n(42)("src"),s=Function.toString,l=(""+s).split("toString");n(22).inspectSource=function(e){return s.call(e)},(e.exports=function(e,t,n,s){var u="function"==typeof n;u&&(o(n,"name")||i(n,"name",t)),e[t]!==n&&(u&&(o(n,a)||i(n,a,e[t]?""+e[t]:l.join(String(t)))),e===r?e[t]=n:s?e[t]?e[t]=n:i(e,t,n):(delete e[t],i(e,t,n)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[a]||s.call(this)})},function(e,t,n){"use strict";var r=n(0),i=n(3),o=n(23),a=/"/g,s=function(e,t,n,r){var i=String(o(e)),s="<"+t;return""!==n&&(s+=" "+n+'="'+String(r).replace(a,"&quot;")+'"'),s+">"+i+"</"+t+">"};e.exports=function(e,t){var n={};n[e]=t(s),r(r.P+r.F*i(function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3}),"String",n)}},function(e,t,n){"use strict";var r=n(49),i=n(38),o=n(17),a=n(26),s=n(11),l=n(104),u=Object.getOwnPropertyDescriptor;t.f=n(6)?u:function(e,t){if(e=o(e),t=a(t,!0),l)try{return u(e,t)}catch(e){}if(s(e,t))return i(!r.f.call(e,t),e[t])}},function(e,t,n){"use strict";var r=n(11),i=n(9),o=n(80)("IE_PROTO"),a=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=i(e),r(e,o)?e[o]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?a:null}},function(e,t,n){"use strict";var r=n(48),i=n(23);e.exports=function(e){return r(i(e))}},function(e,t,n){"use strict";var r={}.toString;e.exports=function(e){return r.call(e).slice(8,-1)}},function(e,t,n){"use strict";var r=n(10);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}}},function(e,t,n){"use strict";var r=n(3);e.exports=function(e,t){return!!e&&r(function(){t?e.call(null,function(){},1):e.call(null)})}},function(e,t,n){"use strict";var r=n(19),i=n(48),o=n(9),a=n(8),s=n(65);e.exports=function(e,t){var n=1==e,l=2==e,u=3==e,d=4==e,c=6==e,f=5==e||c,h=t||s;return function(t,s,p){for(var m,g,y=o(t),v=i(y),_=r(s,p,3),b=a(v.length),E=0,T=n?h(t,b):l?h(t,0):void 0;b>E;E++)if((f||E in v)&&(m=v[E],g=_(m,E,y),e))if(n)T[E]=g;else if(g)switch(e){case 3:return!0;case 5:return m;case 6:return E;case 2:T.push(m)}else if(d)return!1;return c?-1:u||d?d:T}}},function(e,t,n){"use strict";var r=e.exports={version:"2.5.1"};"number"==typeof __e&&(__e=r)},function(e,t,n){"use strict";e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,n){"use strict";var r=n(0),i=n(22),o=n(3);e.exports=function(e,t){var n=(i.Object||{})[e]||Object[e],a={};a[e]=t(n),r(r.S+r.F*o(function(){n(1)}),"Object",a)}},function(e,t,n){"use strict";var r=Math.ceil,i=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?i:r)(e)}},function(e,t,n){"use strict";var r=n(4);e.exports=function(e,t){if(!r(e))return e;var n,i;if(t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;if("function"==typeof(n=e.valueOf)&&!r(i=n.call(e)))return i;if(!t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(125),o=n(0),a=n(61)("metadata"),s=a.store||(a.store=new(n(128))),l=function(e,t,n){var r=s.get(e);if(!r){if(!n)return;s.set(e,r=new i)}var o=r.get(t);if(!o){if(!n)return;r.set(t,o=new i)}return o},u=function(e,t,n){var r=l(t,n,!1);return void 0!==r&&r.has(e)},d=function(e,t,n){var r=l(t,n,!1);return void 0===r?void 0:r.get(e)},c=function(e,t,n,r){l(n,r,!0).set(e,t)},f=function(e,t){var n=l(e,t,!1),r=[];return n&&n.forEach(function(e,t){r.push(t)}),r},h=function(e){return void 0===e||"symbol"==(void 0===e?"undefined":r(e))?e:String(e)},p=function(e){o(o.S,"Reflect",e)};e.exports={store:s,map:l,has:u,get:d,set:c,keys:f,key:h,exp:p}},function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};if(n(6)){var i=n(34),o=n(2),a=n(3),s=n(0),l=n(63),u=n(86),d=n(19),c=n(32),f=n(38),h=n(12),p=n(39),m=n(25),g=n(8),y=n(123),v=n(41),_=n(26),b=n(11),E=n(47),T=n(4),S=n(9),x=n(72),w=n(35),I=n(16),D=n(36).f,R=n(88),A=n(42),P=n(5),M=n(21),L=n(50),C=n(62),O=n(89),k=n(43),N=n(56),F=n(40),B=n(64),U=n(96),j=n(7),H=n(15),q=j.f,V=H.f,G=o.RangeError,K=o.TypeError,z=o.Uint8Array,Y=Array.prototype,W=u.ArrayBuffer,X=u.DataView,Q=M(0),Z=M(2),J=M(3),$=M(4),ee=M(5),te=M(6),ne=L(!0),re=L(!1),ie=O.values,oe=O.keys,ae=O.entries,se=Y.lastIndexOf,le=Y.reduce,ue=Y.reduceRight,de=Y.join,ce=Y.sort,fe=Y.slice,he=Y.toString,pe=Y.toLocaleString,me=P("iterator"),ge=P("toStringTag"),ye=A("typed_constructor"),ve=A("def_constructor"),_e=l.CONSTR,be=l.TYPED,Ee=l.VIEW,Te=M(1,function(e,t){return De(C(e,e[ve]),t)}),Se=a(function(){return 1===new z(new Uint16Array([1]).buffer)[0]}),xe=!!z&&!!z.prototype.set&&a(function(){new z(1).set({})}),we=function(e,t){var n=m(e);if(n<0||n%t)throw G("Wrong offset!");return n},Ie=function(e){if(T(e)&&be in e)return e;throw K(e+" is not a typed array!")},De=function(e,t){if(!(T(e)&&ye in e))throw K("It is not a typed array constructor!");return new e(t)},Re=function(e,t){return Ae(C(e,e[ve]),t)},Ae=function(e,t){for(var n=0,r=t.length,i=De(e,r);r>n;)i[n]=t[n++];return i},Pe=function(e,t,n){q(e,t,{get:function(){return this._d[n]}})},Me=function(e){var t,n,r,i,o,a,s=S(e),l=arguments.length,u=l>1?arguments[1]:void 0,c=void 0!==u,f=R(s);if(void 0!=f&&!x(f)){for(a=f.call(s),r=[],t=0;!(o=a.next()).done;t++)r.push(o.value);s=r}for(c&&l>2&&(u=d(u,arguments[2],2)),t=0,n=g(s.length),i=De(this,n);n>t;t++)i[t]=c?u(s[t],t):s[t];return i},Le=function(){for(var e=0,t=arguments.length,n=De(this,t);t>e;)n[e]=arguments[e++];return n},Ce=!!z&&a(function(){pe.call(new z(1))}),Oe=function(){return pe.apply(Ce?fe.call(Ie(this)):Ie(this),arguments)},ke={copyWithin:function(e,t){return U.call(Ie(this),e,t,arguments.length>2?arguments[2]:void 0)},every:function(e){return $(Ie(this),e,arguments.length>1?arguments[1]:void 0)},fill:function(e){return B.apply(Ie(this),arguments)},filter:function(e){return Re(this,Z(Ie(this),e,arguments.length>1?arguments[1]:void 0))},find:function(e){return ee(Ie(this),e,arguments.length>1?arguments[1]:void 0)},findIndex:function(e){return te(Ie(this),e,arguments.length>1?arguments[1]:void 0)},forEach:function(e){Q(Ie(this),e,arguments.length>1?arguments[1]:void 0)},indexOf:function(e){return re(Ie(this),e,arguments.length>1?arguments[1]:void 0)},includes:function(e){return ne(Ie(this),e,arguments.length>1?arguments[1]:void 0)},join:function(e){return de.apply(Ie(this),arguments)},lastIndexOf:function(e){return se.apply(Ie(this),arguments)},map:function(e){return Te(Ie(this),e,arguments.length>1?arguments[1]:void 0)},reduce:function(e){return le.apply(Ie(this),arguments)},reduceRight:function(e){return ue.apply(Ie(this),arguments)},reverse:function(){for(var e,t=this,n=Ie(t).length,r=Math.floor(n/2),i=0;i<r;)e=t[i],t[i++]=t[--n],t[n]=e;return t},some:function(e){return J(Ie(this),e,arguments.length>1?arguments[1]:void 0)},sort:function(e){return ce.call(Ie(this),e)},subarray:function(e,t){var n=Ie(this),r=n.length,i=v(e,r);return new(C(n,n[ve]))(n.buffer,n.byteOffset+i*n.BYTES_PER_ELEMENT,g((void 0===t?r:v(t,r))-i))}},Ne=function(e,t){return Re(this,fe.call(Ie(this),e,t))},Fe=function(e){Ie(this);var t=we(arguments[1],1),n=this.length,r=S(e),i=g(r.length),o=0;if(i+t>n)throw G("Wrong length!");for(;o<i;)this[t+o]=r[o++]},Be={entries:function(){return ae.call(Ie(this))},keys:function(){return oe.call(Ie(this))},values:function(){return ie.call(Ie(this))}},Ue=function(e,t){return T(e)&&e[be]&&"symbol"!=(void 0===t?"undefined":r(t))&&t in e&&String(+t)==String(t)},je=function(e,t){return Ue(e,t=_(t,!0))?f(2,e[t]):V(e,t)},He=function(e,t,n){return!(Ue(e,t=_(t,!0))&&T(n)&&b(n,"value"))||b(n,"get")||b(n,"set")||n.configurable||b(n,"writable")&&!n.writable||b(n,"enumerable")&&!n.enumerable?q(e,t,n):(e[t]=n.value,e)};_e||(H.f=je,j.f=He),s(s.S+s.F*!_e,"Object",{getOwnPropertyDescriptor:je,defineProperty:He}),a(function(){he.call({})})&&(he=pe=function(){return de.call(this)});var qe=p({},ke);p(qe,Be),h(qe,me,Be.values),p(qe,{slice:Ne,set:Fe,constructor:function(){},toString:he,toLocaleString:Oe}),Pe(qe,"buffer","b"),Pe(qe,"byteOffset","o"),Pe(qe,"byteLength","l"),Pe(qe,"length","e"),q(qe,ge,{get:function(){return this[be]}}),e.exports=function(e,t,n,r){r=!!r;var u=e+(r?"Clamped":"")+"Array",d="get"+e,f="set"+e,p=o[u],m=p||{},v=p&&I(p),_=!p||!l.ABV,b={},S=p&&p.prototype,x=function(e,n){var r=e._d;return r.v[d](n*t+r.o,Se)},R=function(e,n,i){var o=e._d;r&&(i=(i=Math.round(i))<0?0:i>255?255:255&i),o.v[f](n*t+o.o,i,Se)},A=function(e,t){q(e,t,{get:function(){return x(this,t)},set:function(e){return R(this,t,e)},enumerable:!0})};_?(p=n(function(e,n,r,i){c(e,p,u,"_d");var o,a,s,l,d=0,f=0;if(T(n)){if(!(n instanceof W||"ArrayBuffer"==(l=E(n))||"SharedArrayBuffer"==l))return be in n?Ae(p,n):Me.call(p,n);o=n,f=we(r,t);var m=n.byteLength;if(void 0===i){if(m%t)throw G("Wrong length!");if((a=m-f)<0)throw G("Wrong length!")}else if((a=g(i)*t)+f>m)throw G("Wrong length!");s=a/t}else s=y(n),a=s*t,o=new W(a);for(h(e,"_d",{b:o,o:f,l:a,e:s,v:new X(o)});d<s;)A(e,d++)}),S=p.prototype=w(qe),h(S,"constructor",p)):a(function(){p(1)})&&a(function(){new p(-1)})&&N(function(e){new p,new p(null),new p(1.5),new p(e)},!0)||(p=n(function(e,n,r,i){c(e,p,u);var o;return T(n)?n instanceof W||"ArrayBuffer"==(o=E(n))||"SharedArrayBuffer"==o?void 0!==i?new m(n,we(r,t),i):void 0!==r?new m(n,we(r,t)):new m(n):be in n?Ae(p,n):Me.call(p,n):new m(y(n))}),Q(v!==Function.prototype?D(m).concat(D(v)):D(m),function(e){e in p||h(p,e,m[e])}),p.prototype=S,i||(S.constructor=p));var P=S[me],M=!!P&&("values"==P.name||void 0==P.name),L=Be.values;h(p,ye,!0),h(S,be,u),h(S,Ee,!0),h(S,ve,p),(r?new p(1)[ge]==u:ge in S)||q(S,ge,{get:function(){return u}}),b[u]=p,s(s.G+s.W+s.F*(p!=m),b),s(s.S,u,{BYTES_PER_ELEMENT:t}),s(s.S+s.F*a(function(){m.of.call(p,1)}),u,{from:Me,of:Le}),"BYTES_PER_ELEMENT"in S||h(S,"BYTES_PER_ELEMENT",t),s(s.P,u,ke),F(u),s(s.P+s.F*xe,u,{set:Fe}),s(s.P+s.F*!M,u,Be),i||S.toString==he||(S.toString=he),s(s.P+s.F*a(function(){new p(1).slice()}),u,{slice:Ne}),s(s.P+s.F*(a(function(){return[1,2].toLocaleString()!=new p([1,2]).toLocaleString()})||!a(function(){S.toLocaleString.call([1,2])})),u,{toLocaleString:Oe}),k[u]=M?P:L,i||M||h(S,me,L)}}else e.exports=function(){}},function(e,t,n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(){function e(t,n){i(this,e),this.config=t,this.meister=n,this.name=this.config.name,this.eventStore=[],this.meister.on("requestDestroy",this.destroy.bind(this),this.name)}return o(e,[{key:"on",value:function(e,t){var n;(n=this.eventStore).push.apply(n,r(this.meister.on(e,t,this.name)))}},{key:"one",value:function(e,t,n){this.eventStore.push(this.meister.one(e,t,n,this.name))}},{key:"unload",value:function(){this.meister.remove(this.eventStore),this.eventStore=[]}},{key:"destroy",value:function(){this.unload()}}]),e}();t.default=a},function(e,t,n){"use strict";var r=n(5)("unscopables"),i=Array.prototype;void 0==i[r]&&n(12)(i,r,{}),e.exports=function(e){i[r][e]=!0}},function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(42)("meta"),o=n(4),a=n(11),s=n(7).f,l=0,u=Object.isExtensible||function(){return!0},d=!n(3)(function(){return u(Object.preventExtensions({}))}),c=function(e){s(e,i,{value:{i:"O"+ ++l,w:{}}})},f=function(e,t){if(!o(e))return"symbol"==(void 0===e?"undefined":r(e))?e:("string"==typeof e?"S":"P")+e;if(!a(e,i)){if(!u(e))return"F";if(!t)return"E";c(e)}return e[i].i},h=function(e,t){if(!a(e,i)){if(!u(e))return!0;if(!t)return!1;c(e)}return e[i].w},p=function(e){return d&&m.NEED&&u(e)&&!a(e,i)&&c(e),e},m=e.exports={KEY:i,NEED:!1,fastKey:f,getWeak:h,onFreeze:p}},function(e,t,n){"use strict";e.exports=function(e,t,n,r){if(!(e instanceof t)||void 0!==r&&r in e)throw TypeError(n+": incorrect invocation!");return e}},function(e,t,n){"use strict";var r=n(19),i=n(107),o=n(72),a=n(1),s=n(8),l=n(88),u={},d={},c=e.exports=function(e,t,n,c,f){var h,p,m,g,y=f?function(){return e}:l(e),v=r(n,c,t?2:1),_=0;if("function"!=typeof y)throw TypeError(e+" is not iterable!");if(o(y)){for(h=s(e.length);h>_;_++)if((g=t?v(a(p=e[_])[0],p[1]):v(e[_]))===u||g===d)return g}else for(m=y.call(e);!(p=m.next()).done;)if((g=i(m,v,p.value,t))===u||g===d)return g};c.BREAK=u,c.RETURN=d},function(e,t,n){"use strict";e.exports=!1},function(e,t,n){"use strict";var r=n(1),i=n(113),o=n(68),a=n(80)("IE_PROTO"),s=function(){},l=function(){var e,t=n(67)("iframe"),r=o.length;for(t.style.display="none",n(70).appendChild(t),t.src="javascript:",e=t.contentWindow.document,e.open(),e.write("<script>document.F=Object<\/script>"),e.close(),l=e.F;r--;)delete l.prototype[o[r]];return l()};e.exports=Object.create||function(e,t){var n;return null!==e?(s.prototype=r(e),n=new s,s.prototype=null,n[a]=e):n=l(),void 0===t?n:i(n,t)}},function(e,t,n){"use strict";var r=n(115),i=n(68).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,i)}},function(e,t,n){"use strict";var r=n(115),i=n(68);e.exports=Object.keys||function(e){return r(e,i)}},function(e,t,n){"use strict";e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,n){"use strict";var r=n(13);e.exports=function(e,t,n){for(var i in t)r(e,i,t[i],n);return e}},function(e,t,n){"use strict";var r=n(2),i=n(7),o=n(6),a=n(5)("species");e.exports=function(e){var t=r[e];o&&t&&!t[a]&&i.f(t,a,{configurable:!0,get:function(){return this}})}},function(e,t,n){"use strict";var r=n(25),i=Math.max,o=Math.min;e.exports=function(e,t){return e=r(e),e<0?i(e+t,0):o(e,t)}},function(e,t,n){"use strict";var r=0,i=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++r+i).toString(36))}},function(e,t,n){"use strict";e.exports={}},function(e,t,n){"use strict";var r=n(7).f,i=n(11),o=n(5)("toStringTag");e.exports=function(e,t,n){e&&!i(e=n?e:e.prototype,o)&&r(e,o,{configurable:!0,value:t})}},function(e,t,n){"use strict";var r=n(0),i=n(23),o=n(3),a=n(84),s="["+a+"]",l="​",u=RegExp("^"+s+s+"*"),d=RegExp(s+s+"*$"),c=function(e,t,n){var i={},s=o(function(){return!!a[e]()||l[e]()!=l}),u=i[e]=s?t(f):a[e];n&&(i[n]=u),r(r.P+r.F*s,"String",i)},f=c.trim=function(e,t){return e=String(i(e)),1&t&&(e=e.replace(u,"")),2&t&&(e=e.replace(d,"")),e};e.exports=c},function(e,t,n){"use strict";var r=n(4);e.exports=function(e,t){if(!r(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},function(e,t,n){"use strict";var r=n(18),i=n(5)("toStringTag"),o="Arguments"==r(function(){return arguments}()),a=function(e,t){try{return e[t]}catch(e){}};e.exports=function(e){var t,n,s;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=a(t=Object(e),i))?n:o?r(t):"Object"==(s=r(t))&&"function"==typeof t.callee?"Arguments":s}},function(e,t,n){"use strict";var r=n(18);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},function(e,t,n){"use strict";t.f={}.propertyIsEnumerable},function(e,t,n){"use strict";var r=n(17),i=n(8),o=n(41);e.exports=function(e){return function(t,n,a){var s,l=r(t),u=i(l.length),d=o(a,u);if(e&&n!=n){for(;u>d;)if((s=l[d++])!=s)return!0}else for(;u>d;d++)if((e||d in l)&&l[d]===n)return e||d||0;return!e&&-1}}},function(e,t,n){"use strict";var r=n(2),i=n(0),o=n(13),a=n(39),s=n(31),l=n(33),u=n(32),d=n(4),c=n(3),f=n(56),h=n(44),p=n(71);e.exports=function(e,t,n,m,g,y){var v=r[e],_=v,b=g?"set":"add",E=_&&_.prototype,T={},S=function(e){var t=E[e];o(E,e,"delete"==e?function(e){return!(y&&!d(e))&&t.call(this,0===e?0:e)}:"has"==e?function(e){return!(y&&!d(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return y&&!d(e)?void 0:t.call(this,0===e?0:e)}:"add"==e?function(e){return t.call(this,0===e?0:e),this}:function(e,n){return t.call(this,0===e?0:e,n),this})};if("function"==typeof _&&(y||E.forEach&&!c(function(){(new _).entries().next()}))){var x=new _,w=x[b](y?{}:-0,1)!=x,I=c(function(){x.has(1)}),D=f(function(e){new _(e)}),R=!y&&c(function(){for(var e=new _,t=5;t--;)e[b](t,t);return!e.has(-0)});D||(_=t(function(t,n){u(t,_,e);var r=p(new v,t,_);return void 0!=n&&l(n,g,r[b],r),r}),_.prototype=E,E.constructor=_),(I||R)&&(S("delete"),S("has"),g&&S("get")),(R||w)&&S(b),y&&E.clear&&delete E.clear}else _=m.getConstructor(t,e,g,b),a(_.prototype,n),s.NEED=!0;return h(_,e),T[e]=_,i(i.G+i.W+i.F*(_!=v),T),y||m.setStrong(_,e,g),_}},function(e,t,n){"use strict";var r=n(12),i=n(13),o=n(3),a=n(23),s=n(5);e.exports=function(e,t,n){var l=s(e),u=n(a,l,""[e]),d=u[0],c=u[1];o(function(){var t={};return t[l]=function(){return 7},7!=""[e](t)})&&(i(String.prototype,e,d),r(RegExp.prototype,l,2==t?function(e,t){return c.call(e,this,t)}:function(e){return c.call(e,this)}))}},function(e,t,n){"use strict";var r=n(1);e.exports=function(){var e=r(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},function(e,t,n){"use strict";var r=n(18);e.exports=Array.isArray||function(e){return"Array"==r(e)}},function(e,t,n){"use strict";var r=n(4),i=n(18),o=n(5)("match");e.exports=function(e){var t;return r(e)&&(void 0!==(t=e[o])?!!t:"RegExp"==i(e))}},function(e,t,n){"use strict";var r=n(5)("iterator"),i=!1;try{var o=[7][r]();o.return=function(){i=!0},Array.from(o,function(){throw 2})}catch(e){}e.exports=function(e,t){if(!t&&!i)return!1;var n=!1;try{var o=[7],a=o[r]();a.next=function(){return{done:n=!0}},o[r]=function(){return a},e(o)}catch(e){}return n}},function(e,t,n){"use strict";e.exports=n(34)||!n(3)(function(){var e=Math.random();__defineSetter__.call(null,e,function(){}),delete n(2)[e]})},function(e,t,n){"use strict";t.f=Object.getOwnPropertySymbols},function(e,t,n){"use strict";var r=n(0),i=n(10),o=n(19),a=n(33);e.exports=function(e){r(r.S,e,{from:function(e){var t,n,r,s,l=arguments[1];return i(this),t=void 0!==l,t&&i(l),void 0==e?new this:(n=[],t?(r=0,s=o(l,arguments[2],2),a(e,!1,function(e){n.push(s(e,r++))})):a(e,!1,n.push,n),new this(n))}})}},function(e,t,n){"use strict";var r=n(0);e.exports=function(e){r(r.S,e,{of:function(){for(var e=arguments.length,t=Array(e);e--;)t[e]=arguments[e];return new this(t)}})}},function(e,t,n){"use strict";var r=n(2),i=r["__core-js_shared__"]||(r["__core-js_shared__"]={});e.exports=function(e){return i[e]||(i[e]={})}},function(e,t,n){"use strict";var r=n(1),i=n(10),o=n(5)("species");e.exports=function(e,t){var n,a=r(e).constructor;return void 0===a||void 0==(n=r(a)[o])?t:i(n)}},function(e,t,n){"use strict";for(var r,i=n(2),o=n(12),a=n(42),s=a("typed_array"),l=a("view"),u=!(!i.ArrayBuffer||!i.DataView),d=u,c=0,f="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");c<9;)(r=i[f[c++]])?(o(r.prototype,s,!0),o(r.prototype,l,!0)):d=!1;e.exports={ABV:u,CONSTR:d,TYPED:s,VIEW:l}},function(e,t,n){"use strict";var r=n(9),i=n(41),o=n(8);e.exports=function(e){for(var t=r(this),n=o(t.length),a=arguments.length,s=i(a>1?arguments[1]:void 0,n),l=a>2?arguments[2]:void 0,u=void 0===l?n:i(l,n);u>s;)t[s++]=e;return t}},function(e,t,n){"use strict";var r=n(184);e.exports=function(e,t){return new(r(e))(t)}},function(e,t,n){"use strict";var r=n(7),i=n(38);e.exports=function(e,t,n){t in e?r.f(e,t,i(0,n)):e[t]=n}},function(e,t,n){"use strict";var r=n(4),i=n(2).document,o=r(i)&&r(i.createElement);e.exports=function(e){return o?i.createElement(e):{}}},function(e,t,n){"use strict";e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,n){"use strict";var r=n(5)("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[r]=!1,!"/./"[e](t)}catch(e){}}return!0}},function(e,t,n){"use strict";var r=n(2).document;e.exports=r&&r.documentElement},function(e,t,n){"use strict";var r=n(4),i=n(79).set;e.exports=function(e,t,n){var o,a=t.constructor;return a!==n&&"function"==typeof a&&(o=a.prototype)!==n.prototype&&r(o)&&i&&i(e,o),e}},function(e,t,n){"use strict";var r=n(43),i=n(5)("iterator"),o=Array.prototype;e.exports=function(e){return void 0!==e&&(r.Array===e||o[i]===e)}},function(e,t,n){"use strict";var r=n(35),i=n(38),o=n(44),a={};n(12)(a,n(5)("iterator"),function(){return this}),e.exports=function(e,t,n){e.prototype=r(a,{next:i(1,n)}),o(e,t+" Iterator")}},function(e,t,n){"use strict";var r=n(34),i=n(0),o=n(13),a=n(12),s=n(11),l=n(43),u=n(73),d=n(44),c=n(16),f=n(5)("iterator"),h=!([].keys&&"next"in[].keys()),p=function(){return this};e.exports=function(e,t,n,m,g,y,v){u(n,t,m);var _,b,E,T=function(e){if(!h&&e in I)return I[e];switch(e){case"keys":case"values":return function(){return new n(this,e)}}return function(){return new n(this,e)}},S=t+" Iterator",x="values"==g,w=!1,I=e.prototype,D=I[f]||I["@@iterator"]||g&&I[g],R=D||T(g),A=g?x?T("entries"):R:void 0,P="Array"==t?I.entries||D:D;if(P&&(E=c(P.call(new e)))!==Object.prototype&&E.next&&(d(E,S,!0),r||s(E,f)||a(E,f,p)),x&&D&&"values"!==D.name&&(w=!0,R=function(){return D.call(this)}),r&&!v||!h&&!w&&I[f]||a(I,f,R),l[t]=R,l[S]=p,g)if(_={values:x?R:T("values"),keys:y?R:T("keys"),entries:A},v)for(b in _)b in I||o(I,b,_[b]);else i(i.P+i.F*(h||w),t,_);return _}},function(e,t,n){"use strict";var r=Math.expm1;e.exports=!r||r(10)>22025.465794806718||r(10)<22025.465794806718||-2e-17!=r(-2e-17)?function(e){return 0==(e=+e)?e:e>-1e-6&&e<1e-6?e+e*e/2:Math.exp(e)-1}:r},function(e,t,n){"use strict";e.exports=Math.sign||function(e){return 0==(e=+e)||e!=e?e:e<0?-1:1}},function(e,t,n){"use strict";var r=n(2),i=n(85).set,o=r.MutationObserver||r.WebKitMutationObserver,a=r.process,s=r.Promise,l="process"==n(18)(a);e.exports=function(){var e,t,n,u=function(){var r,i;for(l&&(r=a.domain)&&r.exit();e;){i=e.fn,e=e.next;try{i()}catch(r){throw e?n():t=void 0,r}}t=void 0,r&&r.enter()};if(l)n=function(){a.nextTick(u)};else if(o){var d=!0,c=document.createTextNode("");new o(u).observe(c,{characterData:!0}),n=function(){c.data=d=!d}}else if(s&&s.resolve){var f=s.resolve();n=function(){f.then(u)}}else n=function(){i.call(r,u)};return function(r){var i={fn:r,next:void 0};t&&(t.next=i),e||(e=i,n()),t=i}}},function(e,t,n){"use strict";function r(e){var t,n;this.promise=new e(function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r}),this.resolve=i(t),this.reject=i(n)}var i=n(10);e.exports.f=function(e){return new r(e)}},function(e,t,n){"use strict";var r=n(4),i=n(1),o=function(e,t){if(i(e),!r(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,r){try{r=n(19)(Function.call,n(15).f(Object.prototype,"__proto__").set,2),r(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,n){return o(e,n),t?e.__proto__=n:r(e,n),e}}({},!1):void 0),check:o}},function(e,t,n){"use strict";var r=n(61)("keys"),i=n(42);e.exports=function(e){return r[e]||(r[e]=i(e))}},function(e,t,n){"use strict";var r=n(25),i=n(23);e.exports=function(e){return function(t,n){var o,a,s=String(i(t)),l=r(n),u=s.length;return l<0||l>=u?e?"":void 0:(o=s.charCodeAt(l),o<55296||o>56319||l+1===u||(a=s.charCodeAt(l+1))<56320||a>57343?e?s.charAt(l):o:e?s.slice(l,l+2):a-56320+(o-55296<<10)+65536)}}},function(e,t,n){"use strict";var r=n(55),i=n(23);e.exports=function(e,t,n){if(r(t))throw TypeError("String#"+n+" doesn't accept regex!");return String(i(e))}},function(e,t,n){"use strict";var r=n(25),i=n(23);e.exports=function(e){var t=String(i(this)),n="",o=r(e);if(o<0||o==1/0)throw RangeError("Count can't be negative");for(;o>0;(o>>>=1)&&(t+=t))1&o&&(n+=t);return n}},function(e,t,n){"use strict";e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(e,t,n){"use strict";var r,i,o,a=n(19),s=n(105),l=n(70),u=n(67),d=n(2),c=d.process,f=d.setImmediate,h=d.clearImmediate,p=d.MessageChannel,m=d.Dispatch,g=0,y={},v=function(){var e=+this;if(y.hasOwnProperty(e)){var t=y[e];delete y[e],t()}},_=function(e){v.call(e.data)};f&&h||(f=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return y[++g]=function(){s("function"==typeof e?e:Function(e),t)},r(g),g},h=function(e){delete y[e]},"process"==n(18)(c)?r=function(e){c.nextTick(a(v,e,1))}:m&&m.now?r=function(e){m.now(a(v,e,1))}:p?(i=new p,o=i.port2,i.port1.onmessage=_,r=a(o.postMessage,o,1)):d.addEventListener&&"function"==typeof postMessage&&!d.importScripts?(r=function(e){d.postMessage(e+"","*")},d.addEventListener("message",_,!1)):r="onreadystatechange"in u("script")?function(e){l.appendChild(u("script")).onreadystatechange=function(){l.removeChild(this),v.call(e)}}:function(e){setTimeout(a(v,e,1),0)}),e.exports={set:f,clear:h}},function(e,t,n){"use strict";function r(e,t,n){var r,i,o,a=Array(n),s=8*n-t-1,l=(1<<s)-1,u=l>>1,d=23===t?B(2,-24)-B(2,-77):0,c=0,f=e<0||0===e&&1/e<0?1:0;for(e=F(e),e!=e||e===k?(i=e!=e?1:0,r=l):(r=U(j(e)/H),e*(o=B(2,-r))<1&&(r--,o*=2),e+=r+u>=1?d/o:d*B(2,1-u),e*o>=2&&(r++,o/=2),r+u>=l?(i=0,r=l):r+u>=1?(i=(e*o-1)*B(2,t),r+=u):(i=e*B(2,u-1)*B(2,t),r=0));t>=8;a[c++]=255&i,i/=256,t-=8);for(r=r<<t|i,s+=t;s>0;a[c++]=255&r,r/=256,s-=8);return a[--c]|=128*f,a}function i(e,t,n){var r,i=8*n-t-1,o=(1<<i)-1,a=o>>1,s=i-7,l=n-1,u=e[l--],d=127&u;for(u>>=7;s>0;d=256*d+e[l],l--,s-=8);for(r=d&(1<<-s)-1,d>>=-s,s+=t;s>0;r=256*r+e[l],l--,s-=8);if(0===d)d=1-a;else{if(d===o)return r?NaN:u?-k:k;r+=B(2,t),d-=a}return(u?-1:1)*r*B(2,d-t)}function o(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]}function a(e){return[255&e]}function s(e){return[255&e,e>>8&255]}function l(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]}function u(e){return r(e,52,8)}function d(e){return r(e,23,4)}function c(e,t,n){I(e[A],t,{get:function(){return this[n]}})}function f(e,t,n,r){var i=+n,o=x(i);if(o+t>e[V])throw O(P);var a=e[q]._b,s=o+e[G],l=a.slice(s,s+t);return r?l:l.reverse()}function h(e,t,n,r,i,o){var a=+n,s=x(a);if(s+t>e[V])throw O(P);for(var l=e[q]._b,u=s+e[G],d=r(+i),c=0;c<t;c++)l[u+c]=d[o?c:t-c-1]}var p=n(2),m=n(6),g=n(34),y=n(63),v=n(12),_=n(39),b=n(3),E=n(32),T=n(25),S=n(8),x=n(123),w=n(36).f,I=n(7).f,D=n(64),R=n(44),A="prototype",P="Wrong index!",M=p.ArrayBuffer,L=p.DataView,C=p.Math,O=p.RangeError,k=p.Infinity,N=M,F=C.abs,B=C.pow,U=C.floor,j=C.log,H=C.LN2,q=m?"_b":"buffer",V=m?"_l":"byteLength",G=m?"_o":"byteOffset";if(y.ABV){if(!b(function(){M(1)})||!b(function(){new M(-1)})||b(function(){return new M,new M(1.5),new M(NaN),"ArrayBuffer"!=M.name})){M=function(e){return E(this,M),new N(x(e))};for(var K,z=M[A]=N[A],Y=w(N),W=0;Y.length>W;)(K=Y[W++])in M||v(M,K,N[K]);g||(z.constructor=M)}var X=new L(new M(2)),Q=L[A].setInt8;X.setInt8(0,2147483648),X.setInt8(1,2147483649),!X.getInt8(0)&&X.getInt8(1)||_(L[A],{setInt8:function(e,t){Q.call(this,e,t<<24>>24)},setUint8:function(e,t){Q.call(this,e,t<<24>>24)}},!0)}else M=function(e){E(this,M,"ArrayBuffer");var t=x(e);this._b=D.call(Array(t),0),this[V]=t},L=function(e,t,n){E(this,L,"DataView"),E(e,M,"DataView");var r=e[V],i=T(t);if(i<0||i>r)throw O("Wrong offset!");if(n=void 0===n?r-i:S(n),i+n>r)throw O("Wrong length!");this[q]=e,this[G]=i,this[V]=n},m&&(c(M,"byteLength","_l"),c(L,"buffer","_b"),c(L,"byteLength","_l"),c(L,"byteOffset","_o")),_(L[A],{getInt8:function(e){return f(this,1,e)[0]<<24>>24},getUint8:function(e){return f(this,1,e)[0]},getInt16:function(e){var t=f(this,2,e,arguments[1]);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=f(this,2,e,arguments[1]);return t[1]<<8|t[0]},getInt32:function(e){return o(f(this,4,e,arguments[1]))},getUint32:function(e){return o(f(this,4,e,arguments[1]))>>>0},getFloat32:function(e){return i(f(this,4,e,arguments[1]),23,4)},getFloat64:function(e){return i(f(this,8,e,arguments[1]),52,8)},setInt8:function(e,t){h(this,1,e,a,t)},setUint8:function(e,t){h(this,1,e,a,t)},setInt16:function(e,t){h(this,2,e,s,t,arguments[2])},setUint16:function(e,t){h(this,2,e,s,t,arguments[2])},setInt32:function(e,t){h(this,4,e,l,t,arguments[2])},setUint32:function(e,t){h(this,4,e,l,t,arguments[2])},setFloat32:function(e,t){h(this,4,e,d,t,arguments[2])},setFloat64:function(e,t){h(this,8,e,u,t,arguments[2])}});R(M,"ArrayBuffer"),R(L,"DataView"),v(L[A],y.VIEW,!0),t.ArrayBuffer=M,t.DataView=L},function(e,t,n){"use strict";var r=n(2),i=n(22),o=n(34),a=n(124),s=n(7).f;e.exports=function(e){var t=i.Symbol||(i.Symbol=o?{}:r.Symbol||{});"_"==e.charAt(0)||e in t||s(t,e,{value:a.f(e)})}},function(e,t,n){"use strict";var r=n(47),i=n(5)("iterator"),o=n(43);e.exports=n(22).getIteratorMethod=function(e){if(void 0!=e)return e[i]||e["@@iterator"]||o[r(e)]}},function(e,t,n){"use strict";var r=n(30),i=n(108),o=n(43),a=n(17);e.exports=n(74)(Array,"Array",function(e,t){this._t=a(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,i(1)):"keys"==t?i(0,n):"values"==t?i(0,e[n]):i(0,[n,e[n]])},"values"),o.Arguments=o.Array,r("keys"),r("values"),r("entries")},function(e,t,n){"use strict";var r,i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(e){"object"===("undefined"==typeof window?"undefined":i(window))&&(r=window)}e.exports=r},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o={production:{global:{autoplay:!1,controls:!0,startMuted:!1,debug:!1,audioOnly:!1},Dash:{dvrThreshold:300,dvrEnabled:!0},Hls:{dvrEnabled:!0}},development:{global:{autoplay:!1,controls:!0,startMuted:!1,debug:!1,audioOnly:!1},Dash:{dvrThreshold:300,dvrEnabled:!0},Hls:{dvrEnabled:!0}}},a=function(){function e(){r(this,e)}return i(e,null,[{key:"set",value:function(e,t){o.development[e]=t}},{key:"get",value:function(e){return o.development[e]}},{key:"getGlobals",value:function(e){return Object.keys(e).forEach(function(t){o.development.global[t]=e[t]}),o.development.global}},{key:"overwrite",value:function(e){Object.keys(e).forEach(function(t){if(!o.development[t])return void(o.development[t]=e[t]);Object.keys(e[t]).forEach(function(n){o.development[t][n]=e[t][n]})})}},{key:"getAll",value:function(){return o.development}}]),e}();t.default=a},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}Object.defineProperty(t,"__esModule",{value:!0});var o=n(144),a=r(o),s=n(145),l=r(s),u=n(147),d=r(u),c=n(146),f=r(c),h=n(148),p=r(h),m=n(149),g=r(m),y=n(150),v=r(y),_=[];_.push.apply(_,i(a.default)),_.push.apply(_,i(l.default)),_.push.apply(_,i(d.default)),_.push.apply(_,i(f.default)),_.push.apply(_,i(p.default)),_.push.apply(_,i(g.default)),_.push.apply(_,i(v.default)),t.default=_},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(){r(this,e)}return i(e,null,[{key:"set",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r="";null!==n&&(r="; expires="+n.toGMTString()),document.cookie=e+"="+t+r+"; path=/"}},{key:"get",value:function(e){for(var t=e+"=",n=document.cookie.split(";"),r=0;r<n.length;r+=1){for(var i=n[r];" "===i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(t))return i.substr(t.length,i.length)}return null}},{key:"delete",value:function(e){this.set(e,"",-1)}}]),e}();t.default=o},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},l=n(29),u=function(e){return e&&e.__esModule?e:{default:e}}(l),d=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),a(t,[{key:"isItemSupported",value:function(){return new Promise(function(e){return e({supported:!1,errorCode:Meister.ErrorCodes.WRONG_TYPE})})}},{key:"process",value:function(e){return new Promise(function(t){console.warn("Process not implemented. Player may not play correctly."),t(e)})}},{key:"load",value:function(e){var t=this;this.meister.config.debug&&console.log("Loading item with type '"+e.type+"' and src '"+e.src+"'"),Number.isFinite(e.startPosition)&&(this.startPosition=e.startPosition),this.on("playerLoadedMetadata",function(){return t.playerLoadedMetadata()}),this.on("_playerTimeUpdate",this._onPlayerTimeUpdate.bind(this)),this.on("_playerSeek",this._onPlayerSeek.bind(this)),this.on("requestSeek",this.onRequestSeek.bind(this)),this.blockSeekForward=!!e.blockSeekForward}},{key:"playerLoadedMetadata",value:function(){if(this.startPosition>0&&this.player.duration>this.startPosition){if(this.startPositionCompleted)return;this.startPositionCompleted=!0,this.meister.trigger("requestSeek",{targetTime:this.startPosition,forcedStart:!0})}}},{key:"_onPlayerTimeUpdate",value:function(){console.error(this.name+" does not implement '_onPlayerTimeUpdate', event ignored.")}},{key:"_onPlayerSeek",value:function(){console.error(this.name+" does not implement '_onPlayerSeek', event ignored.")}},{key:"onRequestSeek",value:function(){console.error(this.name+" does not implement 'onRequestSeek', event ignored.")}},{key:"unload",value:function(){s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"unload",this).call(this),this.startPositionCompleted=!1,this.startPosition=null,this.blockSeekForward=!1}},{key:"destroy",value:function(){s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"currentItem",get:function(){return console.error(this.name+" does not support this method."),null}},{key:"duration",get:function(){return this.meister.debugEnabled&&console.error(this.name+" does not provide a duration getter."),NaN}},{key:"currentTime",get:function(){return this.meister.debugEnabled&&console.error(this.name+" does not provide a currentTime getter."),NaN},set:function(e){this.meister.debugEnabled&&console.error(this.name+" does not provide a currentTime setter.")}}]),t}(u.default);t.default=d},function(e,t,n){"use strict";var r=n(18);e.exports=function(e,t){if("number"!=typeof e&&"Number"!=r(e))throw TypeError(t);return+e}},function(e,t,n){"use strict";var r=n(9),i=n(41),o=n(8);e.exports=[].copyWithin||function(e,t){var n=r(this),a=o(n.length),s=i(e,a),l=i(t,a),u=arguments.length>2?arguments[2]:void 0,d=Math.min((void 0===u?a:i(u,a))-l,a-s),c=1;for(l<s&&s<l+d&&(c=-1,l+=d-1,s+=d-1);d-- >0;)l in n?n[s]=n[l]:delete n[s],s+=c,l+=c;return n}},function(e,t,n){"use strict";var r=n(33);e.exports=function(e,t){var n=[];return r(e,!1,n.push,n,t),n}},function(e,t,n){"use strict";var r=n(10),i=n(9),o=n(48),a=n(8);e.exports=function(e,t,n,s,l){r(t);var u=i(e),d=o(u),c=a(u.length),f=l?c-1:0,h=l?-1:1;if(n<2)for(;;){if(f in d){s=d[f],f+=h;break}if(f+=h,l?f<0:c<=f)throw TypeError("Reduce of empty array with no initial value")}for(;l?f>=0:c>f;f+=h)f in d&&(s=t(s,d[f],f,u));return s}},function(e,t,n){"use strict";var r=n(10),i=n(4),o=n(105),a=[].slice,s={},l=function(e,t,n){if(!(t in s)){for(var r=[],i=0;i<t;i++)r[i]="a["+i+"]";s[t]=Function("F,a","return new F("+r.join(",")+")")}return s[t](e,n)};e.exports=Function.bind||function(e){var t=r(this),n=a.call(arguments,1),s=function r(){var i=n.concat(a.call(arguments));return this instanceof r?l(t,i.length,i):o(t,i,e)};return i(t.prototype)&&(s.prototype=t.prototype),s}},function(e,t,n){"use strict";var r=n(7).f,i=n(35),o=n(39),a=n(19),s=n(32),l=n(33),u=n(74),d=n(108),c=n(40),f=n(6),h=n(31).fastKey,p=n(46),m=f?"_s":"size",g=function(e,t){var n,r=h(t);if("F"!==r)return e._i[r];for(n=e._f;n;n=n.n)if(n.k==t)return n};e.exports={getConstructor:function(e,t,n,u){var d=e(function(e,r){s(e,d,t,"_i"),e._t=t,e._i=i(null),e._f=void 0,e._l=void 0,e[m]=0,void 0!=r&&l(r,n,e[u],e)});return o(d.prototype,{clear:function(){for(var e=p(this,t),n=e._i,r=e._f;r;r=r.n)r.r=!0,r.p&&(r.p=r.p.n=void 0),delete n[r.i];e._f=e._l=void 0,e[m]=0},delete:function(e){var n=p(this,t),r=g(n,e);if(r){var i=r.n,o=r.p;delete n._i[r.i],r.r=!0,o&&(o.n=i),i&&(i.p=o),n._f==r&&(n._f=i),n._l==r&&(n._l=o),n[m]--}return!!r},forEach:function(e){p(this,t);for(var n,r=a(e,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(r(n.v,n.k,this);n&&n.r;)n=n.p},has:function(e){return!!g(p(this,t),e)}}),f&&r(d.prototype,"size",{get:function(){return p(this,t)[m]}}),d},def:function(e,t,n){var r,i,o=g(e,t);return o?o.v=n:(e._l=o={i:i=h(t,!0),k:t,v:n,p:r=e._l,n:void 0,r:!1},e._f||(e._f=o),r&&(r.n=o),e[m]++,"F"!==i&&(e._i[i]=o)),e},getEntry:g,setStrong:function(e,t,n){u(e,t,function(e,n){this._t=p(e,t),this._k=n,this._l=void 0},function(){for(var e=this,t=e._k,n=e._l;n&&n.r;)n=n.p;return e._t&&(e._l=n=n?n.n:e._t._f)?"keys"==t?d(0,n.k):"values"==t?d(0,n.v):d(0,[n.k,n.v]):(e._t=void 0,d(1))},n?"entries":"values",!n,!0),c(t)}}},function(e,t,n){"use strict";var r=n(47),i=n(97);e.exports=function(e){return function(){if(r(this)!=e)throw TypeError(e+"#toJSON isn't generic");return i(this)}}},function(e,t,n){"use strict";var r=n(39),i=n(31).getWeak,o=n(1),a=n(4),s=n(32),l=n(33),u=n(21),d=n(11),c=n(46),f=u(5),h=u(6),p=0,m=function(e){return e._l||(e._l=new g)},g=function(){this.a=[]},y=function(e,t){return f(e.a,function(e){return e[0]===t})};g.prototype={get:function(e){var t=y(this,e);if(t)return t[1]},has:function(e){return!!y(this,e)},set:function(e,t){var n=y(this,e);n?n[1]=t:this.a.push([e,t])},delete:function(e){var t=h(this.a,function(t){return t[0]===e});return~t&&this.a.splice(t,1),!!~t}},e.exports={getConstructor:function(e,t,n,o){var u=e(function(e,r){s(e,u,t,"_i"),e._t=t,e._i=p++,e._l=void 0,void 0!=r&&l(r,n,e[o],e)});return r(u.prototype,{delete:function(e){if(!a(e))return!1;var n=i(e);return!0===n?m(c(this,t)).delete(e):n&&d(n,this._i)&&delete n[this._i]},has:function(e){if(!a(e))return!1;var n=i(e);return!0===n?m(c(this,t)).has(e):n&&d(n,this._i)}}),u},def:function(e,t,n){var r=i(o(t),!0);return!0===r?m(e).set(t,n):r[e._i]=n,e},ufstore:m}},function(e,t,n){"use strict";function r(e,t,n,u,d,c,f,h){for(var p,m,g=d,y=0,v=!!f&&s(f,h,3);y<u;){if(y in n){if(p=v?v(n[y],y,t):n[y],m=!1,o(p)&&(m=p[l],m=void 0!==m?!!m:i(p)),m&&c>0)g=r(e,t,p,a(p.length),g,c-1)-1;else{if(g>=9007199254740991)throw TypeError();e[g]=p}g++}y++}return g}var i=n(54),o=n(4),a=n(8),s=n(19),l=n(5)("isConcatSpreadable");e.exports=r},function(e,t,n){"use strict";e.exports=!n(6)&&!n(3)(function(){return 7!=Object.defineProperty(n(67)("div"),"a",{get:function(){return 7}}).a})},function(e,t,n){"use strict";e.exports=function(e,t,n){var r=void 0===n;switch(t.length){case 0:return r?e():e.call(n);case 1:return r?e(t[0]):e.call(n,t[0]);case 2:return r?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return r?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return r?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}},function(e,t,n){"use strict";var r=n(4),i=Math.floor;e.exports=function(e){return!r(e)&&isFinite(e)&&i(e)===e}},function(e,t,n){"use strict";var r=n(1);e.exports=function(e,t,n,i){try{return i?t(r(n)[0],n[1]):t(n)}catch(t){var o=e.return;throw void 0!==o&&r(o.call(e)),t}}},function(e,t,n){"use strict";e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,n){"use strict";var r=n(76),i=Math.pow,o=i(2,-52),a=i(2,-23),s=i(2,127)*(2-a),l=i(2,-126),u=function(e){return e+1/o-1/o};e.exports=Math.fround||function(e){var t,n,i=Math.abs(e),d=r(e);return i<l?d*u(i/l/a)*l*a:(t=(1+a/o)*i,n=t-(t-i),n>s||n!=n?d*(1/0):d*n)}},function(e,t,n){"use strict";e.exports=Math.log1p||function(e){return(e=+e)>-1e-8&&e<1e-8?e-e*e/2:Math.log(1+e)}},function(e,t,n){"use strict";e.exports=Math.scale||function(e,t,n,r,i){return 0===arguments.length||e!=e||t!=t||n!=n||r!=r||i!=i?NaN:e===1/0||e===-1/0?e:(e-t)*(i-r)/(n-t)+r}},function(e,t,n){"use strict";var r=n(37),i=n(58),o=n(49),a=n(9),s=n(48),l=Object.assign;e.exports=!l||n(3)(function(){var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach(function(e){t[e]=e}),7!=l({},e)[n]||Object.keys(l({},t)).join("")!=r})?function(e,t){for(var n=a(e),l=arguments.length,u=1,d=i.f,c=o.f;l>u;)for(var f,h=s(arguments[u++]),p=d?r(h).concat(d(h)):r(h),m=p.length,g=0;m>g;)c.call(h,f=p[g++])&&(n[f]=h[f]);return n}:l},function(e,t,n){"use strict";var r=n(7),i=n(1),o=n(37);e.exports=n(6)?Object.defineProperties:function(e,t){i(e);for(var n,a=o(t),s=a.length,l=0;s>l;)r.f(e,n=a[l++],t[n]);return e}},function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(17),o=n(36).f,a={}.toString,s="object"==("undefined"==typeof window?"undefined":r(window))&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],l=function(e){try{return o(e)}catch(e){return s.slice()}};e.exports.f=function(e){return s&&"[object Window]"==a.call(e)?l(e):o(i(e))}},function(e,t,n){"use strict";var r=n(11),i=n(17),o=n(50)(!1),a=n(80)("IE_PROTO");e.exports=function(e,t){var n,s=i(e),l=0,u=[];for(n in s)n!=a&&r(s,n)&&u.push(n);for(;t.length>l;)r(s,n=t[l++])&&(~o(u,n)||u.push(n));return u}},function(e,t,n){"use strict";var r=n(37),i=n(17),o=n(49).f;e.exports=function(e){return function(t){for(var n,a=i(t),s=r(a),l=s.length,u=0,d=[];l>u;)o.call(a,n=s[u++])&&d.push(e?[n,a[n]]:a[n]);return d}}},function(e,t,n){"use strict";var r=n(36),i=n(58),o=n(1),a=n(2).Reflect;e.exports=a&&a.ownKeys||function(e){var t=r.f(o(e)),n=i.f;return n?t.concat(n(e)):t}},function(e,t,n){"use strict";var r=n(2).parseFloat,i=n(45).trim;e.exports=1/r(n(84)+"-0")!=-1/0?function(e){var t=i(String(e),3),n=r(t);return 0===n&&"-"==t.charAt(0)?-0:n}:r},function(e,t,n){"use strict";var r=n(2).parseInt,i=n(45).trim,o=n(84),a=/^[-+]?0[xX]/;e.exports=8!==r(o+"08")||22!==r(o+"0x16")?function(e,t){var n=i(String(e),3);return r(n,t>>>0||(a.test(n)?16:10))}:r},function(e,t,n){"use strict";e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},function(e,t,n){"use strict";var r=n(1),i=n(4),o=n(78);e.exports=function(e,t){if(r(e),i(t)&&t.constructor===e)return t;var n=o.f(e);return(0,n.resolve)(t),n.promise}},function(e,t,n){"use strict";var r=n(8),i=n(83),o=n(23);e.exports=function(e,t,n,a){var s=String(o(e)),l=s.length,u=void 0===n?" ":String(n),d=r(t);if(d<=l||""==u)return s;var c=d-l,f=i.call(u,Math.ceil(c/u.length));return f.length>c&&(f=f.slice(0,c)),a?f+s:s+f}},function(e,t,n){"use strict";var r=n(25),i=n(8);e.exports=function(e){if(void 0===e)return 0;var t=r(e),n=i(t);if(t!==n)throw RangeError("Wrong length!");return n}},function(e,t,n){"use strict";t.f=n(5)},function(e,t,n){"use strict";var r=n(100),i=n(46);e.exports=n(51)("Map",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{get:function(e){var t=r.getEntry(i(this,"Map"),e);return t&&t.v},set:function(e,t){return r.def(i(this,"Map"),0===e?0:e,t)}},r,!0)},function(e,t,n){"use strict";n(6)&&"g"!=/./g.flags&&n(7).f(RegExp.prototype,"flags",{configurable:!0,get:n(53)})},function(e,t,n){"use strict";var r=n(100),i=n(46);e.exports=n(51)("Set",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{add:function(e){return r.def(i(this,"Set"),e=0===e?0:e,e)}},r)},function(e,t,n){"use strict";var r,i=n(21)(0),o=n(13),a=n(31),s=n(112),l=n(102),u=n(4),d=n(3),c=n(46),f=a.getWeak,h=Object.isExtensible,p=l.ufstore,m={},g=function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},y={get:function(e){if(u(e)){var t=f(e);return!0===t?p(c(this,"WeakMap")).get(e):t?t[this._i]:void 0}},set:function(e,t){return l.def(c(this,"WeakMap"),e,t)}},v=e.exports=n(51)("WeakMap",g,y,l,!0,!0);d(function(){return 7!=(new v).set((Object.freeze||Object)(m),7).get(m)})&&(r=l.getConstructor(g,"WeakMap"),s(r.prototype,y),a.NEED=!0,i(["delete","has","get","set"],function(e){var t=v.prototype,n=t[e];o(t,e,function(t,i){if(u(t)&&!h(t)){this._f||(this._f=new r);var o=this._f[e](t,i);return"set"==e?this:o}return n.call(this,t,i)})}))},function(e,t,n){"use strict";function r(e,t){this._id=e,this._clearFn=t}var i=Function.prototype.apply;t.setTimeout=function(){return new r(i.call(setTimeout,window,arguments),clearTimeout)},t.setInterval=function(){return new r(i.call(setInterval,window,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(window,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},n(388),t.setImmediate=setImmediate,t.clearImmediate=clearImmediate},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(390),i=function(e){return e&&e.__esModule?e:{default:e}}(r);t.default=i.default},function(e,t){e.exports={_from:"@meisterplayer/meisterplayer@5.2.3",_id:"@meisterplayer/meisterplayer@5.2.3",_inBundle:!1,_integrity:"sha512-uHadI22Y/Gr4wuBuaq4Sy2fj2ikYjfJip9+LYlteSXs7Oelie97mnHkVo1qgIuptr/c9Xu8rnS84b6Aw/QBgcw==",_location:"/@meisterplayer/meisterplayer",_phantomChildren:{},_requested:{type:"version",registry:!0,raw:"@meisterplayer/meisterplayer@5.2.3",name:"@meisterplayer/meisterplayer",escapedName:"@meisterplayer%2fmeisterplayer",scope:"@meisterplayer",rawSpec:"5.2.3",saveSpec:null,fetchSpec:"5.2.3"},_requiredBy:["#USER","/"],_resolved:"https://registry.npmjs.org/@meisterplayer/meisterplayer/-/meisterplayer-5.2.3.tgz",_shasum:"53302369be97cd180fb967f74a06533cfcbfe36b",_spec:"@meisterplayer/meisterplayer@5.2.3",_where:"/Users/i.toby/workspace_triple/meister5-targets/meister-website-release-target",author:{name:"Triple"},bundleDependencies:!1,dependencies:{noop2:"^2.0.0"},deprecated:!1,description:"Meister Player: Video Player for HTML5",devDependencies:{"babel-preset-es2015":"^6.24.0","babel-preset-es2017":"^6.22.0",gulp:"^3.9.1",jest:"^20.0.4","meister-gulp-webpack-tasks":"^1.0.6","meister-js-dev":"^3.1.0",yargs:"^7.1.0"},keywords:["meister","video","plugin"],license:"Apache-2.0",main:"dist/Meister.js",name:"@meisterplayer/meisterplayer",scripts:{build:"gulp build",dist:"gulp build:min && gulp build:dist",lint:"eslint ./src/js",test:"jest","test:coverage":"jest --coverage"},version:"5.2.3"}},function(e,t){e.exports={_from:"@npm-wearetriple/meister-plugin-beacon@5.2.0",_id:"@npm-wearetriple/meister-plugin-beacon@5.2.0",_inBundle:!1,_integrity:"sha512-wLPekIygA/+2ovU95H19kdZj+nkcuhJEI2shVhXSTBBzA3yU+eA9mSEiZOAb8v7FIccZ/khmaz4ZY8Eji/aPdw==",_location:"/@npm-wearetriple/meister-plugin-beacon",_phantomChildren:{},_requested:{type:"version",registry:!0,raw:"@npm-wearetriple/meister-plugin-beacon@5.2.0",name:"@npm-wearetriple/meister-plugin-beacon",escapedName:"@npm-wearetriple%2fmeister-plugin-beacon",scope:"@npm-wearetriple",rawSpec:"5.2.0",saveSpec:null,fetchSpec:"5.2.0"},_requiredBy:["#USER","/"],_resolved:"https://registry.npmjs.org/@npm-wearetriple/meister-plugin-beacon/-/meister-plugin-beacon-5.2.0.tgz",_shasum:"aa3e6419af551106c7b25f99c9e96d1d50b1cd4d",_spec:"@npm-wearetriple/meister-plugin-beacon@5.2.0",_where:"/Users/i.toby/workspace_triple/meister5-targets/meister-website-release-target",author:{name:"Triple"},bundleDependencies:!1,dependencies:{},deprecated:!1,description:"Beacon plugin. Just install, no need to configure :)",devDependencies:{gulp:"^3.9.1","meister-gulp-webpack-tasks":"^1.0.6","meister-js-dev":"^3.1.0"},keywords:["meister","video","plugin"],license:"Apache-2.0",main:"dist/GoogleAnalytics.js",name:"@npm-wearetriple/meister-plugin-beacon",scripts:{},version:"5.2.0"}},function(e,t){e.exports={_from:"@npm-wearetriple/meister-plugin-youtube@5.2.0",_id:"@npm-wearetriple/meister-plugin-youtube@5.2.0",_inBundle:!1,_integrity:"sha512-5mWB7Yb8HM68sRaN/iTQ/runRrAFBRlBrnDnsQPdTyqCYDlaGW7hlmLn/46GrPC7Ll7Lza/VJvwSO7S2x4HzmQ==",_location:"/@npm-wearetriple/meister-plugin-youtube",_phantomChildren:{},_requested:{type:"version",registry:!0,raw:"@npm-wearetriple/meister-plugin-youtube@5.2.0",name:"@npm-wearetriple/meister-plugin-youtube",escapedName:"@npm-wearetriple%2fmeister-plugin-youtube",scope:"@npm-wearetriple",rawSpec:"5.2.0",saveSpec:null,fetchSpec:"5.2.0"},_requiredBy:["#USER","/"],_resolved:"https://registry.npmjs.org/@npm-wearetriple/meister-plugin-youtube/-/meister-plugin-youtube-5.2.0.tgz",_shasum:"bedc9c67ca9fc592ce72556007540f00648aef96",_spec:"@npm-wearetriple/meister-plugin-youtube@5.2.0",_where:"/Users/i.toby/workspace_triple/meister5-targets/meister-website-release-target",author:{name:"Triple"},bugs:{url:"https://github.com/meisterplayer/media-youtube/issues"},bundleDependencies:!1,dependencies:{"meister-heartbeat":"^1.0.2","promise-script-loader":"^0.1.3"},deprecated:!1,description:"Meister plugin for playing Youtube videos",devDependencies:{"babel-preset-es2015":"^6.24.0","babel-preset-es2017":"^6.22.0",gulp:"^3.9.1","meister-gulp-webpack-tasks":"^1.0.6","meister-js-dev":"^3.1.0"},homepage:"https://github.com/meisterplayer/media-youtube#readme",keywords:["meister","video","plugin"],license:"Apache-2.0",main:"dist/Hls.js",name:"@npm-wearetriple/meister-plugin-youtube",peerDependencies:{"@meisterplayer/meisterplayer":">= 5.1.0"},repository:{type:"git",url:"git+https://github.com/meisterplayer/media-youtube.git"},version:"5.2.0"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(139),i=function(e){return e&&e.__esModule?e:{default:e}}(r);t.default=i.default},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(){r(this,e)}return i(e,null,[{key:"register",value:function(e){window.onfocus=function(){e.eventHandler.trigger("windowFocusChange",{onForeground:!0})},window.onblur=function(){e.eventHandler.trigger("windowFocusChange",{onForeground:!1})},document.addEventListener("visibilitychange",function(){e.eventHandler.trigger("windowVisibilityChange",{visibility:document.visibilityState})}),document.addEventListener("webkitfullscreenchange",function(){e.eventHandler.trigger("playerFullscreen")}),document.addEventListener("mozfullscreenchange",function(){e.eventHandler.trigger("playerFullscreen")}),document.addEventListener("fullscreenchange",function(){e.eventHandler.trigger("playerFullscreen")}),document.addEventListener("MSFullscreenchange",function(){e.eventHandler.trigger("playerFullscreen")})}}]),e}();t.default=o},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(t){if(r(this,e),this.meister=t,this.fullscreenElement=this.meister.defaultWrapper,this.meister.config.customFullscreenElement)if("string"==typeof this.meister.config.customFullscreenElement){var n=document.querySelector(this.meister.config.customFullscreenElement);n?this.fullscreenElement=n:console.warn("Unable to find fullscreen element with queryselector "+this.meister.config.customFullscreenElement+", using default element instead.")}else this.meister.config.customFullscreenElement instanceof Node?this.fullscreenElement=this.meister.config.customFullscreenElement:console.warn("Custom fullscreen element is not of type string or Node, using default element instead.");this.meister.config.fullscreenOnDoubleClick&&(this.meister.browser.isiOS||this.meister.browser.isAndroid?(this.tapped=null,this.meister.controlsWrapper.addEventListener("touchstart",this.doubleTapCheck.bind(this))):this.meister.controlsWrapper.addEventListener("dblclick",this.toggleFullscreen.bind(this)))}return i(e,[{key:"requestFullscreen",value:function(){document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement||(this.meister.browser.isiOS?this.meister.playerPlugin.mediaElement.webkitEnterFullscreen():this.fullscreenElement.requestFullscreen?this.fullscreenElement.requestFullscreen():this.fullscreenElement.mozRequestFullScreen?this.fullscreenElement.mozRequestFullScreen():this.fullscreenElement.webkitRequestFullscreen?this.fullscreenElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT):this.fullscreenElement.msRequestFullscreen&&this.fullscreenElement.msRequestFullscreen())}},{key:"cancelFullscreen",value:function(){document.fullscreenElement?document.exitFullscreen():document.cancelFullScreen?document.cancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen(),this.meister.browser.isiOS&&this.meister.playerPlugin.mediaElement.webkitExitFullScreen()}},{key:"doubleTapCheck",value:function(){var e=this;this.tapped?(clearTimeout(this.tapped),this.tapped=null,this.toggleFullscreen()):this.tapped=setTimeout(function(){e.tapped=null},300)}},{key:"toggleFullscreen",value:function(){this.meister.isFullscreen?this.cancelFullscreen():this.requestFullscreen()}},{key:"isFullscreen",get:function(){return!!(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement)}}]),e}();t.default=o},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(152),l=r(s),u=n(153),d=r(u),c=n(154),f=r(c),h="en",p={},m=function(){function e(){i(this,e)}return a(e,null,[{key:"init",value:function(t){t?e.setFromFormattedObject(f.default):(console.warn("In future Meister versions this localization method is deprecated. Set i18nEnabled to true in the Meister global object."),Object.keys(l.default).forEach(function(t){e.set(t,l.default[t],"en")}),Object.keys(d.default).forEach(function(t){e.set(t,d.default[t],"nl")}))}},{key:"set",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:h;p[n]||(p[n]={});var r=e;"object"===(void 0===t?"undefined":o(t))?r=t[n]:"string"==typeof t&&(r=t),p[n][e]=r}},{key:"setFromFormattedObject",value:function(t){Object.keys(t).forEach(function(n){Object.keys(t[n]).forEach(function(r){e.set(n,t[n][r],r)})})}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:h;return p[t][e]}},{key:"all",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h;return p[e]}},{key:"setLanguage",value:function(e){h=e}}]),e}();t.default=m},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(t){var n=this;r(this,e),this.meister=t,this.currentPlugin=null,this.adBreakPlaying=!1,this.meister.on("adBreakStarted",function(){n.adBreakPlaying=!0}),this.meister.on(["adBreakEnded","itemUnloaded"],function(){n.adBreakPlaying=!1})}return i(e,[{key:"loadNewItem",value:function(e){var t=this;if(this.meister.config.disableLoadDuringAd&&this.adBreakPlaying)return this.meister.trigger("itemLoadPrevented",{error:"adPlaying"}),void console.warn("Unable to switch content while ad is playing");this.plugin&&(this.plugin.unload(),this.plugin=null),this.meister.trigger("itemUnloaded"),this.getPluginFor(e).then(function(n){t.plugin=n,t.plugin.process(e).then(function(n){var r=t.plugin.load(n);r?r.then(function(){t.meister.trigger("itemLoaded",{item:n})}).catch(function(n){console.error("@"+t.plugin.name+": Could not load item with type: '"+e.type+"' and src: '"+e.src+"'.",n)}):t.meister.trigger("itemLoaded",{item:n})}).catch(function(n){t.meister.error("Could not find plugin to play type: '"+e.type+"'.",n.errorCode,{title:"Unable to play content."}),console.error("@"+t.plugin.name+": Could not process item with type: '"+e.type+"' and src: '"+e.src+"'.",n)})}).catch(function(n){console.error("@"+t.plugin.name+": Could not getPluginFor item with type: '"+e.type+"' and src: '"+e.src+" '.",n)})}},{key:"switchItem",value:function(e){this.loadNewItem(e)}},{key:"getPluginFor",value:function(e){return this.meister.pluginLoader.getPluginByItem(e).then(function(e){if(e.errorCode)throw e;return e})}},{key:"currentItem",get:function(){return this.plugin&&this.plugin.currentItem?this.plugin.currentItem:(console.warn(this.plugin.name+" does not provide metadata."),{})}},{key:"duration",get:function(){return this.plugin?this.plugin.duration:NaN}},{key:"currentTime",get:function(){return this.plugin?this.plugin.currentTime:NaN},set:function(e){this.plugin&&(this.plugin.currentTime=e)}}]),e}();t.default=o},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(131),s=r(a),l=n(142),u=r(l),d=n(91),c=r(d),f=n(151),h=r(f),p=n(92),m=r(p),g=n(135),y=r(g),v=n(164),_=r(v),b=n(163),E=r(b),T=n(161),S=r(T),x=n(162),w=r(x),I=n(141),D=r(I),R=n(138),A=r(R),P=n(136),M=r(P),L=n(93),C=r(L),O=n(143),k=r(O),N=n(137),F=r(N),B=n(155),U=r(B),j=n(94),H=r(j),q=n(157),V=r(q),G=n(158),K=r(G),z=n(159),Y=r(z),W=n(160),X=r(W),Q=n(156),Z=r(Q),J=n(29),$=r(J);window!==window.top&&(console.warn=console.log.bind(console),console.error=console.log.bind(console));var ee=[],te=function(){function e(t,n){var r=this;i(this,e);var o={global:{}},a=Object.assign({},o,n);if((0,v.isDOMNode)(t)?this.wrapper=t:this.wrapper=document.querySelector(t),!this.wrapper)throw Error("Wrapper with Queryseletor: "+t+" not found.");if(this.eventHandler=new h.default(m.default),this.instanceId=Math.random(),this.utils=_.default,this.elementUtils=E.default,this.browser=S.default,this.Localization=F.default,w.default.init(),this.config=c.default.getGlobals(a.global),this.config.language&&this.Localization.setLanguage(this.config.language),this.Localization.init(this.config.i18nEnabled),this.config.autoplay)if(this.browser.isMobile||this.browser.isNonAutoPlay&&!this.config.startMuted){var s=this.config.autoplay;this.config.autoplay=!1,this.one("playerPlay",function(){r.config.autoplay=s,r.on("itemLoaded",function(){return r.trigger("requestPlay")},"meister")},"meister")}else this.on("itemLoaded",function(){return r.trigger("requestPlay")},"meister");this.config.fullscreenOnDoubleClick&&(this.config.iosPlaysInline=!0),this.container=document.createElement("div"),this.defaultWrapper=document.createElement("div"),this.playerWrapper=document.createElement("div"),this.controlsWrapper=document.createElement("div"),this.adWrapper=document.createElement("div"),this.container.classList.add("pf-player-container"),this.defaultWrapper.classList.add("pf-default-wrapper"),this.playerWrapper.classList.add("pf-player"),this.controlsWrapper.classList.add("pf-controls"),this.config.controls||this.controlsWrapper.classList.add("pf-ui-element-hidden"),this.elementUtils.classListAdd(this.adWrapper,"pf-ads","pf-ui-element-hidden"),this.wrapper.appendChild(this.container),this.container.appendChild(this.defaultWrapper),this.defaultWrapper.appendChild(this.playerWrapper),this.defaultWrapper.appendChild(this.controlsWrapper),this.defaultWrapper.appendChild(this.adWrapper),c.default.overwrite(a),this.pluginLoader=new u.default(this),this.pluginLoader.config(a,this),this.pluginLoader.drawUiPlugins(),this.pluginLoader.loadAnalyticsPlugins(),y.default.register(this),this.playerPlugin=null,this.playlist=null,this.mediaController=new A.default(this),this.fullscreenController=new M.default(this),this.on("requestDrmKeySystemSupport",function(){r.trigger("drmKeySystemSupport",[])}),ee.push({id:this.instanceId,instance:this})}return o(e,[{key:"load",value:function(){this.playlist.loadCurrentIndex()}},{key:"destroy",value:function(){var e=this;this.wrapper.innerHTML="",this.trigger("requestDestroy"),setTimeout(function(){e.pluginLoader=null,e.playerPlugin=null,e.playlist=null,e.mediaController=null,e.fullscreenController=null,e.eventHandler.destroy(),ee=ee.filter(function(t){return t.id===e.id})},0)}},{key:"play",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.trigger("requestPlay",{triggerByUser:e})}},{key:"pause",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.trigger("requestPause",{triggerByUser:e})}},{key:"requestFullscreen",value:function(){this.fullscreenController&&this.fullscreenController.requestFullscreen()}},{key:"cancelFullscreen",value:function(){this.fullscreenController&&this.fullscreenController.cancelFullscreen()}},{key:"getPlayerByType",value:function(e,t){var n=this.pluginLoader.getPlayerPluginByType(e,t);return this.playerPlugin?this.playerPlugin&&this.playerPlugin.name!==n.name&&(this.playerPlugin.unload(),this.playerWrapper.innerHTML="",this.playerPlugin=n,this.playerPlugin.load(t)):n?(this.playerPlugin=n,this.playerPlugin.load(t)):console.warn("Could not find player with type '"+e+"'"),this.playerPlugin}},{key:"setItem",value:function(e){if(!e.type)throw new TypeError("Item must have a type attribute.");if("aditem"!==e.type&&"multi-source"!==e.type&&!e.src)throw new TypeError("Non-aditem items must have a src attribute.");this.playlist=new D.default([e],this)}},{key:"setPlaylist",value:function(e){for(var t=0;t<e.length;t+=1){if(!e[t].type)throw new TypeError("Item "+t+": Item must have a type attribute.");if("aditem"!==e[t].type&&"multi-source"!==e[t].type&&!e[t].src)throw new TypeError("Item "+t+": Non-aditem items must have a src attribute.")}this.playlist=new D.default(e,this)}},{key:"switchItem",value:function(e){this.mediaController.switchItem(e)}},{key:"on",value:function(e,t,n){return this.eventHandler.on(e,t,n)}},{key:"one",value:function(e,t,n,r){return this.eventHandler.one(e,t,n,r)}},{key:"trigger",value:function(){var e;(e=this.eventHandler).trigger.apply(e,arguments)}},{key:"remove",value:function(e){this.eventHandler.remove(e)}},{key:"disable",value:function(e,t){this.eventHandler.disable(e,t)}},{key:"enable",value:function(e,t){this.eventHandler.enable(e,t)}},{key:"error",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ERR-9001",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};console.error(t+" - "+e),this.eventHandler.trigger("error",{message:e,code:t,options:n})}},{key:"debugEnabled",get:function(){return this.config.debug},set:function(e){this.config.debug=e}},{key:"showControls",get:function(){return this.config.controls},set:function(e){e?this.controlsWrapper.classList.remove("pf-ui-element-hidden"):this.controlsWrapper.classList.add("pf-ui-element-hidden"),this.config.controls=e}},{key:"playerMode",get:function(){return this.config.audioOnly?"audio":"video"}},{key:"volume",get:function(){return this.playerPlugin?this.playerPlugin.volume:null},set:function(e){this.playerPlugin&&(C.default.set("volume",e),this.playerPlugin.volume=e)}},{key:"muted",get:function(){return this.playerPlugin?this.playerPlugin.muted:null},set:function(e){this.playerPlugin&&(this.playerPlugin.muted=e)}},{key:"playing",get:function(){return this.playerPlugin?this.playerPlugin.playing:null}},{key:"currentItem",get:function(){return this.mediaController?this.mediaController.currentItem:null}},{key:"duration",get:function(){return this.mediaController?this.mediaController.duration:null}},{key:"currentTime",get:function(){return this.mediaController?this.mediaController.currentTime:null},set:function(e){this.mediaController&&(this.mediaController.currentTime=e)}},{key:"isFullscreen",get:function(){return this.fullscreenController?this.fullscreenController.isFullscreen:null}},{key:"playerType",get:function(){return this.playerPlugin.type}}],[{key:"registerPlugin",value:function(e,t){return u.default.register(e,t)}},{key:"registerMiddleware",value:function(e,t){return u.default.registerMiddleware(e,t)}},{key:"version",get:function(){return s.default.version}},{key:"pluginVersions",get:function(){var e=u.default.getRegistered(),t=[];return e.forEach(function(e){var n=e.Plugin.pluginName.toLowerCase();-1===t.findIndex(function(e){return e.pluginName.toLowerCase()===n})&&t.push({pluginName:e.Plugin.pluginName,pluginVersion:e.Plugin.pluginVersion})}),t}},{key:"instances",get:function(){return ee}}]),e}();window.Meister=te,te.MediaPlugin=H.default,te.ParserPlugin=V.default,te.PlayerPlugin=K.default,te.Ui=Y.default,te.UiPlugin=X.default,te.AnalyticsPlugin=U.default,te.Middleware=Z.default,te.ProtoPlugin=$.default,te.Browser=S.default,te.ErrorCodes=k.default,te.PluginLoader=u.default,te.Configuration=c.default,window.Vinson=te,t.default=te},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},l=n(94),u=function(e){return e&&e.__esModule?e:{default:e}}(l),d=function(e){function t(e){r(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{name:"parallel-builtin"},e));return n.meister=e,n.plugins=[],n.bitrates=null,n.currentBitrateIndex=0,n.plugin=null,n.eventStore=[],n}return o(t,e),a(t,[{key:"isItemSupported",value:function(e){return new Promise(function(t){return t("media"!==e.type?{supported:!1,errorCode:Meister.ErrorCodes.WRONG_TYPE}:{supported:!0})})}},{key:"process",value:function(e){var t=this;return new Promise(function(n,r){var i=[];t.bitrates=e.bitrates,t.currentBitrateIndex=Math.floor(t.bitrates.length/2);var o=t.bitrates[t.currentBitrateIndex];if("m3u"!==o.type&&"m3u8"!==o.type&&"mpd"!==o.type&&"dash"!==o.type&&o.metadata){t.bitrates.sort(function(e,t){return e.metadata.bitrate-t.metadata.bitrate});for(var a=[],s=0;s<t.bitrates.length;s+=1){var l=t.bitrates[s];l.default&&(t.currentBitrateIndex=s),a.push({bitrate:l.metadata.bitrate,index:s})}t.meister.trigger("itemBitrates",{bitrates:a,currentIndex:t.currentBitrateIndex})}t.meister.pluginLoader.getPluginByItem(t.bitrates[t.currentBitrateIndex]).then(function(o){if(o.errorCode)return void t.meister.error("Could not find plugin to play type: '"+t.bitrates[t.currentBitrateIndex].type+"'.",o.errorCode,{title:"Unable to play content."});t.plugin=o;var a=[];i.push(t.plugin.process(t.bitrates[t.currentBitrateIndex])),e.parallel.forEach(function(e){var n=t.meister.pluginLoader.getPluginByItem(e);n.errorCode||a.push(n)}),Promise.all(a).then(function(o){o.forEach(function(n,r){n.errorCode||(t.plugins.push(n),i.push(n.process(e.parallel[r])))}),Promise.all(i).then(function(){n(e)}).catch(function(e){r(e)})})})})}},{key:"load",value:function(e){var t=this;this.plugin.load(this.bitrates[this.currentBitrateIndex]),this.plugins.forEach(function(t,n){t.load(e.parallel[n])}),this.plugin.onRequestBitrate||this.on("requestBitrate",function(e){return t.onRequestBitrate(e.bitrateIndex)})}},{key:"unload",value:function(){s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"unload",this).call(this),this.plugin&&this.plugin.unload(),this.plugins.forEach(function(e){e.unload()}),this.plugins=[]}},{key:"onRequestBitrate",value:function(e){if(this.currentBitrateIndex!==e){if(this.currentBitrateIndex=e,this.plugin&&this.plugin.changeBitrate)return void this.plugin.changeBitrate(this.currentBitrateIndex);var t=this.meister.currentTime,n=this.meister.playing;this.plugin.unload(),this.plugin.load(this.bitrates[this.currentBitrateIndex]),this.meister.currentTime=t,n&&this.meister.play();var r=this.bitrates[this.currentBitrateIndex].metadata?this.bitrates[this.currentBitrateIndex].metadata.bitrate:0;this.meister.trigger("playerSwitchBitrate",{newBitrate:r,newBitrateIndex:e})}}},{key:"currentItem",get:function(){return this.plugin?this.plugin.currentItem:null}},{key:"duration",get:function(){return this.plugin?this.plugin.duration:NaN}},{key:"currentTime",get:function(){return this.plugin?this.plugin.currentTime:NaN},set:function(e){this.plugin&&(this.plugin.currentTime=e)}}]),t}(u.default);t.default=d},function(e,t,n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(){function e(t,n){var r=this;i(this,e),this.list=t,this.meister=n,this.index=0,this.meister.on("playlistNext",function(){return r.next()}),this.meister.on("playlistPrevious",function(){return r.previous()}),this.meister.on("playlistGoTo",function(e){return r.goTo(e.index)}),this.meister.on("playerEnd",function(){r.meister.config.autoplay&&r.index<r.list.length-1&&r.next()})}return o(e,[{key:"loadCurrentIndex",value:function(){var e=this;this.meister.trigger("showLoading",{code:"INITIALIZING"});var t=this.list[this.index];this.getPluginFor(t).then(function(n){e.meister.trigger("playlistMetadata",t),n instanceof Meister.ParserPlugin?n.process(t).then(function(t){if(t instanceof Array){var n=e.list.slice(0,e.index);n.push.apply(n,r(t)),n.push.apply(n,r(e.list.slice(e.index+1))),e.list=n}else e.list[e.index]=t;e.loadCurrentIndex()}).catch(function(e){console.error("Could not process item with type: "+t.type+" and src: "+t.src+". \n"+e)}):n instanceof Meister.MediaPlugin&&(e.meister.switchItem(t),e.meister.trigger("playlistInfo",{currentIndex:e.index,length:e.list.length}))}).catch(function(n){e.meister.error("Could not find plugin to play type: '"+t.type+"'.",n.errorCode,{title:"Unable to play content."}),console.error("Could not load item with type: '"+t.type+"' and src: '"+t.src+"'.")})}},{key:"next",value:function(){var e=this.index+1;this.goTo(e)}},{key:"previous",value:function(){var e=this.index-1;this.goTo(e)}},{key:"goTo",value:function(e){if(e<0||e>=this.list.length)return void console.error("Playlist index '"+e+"' is out of bounds.");this.index=e,this.loadCurrentIndex()}},{key:"getPluginFor",value:function(e){return this.meister.pluginLoader.getPluginByItem(e).then(function(e){if(e.errorCode)throw e;return e})}}]),e}();t.default=a},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(91),s=r(a),l=n(140),u=r(l),d=[],c=[],f=[],h=function(){function e(t){i(this,e),this.loaded=[],this.meister=t}return o(e,[{key:"getLoadedPlugin",value:function(e){return this.loaded.find(function(t){return t.name===e})}},{key:"config",value:function(t,n){var r=this,i={};Meister.builtIn&&Object.keys(Meister.builtIn).forEach(function(e){t[e]||(i[e]=Meister.builtIn[e])}),Object.assign(i,t),Object.keys(i).forEach(function(t){var i=e.get(t);if(!i)return void("global"!==t&&console.warn(t+" is not a registered plugin."));var o={};o=s.default.get(t),o.name=t;var a=function(t){return e.execMiddleware(o.middleware,n,t)};r.loaded.push({name:i.name,plugin:new i.Plugin(o,n,a),middleware:o.middleware})}),this.loaded.push({name:"parallel",plugin:new u.default(n)})}},{key:"getPluginByItem",value:function(e){e.drmConfig&&this.meister.trigger("drmConfig",e.drmConfig);var t=[],n=[];return this.loaded.forEach(function(r){if(r.plugin.isItemSupported){n.push(r);var i=r.plugin.isItemSupported(e);t.push(i)}}),Promise.all(t).then(function(e){for(var t=Meister.ErrorCodes.WRONG_TYPE,r=0;r<e.length;r+=1){var i=e[r];if(i.supported)return n[r].plugin;i.errorCode!==Meister.ErrorCodes.WRONG_TYPE&&(t=i.errorCode)}return{errorCode:t}})}},{key:"getPlayerPluginByType",value:function(e){var t=this.loaded.find(function(t){return!!t.plugin.isTypeSupported&&t.plugin.isTypeSupported(e)});return t?t.plugin:null}},{key:"drawUiPlugins",value:function(){this.loaded.forEach(function(e){e.plugin.draw&&e.plugin.draw()})}},{key:"loadAnalyticsPlugins",value:function(){this.loaded.forEach(function(e){e.plugin.isAnalytics&&e.plugin.load()})}}],[{key:"getRegistered",value:function(){return d}},{key:"getLoaded",value:function(){return c}},{key:"get",value:function(e){return d.find(function(t){return t.name===e})}},{key:"getMiddleware",value:function(e){return f.find(function(t){return t.name===e})}},{key:"execMiddleware",value:function(e,t,n){var r=this,i=[];return e&&e.length?(e.forEach(function(e){var n=r.getMiddleware(e);i.push(new n.Middleware({},t))}),this.processMiddlewares(i,n)):new Promise(function(e){e(n)})}},{key:"processMiddlewares",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return e[r].process(t).then(function(t){return e[r+1]?n.processMiddlewares(e,t,r+1):t})}},{key:"register",value:function(e,t){var n=this.get(e);if(n)return console.warn("Plugin "+e+" is already registered. Overriding previous version."),void(n.Plugin=t);d.push({name:e,Plugin:t})}},{key:"registerMiddleware",value:function(e,t){var n=this.getMiddleware(e);if(n)return console.warn("Middleware "+e+" is already registered. Overriding previous version."),void(n.Middleware=t);f.push({name:e,Middleware:t})}}]),e}();t.default=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={WRONG_TYPE:"MSTR-0001",NOT_SUPPORTED:"MSTR-0002",NO_DRM:"MSTR-0003",NO_MEDIA_FOUND:"MSTR-0404",FAIRPLAY_CONTENT_ID_FUNCTION_ERROR:"MSTR-1001"};t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=["adBreakStarted","adBreakEnded","adStarted","adEnded","adTimeupdate","adCuePoints"];t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=["requestPlay","requestSeek","requestPause","requestBitrate"];t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=["windowFocusChange","windowVisibilityChange"];t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=["itemLoadPrevented","itemLoaded","itemUnloaded","itemMetadata","itemTimeInfo","itemLanguages","itemCaptions","itemBitrates","itemImagestream"];t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=["playerCreated","playerDestroyed","_playerTimeUpdate","playerTimeUpdate","playerPlay","playerPlaying","playerFirstPlay","playerReplay","playerPause","_playerSeek","playerSeek","playerSeeking","playerNudge","playerEnd","playerError","playerVolumeChange","playerFullscreen","playerSwitchBitrate","playerAutoSwitchBitrate","playerProgress","playerLoadedMetadata","playerDurationChange","playerBuffering","playerBufferedEnough","playerRemoteConnecting","playerRemoteConnected","playerRemoteDisconnected"];t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=["playlistInfo","playlistNext","playlistPrevious","playlistGoTo","playlistMetadata"];t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=["uiReady","uiPluginInserted","uiPluginOpen","uiPluginClose"];t.default=r},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(384),a=function(e){return e&&e.__esModule?e:{default:e}}(o),s=function(){function e(t){r(this,e),this.counter=0,this.disabledHandles=[],this.protectedHandles={},this.stack={};for(var n=0;n<t.length;n+=1){var i=t[n];this.stack[i]=[]}}return i(e,[{key:"on",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Anonymous";if(!(t instanceof Function))return console.error("EventHandler: Provided handler is not a function."),null;var i=Array.isArray(e)?e:[e],o=[];return i.forEach(function(e){n.stack[e]||(n.stack[e]=[]);var i=n._createHandler(r,t);n.stack[e].push(i),o.push({id:i.id,hook:e})}),o}},{key:"one",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Anonymous",i=e,o=t,a=n,s=r;if("boolean"!=typeof t&&(s=a,a=o,o=!1),!(a instanceof Function))return console.error("EventHandler: Provided handler is not a function."),null;this.stack[i]||(this.stack[i]=[]),this.stack[i].one||(this.stack[i].one=[]);var l=this._createHandler(s,a,o);return this.stack[i].one.push(l),{id:l.id,hook:i}}},{key:"_createHandler",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r={id:this.counter,caller:e,method:t,block:n};return this.counter+=1,r}},{key:"remove",value:function(e){var t=this;(Array.isArray(e)?e:[e]).forEach(function(e){t.stack[e.hook].one&&(t.stack[e.hook].one=t.stack[e.hook].one.filter(function(t){return t.id!==e.id}),0===t.stack[e.hook].one.length&&delete t.stack[e.hook].one),t.stack[e.hook]=t.stack[e.hook].filter(function(t){return t.id!==e.id})})}},{key:"destroy",value:function(){var e=this;Object.keys(this.stack).forEach(function(t){e.stack[t].forEach(function(n){e.remove({id:n.id,hook:t})})})}},{key:"trigger",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.splice(0,1)[0];if(this.stack[r]){if(-1!==this.disabledHandles.indexOf(r))return this.protectedHandles[r]&&this.protectedHandles[r](t),void console.debug("EventHandler: '"+r+"' is disabled, skipping trigger");if(0!==this.stack[r].length||this.stack[r].one){if(this.stack[r].one){for(var i=!1,o=0;o<this.stack[r].one.length;o+=1){var a=this.stack[r].one[o];i||(i=a.block);try{a.method.apply(null,t)}catch(e){console.error("EventHandler: Handle from '"+a.caller+"' for '"+r+"' failed. Error: "+e)}}if(delete this.stack[r].one,i)return}for(var s=0;s<this.stack[r].length;s+=1){var l=this.stack[r][s];try{l.method.apply(null,t)}catch(e){console.error("EventHandler: Handle from '"+l.caller+"' for '"+r+"' failed. Error: "+e)}}}}}},{key:"disable",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.default;this.protectedHandles[e]=t,-1===this.disabledHandles.indexOf(e)&&this.disabledHandles.push(e)}},{key:"enable",value:function(e){this.protectedHandles[e]=a.default;var t=this.disabledHandles.indexOf(e);-1!==t&&this.disabledHandles.splice(t,1)}}]),e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={VIDEO_ACQUIRING_LICENSE:"Acquiring license..",VIDEO_BUFFERING:"Buffering...",VIDEO_ACQUIRING_MANIFEST:"Retrieving manifest..",INITIALIZING:"Initializing",NONE:"None",AD_COUNT:"ad",OF_COUNT:"of"};t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={VIDEO_ACQUIRING_LICENSE:"Ophalen licentie..",VIDEO_BUFFERING:"Bufferen...",VIDEO_ACQUIRING_MANIFEST:"Ophalen manifest..",INITIALIZING:"Initialiseren",NONE:"Geen",AD_COUNT:"advertentie",OF_COUNT:"van"};t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={VIDEO_ACQUIRING_LICENSE:{en:"Acquiring license..",nl:"Ophalen licentie.."},VIDEO_BUFFERING:{en:"Buffering...",nl:"Bufferen..."},VIDEO_ACQUIRING_MANIFEST:{en:"Retrieving manifest..",nl:"Ophalen manifest..."},INITIALIZING:{en:"Initializing",nl:"Initialiseren"},NONE:{en:"None",nl:"Geen"},SOMETHING_WENT_WRONG:{en:"Whoops.. Something went wrong..",nl:"Oeps.. Iets ging mis.."},COULD_NOT_PLAY_CONTENT:{en:"Could not play content",nl:"Kon content niet afspelen"},NETWORK_ERROR:{en:"Network error",nl:"Netwerk fout"},AD_COUNT:{en:"ad",nl:"advertentie"},OF_COUNT:{en:"of",nl:"van"}};t.default=r},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},u=n(29),d=r(u),c=n(92),f=r(c),h=function(e){function t(){return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,[{key:"isAnalytics",value:function(){return!0}},{key:"load",value:function(){var e=this;f.default.forEach(function(t){var n=t.charAt(0).toUpperCase()+t.substring(1),r="on"+n;e[r]&&e.on(t,function(t){e[r](t)})})}},{key:"unload",value:function(){l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"unload",this).call(this)}},{key:"onPlayerRemoteConnected",value:function(){this.deferLogging=!0}},{key:"onPlayerRemoteDisconnected",value:function(){this.deferLogging=!1}}]),t}(d.default);t.default=h},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(29),l=function(e){return e&&e.__esModule?e:{default:e}}(s),u=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),a(t,[{key:"isItemSupported",value:function(){return new Promise(function(e){return e({supported:!1,errorCode:Meister.ErrorCodes.WRONG_TYPE})})}},{key:"process",value:function(e){return new Promise(function(t){t(e)})}}]),t}(l.default);t.default=u},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},l=n(29),u=function(e){return e&&e.__esModule?e:{default:e}}(l),d=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),a(t,[{key:"isItemSupported",value:function(){return new Promise(function(e){return e({supported:!1,errorCode:Meister.ErrorCodes.WRONG_TYPE})})}},{key:"process",value:function(e){return new Promise(function(t){console.error("Process not implemented. Player may not play correctly."),t(e)})}},{key:"unload",value:function(){s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"unload",this).call(this)}}]),t}(u.default);t.default=d},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},u=n(29),d=r(u),c=n(93),f=r(c),h=function(e){function t(e,n){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.wrapper=r.meister.playerWrapper,r.mediaElement=null,r}return a(t,e),s(t,[{key:"isTypeSupported",value:function(){return!1}},{key:"load",value:function(){var e=this;this.on("requestPlay",this.play.bind(this)),this.on("requestPause",this.pause.bind(this)),this.one("playerCreated",function(){var t=f.default.get("volume");t&&(e.volume=t)})}},{key:"unload",value:function(){l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"unload",this).call(this),this.mediaElement=null}},{key:"hide",value:function(){this.mediaElement.style.display="none"}},{key:"show",value:function(){this.mediaElement.style.display="block"}},{key:"play",value:function(){}},{key:"pause",value:function(){}},{key:"currentTime",get:function(){console.warn("currentTime getter is not defined.")},set:function(e){console.warn("currentTime setter is not defined. Can't process "+e+".")}},{key:"duration",get:function(){console.warn("duration getter is not defined.")}},{key:"playing",get:function(){console.warn("playing getter is not defined.")}},{key:"buffered",get:function(){console.warn("bufferd getter is not defined.")}},{key:"controls",get:function(){console.warn("controls getter is not defined.")},set:function(e){console.warn("controls setter is not defined. Can't process "+e+".")}},{key:"currentSrc",get:function(){console.warn("currentSrc getter is not defined.")},set:function(e){console.warn("currentSrc setter is not defined. Can't process "+e+".")}},{key:"type",get:function(){return this.playerType},set:function(e){this.playerType=e}}]),t}(d.default);t.default=h},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(29),s=function(e){return e&&e.__esModule?e:{default:e}}(a),l=function(e){function t(e,n){r(this,t);var o=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return o.controlsWrapper=o.meister.controlsWrapper,o.element=null,o}return o(t,e),t}(s.default);t.default=l},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(29),l=function(e){return e&&e.__esModule?e:{default:e}}(s),u=function(e){function t(e,n){r(this,t);var o=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));o.element=null;var a=o.config.parentSelector;return a?(o.parentElement=document.querySelector(a),o.parentElement||console.warn("Unable to find element with parentSelector '"+a+"', "+o.name+" is disabled.")):o.one("uiReady",function(e){return o.onUiReady(e)}),o}return o(t,e),a(t,[{key:"onPluginOpen",value:function(e){e.name===this.name&&this.element.classList.remove("pf-ui-element-hidden")}},{key:"onPluginClose",value:function(){this.element.classList.add("pf-ui-element-hidden")}},{key:"onUiReady",value:function(e){e.pluginSpace.appendChild(this.element),this.element.classList.add("pf-ui-element-hidden"),this.on("uiPluginOpen",this.onPluginOpen.bind(this)),this.on("uiPluginClose",this.onPluginClose.bind(this)),this.meister.trigger("uiPluginInserted",{icon:this.config.icon,name:this.name})}},{key:"draw",value:function(){this.parentElement&&this.parentElement.appendChild(this.element)}}]),t}(l.default);t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={},i=navigator.userAgent,o=function(){var e=/\b(playstation 4|nx|opera|chrome|edge|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i,t=i.match(e)||[],n=void 0;if(/trident/i.test(t[1]))return n=/\brv[ :]+(\d+)/g.exec(i)||[],{name:"IE",version:parseInt(n[1]||"",10)};if("Chrome"===t[1]){if(null!==(n=i.match(/\bOPR\/(\d+)/)))return{name:"Opera",version:parseInt(n[1],10)};if(null!==(n=i.match(/\bEdge\/(\d+\.\d+)/)))return{name:"Edge",version:parseFloat(n[1])}}return t=t[2]?[t[1],t[2]]:[navigator.appName,navigator.appVersion,"-?"],n=i.match(/version\/(\d+)/i),n&&t.splice(1,1,n[1]),{name:t[0],version:parseInt(t[1],10)}}();r.isSafari=/safari/i.test(i)&&-1===i.indexOf("Chrome"),r.isEdge=/edge/i.test(i),r.isChrome=/chrome/i.test(i)&&!r.isEdge,r.isChrome64=r.isChrome&&/\bx64/i.test(i),r.isFirefox=/firefox/i.test(i),r.isLegacyIE=!!window.ActiveXObject,r.isIE=r.isLegacyIE||/trident.*rv:1\d/i.test(i),r.isIE11=/trident.*rv:11/i.test(i),r.isChromecast=r.isChrome&&/CrKey/i.test(i),r.isMobile=/Android|webOS|iPhone|iPad|iPod|BlackBerry|Windows Phone|IEMobile|Opera Mini/i.test(i),r.isiOS=/iPad|iPhone|iPod/i.test(i),r.isAndroid=/Android/i.test(i),r.isWindowsPhone=/Windows Phone/i.test(i),r.isWin8App=/MSAppHost/i.test(i),r.isWiiU=/WiiU/i.test(i),r.isPS4=/PlayStation 4/i.test(i),r.isSamsungBrowser=/SamsungBrowser/i.test(i),r.isSamsung=/SAMSUNG/i.test(i),r.isMacintosh=/Macintosh/i.test(i),r.isFacebook=/FBAN/i.test(i)&&/FBAV/i.test(i),r.name=o.name,r.version=o.version,r.isNonAutoPlay=!1,r.isMobile?r.isNonAutoPlay=!0:r.isSafari&&r.version>=11&&(r.isNonAutoPlay=!0),t.default=r},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(){r(this,e)}return i(e,null,[{key:"init",value:function(){"remove"in Element.prototype||(Element.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)})}}]),e}();t.default=o},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(){r(this,e)}return i(e,null,[{key:"classListAdd",value:function(e){for(var t=0;t<(arguments.length<=1?0:arguments.length-1);t+=1){var n=arguments.length<=t+1?void 0:arguments[t+1];e.classList.add(n)}}},{key:"classListRemove",value:function(e){for(var t=0;t<(arguments.length<=1?0:arguments.length-1);t+=1){var n=arguments.length<=t+1?void 0:arguments[t+1];e.classList.remove(n)}}}]),e}();t.default=o},function(e,t,n){"use strict";function r(e){if(isNaN(e))return"-";var t=Math.floor(e/3600),n=Math.floor((e-3600*t)/60),r=e-3600*t-60*n;return 0!==t&&n<10&&(n="0"+n),r<10&&(r="0"+r),0!==t?t+":"+n+":"+r:n+":"+r}function i(e){return e<0?NaN:e/1e3+"Kbps"}function o(e,t){var n=document.querySelector("base"),r=document.querySelector("head"),i=document.createElement("a"),o=n,a=void 0;n?a=n.href:o=r.appendChild(document.createElement("base")),o.href=e,i.href=t;var s=i.href;return n?n.href=a:r.removeChild(o),s}function a(e){try{return e instanceof HTMLElement}catch(t){return"object"===(void 0===e?"undefined":s(e))&&1===e.nodeType&&"object"===s(e.style)&&"object"===s(e.ownerDocument)}}Object.defineProperty(t,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.timeToHMS=r,t.bitrateToResolution=i,t.resolveUrl=o,t.isDOMNode=a,t.default={timeToHMS:r,bitrateToResolution:i,resolveUrl:o,isDOMNode:a}},function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports=function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/",t(t.s=3)}([function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=function(e){return e&&e.__esModule?e:{default:e}}(r);t.default=i.default},function(e,t,n){function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":r(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":r(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},u=n(2),d=function(e){return e&&e.__esModule?e:{default:e}}(u),c=function(e){function t(e,n){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.player=null,r.supports=["mp4","mp3","icecast","mov"],r.meister.browser.isSamsung&&!window.MediaSource&&r.supports.push("m3u","m3u8"),r}return a(t,e),s(t,[{key:"isItemSupported",value:function(e){var t=this;return new Promise(function(n){return n(-1===t.supports.indexOf(e.type)?{supported:!1,errorCode:Meister.ErrorCodes.WRONG_TYPE}:{supported:!0})})}},{key:"process",value:function(e){var t=this;return new Promise(function(n,r){t.player=t.meister.getPlayerByType("html5",e),t.player?(t.item=e,t.meister.trigger("uiEvent",{type:"splash",info:t.item.metadata}),n(e)):r(t.name+": Unable to play item "+e.src+", no suitable player available.")})}},{key:"load",value:function(e){var n=this;l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"load",this).call(this,e),this.player.currentSrc=e.src,e.metadata&&this.meister.trigger("itemMetadata",{title:e.metadata.title}),"m3u"!==e.type&&"m3u8"!==e.type||this.meister.trigger("itemBitrates",{bitrates:[{metadata:{bitrate:0}}],currentIndex:0}),this.one("playerLoadedMetadata",function(){var e=!1,t=n.player.duration;t!==1/0&&0!==t||(e=!0),n.meister.trigger("itemTimeInfo",{isLive:e,duration:t})})}},{key:"unload",value:function(){l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"unload",this).call(this),this.item=null}},{key:"_onPlayerTimeUpdate",value:function(){this.meister.trigger("playerTimeUpdate",{currentTime:this.player.currentTime,duration:this.player.duration})}},{key:"_onPlayerSeek",value:function(){var e=this.player.currentTime,t=this.player.duration,n=e/t;this.meister.trigger("playerSeek",{relativePosition:n,currentTime:e,duration:t})}},{key:"onRequestSeek",value:function(e){var t=void 0;isNaN(e.relativePosition)?isNaN(e.timeOffset)||(t=this.player.currentTime+e.timeOffset):t=e.relativePosition*this.player.duration,this.blockSeekForward&&t>this.player.currentTime||Number.isFinite(t)&&(this.player.currentTime=t)}},{key:"currentItem",get:function(){return this.item}},{key:"duration",get:function(){return this.player?this.player.duration:NaN}},{key:"currentTime",get:function(){return this.player?this.player.currentTime:NaN},set:function(e){this.player&&(this.player.currentTime=e)}}],[{key:"pluginName",get:function(){return"BaseMedia"}},{key:"pluginVersion",get:function(){return d.default.version}}]),t}(Meister.MediaPlugin);Meister.registerPlugin(c.pluginName,c),Meister.registerPlugin("baseMedia",c),t.default=c},function(e,t){e.exports={name:"@meisterplayer/plugin-basemedia",version:"5.2.0",description:"Meister plugin for playback of basic media types (mp4, mp3, etc).",main:"dist/BaseMedia.js",keywords:["meister","video","plugin"],repository:{type:"git",url:"https://github.com/meisterplayer/media-basemedia.git"},author:"Triple",license:"Apache-2.0",dependencies:{},devDependencies:{"meister-gulp-webpack-tasks":"^1.0.6","meister-js-dev":"^3.1.0",gulp:"^3.9.1","babel-preset-es2015":"^6.24.0","babel-preset-es2017":"^6.22.0"},peerDependencies:{"@meisterplayer/meisterplayer":">= 5.1.0"}}},function(e,t,n){e.exports=n(0)}])},function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports=function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/",t(t.s=172)}([function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t,n,r){var i=a(r);!i[e]&&t&&(i[e]={instance:t,override:n})}function t(e,t){for(var n in u){var r=u[n];if(r.context===e&&r.name===t)return r.instance}return null}function n(e,t,n){for(var r in u){var i=u[r];if(i.context===e&&i.name===t)return void(u[r].instance=n)}u.push({name:t,context:e,instance:n})}function r(e){return function(t){return void 0===t&&(t={}),{create:function(){return o(e.__dashjs_factory_name,e.apply({context:t},arguments),t,arguments)}}}}function i(e){return function(n){var r=void 0;return void 0===n&&(n={}),{getInstance:function(){return r||(r=t(n,e.__dashjs_factory_name)),r||(r=o(e.__dashjs_factory_name,e.apply({context:n},arguments),n,arguments),u.push({name:e.__dashjs_factory_name,context:n,instance:r})),r}}}}function o(e,t,n,r){var i=a(n),o=i[e];if(o){var l=o.instance;if(!o.override)return l.apply({context:n,factory:s},r);l=l.apply({context:n,factory:s,parent:t},r);for(var u in l)t.hasOwnProperty(u)&&(t[u]=l[u])}return t}function a(e){var t=void 0;return l.forEach(function(n){n===e&&(t=n)}),t||(t=l.push(e)),t}var s=void 0,l=[],u=[];return s={extend:e,getSingletonInstance:t,setSingletonInstance:n,getSingletonFactory:i,getClassFactory:r}}();t.default=r},function(e,t,n){function r(){function e(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:a;if(!e)throw new Error("event type cannot be null or undefined");if(!t||"function"!=typeof t)throw new Error("listener must be a function: "+t);if(!(r(e,t,n)>=0)){o[e]=o[e]||[];var s={callback:t,scope:n,priority:i};o[e].some(function(t,n){if(i>t.priority)return o[e].splice(n,0,s),!0})||o[e].push(s)}}function t(e,t,n){if(e&&t&&o[e]){var i=r(e,t,n);i<0||o[e].splice(i,1)}}function n(e,t){if(e&&o[e]){if(t=t||{},t.hasOwnProperty("type"))throw new Error("'type' is a reserved word for event dispatching");t.type=e,o[e].forEach(function(e){return e.callback.call(e.scope,t)})}}function r(e,t,n){var r=-1;return o[e]?(o[e].some(function(e,i){if(e.callback===t&&(!n||n===e.scope))return r=i,!0}),r):r}function i(){o={}}var o={};return{on:e,off:t,trigger:n,reset:i}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=function(e){return e&&e.__esModule?e:{default:e}}(i),a=0;r.__dashjs_factory_name="EventBus";var s=o.default.getSingletonFactory(r);s.EVENT_PRIORITY_LOW=a,s.EVENT_PRIORITY_HIGH=5e3,t.default=s},function(e,t,n){function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":r(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":r(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(64),l=function(e){return e&&e.__esModule?e:{default:e}}(s),u=function(e){function t(){return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),t}(l.default),d=new u;t.default=d},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e){d=e}function t(e){u=e}function n(){return u}function r(){var e="",t=null;d&&(t=(new Date).getTime(),e+="["+(t-c)+"]"),e.length>0&&(e+=" "),Array.apply(null,arguments).forEach(function(t){e+=t+" "}),u&&console.log(e),o.trigger(l.default.LOG,{message:e})}var i=this.context,o=(0,a.default)(i).getInstance(),s=void 0,u=void 0,d=void 0,c=void 0;return s={log:r,setLogTimestampVisible:e,setLogToBrowserConsole:t,getLogToBrowserConsole:n},function(){u=!0,d=!0,c=(new Date).getTime()}(),s}Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),a=r(o),s=n(2),l=r(s),u=n(0),d=r(u);i.__dashjs_factory_name="Debug",t.default=d.default.getSingletonFactory(i)},function(e,t,n){function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(){function e(e){He=e}function t(){return He}function n(e){Ne=e}function i(){return Ne}function o(e){Fe=e}function a(){return Fe}function l(e){Me=e}function P(){return isNaN(Me)?Ve?y:g:Me}function M(e){Le=e}function L(){return Le}function C(e){Ce=e}function O(){return Ce}function k(e){Oe=e}function N(){return Oe}function F(e){ke=e}function B(){return ke}function U(e){De=e}function j(){return De}function H(e,t){Ae.enabled=e,void 0===t||isNaN(t)||"number"!=typeof t||(Ae.ttl=t)}function q(){return Ae}function V(e,t){Pe.enabled=e,void 0===t||isNaN(t)||"number"!=typeof t||(Pe.ttl=t)}function G(){return Pe}function K(e){Re=e}function z(){return Re}function Y(e){Be[s.HTTPRequest.MEDIA_SEGMENT_TYPE]=e}function W(e,t){Be[e]=t}function X(){return Be[s.HTTPRequest.MEDIA_SEGMENT_TYPE]}function Q(e){return Be[e]}function Z(e){Ue[s.HTTPRequest.MEDIA_SEGMENT_TYPE]=e}function J(e,t){Ue[e]=t}function $(){return Ue[s.HTTPRequest.MEDIA_SEGMENT_TYPE]}function ee(e){return Ue[e]}function te(e){je=e}function ne(){return je}function re(e){Ie=e}function ie(){return Ie}function oe(e){xe=e}function ae(e){we=e}function se(){return xe}function le(){return we}function ue(e){Ee=e}function de(){return Ee}function ce(e){Te=e}function fe(){return Te}function he(e){Se=e}function pe(){return Se}function me(e,t){e?qe[e]=!!t:Object.keys(qe).forEach(function(e){me(e,t)})}function ge(e){var t=qe[e];return void 0===t?qe.default:t}function ye(){return Ve}function ve(e){Ve=e}function _e(){}var be=void 0,Ee=void 0,Te=void 0,Se=void 0,xe=void 0,we=void 0,Ie=void 0,De=void 0,Re=void 0,Ae=void 0,Pe=void 0,Me=void 0,Le=void 0,Ce=void 0,Oe=void 0,ke=void 0,Ne=void 0,Fe=void 0,Be=void 0,Ue=void 0,je=void 0,He=void 0,qe=void 0,Ve=void 0;return be={setBufferOccupancyABREnabled:e,getBufferOccupancyABREnabled:t,setBandwidthSafetyFactor:n,getBandwidthSafetyFactor:i,setAbandonLoadTimeout:o,getAbandonLoadTimeout:a,setLastBitrateCachingInfo:H,getLastBitrateCachingInfo:q,setLastMediaSettingsCachingInfo:V,getLastMediaSettingsCachingInfo:G,setStableBufferTime:l,getStableBufferTime:P,setBufferTimeAtTopQuality:M,getBufferTimeAtTopQuality:L,setBufferTimeAtTopQualityLongForm:C,getBufferTimeAtTopQualityLongForm:O,setLongFormContentDurationThreshold:k,getLongFormContentDurationThreshold:N,setRichBufferThreshold:F,getRichBufferThreshold:B,setBufferToKeep:U,getBufferToKeep:j,setBufferPruningInterval:K,getBufferPruningInterval:z,setFragmentRetryAttempts:Y,getFragmentRetryAttempts:X,setRetryAttemptsForType:W,getRetryAttemptsForType:Q,setFragmentRetryInterval:Z,getFragmentRetryInterval:$,setRetryIntervalForType:J,getRetryIntervalForType:ee,setWallclockTimeUpdateInterval:te,getWallclockTimeUpdateInterval:ne,setScheduleWhilePaused:re,getScheduleWhilePaused:ie,getUseSuggestedPresentationDelay:fe,setUseSuggestedPresentationDelay:ce,setLiveDelayFragmentCount:oe,getLiveDelayFragmentCount:se,getLiveDelay:le,setLiveDelay:ae,setUseManifestDateHeaderTimeSource:ue,getUseManifestDateHeaderTimeSource:de,setUTCTimingSources:he,getUTCTimingSources:pe,setXHRWithCredentialsForType:me,getXHRWithCredentialsForType:ge,setFastSwitchEnabled:ve,getFastSwitchEnabled:ye,reset:_e},function(){var e,t;Se=[],Te=!1,Ee=!0,Ie=!0,He=!1,Ve=!1,Ae={enabled:!0,ttl:d},Pe={enabled:!0,ttl:c},xe=u,we=void 0,De=p,Re=m,Me=NaN,Le=v,Ce=_,Oe=b,ke=E,Ne=f,Fe=h,je=R,qe={default:A},e={},r(e,s.HTTPRequest.MPD_TYPE,x),r(e,s.HTTPRequest.XLINK_EXPANSION_TYPE,I),r(e,s.HTTPRequest.MEDIA_SEGMENT_TYPE,T),r(e,s.HTTPRequest.INIT_SEGMENT_TYPE,T),r(e,s.HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE,T),r(e,s.HTTPRequest.INDEX_SEGMENT_TYPE,T),r(e,s.HTTPRequest.OTHER_TYPE,T),Be=e,t={},r(t,s.HTTPRequest.MPD_TYPE,w),r(t,s.HTTPRequest.XLINK_EXPANSION_TYPE,D),r(t,s.HTTPRequest.MEDIA_SEGMENT_TYPE,S),r(t,s.HTTPRequest.INIT_SEGMENT_TYPE,S),r(t,s.HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE,S),r(t,s.HTTPRequest.INDEX_SEGMENT_TYPE,S),r(t,s.HTTPRequest.OTHER_TYPE,S),Ue=t}(),be}Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),a=function(e){return e&&e.__esModule?e:{default:e}}(o),s=n(5),l={scheme:"urn:mpeg:dash:utc:http-xsdate:2014",value:"http://time.akamai.com/?iso"},u=4,d=36e4,c=36e4,f=.9,h=1e4,p=30,m=30,g=12,y=20,v=30,_=60,b=600,E=20,T=3,S=1e3,x=3,w=500,I=1,D=500,R=50,A=!1;i.__dashjs_factory_name="MediaPlayerModel";var P=a.default.getSingletonFactory(i);P.DEFAULT_UTC_TIMING_SOURCE=l,t.default=P},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){r(this,e),this.tcpid=null,this.type=null,this.url=null,this.actualurl=null,this.range=null,this.trequest=null,this.tresponse=null,this.responsecode=null,this.interval=null,this.trace=[],this._stream=null,this._tfinish=null,this._mediaduration=null,this._responseHeaders=null,this._serviceLocation=null},o=function e(){r(this,e),this.s=null,this.d=null,this.b=[]};i.MPD_TYPE="MPD",i.XLINK_EXPANSION_TYPE="XLinkExpansion",i.INIT_SEGMENT_TYPE="InitializationSegment",i.INDEX_SEGMENT_TYPE="IndexSegment",i.MEDIA_SEGMENT_TYPE="MediaSegment",i.BITSTREAM_SWITCHING_SEGMENT_TYPE="BitstreamSwitchingSegment",i.OTHER_TYPE="other",t.HTTPRequest=i,t.HTTPRequestTrace=o},function(e,t,n){function r(e,t){return{value:void 0===e?a:e,reason:void 0===t?null:t}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=function(e){return e&&e.__esModule?e:{default:e}}(i),a=-1;r.__dashjs_factory_name="SwitchRequest";var s=o.default.getClassFactory(r);s.NO_CHANGE=a,t.default=s},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){de=0,ce=NaN,fe=null,me=null,ye=!1,he={},ge=(0,d.default)(Z).getInstance()}function t(e){pe=e,te=ue.getElement(),X(),me=pe.manifestInfo.isDynamic,ce=pe.start,$.on(p.default.DATA_UPDATE_COMPLETED,C,this),$.on(p.default.BYTES_APPENDED,Y,this),$.on(p.default.BUFFER_LEVEL_STATE_CHANGED,W,this),$.on(p.default.PERIOD_SWITCH_STARTED,n,this),ye&&(ye=!1,s())}function n(e){!me&&e.fromStreamInfo&&he[e.fromStreamInfo.id]&&delete he[e.fromStreamInfo.id]}function r(){var e=D(!0),t=me?e-pe.start:0;return e+(pe.duration-t)-g()}function i(){return g()>0}function o(){return pe.id}function s(){if(te){te.autoplay=!0;var e=te.play();e&&"undefined"!=typeof Promise&&e instanceof Promise&&e.catch(function(e){"NotAllowedError"===e.name&&$.trigger(p.default.PLAYBACK_NOT_ALLOWED),J("Caught pending play exception - continuing ("+e+")")})}else ye=!0}function u(){if(te)return te.paused}function c(){te&&(te.pause(),te.autoplay=!1)}function h(){if(te)return te.seeking}function m(e){ue&&(J("Requesting seek to time: "+e),ue.setCurrentTime(e))}function g(){if(te)return te.currentTime}function y(){if(te)return te.playbackRate}function _(){if(te)return te.played}function b(){if(te)return te.ended}function E(){return me}function T(e){ce=e}function S(){return ce}function x(e,t){var n=se.getMpd(ae.getValue()),r=void 0;r=ge.getUseSuggestedPresentationDelay()&&n.hasOwnProperty("suggestedPresentationDelay")?n.suggestedPresentationDelay:ge.getLiveDelay()?ge.getLiveDelay():isNaN(e)?2*pe.manifestInfo.minBufferTime:e*ge.getLiveDelayFragmentCount();var i=Math.max(t-10,t/2);return Math.min(r,i)}function w(){ue&&te&&($.off(p.default.DATA_UPDATE_COMPLETED,C,this),$.off(p.default.BUFFER_LEVEL_STATE_CHANGED,W,this),$.off(p.default.BYTES_APPENDED,Y,this),P(),Q()),ue=null,pe=null,te=null,me=null,e()}function I(e){e&&(e.streamController&&(ne=e.streamController),e.timelineConverter&&(re=e.timelineConverter),e.metricsModel&&(ie=e.metricsModel),e.dashMetrics&&(oe=e.dashMetrics),e.manifestModel&&(ae=e.manifestModel),e.dashManifestModel&&(se=e.dashManifestModel),e.adapter&&(le=e.adapter),e.videoModel&&(ue=e.videoModel))}function D(e){var t=void 0,n=(0,l.default)(Z).getInstance().getURIFragmentData(),r=parseInt(n.s,10),i=parseInt(n.t,10),o=NaN;if(e||(o=isNaN(r)?i:r),me)!isNaN(o)&&o>1262304e3&&((t=o-pe.manifestInfo.availableFrom.getTime()/1e3)>ce||t<ce-pe.manifestInfo.DVRWindowSize)&&(t=null),t=t||ce;else if(!isNaN(o)&&o<Math.max(pe.manifestInfo.duration,pe.duration)&&o>=0)t=o;else{var a=he[pe.id];void 0===a&&(a=ne.getActiveStreamCommonEarliestTime()),t=Math.max(a,pe.start)}return t}function R(e){var t,n=ie.getReadOnlyMetricsFor("video")||ie.getReadOnlyMetricsFor("audio"),r=oe.getCurrentDVRInfo(n),i=r?r.range:null;if(!i)return NaN;if(e>i.end)t=Math.max(i.end-2*pe.manifestInfo.minBufferTime,i.start);else{if(!(e<i.start))return e;t=i.start}return t}function A(){if(null===fe){var e=function(){z()};fe=setInterval(e,ge.getWallclockTimeUpdateInterval())}}function P(){clearInterval(fe),fe=null}function M(){var e=D(!1);e>0&&(m(e),J("Starting playback at offset: "+e))}function L(){if(!u()&&me&&0!==te.readyState){var e=g(),t=R(e);!isNaN(t)&&t!==e&&m(t)}}function C(e){if(!e.error){var t=le.convertDataToTrack(ae.getValue(),e.currentRepresentation),n=t.mediaInfo.streamInfo;pe.id===n.id&&(pe=n,L())}}function O(){$.trigger(p.default.CAN_PLAY)}function k(){J("Native video element event: play"),L(),A(),$.trigger(p.default.PLAYBACK_STARTED,{startTime:g()})}function N(){J("Native video element event: playing"),$.trigger(p.default.PLAYBACK_PLAYING,{playingTime:g()})}function F(){J("Native video element event: pause"),$.trigger(p.default.PLAYBACK_PAUSED,{ended:b()})}function B(){var e=g();J("Seeking to: "+e),A(),$.trigger(p.default.PLAYBACK_SEEKING,{seekTime:e})}function U(){J("Native video element event: seeked"),$.trigger(p.default.PLAYBACK_SEEKED)}function j(){var e=g();e!==de&&(de=e,$.trigger(p.default.PLAYBACK_TIME_UPDATED,{timeToEnd:r(),time:e}))}function H(){$.trigger(p.default.PLAYBACK_PROGRESS)}function q(){var e=y();J("Native video element event: ratechange: ",e),$.trigger(p.default.PLAYBACK_RATE_CHANGED,{playbackRate:e})}function V(){J("Native video element event: loadedmetadata"),(!me&&pe.isFirst||re.isTimeSyncCompleted())&&M(),$.trigger(p.default.PLAYBACK_METADATA_LOADED),A()}function G(){J("Native video element event: ended"),c(),P(),$.trigger(p.default.PLAYBACK_ENDED)}function K(e){var t=e.target||e.srcElement;$.trigger(p.default.PLAYBACK_ERROR,{error:t.error})}function z(){$.trigger(p.default.WALLCLOCK_TIME_UPDATED,{isDynamic:me,time:new Date})}function Y(e){var t=e.bufferedRanges;if(t&&t.length){var n=Math.max(t.start(0),pe.start),r=void 0===he[pe.id]?n:Math.max(he[pe.id],n);r!==he[pe.id]&&(!me&&D(!0)<r&&g()<r&&m(r),he[pe.id]=r)}}function W(e){e.streamInfo.id===pe.id&&ue.setStallState(e.mediaType,e.state===a.default.BUFFER_EMPTY)}function X(){te.addEventListener("canplay",O),te.addEventListener("play",k),te.addEventListener("playing",N),te.addEventListener("pause",F),te.addEventListener("error",K),te.addEventListener("seeking",B),te.addEventListener("seeked",U),te.addEventListener("timeupdate",j),te.addEventListener("progress",H),te.addEventListener("ratechange",q),te.addEventListener("loadedmetadata",V),te.addEventListener("ended",G)}function Q(){te.removeEventListener("canplay",O),te.removeEventListener("play",k),te.removeEventListener("playing",N),te.removeEventListener("pause",F),te.removeEventListener("error",K),te.removeEventListener("seeking",B),te.removeEventListener("seeked",U),te.removeEventListener("timeupdate",j),te.removeEventListener("progress",H),te.removeEventListener("ratechange",q),te.removeEventListener("loadedmetadata",V),te.removeEventListener("ended",G)}var Z=this.context,J=(0,v.default)(Z).getInstance().log,$=(0,f.default)(Z).getInstance(),ee=void 0,te=void 0,ne=void 0,re=void 0,ie=void 0,oe=void 0,ae=void 0,se=void 0,le=void 0,ue=void 0,de=void 0,ce=void 0,fe=void 0,he=void 0,pe=void 0,me=void 0,ge=void 0,ye=void 0;return ee={initialize:t,setConfig:I,getStreamStartTime:D,getTimeToStreamEnd:r,isPlaybackStarted:i,getStreamId:o,getTime:g,getPlaybackRate:y,getPlayedRanges:_,getEnded:b,getIsDynamic:E,setLiveStartTime:T,getLiveStartTime:S,computeLiveDelay:x,play:s,isPaused:u,pause:c,isSeeking:h,seek:m,reset:w},e(),ee}Object.defineProperty(t,"__esModule",{value:!0});var o=n(16),a=r(o),s=n(37),l=r(s),u=n(4),d=r(u),c=n(1),f=r(c),h=n(2),p=r(h),m=n(0),g=r(m),y=n(3),v=r(y);i.__dashjs_factory_name="PlaybackController",t.default=g.default.getSingletonFactory(i)},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e){e&&e.adapter&&(V=e.adapter)}function t(){H.trigger(R.default.METRICS_CHANGED)}function n(e){H.trigger(R.default.METRIC_CHANGED,{mediaType:e}),t()}function r(e,t,r){H.trigger(R.default.METRIC_UPDATED,{mediaType:e,metric:t,value:r}),n(e)}function i(e,t,r){H.trigger(R.default.METRIC_ADDED,{mediaType:e,metric:t,value:r}),n(e)}function o(e){delete G[e],n(e)}function s(){G={},t()}function d(e){return G.hasOwnProperty(e)?G[e]:null}function f(e){var t;return G.hasOwnProperty(e)?t=G[e]:(t=new a.default,G[e]=t),t}function p(e,t,n,r,o,a){var s=new l.default;return s.tcpid=t,s.dest=n,s.topen=r,s.tclose=o,s.tconnect=a,f(e).TcpList.push(s),i(e,V.metricsList.TCP_CONNECTION,s),s}function g(e,t,n,r){var i=new u.HTTPRequestTrace;return i.s=t,i.d=n,i.b=r,e.trace.push(i),e.interval||(e.interval=0),e.interval+=n,i}function v(e,t,n,r,o,a,s,l,d,c,h,p,m,y){var _=new u.HTTPRequest;return o&&o!==r&&(v(e,null,n,r,null,null,s,l,null,null,null,p,null,null),_.actualurl=o),_.tcpid=t,_.type=n,_.url=r,_.range=s,_.trequest=l,_.tresponse=d,_.responsecode=h,_._tfinish=c,_._stream=e,_._mediaduration=p,_._responseHeaders=m,_._serviceLocation=a,y?y.forEach(function(e){g(_,e.s,e.d,e.b)}):(delete _.interval,delete _.trace),f(e).HttpList.push(_),i(e,V.metricsList.HTTP_REQUEST,_),_}function E(e,t,n,r,o){var a=new c.default;return a.t=t,a.mt=n,a.to=r,o?a.lto=o:delete a.lto,f(e).RepSwitchList.push(a),i(e,V.metricsList.TRACK_SWITCH,a),a}function S(e,t,n){var r=new h.default;return r.t=t,r.level=n,f(e).BufferLevel.push(r),i(e,V.metricsList.BUFFER_LEVEL,r),r}function w(e,t,n){var r=new m.default;return r.target=n,r.state=t,f(e).BufferState.push(r),i(e,V.metricsList.BUFFER_STATE,r),r}function D(e,t,n,r){var o=new y.default;return o.time=t,o.range=r,o.manifestInfo=n,f(e).DVRInfo.push(o),i(e,V.metricsList.DVR_INFO,o),o}function A(e,t){var n=new _.default,r=f(e).DroppedFrames;return n.time=t.creationTime,n.droppedFrames=t.droppedVideoFrames,r.length>0&&r[r.length-1]==n?r[r.length-1]:(r.push(n),i(e,V.metricsList.DROPPED_FRAMES,n),n)}function P(e,t,n,r,o,a,s,l,u){var d=new T.default;return d.mediaType=e,d.t=t,d.type=n,d.startTime=r,d.availabilityStartTime=o,d.duration=a,d.quality=s,d.range=l,d.state=u,f(e).SchedulingInfo.push(d),i(e,V.metricsList.SCHEDULING_INFO,d),d}function M(e,t,n){var r=new I.default;r.loadingRequests=t,r.executedRequests=n,f(e).RequestsQueue=r,i(e,V.metricsList.REQUESTS_QUEUE,r)}function C(e,t,n,r,o,a,s,l,u,d){var c=new b.ManifestUpdate,h=f("stream");return c.mediaType=e,c.type=t,c.requestTime=n,c.fetchTime=r,c.availabilityStartTime=o,c.presentationStartTime=a,c.clientTimeOffset=s,c.currentTime=l,c.buffered=u,c.latency=d,h.ManifestUpdate.push(c),i(e,V.metricsList.MANIFEST_UPDATE,c),c}function O(e,t){if(e){for(var n in t)e[n]=t[n];r(e.mediaType,V.metricsList.MANIFEST_UPDATE,e)}}function k(e,t,n,i,o){if(e){var a=new b.ManifestUpdateStreamInfo;return a.id=t,a.index=n,a.start=i,a.duration=o,e.streamInfo.push(a),r(e.mediaType,V.metricsList.MANIFEST_UPDATE_STREAM_INFO,e),a}return null}function N(e,t,n,i,o,a,s,l){if(e){var u=new b.ManifestUpdateTrackInfo;return u.id=t,u.index=n,u.streamIndex=i,u.mediaType=o,u.startNumber=s,u.fragmentInfoType=l,u.presentationTimeOffset=a,e.trackInfo.push(u),r(e.mediaType,V.metricsList.MANIFEST_UPDATE_TRACK_INFO,e),u}return null}function F(e){return e.trace&&Array.isArray(e.trace)?e.trace.forEach(function(e){e.hasOwnProperty("subreplevel")&&!e.subreplevel&&delete e.subreplevel}):delete e.trace,f("stream").PlayList.push(e),i("stream",V.metricsList.PLAY_LIST,e),e}function B(e){return f("stream").DVBErrors.push(e),i("stream",V.metricsList.DVB_ERRORS,e),e}function U(e,t){var n=new L.default;return n._s=t,f(e).BolaState=[n],i(e,"BolaState",n),n}var j=this.context,H=(0,x.default)(j).getInstance(),q=void 0,V=void 0,G=void 0;return q={metricsChanged:t,metricChanged:n,metricUpdated:r,metricAdded:i,clearCurrentMetricsForType:o,clearAllCurrentMetrics:s,getReadOnlyMetricsFor:d,getMetricsFor:f,addTcpConnection:p,addHttpRequest:v,addRepresentationSwitch:E,addBufferLevel:S,addBufferState:w,addDVRInfo:D,addDroppedFrames:A,addSchedulingInfo:P,addRequestsQueue:M,addManifestUpdate:C,updateManifestUpdateInfo:O,addManifestUpdateStreamInfo:k,addManifestUpdateRepresentationInfo:N,addPlayList:F,addDVBErrors:B,updateBolaState:U,setConfig:e},function(){G={}}(),q}Object.defineProperty(t,"__esModule",{value:!0});var o=n(147),a=r(o),s=n(161),l=r(s),u=n(5),d=n(158),c=r(d),f=n(153),h=r(f),p=n(154),m=r(p),g=n(155),y=r(g),v=n(156),_=r(v),b=n(157),E=n(160),T=r(E),S=n(1),x=r(S),w=n(159),I=r(w),D=n(2),R=r(D),A=n(0),P=r(A),M=n(152),L=r(M);i.__dashjs_factory_name="MetricsModel",t.default=P.default.getSingletonFactory(i)},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(t,n,i){r(this,e),this.code=t||null,this.message=n||null,this.data=i||null};t.default=i},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e,t){var n;return n=S(D.getValue().Period_asArray[t],e),null===n?null:n.bandwidth}function t(e,t){return T(D.getValue().Period_asArray[t],e)}function n(e,t){return w(D.getValue().Period_asArray[t],e)}function r(e){return f(e,h.TRACK_SWITCH)}function i(e){return f(e,h.BUFFER_LEVEL)}function a(e){var t=i(e);return t?(0,p.round10)(t.level/1e3,-3):0}function l(e){return e.RequestsQueue}function d(e){if(null===e)return null;var t,n,r=e.HttpList,i=null;if(null===r||r.length<=0)return null;for(t=r.length,n=t-1;n>=0;){if(r[n].responsecode){i=r[n];break}n--}return i}function c(e){return null===e?[]:e.HttpList?e.HttpList:[]}function f(e,t){if(null===e)return null;var n=e[t];if(null===n)return null;var r=n.length;return r<=0?null:n[r-1]}function m(e){return f(e,h.DROPPED_FRAMES)}function g(e){return f(e,h.SCHEDULING_INFO)}function y(e){return f(e,h.MANIFEST_UPDATE)}function v(e){return f(e,h.DVR_INFO)}function _(e,t){var n,r,i,a={};if(null===e)return null;for(n=c(e),i=n.length-1;i>=0;i--)if(r=n[i],r.type===o.HTTPRequest.MPD_TYPE){a=E(r._responseHeaders);break}return void 0===a[t]?null:a[t]}function b(e,t){if(null===e)return null;var n,r=d(e);return null===r||null===r._responseHeaders?null:(n=E(r._responseHeaders),void 0===n[t]?null:n[t])}function E(e){var t={};if(!e)return t;for(var n=e.trim().split("\r\n"),r=0,i=n.length;r<i;r++){var o=n[r],a=o.indexOf(": ");a>0&&(t[o.substring(0,a)]=o.substring(a+2))}return t}function T(e,t){var n=S(e,t,!0);return null!==n?n:-1}function S(e,t,n){var r,i,o,a,s,l;for(i=e.AdaptationSet_asArray,s=0;s<i.length;s+=1)for(r=i[s],a=r.Representation_asArray,l=0;l<a.length;l+=1)if(o=a[l],t===o.id)return n?l:o;return null}function x(e,t){return(0,u.default)(I).getInstance().getIsTypeOf(e,t)}function w(e,t){var n,r,i,o;if(!e||!t)return-1;for(r=e.AdaptationSet_asArray,o=0;o<r.length;o+=1)if(n=r[o],i=n.Representation_asArray,x(n,t))return i.length;return-1}var I=this.context,D=(0,s.default)(I).getInstance();return{getBandwidthForRepresentation:e,getIndexForRepresentation:t,getMaxIndexForBufferType:n,getCurrentRepresentationSwitch:r,getLatestBufferLevelVO:i,getCurrentBufferLevel:a,getCurrentHttpRequest:d,getHttpRequests:c,getCurrentDroppedFrames:m,getCurrentSchedulingInfo:g,getCurrentDVRInfo:v,getCurrentManifestUpdate:y,getLatestFragmentRequestHeaderValueByID:b,getLatestMPDRequestHeaderValueByID:_,getRequestsQueue:l}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(5),a=n(29),s=r(a),l=n(11),u=r(l),d=n(0),c=r(d),f=n(44),h=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(f),p=n(162);i.__dashjs_factory_name="DashMetrics",t.default=c.default.getSingletonFactory(i)},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e,t){var n,r,i,o=!1,a=!1,s=e.ContentComponent_asArray,l="text"!==t?new RegExp(t):new RegExp("(vtt|ttml)");if(e.Representation_asArray.length>0&&e.Representation_asArray[0].hasOwnProperty("codecs")){var u=e.Representation_asArray[0].codecs;if(0===u.search("stpp")||0===u.search("wvtt"))return"fragmentedText"===t}if(s){if(s.length>1)return"muxed"===t;s[0]&&s[0].contentType===t&&(o=!0,a=!0)}if(e.hasOwnProperty("mimeType")&&(o=l.test(e.mimeType),a=!0),!a)for(n=0,r=e.Representation_asArray.length;!a&&n<r;)i=e.Representation_asArray[n],i.hasOwnProperty("mimeType")&&(o=l.test(i.mimeType),a=!0),n++;return o}function t(t){return e(t,"audio")}function n(t){return e(t,"video")}function r(t){return e(t,"fragmentedText")}function i(t){return e(t,"text")}function o(t){return e(t,"muxed")}function s(e){return"text/vtt"===e||"application/ttml+xml"===e}function u(e){var t="";return e.hasOwnProperty("lang")&&(t=e.lang.replace(/[^A-Za-z0-9-]/g,"")),t}function c(e){return e.hasOwnProperty("Viewpoint")?e.Viewpoint:null}function h(e){return e.hasOwnProperty("Role_asArray")?e.Role_asArray:[]}function m(e){return e.hasOwnProperty("Accessibility_asArray")?e.Accessibility_asArray:[]}function y(e){return e.hasOwnProperty("AudioChannelConfiguration_asArray")?e.AudioChannelConfiguration_asArray:[]}function _(e){return h(e).filter(function(e){return"main"===e.value})[0]}function E(){return function(e,t){return e.bandwidth-t.bandwidth}}function S(e){return void 0!==e.Representation_asArray&&null!==e.Representation_asArray&&e.Representation_asArray.sort(E()),e}function w(e,t,n){var r,i,o=t.Period_asArray[n].AdaptationSet_asArray;for(r=0,i=o.length;r<i;r++)if(o[r].hasOwnProperty("id")&&o[r].id===e)return o[r];return null}function D(e,t,n){return t.Period_asArray[n].AdaptationSet_asArray[e]}function A(e,t,n){var r,i,o=t.Period_asArray[n].AdaptationSet_asArray;for(r=0,i=o.length;r<i;r++)if(o[r]===e)return r;return-1}function P(t,n,r){var i,o,a=t.Period_asArray[n].AdaptationSet_asArray,s=[];for(i=0,o=a.length;i<o;i++)e(a[i],r)&&s.push(S(a[i]));return s}function M(e,t,n,r){var i=P(e,t,n);if(!i||0===i.length)return null;if(i.length>1&&r)for(var o=le.getCurrentTrackFor(n,r),a=ue.getAllMediaInfoForType(e,r,n),s=0,l=i.length;s<l;s++){if(o&&le.isTracksEqual(o,a[s]))return i[s];if(_(i[s]))return i[s]}return i[0]}function L(e){var t=e.Representation_asArray[0];return t.mimeType+';codecs="'+t.codecs+'"'}function C(e){return e.Representation_asArray[0].mimeType}function O(e){return e&&e.hasOwnProperty("cenc:default_KID")?e["cenc:default_KID"]:null}function k(e){return e&&e.hasOwnProperty("ContentProtection_asArray")&&0!==e.ContentProtection_asArray.length?e.ContentProtection_asArray:null}function N(e){var t=!1;return e.hasOwnProperty("type")&&(t="dynamic"===e.type),t}function F(e){var t,n=N(e);return t=!isNaN(e.timeShiftBufferDepth),n&&t}function B(e,t){var n=!1;return e.profiles&&e.profiles.length>0&&(n=-1!==e.profiles.indexOf(t)),n}function U(e){return B(e,"urn:mpeg:dash:profile:isoff-on-demand:2011")}function j(e){return B(e,"urn:dvb:dash:profile:dvb-dash:2014")}function H(e){return e.hasOwnProperty("mediaPresentationDuration")?e.mediaPresentationDuration:Number.MAX_VALUE}function q(e){return e.bandwidth}function V(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=NaN;return e.hasOwnProperty("minimumUpdatePeriod")&&(n=e.minimumUpdatePeriod),isNaN(n)?n:Math.max(n-t,1)}function G(e){return e.Representation_asArray.length}function K(e){if(!e||!e.Representation_asArray||!e.Representation_asArray.length)return null;for(var t=S(e),n=t.Representation_asArray,r=n.length,i=[],o=0;o<r;o++)i.push({bandwidth:n[o].bandwidth,width:n[o].width||0,height:n[o].height||0});return i}function z(e,t){return t.Representation_asArray[e]}function Y(e,t){for(var n,r,i,o,l,u=S(e.Period_asArray[t.period.index].AdaptationSet_asArray[t.index]),d=[],c=0;c<u.Representation_asArray.length;c++)o=u.Representation_asArray[c],n=new a.default,n.index=c,n.adaptation=t,o.hasOwnProperty("id")&&(n.id=o.id),o.hasOwnProperty("bandwidth")&&(n.bandwidth=o.bandwidth),o.hasOwnProperty("maxPlayoutRate")&&(n.maxPlayoutRate=o.maxPlayoutRate),o.hasOwnProperty("SegmentBase")?(i=o.SegmentBase,n.segmentInfoType="SegmentBase"):o.hasOwnProperty("SegmentList")?(i=o.SegmentList,i.hasOwnProperty("SegmentTimeline")?(n.segmentInfoType="SegmentTimeline",l=i.SegmentTimeline.S_asArray[i.SegmentTimeline.S_asArray.length-1],(!l.hasOwnProperty("r")||l.r>=0)&&(n.useCalculatedLiveEdgeTime=!0)):(n.segmentInfoType="SegmentList",n.useCalculatedLiveEdgeTime=!0)):o.hasOwnProperty("SegmentTemplate")?(i=o.SegmentTemplate,i.hasOwnProperty("SegmentTimeline")?(n.segmentInfoType="SegmentTimeline",l=i.SegmentTimeline.S_asArray[i.SegmentTimeline.S_asArray.length-1],(!l.hasOwnProperty("r")||l.r>=0)&&(n.useCalculatedLiveEdgeTime=!0)):n.segmentInfoType="SegmentTemplate",i.hasOwnProperty("initialization")&&(n.initialization=i.initialization.split("$Bandwidth$").join(o.bandwidth).split("$RepresentationID$").join(o.id))):n.segmentInfoType="BaseURL",i&&(i.hasOwnProperty("Initialization")?(r=i.Initialization,r.hasOwnProperty("sourceURL")?n.initialization=r.sourceURL:r.hasOwnProperty("range")&&(n.range=r.range)):o.hasOwnProperty("mimeType")&&s(o.mimeType)&&(n.range=0),i.hasOwnProperty("timescale")&&(n.timescale=i.timescale),i.hasOwnProperty("duration")&&(n.segmentDuration=i.duration/n.timescale),i.hasOwnProperty("startNumber")&&(n.startNumber=i.startNumber),i.hasOwnProperty("indexRange")&&(n.indexRange=i.indexRange),i.hasOwnProperty("presentationTimeOffset")&&(n.presentationTimeOffset=i.presentationTimeOffset/n.timescale)),n.MSETimeOffset=se.calcMSETimeOffset(n),n.path=[t.period.index,t.index,c],d.push(n);return d}function W(e,i){for(var a,s,u=e.Period_asArray[i.index],d=[],c=0;c<u.AdaptationSet_asArray.length;c++)s=u.AdaptationSet_asArray[c],a=new l.default,s.hasOwnProperty("id")&&(a.id=s.id),a.index=c,a.period=i,o(s)?a.type="muxed":t(s)?a.type="audio":n(s)?a.type="video":r(s)?a.type="fragmentedText":a.type="text",d.push(a);return d}function X(e,t){var n,r,i=N(e),o=[],a=null,s=null,l=null,u=null;for(r=0,n=e.Period_asArray.length;r<n;r++)s=e.Period_asArray[r],s.hasOwnProperty("start")?(u=new d.default,u.start=s.start):null!==a&&s.hasOwnProperty("duration")&&null!==l?(u=new d.default,u.start=l.start+l.duration,u.duration=s.duration):0!==r||i||(u=new d.default,u.start=0),null!==l&&isNaN(l.duration)&&(l.duration=u.start-l.start),null!==u&&(u.id=Q(s,r)),null!==u&&s.hasOwnProperty("duration")&&(u.duration=s.duration),null!==u&&(u.index=r,u.mpd=t,o.push(u),a=s,l=u),s=null,u=null;return 0===o.length?o:(null!==l&&isNaN(l.duration)&&(l.duration=J(e,l)-l.start),o)}function Q(e,t){if(!e)throw new Error("Period cannot be null or undefined");var n=d.default.DEFAULT_ID+"_"+t;return e.hasOwnProperty("id")&&"__proto__"!==e.id&&(n=e.id),n}function Z(e){var t=new f.default;return t.manifest=e,e.hasOwnProperty("availabilityStartTime")?t.availabilityStartTime=new Date(e.availabilityStartTime.getTime()):t.availabilityStartTime=new Date(e.loadedTime.getTime()),e.hasOwnProperty("availabilityEndTime")&&(t.availabilityEndTime=new Date(e.availabilityEndTime.getTime())),e.hasOwnProperty("minimumUpdatePeriod")&&(t.minimumUpdatePeriod=e.minimumUpdatePeriod),e.hasOwnProperty("mediaPresentationDuration")&&(t.mediaPresentationDuration=e.mediaPresentationDuration),e.hasOwnProperty("suggestedPresentationDelay")&&(t.suggestedPresentationDelay=e.suggestedPresentationDelay),e.hasOwnProperty("timeShiftBufferDepth")&&(t.timeShiftBufferDepth=e.timeShiftBufferDepth),e.hasOwnProperty("maxSegmentDuration")&&(t.maxSegmentDuration=e.maxSegmentDuration),t}function J(e,t){var n=N(e),r=void 0;if(e.mediaPresentationDuration)r=e.mediaPresentationDuration;else if(t.duration)r=t.duration;else{if(!n)throw new Error("Must have @mediaPresentationDuratio on MPD or an explicit @duration on the last period.");r=Number.POSITIVE_INFINITY}return r}function $(e,t){var n=e.Period_asArray,r=n[t.index].EventStream_asArray,i=[];if(r)for(var o=0;o<r.length;o++){var a=new I.default;if(a.period=t,a.timescale=1,!r[o].hasOwnProperty("schemeIdUri"))throw new Error("Invalid EventStream. SchemeIdUri has to be set");a.schemeIdUri=r[o].schemeIdUri,r[o].hasOwnProperty("timescale")&&(a.timescale=r[o].timescale),r[o].hasOwnProperty("value")&&(a.value=r[o].value);for(var s=0;s<r[o].Event_asArray.length;s++){var l=new T.default;l.presentationTime=0,l.eventStream=a,r[o].Event_asArray[s].hasOwnProperty("presentationTime")&&(l.presentationTime=r[o].Event_asArray[s].presentationTime),r[o].Event_asArray[s].hasOwnProperty("duration")&&(l.duration=r[o].Event_asArray[s].duration),r[o].Event_asArray[s].hasOwnProperty("id")&&(l.id=r[o].Event_asArray[s].id),i.push(l)}}return i}function ee(e,t){var n=[];if(!e)return n;for(var r=0;r<e.length;r++){var i=new I.default;if(i.timescale=1,i.representation=t,!e[r].hasOwnProperty("schemeIdUri"))throw new Error("Invalid EventStream. SchemeIdUri has to be set");i.schemeIdUri=e[r].schemeIdUri,e[r].hasOwnProperty("timescale")&&(i.timescale=e[r].timescale),e[r].hasOwnProperty("value")&&(i.value=e[r].value),n.push(i)}return n}function te(e,t){return ee(e.Period_asArray[t.period.index].AdaptationSet_asArray[t.index].InbandEventStream_asArray,null)}function ne(e,t){return ee(e.Period_asArray[t.adaptation.period.index].AdaptationSet_asArray[t.adaptation.index].Representation_asArray[t.index].InbandEventStream_asArray,t)}function re(e){var t=N(e),n=e.hasOwnProperty("availabilityStartTime"),r=e.UTCTiming_asArray,i=[];return(t||n)&&r&&r.forEach(function(e){var t=new p.default;e.hasOwnProperty("schemeIdUri")&&(t.schemeIdUri=e.schemeIdUri,e.hasOwnProperty("value")&&(t.value=e.value.toString(),i.push(t)))}),i}function ie(e){var t=[],n=e.BaseURL_asArray||[e.baseUri],r=!1;return n.some(function(n){if(n){var i=new x.default,o=n.__text||n;return de.isRelative(o)&&(r=!0,e.baseUri&&(o=e.baseUri+o)),i.url=o,n.hasOwnProperty("serviceLocation")&&n.serviceLocation.length?i.serviceLocation=n.serviceLocation:i.serviceLocation=o,n.hasOwnProperty("dvb:priority")&&(i.dvb_priority=n["dvb:priority"]),n.hasOwnProperty("dvb:weight")&&(i.dvb_weight=n["dvb:weight"]),t.push(i),r}}),t}function oe(e){return e.hasOwnProperty("Location")&&(e.Location=e.Location_asArray[0]),e.Location}var ae=this.context,se=(0,g.default)(ae).getInstance(),le=(0,v.default)(ae).getInstance(),ue=(0,b.default)(ae).getInstance(),de=(0,R.default)(ae).getInstance();return{getIsTypeOf:e,getIsAudio:t,getIsVideo:n,getIsText:i,getIsMuxed:o,getIsTextTrack:s,getIsFragmentedText:r,getIsMain:_,getLanguageForAdaptation:u,getViewpointForAdaptation:c,getRolesForAdaptation:h,getAccessibilityForAdaptation:m,getAudioChannelConfigurationForAdaptation:y,processAdaptation:S,getAdaptationForIndex:D,getIndexForAdaptation:A,getAdaptationForId:w,getAdaptationsForType:P,getAdaptationForType:M,getCodec:L,getMimeType:C,getKID:O,getContentProtectionData:k,getIsDynamic:N,getIsDVR:F,getIsOnDemand:U,getIsDVB:j,getDuration:H,getBandwidth:q,getManifestUpdatePeriod:V,getRepresentationCount:G,getBitrateListForAdaptation:K,getRepresentationFor:z,getRepresentationsForAdaptation:Y,getAdaptationsForPeriod:W,getRegularPeriods:X,getMpd:Z,getEventsForPeriod:$,getEventStreams:ee,getEventStreamForAdaptationSet:te,getEventStreamForRepresentation:ne,getUTCTimingSources:re,getBaseURLsFromElement:ie,getRepresentationSortFunction:E,getLocation:oe}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(34),a=r(o),s=n(82),l=r(s),u=n(85),d=r(u),c=n(84),f=r(c),h=n(48),p=r(h),m=n(33),g=r(m),y=n(13),v=r(y),_=n(19),b=r(_),E=n(47),T=r(E),S=n(46),x=r(S),w=n(83),I=r(w),D=n(23),R=r(D),A=n(0),P=r(A);i.__dashjs_factory_name="DashManifestModel",t.default=P.default.getSingletonFactory(i)},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){ge={video:!0,audio:!0},ye={},ve={},_e={},be={},Ee={},Se={},Te={},Ne={},we=!1,Ie=!1,void 0===De&&(De=!1),Oe=(0,l.default)(ue).getInstance(),Ce=(0,d.default)(ue).getInstance(),Pe=(0,T.default)(ue).getInstance(),Me=(0,x.default)(ue).getInstance(),Le=(0,I.default)(ue).getInstance(),Be=(0,N.default)(ue).getInstance(),Ue=(0,B.default)(ue).getInstance(),je=(new Date).getTime()/1e3}function t(e,t){Ne[e]=(0,L.default)(ue).create(),Te[e]=t,Se[e]=Se[e]||{},Se[e].state=q,fe.on(g.default.LOADING_PROGRESS,le,this),"video"==e&&(fe.on(v.default.QUALITY_CHANGE_RENDERED,i,this),Fe=(0,O.default)(ue).create(),ae())}function n(){fe.off(g.default.LOADING_PROGRESS,le,this),fe.off(v.default.QUALITY_CHANGE_RENDERED,i,this),ke=void 0,Fe=void 0,clearTimeout(xe),xe=null,e()}function r(e){e&&(e.abrRulesCollection&&(pe=e.abrRulesCollection),e.streamController&&(me=e.streamController))}function i(e){"video"===e.mediaType&&(ke=e.newQuality,Fe.push(ke,Le.getPlaybackQuality()))}function o(e,t){var n;return ye[t]=ye[t]||{},ye[t].hasOwnProperty(e)||(ye[t][e]=0),n=re(ye[t][e],e),n=ie(n,e,ye[t][e]),n=se(n,e)}function s(e){var t=Oe.getSavedBitrateSettings(e);if(!_e.hasOwnProperty(e))if(be.hasOwnProperty(e)){var n=Pe.getValue(),r=Me.getAdaptationForType(n,0,e).Representation;if(Array.isArray(r)){var i=Math.max(Math.round(r.length*be[e])-1,0);_e[e]=r[i].bandwidth}else _e[e]=0}else isNaN(t)?_e[e]="video"===e?V:G:_e[e]=t;return _e[e]}function u(e,t){_e[e]=t}function c(e){return be.hasOwnProperty(e)?be[e]:null}function h(e,t){be[e]=t}function m(e){return _e.hasOwnProperty("max")&&_e.max.hasOwnProperty(e)?_e.max[e]:NaN}function y(e,t){_e.max=_e.max||{},_e.max[e]=t}function _(e){return be.hasOwnProperty("max")&&be.max.hasOwnProperty(e)?be.max[e]:1}function b(e,t){be.max=be.max||{},be.max[e]=t}function E(e){return ge[e]}function S(e,t){ge[e]=t}function w(){return we}function D(e){we=e}function A(){return Ie}function M(e){Ie=e}function C(e){var t=e.getType(),n=e.getStreamInfo(),r=n.id,i=ee(t,n),a=(0,R.default)(ue).create({streamProcessor:e,currentValue:i,playbackIndex:ke,switchHistory:Ne[t],droppedFramesHistory:Fe,hasRichBuffer:X(t)});if(Fe&&Fe.push(ke,Le.getPlaybackQuality()),E(t)){var s=o(t,r),l=pe.getMaxQuality(a),u=l.value;if(u>s&&(u=s),Ne[t].push({oldValue:i,newValue:u}),u>P.default.NO_CHANGE&&u!=i)(Se[t].state===q||u>i)&&F(t,n,i,u,s,l.reason);else if(de.getLogToBrowserConsole()){var d=Ue.getCurrentBufferLevel(Be.getReadOnlyMetricsFor(t));ce("AbrController ("+t+") stay on "+i+"/"+s+" (buffer: "+d+")")}}}function k(e,t,n,r){var i=t.id,a=ee(e,t);if(null===n||isNaN(n)||n%1!=0)throw new Error("argument is not an integer");var s=o(e,i);n!==a&&n>=0&&n<=s&&F(e,t,a,n,s,r)}function F(e,t,n,r,i,o){if(de.getLogToBrowserConsole()){var a=Ue.getCurrentBufferLevel(Be.getReadOnlyMetricsFor(e));ce("AbrController ("+e+") switch from "+n+" to "+r+"/"+i+" (buffer: "+a+")\n"+JSON.stringify(o))}te(e,t.id,r),fe.trigger(g.default.QUALITY_CHANGE_REQUESTED,{mediaType:e,streamInfo:t,oldQuality:n,newQuality:r,reason:o})}function U(e,t){Se[e].state=t}function z(e){return Se[e].state}function Y(e,t,n){if(n&&Te[e.type].getCurrentRepresentationInfo()&&Te[e.type].getCurrentRepresentationInfo().fragmentDuration){n/=1e3;var r=Te[e.type].getCurrentRepresentationInfo().fragmentDuration;if(n>r)return 0;t*=1-n/r}var i=W(e);if(!i||0===i.length)return K;for(var o=i.length-1;o>=0;o--)if(1e3*t>=i[o].bitrate)return o;return 0}function W(e){if(!e||!e.bitrateList)return null;for(var t,n=e.bitrateList,r=e.type,i=[],o=0,s=n.length;o<s;o++)t=new a.default,t.mediaType=r,t.qualityIndex=o,t.bitrate=n[o].bandwidth,t.width=n[o].width,t.height=n[o].height,i.push(t);return i}function X(e){var t=Be.getReadOnlyMetricsFor(e),n=Ue.getCurrentBufferLevel(t),r=t.BufferState.length>0?t.BufferState[t.BufferState.length-1]:null,i=!1;return r&&n>r.target&&(i=n>r.target+Ce.getRichBufferThreshold()),i}function Q(e,t){Ee[e]=t}function Z(e){return Ee[e]}function J(e){var t=e.type,n=e.streamInfo.id,r=e.representationCount-1;return ne(t,n,r),r}function $(e){var t=e.id,n=ee("audio",e),r=ee("video",e);return n===o("audio",t)&&r===o("video",t)}function ee(e,t){var n=t.id;return ve[n]=ve[n]||{},ve[n].hasOwnProperty(e)||(ve[n][e]=K),ve[n][e]}function te(e,t,n){ve[t]=ve[t]||{},ve[t][e]=n}function ne(e,t,n){ye[t]=ye[t]||{},ye[t][e]=n}function re(e,t){var n=m(t);if(isNaN(n)||!Te[t])return e;var r=Y(Te[t].getMediaInfo(),n);return Math.min(e,r)}function ie(e,t,n){var r=_(t);return isNaN(r)||r>=1||r<0?e:Math.min(e,Math.round(n*r))}function oe(e){De=e}function ae(){var e=Le.getElement();if(void 0!==e){var t=Ie&&window.hasOwnProperty("devicePixelRatio"),n=t?window.devicePixelRatio:1;Re=e.clientWidth*n,Ae=e.clientHeight*n}}function se(e,t){if("video"!==t||!we||!Te[t])return e;De||ae();var n=Pe.getValue(),r=Me.getAdaptationForType(n,0,t).Representation,i=e;if(Re>0&&Ae>0){for(;i>0&&r[i]&&Re<r[i].width&&Re-r[i-1].width<r[i].width-Re;)i-=1;r.length-2>=i&&r[i].width===r[i+1].width&&(i=Math.min(e,i+1))}return i}function le(e){var t=e.request.mediaType;if(E(t)){var n=Te[t].getScheduleController();if(!n)return;var r=(0,R.default)(ue).create({streamProcessor:Te[t],currentRequest:e.request,currentValue:ee(t,me.getActiveStreamInfo()),hasRichBuffer:X(t)}),i=pe.shouldAbandonFragment(r);if(i.value>P.default.NO_CHANGE){var o=n.getFragmentModel(),a=o.getRequests({state:f.default.FRAGMENT_MODEL_LOADING,index:e.request.index})[0];a&&(o.abortRequests(),U(t,H),Ne[t].reset(),Ne[t].push({oldValue:ee(t,me.getActiveStreamInfo()),newValue:i.value,confidence:1,reason:i.reason}),k(t,me.getActiveStreamInfo(),i.value,i.reason),fe.trigger(g.default.FRAGMENT_LOADING_ABANDONED,{streamProcessor:Te[t],request:a,mediaType:t}),clearTimeout(xe),xe=setTimeout(function(){U(t,q),xe=null},Ce.getAbandonLoadTimeout()))}}}var ue=this.context,de=(0,j.default)(ue).getInstance(),ce=de.log,fe=(0,p.default)(ue).getInstance(),he=void 0,pe=void 0,me=void 0,ge=void 0,ye=void 0,ve=void 0,_e=void 0,be=void 0,Ee=void 0,Te=void 0,Se=void 0,xe=void 0,we=void 0,Ie=void 0,De=void 0,Re=void 0,Ae=void 0,Pe=void 0,Me=void 0,Le=void 0,Ce=void 0,Oe=void 0,ke=void 0,Ne=void 0,Fe=void 0,Be=void 0,Ue=void 0,je=void 0;return he={isPlayingAtTopQuality:$,updateTopQualityIndex:J,getAverageThroughput:Z,getBitrateList:W,getQualityForBitrate:Y,getMaxAllowedBitrateFor:m,setMaxAllowedBitrateFor:y,getMaxAllowedRepresentationRatioFor:_,setMaxAllowedRepresentationRatioFor:b,getInitialBitrateFor:s,setInitialBitrateFor:u,getInitialRepresentationRatioFor:c,setInitialRepresentationRatioFor:h,setAutoSwitchBitrateFor:S,getAutoSwitchBitrateFor:E,setLimitBitrateByPortal:D,getLimitBitrateByPortal:w,getUsePixelRatioInLimitBitrateByPortal:A,setUsePixelRatioInLimitBitrateByPortal:M,getQualityFor:ee,getAbandonmentStateFor:z,setAbandonmentStateFor:U,setPlaybackQuality:k,getPlaybackQuality:C,setAverageThroughput:Q,getTopQualityIndexFor:o,setElementSize:ae,setWindowResizeEventCalled:oe,initialize:t,setConfig:r,reset:n},e(),he}Object.defineProperty(t,"__esModule",{value:!0});var o=n(141),a=r(o),s=n(39),l=r(s),u=n(4),d=r(u),c=n(28),f=r(c),h=n(1),p=r(h),m=n(2),g=r(m),y=n(20),v=r(y),_=n(0),b=r(_),E=n(29),T=r(E),S=n(11),x=r(S),w=n(17),I=r(w),D=n(53),R=r(D),A=n(6),P=r(A),M=n(123),L=r(M),C=n(122),O=r(C),k=n(8),N=r(k),F=n(10),B=r(F),U=n(3),j=r(U),H="abandonload",q="allowload",V=1e3,G=100,K=0;i.__dashjs_factory_name="AbrController";var z=b.default.getSingletonFactory(i);z.ABANDON_LOAD=H,z.QUALITY_DEFAULT=K,t.default=z},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){B={},P(),A()}function t(e,t){var n=d(e),i=r(e,t),o=[];if("fragmentedText"===e)return void s(i[0]);n||(n=F.getSavedMediaSettings(e),u(e,n)),i&&0!==i.length&&(n&&i.forEach(function(e){R(n,e)&&o.push(e)}),s(0===o.length?M(i):o.length>1?M(o):o[0]))}function n(e){var t=e?e.type:null,n=e?e.streamInfo.id:null,r=d(t);return!(!e||!S(t)||(B[n]=B[n]||L(),B[n][t].list.indexOf(e)>=0||(B[n][t].list.push(e),r&&R(r,e)&&!i(t,e.streamInfo)&&s(e),0)))}function r(e,t){if(!e||!t)return[];var n=t.id;return B[n]&&B[n][e]?B[n][e].list:[]}function i(e,t){return!e||!t||t&&!B[t.id]?null:B[t.id][e].current}function o(e){var t=e.type,n=e.streamInfo.id;return B[n]&&B[n][t]&&x(B[n][t].current,e)}function s(e){if(e){var t=e.type,n=e.streamInfo,r=n.id,o=i(t,n);if(B[r]&&B[r][t]&&(!o||!x(e,o))){B[r][t].current=e,o&&k.trigger(a.default.CURRENT_TRACK_CHANGED,{oldMediaInfo:o,newMediaInfo:e,switchMode:H[t]});var s=D(e);s&&B[r][t].storeLastSettings&&(s.roles&&(s.role=s.roles[0],delete s.roles),s.accessibility&&(s.accessibility=s.accessibility[0]),s.audioChannelConfiguration&&(s.audioChannelConfiguration=s.audioChannelConfiguration[0]),F.setSavedMediaSettings(t,s))}}}function u(e,t){e&&t&&(U[e]=t)}function d(e){return e?U[e]:null}function c(e,t){if(-1===V.indexOf(t))return void O("track switch mode is not supported: "+t);H[e]=t}function h(e){return H[e]}function m(e){if(-1===G.indexOf(e))return void O("track selection mode is not supported: "+e);j=e}function T(){return j||E}function S(e){return"audio"===e||"video"===e||"text"===e||"fragmentedText"===e}function x(e,t){var n=e.id===t.id,r=e.viewpoint===t.viewpoint,i=e.lang===t.lang,o=e.roles.toString()===t.roles.toString(),a=e.accessibility.toString()===t.accessibility.toString(),s=e.audioChannelConfiguration.toString()===t.audioChannelConfiguration.toString();return n&&r&&i&&o&&a&&s}function w(e){e&&e.errHandler&&(q=e.errHandler)}function I(){e(),N.resetEmbedded()}function D(e){var t={lang:e.lang,viewpoint:e.viewpoint,roles:e.roles,accessibility:e.accessibility,audioChannelConfiguration:e.audioChannelConfiguration};return t.lang||t.viewpoint||t.role&&t.role.length>0||t.accessibility&&t.accessibility.length>0||t.audioChannelConfiguration&&t.audioChannelConfiguration.length>0?t:null}function R(e,t){var n=!e.lang||e.lang===t.lang,r=!e.viewpoint||e.viewpoint===t.viewpoint,i=!e.role||!!t.roles.filter(function(t){return t===e.role})[0],o=!e.accessibility||!!t.accessibility.filter(function(t){return t===e.accessibility})[0],a=!e.audioChannelConfiguration||!!t.audioChannelConfiguration.filter(function(t){return t===e.audioChannelConfiguration})[0];return n&&r&&i&&o&&a}function A(){H={audio:v,video:y}}function P(){U={audio:null,video:null}}function M(e){var t=T(),n=[],r=function(e){var t,n=0,r=[];return e.forEach(function(e){t=Math.max.apply(Math,e.bitrateList.map(function(e){return e.bandwidth})),t>n?(n=t,r=[e]):t===n&&r.push(e)}),r},i=function(e){var t,n=0,r=[];return e.forEach(function(e){t=e.representationCount,t>n?(n=t,r=[e]):t===n&&r.push(e)}),r};switch(t){case _:n=r(e),n.length>1&&(n=i(n));break;case b:n=i(e),n.length>1&&(n=r(e));break;default:O("track selection mode is not supported: "+t)}return n[0]}function L(){return{audio:{list:[],storeLastSettings:!0,current:null},video:{list:[],storeLastSettings:!0,current:null},text:{list:[],storeLastSettings:!0,current:null},fragmentedText:{list:[],storeLastSettings:!0,current:null}}}var C=this.context,O=(0,f.default)(C).getInstance().log,k=(0,l.default)(C).getInstance(),N=(0,p.default)(C).getInstance(),F=(0,g.default)(C).getInstance(),B=void 0,U=void 0,j=void 0,H=void 0,q=void 0,V=[v,y],G=[_,b];return{initialize:e,checkInitialMediaSettingsForType:t,addTrack:n,getTracksFor:r,getCurrentTrackFor:i,isCurrentTrack:o,setTrack:s,setInitialSettings:u,getInitialSettings:d,setSwitchMode:c,getSwitchMode:h,setSelectionModeForInitialTrack:m,getSelectionModeForInitialTrack:T,isMultiTrackSupportedByType:S,isTracksEqual:x,setConfig:w,reset:I}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),a=r(o),s=n(1),l=r(s),u=n(0),d=r(u),c=n(3),f=r(c),h=n(15),p=r(h),m=n(39),g=r(m),y="neverReplace",v="alwaysReplace",_="highestBitrate",b="widestRange",E=_;i.__dashjs_factory_name="MediaController";var T=d.default.getSingletonFactory(i);T.TRACK_SWITCH_MODE_NEVER_REPLACE=y,T.TRACK_SWITCH_MODE_ALWAYS_REPLACE=v,T.TRACK_SELECTION_MODE_HIGHEST_BITRATE=_,T.TRACK_SELECTION_MODE_WIDEST_RANGE=b,T.DEFAULT_INIT_TRACK_SELECTION_MODE=E,t.default=T},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e){d.trigger(l.default.ERROR,{error:"capability",event:e})}function t(e,t,n){d.trigger(l.default.ERROR,{error:"download",event:{id:e,url:t,request:n}})}function n(e,t,n,r){d.trigger(l.default.ERROR,{error:"manifestError",event:{message:e,id:t,manifest:n,event:r}})}function r(e,t,n){d.trigger(l.default.ERROR,{error:"cc",event:{message:e,id:t,cc:n}})}function i(e){d.trigger(l.default.ERROR,{error:"mediasource",event:e})}function o(e){d.trigger(l.default.ERROR,{error:"key_session",event:e})}function s(e){d.trigger(l.default.ERROR,{error:"key_message",event:e})}var u=this.context,d=(0,a.default)(u).getInstance();return{capabilityError:e,downloadError:t,manifestError:n,timedTextError:r,mediaSourceError:i,mediaKeySessionError:o,mediaKeyMessageError:s}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),a=r(o),s=n(2),l=r(s),u=n(0),d=r(u);i.__dashjs_factory_name="ErrorHandler";var c=d.default.getSingletonFactory(i);c.CAPABILITY_ERROR_MEDIASOURCE="mediasource",c.CAPABILITY_ERROR_MEDIAKEYS="mediakeys",c.DOWNLOAD_ERROR_ID_MANIFEST="manifest",c.DOWNLOAD_ERROR_ID_SIDX="SIDX",c.DOWNLOAD_ERROR_ID_CONTENT="content",c.DOWNLOAD_ERROR_ID_INITIALIZATION="initialization",c.DOWNLOAD_ERROR_ID_XLINK="xlink",c.MANIFEST_ERROR_ID_CODEC="codec",c.MANIFEST_ERROR_ID_PARSE="parse",c.MANIFEST_ERROR_ID_NOSTREAMS="nostreams",c.TIMED_TEXT_ERROR_ID_PARSE="parse",t.default=c},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e,n){F=!1,B=null,K=null,z=!1,Y=NaN,W=[],Z=null,M||t();var r=n.getStreamProcessor();if(q=r.getMediaInfoArr(),V.setConfig({videoModel:X}),V.initialize(),G=!k.getIsTextTrack(e),C=(0,d.default)(A).getInstance(),H=(0,l.default)(A).getInstance(),H.setConfig({boxParser:C}),G){K=r.getFragmentModel(),this.buffered=(0,f.default)(A).create(),W=N.getTracksFor("fragmentedText",Q.getActiveStreamInfo());for(var i=N.getCurrentTrackFor("fragmentedText",Q.getActiveStreamInfo()),o=0;o<W.length;o++)if(W[o]===i){J=o;break}}}function t(){$=[],q=[],X=(0,v.default)(A).getInstance(),V=(0,b.default)(A).getInstance(),V.setConfig({videoModel:X}),V.initialize(),C=(0,d.default)(A).getInstance(),H=(0,l.default)(A).getInstance(),H.setConfig({boxParser:C}),G=!1,J=null,ee=!1,te=0,ie=[],re=[],ne=null,M=!0}function n(e,t){function n(e,t){var n=new a.default,r={subtitle:"subtitles",caption:"captions"};n.captionData=e,n.lang=t.lang,n.label=t.id,n.index=t.index,n.isTTML=function(){var e=!1;return t.codec&&t.codec.search("stpp")>=0&&(e=!0),t.mimeType&&t.mimeType.search("ttml")>=0&&(e=!0),e}(),n.video=X.getElement(),n.defaultTrack=I(t),n.isFragmented=G,n.isEmbedded=!!t.isEmbedded,n.kind=function(){var e=t.roles.length>0?r[t.roles[0]]:r.caption;return e=e===r.caption||e===r.subtitle?e:r.caption}();var i=(q?q.length:0)+$.length;V.addTextTrack(n,i)}var i,o,s,l,u,d,c,f=t.mediaInfo,h=f.type,m=f.mimeType,g=f.codec||m;if(!g)return void P("No text type defined");if("fragmentedText"===h)if(z)if(d=H.getSamplesInfo(e),o=d.sampleList,!Z&&o.length>0&&(Z=o[0].cts-t.start*Y),g.search("stpp")>=0)for(B=null!==B?B:D(g),s=0;s<o.length;s++){var y=o[s],v=y.cts,_=v-Z;this.buffered.add(_/Y,(_+y.duration)/Y);var b=new DataView(e,y.offset,y.subSizes[0]);c=T.default.Utils.dataViewToString(b,"utf-8");var E=[],S=y.offset+y.subSizes[0];for(l=1;l<y.subSizes.length;l++){var w=new Uint8Array(e,S,y.subSizes[l]),R=String.fromCharCode.apply(null,w);E.push(R),S+=y.subSizes[l]}try{i=B.parse(c,v/Y,(v+y.duration)/Y,E),V.addCaptions(J,Z/Y,i)}catch(e){P("TTML parser error: "+e.message)}}else{var A=[];for(s=0;s<o.length;s++){var M=o[s];M.cts-=Z,this.buffered.add(M.cts/Y,(M.cts+M.duration)/Y);var L=e.slice(M.offset,M.offset+M.size),C=T.default.parseBuffer(L);for(l=0;l<C.boxes.length;l++){var k=C.boxes[l];if(P("VTT box1: "+k.type),"vtte"!==k.type&&"vttc"===k.type)for(P("VTT vttc boxes.length = "+k.boxes.length),u=0;u<k.boxes.length;u++){var N=k.boxes[u];if(P("VTT box2: "+N.type),"payl"===N.type){var F=N.cue_text;P("VTT cue_text = "+F);var U=M.cts/Y,j=(M.cts+M.duration)/Y;A.push({start:U,end:j,data:F,styles:{}}),P("VTT "+U+"-"+j+" : "+F)}}}}A.length>0&&V.addCaptions(J,0,A)}else{for(z=!0,s=0;s<q.length;s++)n(null,q[s]);Y=H.getMediaTimescaleFromMoov(e)}else if("text"===h){var K=new DataView(e,0,e.byteLength);c=T.default.Utils.dataViewToString(K,"utf-8");try{i=D(g).parse(c),n(i,f)}catch(e){O.timedTextError(e,"parse",c)}}else if("video"===h)if("InitializationSegment"===t.segmentType){if(0===te)for(te=H.getMediaTimescaleFromMoov(e),s=0;s<$.length;s++)n(null,$[s])}else{if(0===te)return void P("CEA-608: No timescale for embeddedTextTrack yet");d=H.getSamplesInfo(e);var W=d.sequenceNumber;if(!ie[0]&&!ie[1]){var Q=void 0,ee=void 0;for(s=0;s<$.length;s++){if("CC1"===$[s].id?ee=V.getTrackIdxForId("CC1"):"CC3"===$[s].id&&(ee=V.getTrackIdxForId("CC3")),-1===ee)return void P("CEA-608: data before track is ready.");Q=function(e,t){function n(e,n,r){var i=null;(i=X.getTTMLRenderingDiv()?p(X.getElement(),e,n,r):[{start:e,end:n,data:r.getDisplayText(),styles:{}}])&&V.addCaptions(t,0,i)}return n}(0,ee),ie[s]=new x.default.Cea608Parser(s,{newCue:Q},null)}}if(te&&-1==re.indexOf(W)){if(null!==ne&&W!==ne+1)for(s=0;s<ie.length;s++)ie[s]&&ie[s].reset();for(var oe=r(e),ae=0;ae<ie.length;ae++){var se=oe.fields[ae],le=ie[ae];if(le){for(s=0;s<se.length;s++)le.addData(se[s][0]/te,se[s][1]);oe.endTime&&le.cueSplitAtTime(oe.endTime/te)}}ne=W,re.push(W)}}}function r(e){var t=C.parse(e),n=t.getBox("moof"),r=t.getBox("tfdt"),i=t.getBox("tfhd"),o=t.getBoxes("trun"),a=null;if(0===o.length)return null;a=o[0],o.length>1&&P("Warning: Too many truns");for(var s=n.offset+a.data_offset,l=a.sample_count,u=s,d=r.baseMediaDecodeTime,c=new DataView(e),f={startTime:null,endTime:null,fields:[[],[]]},h=0,p=0;p<l;p++){var m=a.samples[p];void 0===m.sample_duration&&(m.sample_duration=i.default_sample_duration),void 0===m.sample_size&&(m.sample_size=i.default_sample_size),void 0===m.sample_composition_time_offset&&(m.sample_composition_time_offset=0);for(var g=d+h+m.sample_composition_time_offset,y=x.default.findCea608Nalus(c,u,m.sample_size),v=0;v<y.length;v++)for(var _=x.default.extractCea608DataFromRange(c,y[v]),b=0;b<2;b++)_[b].length>0&&function(e,t,n){var r=e.length;if(r>0){if(t>=e[r-1][0])e.push([t,n]);else for(var i=r-1;i>=0;i--)if(t<e[i][0]){e.splice(i,0,[t,n]);break}}else e.push([t,n])}(f.fields[b],g,_[b]);h+=m.sample_duration,u+=m.sample_size}var E=d+h;return f.startTime=d,f.endTime=E,f}function i(e){for(var t="",n=0;n<e.length;++n)t+=e[n].uchar;return t.length-t.replace(/^\s+/,"").length}function o(e){return"left: "+3.125*e.x+"%; top: "+6.66*e.y1+"%; width: "+(100-3.125*e.x)+"%; height: "+6.66*Math.max(e.y2-1-e.y1,1)+"%; align-items: flex-start; overflow: visible; -webkit-writing-mode: horizontal-tb;"}function s(e){return"red"==e?"rgb(255, 0, 0)":"green"==e?"rgb(0, 255, 0)":"blue"==e?"rgb(0, 0, 255)":"cyan"==e?"rgb(0, 255, 255)":"magenta"==e?"rgb(255, 0, 255)":"yellow"==e?"rgb(255, 255, 0)":"white"==e?"rgb(255, 255, 255)":"black"==e?"rgb(0, 0, 0)":e}function u(e,t){var n=e.videoHeight/15;return t?"font-size: "+n+"px; font-family: Menlo, Consolas, 'Cutive Mono', monospace; color: "+(t.foreground?s(t.foreground):"rgb(255, 255, 255)")+"; font-style: "+(t.italics?"italic":"normal")+"; text-decoration: "+(t.underline?"underline":"none")+"; white-space: pre; background-color: "+(t.background?s(t.background):"transparent")+";":"font-size: "+n+"px; font-family: Menlo, Consolas, 'Cutive Mono', monospace; justify-content: flex-start; text-align: left; color: rgb(255, 255, 255); font-style: normal; white-space: pre; line-height: normal; font-weight: normal; text-decoration: none; width: 100%; display: flex;"}function c(e){return e.replace(/^\s+/g,"")}function h(e){return e.replace(/\s+$/g,"")}function p(e,t,n,r){var a=null,s=null,l=!1,d=-1,f={start:t,end:n,spans:[]},p="style_cea608_white_black",m={},g={},y=[],v=void 0,_=void 0;for(v=0;v<15;++v){var b=r.rows[v],E="",T=null;if(!1===b.isEmpty()){var S=i(b.chars);null===a&&(a={x:S,y1:v,y2:v+1,p:[]}),S!==d&&l&&(a.p.push(f),f={start:t,end:n,spans:[]},a.y2=v,a.name="region_"+a.x+"_"+a.y1+"_"+a.y2,!1===m.hasOwnProperty(a.name)?(y.push(a),m[a.name]=a):(s=m[a.name],s.p.contat(a.p)),a={x:S,y1:v,y2:v+1,p:[]});for(var x=0;x<b.chars.length;++x){var w=b.chars[x],I=w.penState;if(null===T||!I.equals(T)){E.trim().length>0&&(f.spans.push({name:p,line:E,row:v}),E="");var D="style_cea608_"+I.foreground+"_"+I.background;I.underline&&(D+="_underline"),I.italics&&(D+="_italics"),g.hasOwnProperty(D)||(g[D]=JSON.parse(JSON.stringify(I))),T=I,p=D}E+=w.uchar}E.trim().length>0&&f.spans.push({name:p,line:E,row:v}),l=!0,d=S}else l=!1,d=-1,a&&(a.p.push(f),f={start:t,end:n,spans:[]},a.y2=v,a.name="region_"+a.x+"_"+a.y1+"_"+a.y2,!1===m.hasOwnProperty(a.name)?(y.push(a),m[a.name]=a):(s=m[a.name],s.p.contat(a.p)),a=null)}a&&(a.p.push(f),a.y2=v+1,a.name="region_"+a.x+"_"+a.y1+"_"+a.y2,!1===m.hasOwnProperty(a.name)?(y.push(a),m[a.name]=a):(s=m[a.name],s.p.contat(a.p)),a=null);var R=[];for(v=0;v<y.length;++v){var A=y[v],P="sub_cea608_"+L++,M=document.createElement("div");M.id=P;var C=o(A);M.style.cssText="position: absolute; margin: 0; display: flex; box-sizing: border-box; pointer-events: none;"+C;var O=document.createElement("div");O.className="paragraph bodyStyle",O.style.cssText=u(e);var k=document.createElement("div");k.className="cueUniWrapper",k.style.cssText="unicode-bidi: normal; direction: ltr;";for(var N=0;N<A.p.length;++N){var F=A.p[N],B=0;for(_=0;_<F.spans.length;++_){var U=F.spans[_];if(U.line.length>0){if(0!==_&&B!=U.row){var j=document.createElement("br");j.className="lineBreak",k.appendChild(j)}var H=!1;B===U.row&&(H=!0),B=U.row;var q=g[U.name],V=document.createElement("span");V.className="spanPadding "+U.name+" customSpanColor",V.style.cssText=u(e,q),0!==_&&H?_===F.spans.length-1?V.textContent=h(U.line):V.textContent=U.line:0===_&&F.spans.length>1&&U.row===F.spans[1].row?V.textContent=c(U.line):V.textContent=U.line.trim(),k.appendChild(V)}}}O.appendChild(k),M.appendChild(O);var G={bodyStyle:["%",90]};for(_ in g)g.hasOwnProperty(_)&&(G[_]=["%",90]);R.push({type:"html",start:t,end:n,cueHTMLElement:M,cueID:P,cellResolution:[32,15],isFromCEA608:!0,regions:y,regionID:A.name,videoHeight:e.videoHeight,videoWidth:e.videoWidth,fontSize:G,lineHeight:{},linePadding:{}})}return R}function m(){V.deleteAllTextTracks(),F=!1,B=null,H=null,q=null,V=null,G=!1,K=null,z=!1,Y=NaN,W=[],X=null,Q=null,M=!1,$=null}function y(e){M||t(),"CC1"===e.id||"CC3"===e.id?$.push(e):P("Warning: Embedded track "+e.id+" not supported!")}function _(){M=!1,$=[],ie=[null,null],re=[],ne=null}function E(){return F}function S(e){e&&(e.errHandler&&(O=e.errHandler),e.dashManifestModel&&(k=e.dashManifestModel),e.mediaController&&(N=e.mediaController),e.videoModel&&(X=e.videoModel),e.streamController&&(Q=e.streamController),e.textTracks&&(V=e.textTracks),e.VTTParser&&(U=e.VTTParser),e.TTMLParser&&(j=e.TTMLParser))}function w(){for(var e=X.getElement(),t=e.textTracks,n=t.length,r=n-$.length,i=V.getCurrentTrackIdx(),o=0;o<n;o++){var a=t[o];if(F="showing"!==a.mode,"showing"===a.mode){if(i!==o&&(V.setCurrentTrackIdx(o),V.addCaptions(o,0,null),G&&o<r)){var s=N.getCurrentTrackFor("fragmentedText",Q.getActiveStreamInfo()),l=W[o];l!==s&&(K.abortRequests(),V.deleteTrackCues(s),N.setTrack(l),J=o)}break}}F&&V.setCurrentTrackIdx(-1)}function I(e){var t=!1;return $.length>1&&e.isEmbedded?t=e.id&&"CC1"===e.id:1===$.length?e.id&&"CC"===e.id.substring(0,2)&&(t=!0):0===$.length&&(t=e.index===q[0].index),t}function D(e){var t;return e.search("vtt")>=0?t=U:(e.search("ttml")>=0||e.search("stpp")>=0)&&(t=j,t.setConfig({videoModel:X})),t}function R(){return V.getCurrentTrackIdx()}var A=this.context,P=(0,g.default)(A).getInstance().log,M=!1,L=0,C=void 0,O=void 0,k=void 0,N=void 0,F=void 0,B=void 0,U=void 0,j=void 0,H=void 0,q=void 0,V=void 0,G=void 0,K=void 0,z=void 0,Y=void 0,W=void 0,X=void 0,Q=void 0,Z=void 0,J=void 0,$=void 0,ee=void 0,te=void 0,ne=void 0,re=void 0,ie=void 0;return{initialize:e,append:n,abort:m,getCurrentTrackIdx:R,getAllTracksAreDisabled:E,setTextTrack:w,setConfig:S,addEmbeddedTrack:y,resetEmbedded:_}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(149),a=r(o),s=n(77),l=r(s),u=n(38),d=r(u),c=n(57),f=r(c),h=n(0),p=r(h),m=n(3),g=r(m),y=n(17),v=r(y),_=n(36),b=r(_),E=n(41),T=r(E),S=n(42),x=r(S);i.__dashjs_factory_name="TextSourceBuffer",t.default=p.default.getSingletonFactory(i)},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(e,t,n){be=e,Z(t),Pe=n,Ce=(0,l.default)(te).getInstance(),Ae=(0,p.default)(te).getInstance(),Me=(0,f.default)(te).getInstance(),Oe=(0,R.default)(te).getInstance(),Le=Pe.getScheduleController(),he=Me.getQualityFor(be,Pe.getStreamInfo()),re.on(b.default.DATA_UPDATE_COMPLETED,U,this),re.on(b.default.INIT_FRAGMENT_LOADED,i,this),re.on(b.default.MEDIA_FRAGMENT_LOADED,s,this),re.on(b.default.QUALITY_CHANGE_REQUESTED,h,this),re.on(b.default.STREAM_COMPLETED,j,this),re.on(b.default.PLAYBACK_PROGRESS,y,this),re.on(b.default.PLAYBACK_TIME_UPDATED,y,this),re.on(b.default.PLAYBACK_RATE_CHANGED,V,this),re.on(b.default.PLAYBACK_SEEKING,m,this),re.on(b.default.WALLCLOCK_TIME_UPDATED,q,this),re.on(b.default.CURRENT_TRACK_CHANGED,H,this,v.default.EVENT_PRIORITY_HIGH),re.on(b.default.SOURCEBUFFER_APPEND_COMPLETED,c,this),re.on(b.default.SOURCEBUFFER_REMOVE_COMPLETED,F,this)}function n(e){if(!e||!ye||!Pe)return null;var t=null;try{(t=ae.createSourceBuffer(ye,e))&&t.hasOwnProperty("initialize")&&t.initialize(be,this)}catch(e){se.mediaSourceError("Error creating "+be+" source buffer.")}return W(t),B(Pe.getRepresentationInfoForQuality(he).MSETimeOffset),t}function r(){return Pe.getStreamInfo().id===le.getActiveStreamInfo().id}function i(e){e.fragmentModel===Pe.getFragmentModel()&&(ne("Init fragment finished loading saving to",be+"'s init cache"),Oe.save(e.chunk),u(e.chunk))}function o(e,t){var n=Oe.extract(e,be,t);n?u(n):re.trigger(b.default.INIT_REQUESTED,{sender:fe})}function s(e){if(e.fragmentModel===Pe.getFragmentModel()){var t=e.chunk,n=t.bytes,r=t.quality,i=Pe.getRepresentationInfoForQuality(r),o=oe.getValue(),s=de.getEventsFor(o,i.mediaInfo,Pe),l=de.getEventsFor(o,i,Pe);if(s&&s.length>0||l&&l.length>0){var d=Pe.getFragmentModel().getRequests({state:a.default.FRAGMENT_MODEL_EXECUTED,quality:r,index:t.index})[0],c=D(n,d,s,l);Pe.getEventController().addInbandEvents(c)}t.bytes=L(n),u(t)}}function u(e){Ie=!0,Se=e,ae.append(Ee,e),"video"===e.mediaInfo.type&&e.mediaInfo.embeddedCaptions&&ce.append(e.bytes,e)}function c(e){if(Ee===e.buffer){if(e.error||!C())return e.error.code===d.default.QUOTA_EXCEEDED_ERROR_CODE&&(ge=.8*ae.getTotalBufferedTime(Ee)),void(e.error.code!==d.default.QUOTA_EXCEEDED_ERROR_CODE&&C()||(re.trigger(b.default.QUOTA_EXCEEDED,{sender:fe,criticalBufferLevel:ge}),N(k())));isNaN(Se.index)||(ve=Math.max(Se.index,ve),S());var t=ae.getAllRanges(Ee);if(t&&t.length>0)for(var n=0,r=t.length;n<r;n++)ne("Buffered Range for type:",be,":",t.start(n)," - ",t.end(n));y(),Ie=!1,re.trigger(b.default.BYTES_APPENDED,{sender:fe,quality:Se.quality,startTime:Se.start,index:Se.index,bufferedRanges:t})}}function h(e){he!==e.newQuality&&be===e.mediaType&&Pe.getStreamInfo().id===e.streamInfo.id&&(B(Pe.getRepresentationInfoForQuality(e.newQuality).MSETimeOffset),he=e.newQuality)}function m(){_e=Number.POSITIVE_INFINITY,pe=!1,y()}function y(){_(),E()}function _(){me=ae.getBufferLength(Ee,Ae.getTime()),re.trigger(b.default.BUFFER_LEVEL_UPDATED,{sender:fe,bufferLevel:me}),x()}function E(){r()&&(ie.addBufferState(be,Te,Le.getBufferTarget()),ie.addBufferLevel(be,new Date,1e3*me))}function S(){ve>=_e-1&&!pe&&(pe=!0,re.trigger(b.default.BUFFERING_COMPLETED,{sender:fe,streamInfo:Pe.getStreamInfo()}))}function x(){w(me<M&&!pe?P:A)}function w(e){Te===e||"fragmentedText"===be&&ce.getAllTracksAreDisabled()||(Te=e,E(),re.trigger(b.default.BUFFER_LEVEL_STATE_CHANGED,{sender:fe,state:e,mediaType:be,streamInfo:Pe.getStreamInfo()}),re.trigger(e===A?b.default.BUFFER_LOADED:b.default.BUFFER_EMPTY,{mediaType:be}),ne(e===A?"Got enough buffer to start.":"Waiting for more buffer before starting playback."))}function D(e,t,n,r){var i=Math.max(isNaN(t.startTime)?0:t.startTime,0),o=[],a=[];Re=!1;for(var s=n.concat(r),l=0,u=s.length;l<u;l++)o[s[l].schemeIdUri]=s[l];for(var d=(0,T.default)(te).getInstance().parse(e),c=d.getBoxes("emsg"),f=0,h=c.length;f<h;f++){var p=de.getEvent(c[f],o,i);p&&a.push(p)}return a}function L(e){if(!Re)return e;for(var t=e.length,n=Math.pow(256,2),r=Math.pow(256,3),i=new Uint8Array(e.length),o=0,a=0;o<t;){var s=String.fromCharCode(e[o+4],e[o+5],e[o+6],e[o+7]),l=e[o]*r+e[o+1]*n+256*e[o+2]+1*e[o+3];if("emsg"!=s)for(var u=o;u<o+l;u++)i[a]=e[u],a++;o+=l}return i.subarray(0,a)}function C(){return ae.getTotalBufferedTime(Ee)<ge}function O(){if(Ee&&"fragmentedText"!==be){var e=Ee.buffered.length?Ee.buffered.start(0):0,t=Ae.getTime()-e-Ce.getBufferToKeep();t>0&&(ne("pruning buffer: "+t+" seconds."),De=!0,ae.remove(Ee,0,Math.round(e+t),ye))}}function k(){if(!Ee)return null;var e=Ae.getTime(),t=Pe.getFragmentModel().getRequests({state:a.default.FRAGMENT_MODEL_EXECUTED,time:e})[0],n=ae.getBufferRange(Ee,e),r=t&&!isNaN(t.startTime)?t.startTime:Math.floor(e);return null===n&&Ee.buffered.length>0&&(r=Ee.buffered.end(Ee.buffered.length-1)),{start:Ee.buffered.start(0),end:r}}function N(e){e&&Ee&&ae.remove(Ee,e.start,e.end,ye)}function F(e){Ee===e.buffer&&(De&&(De=!1),_(),re.trigger(b.default.BUFFER_CLEARED,{sender:fe,from:e.from,to:e.to,hasEnoughSpaceToAppend:C()}))}function B(e){Ee&&Ee.timestampOffset!==e&&!isNaN(e)&&(Ee.timestampOffset=e)}function U(e){e.sender.getStreamProcessor()!==Pe||e.error||B(e.currentRepresentation.MSETimeOffset)}function j(e){e.fragmentModel===Pe.getFragmentModel()&&(_e=e.request.index,S())}function H(e){Ee&&e.newMediaInfo.type===be&&e.newMediaInfo.streamInfo.id===Pe.getStreamInfo().id&&ue.getSwitchMode(be)===g.default.TRACK_SWITCH_MODE_ALWAYS_REPLACE&&N(k())}function q(){++xe*(Ce.getWallclockTimeUpdateInterval()/1e3)>=Ce.getBufferPruningInterval()&&!Ie&&(xe=0,O())}function V(){x()}function G(){return be}function K(){return Pe}function z(e){Pe=e}function Y(){return Ee}function W(e){Ee=e}function X(){return me}function Q(){return ge}function Z(e){ye=e}function J(){return ye}function $(){return pe}function ee(e){re.off(b.default.DATA_UPDATE_COMPLETED,U,this),re.off(b.default.QUALITY_CHANGE_REQUESTED,h,this),re.off(b.default.INIT_FRAGMENT_LOADED,i,this),re.off(b.default.MEDIA_FRAGMENT_LOADED,s,this),re.off(b.default.STREAM_COMPLETED,j,this),re.off(b.default.CURRENT_TRACK_CHANGED,H,this),re.off(b.default.PLAYBACK_PROGRESS,y,this),re.off(b.default.PLAYBACK_TIME_UPDATED,y,this),re.off(b.default.PLAYBACK_RATE_CHANGED,V,this),re.off(b.default.PLAYBACK_SEEKING,m,this),re.off(b.default.WALLCLOCK_TIME_UPDATED,q,this),re.off(b.default.SOURCEBUFFER_APPEND_COMPLETED,c,this),re.off(b.default.SOURCEBUFFER_REMOVE_COMPLETED,F,this),ge=Number.POSITIVE_INFINITY,Te=P,he=f.default.QUALITY_DEFAULT,_e=Number.POSITIVE_INFINITY,ve=0,Se=null,we=!1,pe=!1,Ie=!1,De=!1,Ae=null,Pe=null,Me=null,Le=null,e||(ae.abort(ye,Ee),ae.removeSourceBuffer(ye,Ee)),Ee=null}var te=this.context,ne=(0,I.default)(te).getInstance().log,re=(0,v.default)(te).getInstance(),ie=e.metricsModel,oe=e.manifestModel,ae=e.sourceBufferController,se=e.errHandler,le=e.streamController,ue=e.mediaController,de=e.adapter,ce=e.textSourceBuffer,fe=void 0,he=void 0,pe=void 0,me=void 0,ge=void 0,ye=void 0,ve=void 0,_e=void 0,be=void 0,Ee=void 0,Te=void 0,Se=void 0,xe=void 0,we=void 0,Ie=void 0,De=void 0,Re=void 0,Ae=void 0,Pe=void 0,Me=void 0,Le=void 0,Ce=void 0,Oe=void 0;return fe={initialize:t,createBuffer:n,getType:G,getStreamProcessor:K,setStreamProcessor:z,getBuffer:Y,setBuffer:W,getBufferLevel:X,getCriticalBufferLevel:Q,setMediaSource:Z,getMediaSource:J,getIsBufferingCompleted:$,switchInitData:o,reset:ee},function(){he=f.default.QUALITY_DEFAULT,pe=!1,me=0,ge=Number.POSITIVE_INFINITY,ve=0,_e=Number.POSITIVE_INFINITY,Ee=null,Te=P,xe=0,we=!1,Ie=!1,De=!1,Re=!1}(),fe}Object.defineProperty(t,"__esModule",{value:!0});var o=n(28),a=r(o),s=n(4),l=r(s),u=n(26),d=r(u),c=n(12),f=r(c),h=n(7),p=r(h),m=n(13),g=r(m),y=n(1),v=r(y),_=n(2),b=r(_),E=n(38),T=r(E),S=n(0),x=r(S),w=n(3),I=r(w),D=n(58),R=r(D),A="bufferLoaded",P="bufferStalled",M=.5;i.__dashjs_factory_name="BufferController";var L=x.default.getClassFactory(i);L.BUFFER_LOADED=A,L.BUFFER_EMPTY=P,t.default=L},function(e,t,n){function r(){function e(){E=[]}function t(){v.playbackRate=T||1,v.removeEventListener("canplay",t)}function n(e){v&&(v.readyState<=2&&e>0?v.addEventListener("canplay",t):v.playbackRate=e)}function r(e){if(v.currentTime!=e)try{v.currentTime=e}catch(t){0===v.readyState&&t.code===t.INVALID_STATE_ERR&&setTimeout(function(){v.currentTime=e},400)}}function i(){return v}function o(e){v=e,v.preload="auto"}function a(e){e?v.src=e:(v.removeAttribute("src"),v.load())}function s(){return v.src}function l(){return b}function u(e){b=e}function d(){return _}function c(e){_=e,_.style.position="absolute",_.style.display="flex",_.style.overflow="hidden",_.style.pointerEvents="none",_.style.top=0,_.style.left=0}function f(e,t){g(e,t)}function h(){return E.length>0}function p(e){var t=void 0;null===e||v.seeking||-1!==E.indexOf(e)||(E.push(e),1===E.length&&(t=document.createEvent("Event"),t.initEvent("waiting",!0,!1),T=v.playbackRate,n(0),v.dispatchEvent(t)))}function m(e){var t=E.indexOf(e),r=void 0;null!==e&&(-1!==t&&E.splice(t,1),!1===h()&&0===v.playbackRate&&(n(T||1),v.paused||(r=document.createEvent("Event"),r.initEvent("playing",!0,!1),v.dispatchEvent(r))))}function g(e,t){t?p(e):m(e)}function y(){var e="webkitDroppedFrameCount"in v&&"webkitDecodedFrameCount"in v,t="getVideoPlaybackQuality"in v,n=null;return t?n=v.getVideoPlaybackQuality():e&&(n={droppedVideoFrames:v.webkitDroppedFrameCount,totalVideoFrames:v.webkitDroppedFrameCount+v.webkitDecodedFrameCount,creationTime:new Date}),n}var v=void 0,_=void 0,b=void 0,E=void 0,T=void 0;return{initialize:e,setCurrentTime:r,setStallState:f,getElement:i,setElement:o,setSource:a,getSource:s,getVideoContainer:l,setVideoContainer:u,getTTMLRenderingDiv:d,setTTMLRenderingDiv:c,getPlaybackQuality:y}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=function(e){return e&&e.__esModule?e:{default:e}}(i);r.__dashjs_factory_name="VideoModel",t.default=o.default.getSingletonFactory(r)},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){r(this,e),this.action=e.ACTION_DOWNLOAD,this.startTime=NaN,this.mediaType=null,this.mediaInfo=null,this.type=null,this.duration=NaN,this.timescale=NaN,this.range=null,this.url=null,this.serviceLocation=null,this.requestStartDate=null,this.firstByteDate=null,this.requestEndDate=null,this.quality=NaN,this.index=NaN,this.availabilityStartTime=null,this.availabilityEndTime=null,this.wallStartTime=null,this.bytesLoaded=NaN,this.bytesTotal=NaN,this.delayLoadingTime=NaN,this.responseType="arraybuffer"};i.ACTION_DOWNLOAD="download",i.ACTION_COMPLETE="complete",t.default=i},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e){e&&e.dashManifestModel&&(C=e.dashManifestModel)}function t(){O=[],k={}}function n(e,t){return t.getRepresentationForQuality(e.quality)}function r(e){return k?k[e.streamInfo.id][e.index]:null}function i(e){for(var t=O.length,n=0;n<t;n++){var r=O[n];if(e.id===r.id)return r}return null}function o(e,t){var n=new a.default,r=t.adaptation.period.mpd.manifest.Period_asArray[t.adaptation.period.index].AdaptationSet_asArray[t.adaptation.index],i=C.getRepresentationFor(t.index,r);return n.id=t.id,n.quality=t.index,n.bandwidth=C.getBandwidth(i),n.DVRWindow=t.segmentAvailabilityRange,n.fragmentDuration=t.segmentDuration||(t.segments&&t.segments.length>0?t.segments[0].duration:NaN),n.MSETimeOffset=t.MSETimeOffset,n.useCalculatedLiveEdgeTime=t.useCalculatedLiveEdgeTime,n.mediaInfo=s(e,t.adaptation),n}function s(e,t){var n,r=new l.default,i=t.period.mpd.manifest.Period_asArray[t.period.index].AdaptationSet_asArray[t.index];return r.id=t.id,r.index=t.index,r.type=t.type,r.streamInfo=c(e,t.period),r.representationCount=C.getRepresentationCount(i),r.lang=C.getLanguageForAdaptation(i),n=C.getViewpointForAdaptation(i),r.viewpoint=n?n.value:void 0,r.accessibility=C.getAccessibilityForAdaptation(i).map(function(e){var t=e.value,n=t;return e.schemeIdUri&&e.schemeIdUri.search("cea-608")>=0&&void 0!==v.default&&(n=t?"cea-608:"+t:"cea-608",r.embeddedCaptions=!0),n}),r.audioChannelConfiguration=C.getAudioChannelConfigurationForAdaptation(i).map(function(e){return e.value}),r.roles=C.getRolesForAdaptation(i).map(function(e){return e.value}),r.codec=C.getCodec(i),r.mimeType=C.getMimeType(i),r.contentProtection=C.getContentProtectionData(i),r.bitrateList=C.getBitrateListForAdaptation(i),r.contentProtection&&r.contentProtection.forEach(function(e){e.KID=C.getKID(e)}),r.isText=C.getIsTextTrack(r.mimeType),r}function u(e,t,n){e.id=t,e.index=100+parseInt(t.substring(2,3)),e.type="embeddedText",e.codec="cea-608-in-SEI",e.isText=!0,e.isEmbedded=!0,e.lang=t+" "+n,e.roles=["caption"]}function c(e,t){var n=new d.default;return n.id=t.id,n.index=t.index,n.start=t.start,n.duration=t.duration,n.manifestInfo=h(e,t.mpd),n.isLast=1===e.Period_asArray.length||Math.abs(n.start+n.duration-n.manifestInfo.duration)<1,n.isFirst=1===e.Period_asArray.length||C.getRegularPeriods(e,C.getMpd(e))[0].id===t.id,n}function h(e,t){var n=new f.default;return n.DVRWindowSize=t.timeShiftBufferDepth,n.loadedTime=t.manifest.loadedTime,n.availableFrom=t.availabilityStartTime,n.minBufferTime=t.manifest.minBufferTime,n.maxFragmentDuration=t.maxSegmentDuration,n.duration=C.getDuration(e),n.isDynamic=C.getIsDynamic(e),n}function m(e,t,n){var r=C.getAdaptationForType(e,t.index,n,t);if(!r)return null;var o=i(t),a=o.id,l=C.getIndexForAdaptation(r,e,t.index);return k[a]=k[a]||C.getAdaptationsForPeriod(e,o),s(e,k[a][l])}function g(e,t,n){var r,o,a,l,d,c,f=i(t),h=f.id,p=C.getAdaptationsForType(e,t.index,"embeddedText"!==n?n:"video"),m=[];if(!p)return m;for(k[h]=k[h]||C.getAdaptationsForPeriod(e,f),l=0,c=p.length;l<c;l++){if(r=p[l],a=C.getIndexForAdaptation(r,e,t.index),o=s(e,k[h][a]),"embeddedText"===n){var g=o.accessibility.length;for(d=0;d<g;d++)if(o){var y=o.accessibility[d];if(0===y.indexOf("cea-608:")){var v=y.substring(8),_=v.split(";");if("CC"===_[0].substring(0,2))for(d=0;d<_.length;d++)o||(o=s.call(this,e,k[h][a])),u(o,_[d].substring(0,3),_[d].substring(4)),m.push(o),o=null;else for(d=0;d<_.length;d++)o||(o=s.call(this,e,k[h][a])),u(o,"CC"+(d+1),_[d]),m.push(o),o=null}else 0===y.indexOf("cea-608")&&(u(o,"CC1","eng"),m.push(o),o=null)}}o&&"embeddedText"!==n&&m.push(o)}return m}function y(e){if(!e)return null;var t=[],n=C.getMpd(e);O=C.getRegularPeriods(e,n),k={};for(var r=0,i=O.length;r<i;r++)t.push(c(e,O[r]));return t}function _(e){return h(e,C.getMpd(e))}function E(e,t){var n=e.getRepresentationController().getRepresentationForQuality(t);return e.getIndexHandler().getInitRequest(n)}function T(e,t){var r=n(t,e.getRepresentationController());return e.getIndexHandler().getNextSegmentRequest(r)}function S(e,t,r,i){var o=n(t,e.getRepresentationController());return e.getIndexHandler().getSegmentRequestForTime(o,r,i)}function x(e,t,r){var i=n(t,e.getRepresentationController());return e.getIndexHandler().generateSegmentRequestForTime(i,r)}function w(e){return e.getIndexHandler().getCurrentTime()}function I(e,t){return e.getIndexHandler().setCurrentTime(t)}function D(e,t){var n,o,a=i(t.getStreamInfo()),s=t.getMediaInfo(),l=r(s),u=t.getType();n=s.id,o=n?C.getAdaptationForId(n,e,a.index):C.getAdaptationForIndex(s.index,e,a.index),t.getRepresentationController().updateData(o,l,u)}function R(e,t,n){var r=t.getRepresentationForQuality(n);return r?o(e,r):null}function A(e,t){var n=t.getCurrentRepresentation();return n?o(e,n):null}function P(e,t,n){var r=new p.default,i=e.scheme_id_uri,o=e.value,a=e.timescale,s=e.presentation_time_delta,l=e.event_duration,u=e.id,d=e.message_data,c=n*a+s;return t[i]?(r.eventStream=t[i],r.eventStream.value=o,r.eventStream.timescale=a,r.duration=l,r.id=u,r.presentationTime=c,r.messageData=d,r.presentationTimeDelta=s,r):null}function M(e,t,o){var s=[];return t instanceof d.default?s=C.getEventsForPeriod(e,i(t)):t instanceof l.default?s=C.getEventStreamForAdaptationSet(e,r(t)):t instanceof a.default&&(s=C.getEventStreamForRepresentation(e,n(t,o.getRepresentationController()))),s}function L(){O=[],k={}}var C=void 0,O=void 0,k=void 0;return{initialize:t,convertDataToTrack:o,convertDataToMedia:s,convertDataToStream:c,getDataForTrack:n,getDataForMedia:r,getDataForStream:i,getStreamsInfo:y,getManifestInfo:_,getMediaInfoForType:m,getAllMediaInfoForType:g,getCurrentRepresentationInfo:A,getRepresentationInfoForQuality:R,updateData:D,getInitRequest:E,getNextFragmentRequest:T,getFragmentRequestForTime:S,generateFragmentRequestForTime:x,getIndexHandlerTime:w,setIndexHandlerTime:I,getEventsFor:M,getEvent:P,setConfig:e,reset:L,metricsList:b}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(150),a=r(o),s=n(146),l=r(s),u=n(148),d=r(u),c=n(145),f=r(c),h=n(47),p=r(h),m=n(0),g=r(m),y=n(42),v=r(y),_=n(44),b=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(_);i.__dashjs_factory_name="DashAdapter",t.default=g.default.getSingletonFactory(i)},function(e,t,n){function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":r(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":r(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(32),l=function(e){return e&&e.__esModule?e:{default:e}}(s),u=function(e){function t(){i(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.AST_IN_FUTURE="astInFuture",e.BUFFER_EMPTY="bufferStalled",e.BUFFER_LOADED="bufferLoaded",e.BUFFER_LEVEL_STATE_CHANGED="bufferStateChanged",e.ERROR="error",e.FRAGMENT_LOADING_COMPLETED="fragmentLoadingCompleted",e.FRAGMENT_LOADING_STARTED="fragmentLoadingStarted",e.FRAGMENT_LOADING_ABANDONED="fragmentLoadingAbandoned",e.LOG="log",e.MANIFEST_LOADED="manifestLoaded",e.METRICS_CHANGED="metricsChanged",e.METRIC_CHANGED="metricChanged",e.METRIC_ADDED="metricAdded",e.METRIC_UPDATED="metricUpdated",e.PERIOD_SWITCH_COMPLETED="periodSwitchCompleted",e.PERIOD_SWITCH_STARTED="periodSwitchStarted",e.QUALITY_CHANGE_REQUESTED="qualityChangeRequested",e.QUALITY_CHANGE_RENDERED="qualityChangeRendered",e.STREAM_INITIALIZED="streamInitialized",e.TEXT_TRACKS_ADDED="allTextTracksAdded",e.TEXT_TRACK_ADDED="textTrackAdded",e.CAN_PLAY="canPlay",e.PLAYBACK_ENDED="playbackEnded",e.PLAYBACK_ERROR="playbackError",e.PLAYBACK_NOT_ALLOWED="playbackNotAllowed",e.PLAYBACK_METADATA_LOADED="playbackMetaDataLoaded",e.PLAYBACK_PAUSED="playbackPaused",e.PLAYBACK_PLAYING="playbackPlaying",e.PLAYBACK_PROGRESS="playbackProgress",e.PLAYBACK_RATE_CHANGED="playbackRateChanged",e.PLAYBACK_SEEKED="playbackSeeked",e.PLAYBACK_SEEKING="playbackSeeking",e.PLAYBACK_STARTED="playbackStarted",e.PLAYBACK_TIME_UPDATED="playbackTimeUpdated",e}return a(t,e),t}(l.default),d=new u;t.default=d},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e){function t(e,n){var r=e.request,i=new XMLHttpRequest,o=[],a=!0,d=!0,f=new Date,h=f,v=0,_=function(e){d=!1,r.requestStartDate=f,r.requestEndDate=new Date,r.firstByteDate=r.firstByteDate||f,r.checkExistenceOnly||u.addHttpRequest(r.mediaType,null,r.type,r.url,i.responseURL||null,r.serviceLocation||null,r.range||null,r.requestStartDate,r.firstByteDate,r.requestEndDate,i.status,r.duration,i.getAllResponseHeaders(),e?o:null)},b=function(){-1!==p.indexOf(i)&&(p.splice(p.indexOf(i),1),d&&(_(!1),n>0?(n--,g.push(setTimeout(function(){t(e,n)},s.getRetryIntervalForType(r.type)))):(l.downloadError(y[r.type],r.url,r),e.error&&e.error(r,"error",i.statusText),e.complete&&e.complete(r,i.statusText))))},E=function(t){var n=new Date;a&&(a=!1,(!t.lengthComputable||t.lengthComputable&&t.total!==t.loaded)&&(r.firstByteDate=n)),t.lengthComputable&&(r.bytesLoaded=t.loaded,r.bytesTotal=t.total),o.push({s:h,d:n.getTime()-h.getTime(),b:[t.loaded?t.loaded-v:0]}),h=n,v=t.loaded,e.progress&&e.progress()},T=function(){i.status>=200&&i.status<=299&&(_(!0),e.success&&e.success(i.response,i.statusText,i),e.complete&&e.complete(r,i.statusText))};try{var S=c.modifyRequestURL(r.url),x=r.checkExistenceOnly?"HEAD":"GET";i.open(x,S,!0),r.responseType&&(i.responseType=r.responseType),r.range&&i.setRequestHeader("Range","bytes="+r.range),r.requestStartDate||(r.requestStartDate=f),i=c.modifyRequestHeader(i),i.withCredentials=s.getXHRWithCredentialsForType(r.type),i.onload=T,i.onloadend=b,i.onerror=b,i.onprogress=E;var w=(new Date).getTime();if(isNaN(r.delayLoadingTime)||w>=r.delayLoadingTime)p.push(i),i.send();else{var I={xhr:i};m.push(I),I.delayTimeout=setTimeout(function(){if(-1!==m.indexOf(I)){m.splice(m.indexOf(I),1);try{p.push(I.xhr),I.xhr.send()}catch(e){I.xhr.onerror()}}},r.delayLoadingTime-w)}}catch(e){i.onerror()}}function n(e){e.request&&t(e,s.getRetryAttemptsForType(e.request.type))}function r(){g.forEach(function(e){return clearTimeout(e)}),g=[],m.forEach(function(e){return clearTimeout(e.delayTimeout)}),m=[],p.forEach(function(e){e.onloadend=e.onerror=e.onprogress=void 0,e.abort()}),p=[]}var o=this.context,s=(0,d.default)(o).getInstance(),l=e.errHandler,u=e.metricsModel,c=e.requestModifier,h=void 0,p=void 0,m=void 0,g=void 0,y=void 0;return h={load:n,abort:r},function(){var e;p=[],m=[],g=[],e={},i(e,a.HTTPRequest.MPD_TYPE,f.default.DOWNLOAD_ERROR_ID_MANIFEST),i(e,a.HTTPRequest.XLINK_EXPANSION_TYPE,f.default.DOWNLOAD_ERROR_ID_XLINK),i(e,a.HTTPRequest.INIT_SEGMENT_TYPE,f.default.DOWNLOAD_ERROR_ID_INITIALIZATION),i(e,a.HTTPRequest.MEDIA_SEGMENT_TYPE,f.default.DOWNLOAD_ERROR_ID_CONTENT),i(e,a.HTTPRequest.INDEX_SEGMENT_TYPE,f.default.DOWNLOAD_ERROR_ID_CONTENT),i(e,a.HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE,f.default.DOWNLOAD_ERROR_ID_CONTENT),i(e,a.HTTPRequest.OTHER_TYPE,f.default.DOWNLOAD_ERROR_ID_CONTENT),y=e}(),h}Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),s=n(0),l=r(s),u=n(4),d=r(u),c=n(14),f=r(c);o.__dashjs_factory_name="XHRLoader";var h=l.default.getClassFactory(o);t.default=h},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e,s){he=e,fe=s,le.initialize(),ae=(0,D.default)(G).getInstance(),X=(0,d.default)(G).getInstance(),X.setConfig({log:K,manifestModel:Z,dashManifestModel:J}),X.initialize(Q),_e=(0,v.default)(G).getInstance(),be=(0,a.default)(G).getInstance(),be.setConfig({streamController:Y,timelineConverter:le,metricsModel:ee,dashMetrics:te,manifestModel:Z,dashManifestModel:J,adapter:$,videoModel:_e}),z.on(p.default.TIME_SYNCHRONIZATION_COMPLETED,R,this),z.on(p.default.PLAYBACK_SEEKING,n,this),z.on(p.default.PLAYBACK_TIME_UPDATED,t,this),z.on(p.default.PLAYBACK_ENDED,h,this),z.on(p.default.PLAYBACK_ERROR,O,this),z.on(p.default.PLAYBACK_STARTED,r,this),z.on(p.default.PLAYBACK_PAUSED,i,this),z.on(p.default.MANIFEST_UPDATED,A,this),z.on(p.default.STREAM_BUFFERING_COMPLETED,o,this)}function t(e){if(P()){var t=_e.getPlaybackQuality();t&&ee.addDroppedFrames("video",t)}be.isSeeking()||e.timeToEnd<=V&&h()}function n(e){var t=s(e.seekTime);t&&t!==de?(L(S.PlayListTrace.END_OF_PERIOD_STOP_REASON),y(de,t,e.seekTime)):L(S.PlayListTrace.USER_REQUEST_STOP_REASON),C(S.PlayList.SEEK_START_REASON)}function r(){Se?(Se=!1,C(S.PlayList.INITIAL_PLAYOUT_START_REASON)):Te&&(Te=!1,C(S.PlayList.RESUME_FROM_PAUSE_START_REASON))}function i(e){e.ended||(Te=!0,L(S.PlayListTrace.USER_REQUEST_STOP_REASON))}function o(){var e=N().isLast;ve&&e&&re.signalEndOfStream(ve)}function s(e){var t=0,n=null,r=ue.length;r>0&&(t+=ue[0].getStartTime());for(var i=0;i<r;i++)if(n=ue[i],t+=n.getDuration(),e<t)return n;return null}function u(e,t){for(var n=null,r=0,i=0,o=null,a=ue.length,s=0;s<a;s++){if(n=ue[s],i=n.getStartTime(),o=n.getDuration(),Number.isFinite(i)&&(r=i),n.getId()===t)return e-r;Number.isFinite(o)&&(r+=o)}return null}function c(){var e=[];return de.getProcessors().forEach(function(t){e.push(t.getIndexHandler().getEarliestTime())}),Math.min.apply(Math,e)}function h(){var e=m();e&&y(de,e,NaN),L(e?S.PlayListTrace.END_OF_PERIOD_STOP_REASON:S.PlayListTrace.END_OF_CONTENT_STOP_REASON)}function m(){if(de){var e=de.getStreamInfo().start,t=de.getStreamInfo().duration;return ue.filter(function(n){return n.getStreamInfo().start===e+t})[0]}}function y(e,t,n){!pe&&t&&e!==t&&(pe=!0,z.trigger(p.default.PERIOD_SWITCH_STARTED,{fromStreamInfo:e?e.getStreamInfo():null,toStreamInfo:t.getStreamInfo()}),e&&e.deactivate(),de=t,be.initialize(de.getStreamInfo()),we=M(),_(n))}function _(e){function t(){K("MediaSource is open!"),window.URL.revokeObjectURL(n),ve.removeEventListener("sourceopen",t),ve.removeEventListener("webkitsourceopen",t),T(),E(e)}var n=void 0;ve?re.detachMediaSource(_e):ve=re.createMediaSource(),ve.addEventListener("sourceopen",t,!1),ve.addEventListener("webkitsourceopen",t,!1),n=re.attachMediaSource(ve,_e),K("MediaSource attached to element.  Waiting on open...")}function E(e){if(de.activate(ve),!Se)if(isNaN(e)){var t=be.getStreamStartTime(!0);de.getProcessors().forEach(function(e){$.setIndexHandlerTime(e,t)}),be.seek(t)}else be.seek(e);de.startEventController(),!he&&Se||be.play(),pe=!1,z.trigger(p.default.PERIOD_SWITCH_COMPLETED,{toStreamInfo:de.getStreamInfo()})}function T(){var e=de.getStreamInfo().manifestInfo.duration,t=re.setDuration(ve,e);K("Duration successfully set to: "+t)}function x(e){for(var t=0,n=ue.length;t<n;t++)if(ue[t].getId()===e.id)return ue[t];return null}function I(e){try{var t=$.getStreamsInfo(e);if(0===t.length)throw new Error("There are no streams");var n=te.getCurrentManifestUpdate(ee.getMetricsFor("stream"));ee.updateManifestUpdateInfo(n,{currentTime:be.getTime(),buffered:_e.getElement().buffered,presentationStartTime:t[0].start,clientTimeOffset:le.getClientTimeOffset()});for(var r=0,i=t.length;r<i;r++){var o=t[r],a=x(o);a?a.updateData(o):(a=(0,l.default)(G).create({manifestModel:Z,manifestUpdater:X,adapter:$,timelineConverter:le,capabilities:W,errHandler:se,baseURLController:oe}),ue.push(a),a.initialize(o,ce)),ee.addManifestUpdateStreamInfo(n,o.id,o.index,o.start,o.duration)}de||y(null,ue[0],NaN),z.trigger(p.default.STREAMS_COMPOSED)}catch(t){se.manifestError(t.message,"nostreamscomposed",e),ye=!0,q()}}function R(){var e=Z.getValue();ce&&(z.trigger(p.default.PROTECTION_CREATED,{controller:ce,manifest:e}),ce.setMediaElement(_e.getElement()),fe&&ce.setProtectionData(fe)),I(e)}function A(e){if(e.error)ye=!0,q();else{var t,n,r=e.manifest,i=$.getStreamsInfo(r)[0],o=$.getMediaInfoForType(r,i,"video")||$.getMediaInfoForType(r,i,"audio");o&&(t=$.getDataForMedia(o),(n=J.getRepresentationsForAdaptation(r,t)[0].useCalculatedLiveEdgeTime)&&(K("SegmentTimeline detected using calculated Live Edge Time"),Ee.setUseManifestDateHeaderTimeSource(!1)));var a=J.getUTCTimingSources(e.manifest),s=!J.getIsDynamic(r)||n?a:a.concat(Ee.getUTCTimingSources()),l=(0,g.default)(G).getInstance().isManifestHTTPS();s.forEach(function(e){e.value.replace(/.*?:\/\//g,"")===b.default.DEFAULT_UTC_TIMING_SOURCE.value.replace(/.*?:\/\//g,"")&&(e.value=e.value.replace(l?new RegExp(/^(http:)?\/\//i):new RegExp(/^(https:)?\/\//i),l?"https://":"http://"),K("Matching default timing source protocol to manifest protocol: ",e.value))}),oe.initialize(r),ie.setConfig({metricsModel:ee,dashMetrics:te}),ie.initialize(s,Ee.getUseManifestDateHeaderTimeSource())}}function P(){return void 0===we&&(we=M()),we}function M(){var e=!1;return de.getProcessors().forEach(function(t){"video"===t.getMediaInfo().type&&(e=!0)}),e}function L(e,t){t=t||new Date,xe&&(de&&de.getProcessors().forEach(function(n){var r=n.getScheduleController();r&&r.finalisePlayList(t,e)}),ee.addPlayList(xe),xe=null)}function C(e){xe=new S.PlayList,xe.start=new Date,xe.mstart=1e3*be.getTime(),xe.starttype=e,de&&de.getProcessors().forEach(function(e){var t=e.getScheduleController();t&&t.setPlayList(xe)})}function O(e){if(e.error){var t="";switch(e.error.code){case 1:t="MEDIA_ERR_ABORTED";break;case 2:t="MEDIA_ERR_NETWORK";break;case 3:t="MEDIA_ERR_DECODE";break;case 4:t="MEDIA_ERR_SRC_NOT_SUPPORTED";break;case 5:t="MEDIA_ERR_ENCRYPTED";break;default:t="UNKNOWN"}ge=!0,e.error.message&&(t+=" ("+e.error.message+")"),e.error.msExtendedCode&&(t+=" (0x"+(e.error.msExtendedCode>>>0).toString(16).toUpperCase()+")"),K("Video Element Error: "+t),e.error&&K(e.error),se.mediaSourceError(t),q()}}function k(){return he}function N(){return de?de.getStreamInfo():null}function F(e){return de.getId()===e.id}function B(e){return ue.filter(function(t){return t.getId()===e})[0]}function U(e){Q.load(e)}function j(e){X.setManifest(e)}function H(e){e&&(e.capabilities&&(W=e.capabilities),e.manifestLoader&&(Q=e.manifestLoader),e.manifestModel&&(Z=e.manifestModel),e.dashManifestModel&&(J=e.dashManifestModel),e.protectionController&&(ce=e.protectionController),e.adapter&&($=e.adapter),e.metricsModel&&(ee=e.metricsModel),e.dashMetrics&&(te=e.dashMetrics),e.liveEdgeFinder&&(ne=e.liveEdgeFinder),e.mediaSourceController&&(re=e.mediaSourceController),e.timeSyncController&&(ie=e.timeSyncController),e.baseURLController&&(oe=e.baseURLController),e.errHandler&&(se=e.errHandler),e.timelineConverter&&(le=e.timelineConverter))}function q(){ie.reset(),L(ge||ye?S.PlayListTrace.FAILURE_STOP_REASON:S.PlayListTrace.USER_REQUEST_STOP_REASON);for(var e=0,a=ue.length;e<a;e++)ue[e].reset(ge);ue=[],z.off(p.default.PLAYBACK_TIME_UPDATED,t,this),z.off(p.default.PLAYBACK_SEEKING,n,this),z.off(p.default.PLAYBACK_ERROR,O,this),z.off(p.default.PLAYBACK_STARTED,r,this),z.off(p.default.PLAYBACK_PAUSED,i,this),z.off(p.default.PLAYBACK_ENDED,h,this),z.off(p.default.MANIFEST_UPDATED,A,this),z.off(p.default.STREAM_BUFFERING_COMPLETED,o,this),oe.reset(),X.reset(),ee.clearAllCurrentMetrics(),Z.setValue(null),Q.reset(),le.reset(),ne.reset(),$.reset(),ae.reset(),pe=!1,me=!1,de=null,ge=!1,ye=!1,we=void 0,Se=!0,Te=!1,ve&&(re.detachMediaSource(_e),ve=null),_e=null,ce&&(ce.setMediaElement(null),ce=null,fe=null,Z.getValue()&&z.trigger(p.default.PROTECTION_DESTROYED,{data:Z.getValue().url})),z.trigger(p.default.STREAM_TEARDOWN_COMPLETE)}var V=.1,G=this.context,K=(0,w.default)(G).getInstance().log,z=(0,f.default)(G).getInstance(),Y=void 0,W=void 0,X=void 0,Q=void 0,Z=void 0,J=void 0,$=void 0,ee=void 0,te=void 0,ne=void 0,re=void 0,ie=void 0,oe=void 0,ae=void 0,se=void 0,le=void 0,ue=void 0,de=void 0,ce=void 0,fe=void 0,he=void 0,pe=void 0,me=void 0,ge=void 0,ye=void 0,ve=void 0,_e=void 0,be=void 0,Ee=void 0,Te=void 0,Se=void 0,xe=void 0,we=void 0;return Y={initialize:e,getAutoPlay:k,getActiveStreamInfo:N,isStreamActive:F,isVideoTrackPresent:P,getStreamById:B,getTimeRelativeToStreamId:u,load:U,loadWithManifest:j,getActiveStreamCommonEarliestTime:c,setConfig:H,reset:q},function(){ce=null,ue=[],Ee=(0,b.default)(G).getInstance(),he=!0,pe=!1,me=!1,Te=!1,Se=!0,xe=null,ge=!1,ye=!1}(),Y}Object.defineProperty(t,"__esModule",{value:!0});var o=n(7),a=r(o),s=n(90),l=r(s),u=n(88),d=r(u),c=n(1),f=r(c),h=n(2),p=r(h),m=n(37),g=r(m),y=n(17),v=r(y),_=n(4),b=r(_),E=n(0),T=r(E),S=n(60),x=n(3),w=r(x),I=n(58),D=r(I);i.__dashjs_factory_name="StreamController",t.default=T.default.getSingletonFactory(i)},function(e,t,n){function r(){function e(e){var t=e.indexOf("/"),n=e.lastIndexOf("/");return-1!==t?n===t+1?e:(-1!==e.indexOf("?")&&(e=e.substring(0,e.indexOf("?"))),e.substring(0,n+1)):""}function t(e){var t=e.match(u);return t?t[1]:""}function n(e){return!s.test(e)}function r(e){return n(e)&&"/"===e.charAt(0)}function i(e){return l.test(e)}function o(e,t){return a(e,t)}var a=void 0,s=/^[a-z][a-z0-9+\-.]*:/i,l=/^https?:\/\//i,u=/^([a-z][a-z0-9+\-.]*:\/\/[^\/]+)\/?/i,d=function(e,t){try{return new window.URL(e,t).toString()}catch(t){return e}},c=function(i,o){var a=e;if(!o)return i;if(!n(i))return i;r(i)&&(a=t);var s=a(o);return[s,i].join("/"!==s.charAt(s.length-1)&&"/"!==i.charAt(0)?"/":"")};return function(){try{new window.URL("x","http://y"),a=d}catch(e){}finally{a=a||c}}(),{parseBaseUrl:e,parseOrigin:t,isRelative:n,isPathAbsolute:r,isHTTPURL:i,resolve:o}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=function(e){return e&&e.__esModule?e:{default:e}}(i);r.__dashjs_factory_name="URLUtils",t.default=o.default.getSingletonFactory(r)},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(t,n){r(this,e),this._test=t,this._converter=n}return i(e,[{key:"test",get:function(){return this._test}},{key:"converter",get:function(){return this._converter}}]),e}();t.default=o},function(e,t,n){function r(e,t){for(;e.length<t;)e="0"+e;return e}function i(e,t){return e.representation.startNumber+t}function o(e,t,n){var i,o,a,s,l,u,d=t.length,c="%0".length;if(!e)return e;for(;;){if((i=e.indexOf("$"+t))<0)return e;if((o=e.indexOf("$",i+d))<0)return e;if((a=e.indexOf("%0",i+d))>i&&a<o)switch(s=e.charAt(o-1),l=parseInt(e.substring(a+c,o-1),10),s){case"d":case"i":case"u":u=r(n.toString(),l);break;case"x":u=r(n.toString(16),l);break;case"X":u=r(n.toString(16),l).toUpperCase();break;case"o":u=r(n.toString(8),l);break;default:return e}else u=n;e=e.substring(0,i)+u+e.substring(o+1)}}function a(e,t,n,r){var o,a,s,l;return a=n.segmentDuration,isNaN(a)&&(a=n.adaptation.period.duration),s=n.adaptation.period.start+r*a,l=s+a,o=new f.default,o.representation=n,o.duration=a,o.presentationStartTime=s,o.mediaStartTime=e.calcMediaTimeFromPresentationTime(o.presentationStartTime,n),o.availabilityStartTime=e.calcAvailabilityStartTimeFromPresentationTime(o.presentationStartTime,n.adaptation.period.mpd,t),o.availabilityEndTime=e.calcAvailabilityEndTimeFromPresentationTime(l,n.adaptation.period.mpd,t),o.wallStartTime=e.calcWallTimeForSegment(o,t),o.replacementNumber=i(o,r),o.availabilityIdx=r,o}function s(e,t,n,r,a,s,l,u,d){var c,h,p,m=r/s,g=Math.min(a/s,n.adaptation.period.mpd.maxSegmentDuration);return c=e.calcPresentationTimeFromMediaTime(m,n),h=c+g,p=new f.default,p.representation=n,p.duration=g,p.mediaStartTime=m,p.presentationStartTime=c,p.availabilityStartTime=n.adaptation.period.mpd.manifest.loadedTime,p.availabilityEndTime=e.calcAvailabilityEndTimeFromPresentationTime(h,n.adaptation.period.mpd,t),p.wallStartTime=e.calcWallTimeForSegment(p,t),p.replacementTime=r,p.replacementNumber=i(p,d),l=o(l,"Number",p.replacementNumber),l=o(l,"Time",p.replacementTime),p.media=l,p.mediaRange=u,p.availabilityIdx=d,p}function l(e,t){if(!t||!t.segments)return null;var n,r,i=t.segments.length;if(e<i&&(n=t.segments[e])&&n.availabilityIdx===e)return n;for(r=0;r<i;r++)if((n=t.segments[r])&&n.availabilityIdx===e)return n;return null}function u(e,t,n,r,i){var o,a,s=i||10,l=Number.POSITIVE_INFINITY;return t&&!e.isTimeSyncCompleted()?{start:0,end:l}:!t&&n||r<0?null:(o=Math.max(r-2,0),a=Math.min(r+s,l),{start:o,end:a})}function d(e,t,n,r,i,o){var a,s,u=n.segmentDuration,d=n.adaptation.period.mpd.manifest.minBufferTime,c=n.segmentAvailabilityRange,f={start:e.calcPeriodRelativeTimeFromMpdRelativeTime(n,c.start),end:e.calcPeriodRelativeTimeFromMpdRelativeTime(n,c.end)},h=n.segments,p=2*u,m=o||Math.max(2*d,10*u),g=NaN,y=null;return f.start=Math.max(f.start,0),t&&!e.isTimeSyncCompleted()?(a=Math.floor(f.start/u),s=Math.floor(f.end/u),{start:a,end:s}):(h&&h.length>0?(y=l(i,n),g=y?e.calcPeriodRelativeTimeFromMpdRelativeTime(n,y.presentationStartTime):i>0?i*u:e.calcPeriodRelativeTimeFromMpdRelativeTime(n,r)):g=i>0?i*u:t?f.end:f.start,a=Math.floor(Math.max(g-p,f.start)/u),s=Math.floor(Math.min(a+m/u,f.end/u)),{start:a,end:s})}Object.defineProperty(t,"__esModule",{value:!0}),t.replaceTokenForTemplate=o,t.getIndexBasedSegment=a,t.getTimeBasedSegment=s,t.getSegmentByIndex=l,t.decideSegmentListRangeForTimeline=u,t.decideSegmentListRangeForTemplate=d;var c=n(35),f=function(e){return e&&e.__esModule?e:{default:e}}(c)},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e,t){var n=t.codec,r=null;try{if(n.match(/application\/mp4;\s*codecs="(stpp|wvtt).*"/i))throw new x.default("not really supported");r=e.addSourceBuffer(n)}catch(e){if(!t.isText&&-1===n.indexOf('codecs="stpp')&&-1===n.indexOf('codecs="wvtt'))throw e;r=(0,a.default)(_).getInstance(),r.setConfig({errHandler:(0,f.default)(_).getInstance(),adapter:(0,d.default)(_).getInstance(),dashManifestModel:S,mediaController:(0,l.default)(_).getInstance(),videoModel:(0,T.default)(_).getInstance(),streamController:(0,p.default)(_).getInstance(),textTracks:(0,g.default)(_).getInstance(),VTTParser:(0,v.default)(_).getInstance(),TTMLParser:(0,b.default)(_).getInstance()})}return r}function t(e,t){try{e.removeSourceBuffer(t)}catch(e){}}function n(e,t,n){var r,i,o=null,a=0,s=0,l=null,u=null,d=0,c=n||.15;try{o=e.buffered}catch(e){return null}if(null!==o&&void 0!==o){for(i=0,r=o.length;i<r;i++)if(a=o.start(i),s=o.end(i),null===l)d=Math.abs(a-t),t>=a&&t<s?(l=a,u=s):d<=c&&(l=a,u=s);else{if(!((d=a-u)<=c))break;u=s}if(null!==l)return{start:l,end:u}}return null}function r(e){try{return e.buffered}catch(e){return null}}function i(e){var t,n,i=r(e),o=0;if(!i)return o;for(n=0,t=i.length;n<t;n++)o+=i.end(n)-i.start(n);return o}function o(e,t,r){var i;return i=n(e,t,r),null===i?0:i.end-t}function s(e,t){if(!t)return null;var n,i,o,a,s,l,u,d,c,f=r(t);if(!f)return null;for(var h=0,p=f.length;h<p;h++){if(d=e.length>h,s=d?{start:e.start(h),end:e.end(h)}:null,n=f.start(h),i=f.end(h),!s)return c={start:n,end:i};if(o=s.start===n,a=s.end===i,!o||!a){if(o)c={start:s.end,end:i};else{if(!a)return c={start:n,end:i};c={start:n,end:s.start}}return l=e.length>h+1?{start:e.start(h+1),end:e.end(h+1)}:null,u=h+1<p?{start:f.start(h+1),end:f.end(h+1)}:null,!l||u&&u.start===l.start&&u.end===l.end||(c.end=l.start),c}}return null}function u(e,t){var n=t.bytes,r="append"in e?"append":"appendBuffer"in e?"appendBuffer":null,i="Object"===Object.prototype.toString.call(e).slice(8,-1);if(r)try{y(e,function(){i?e[r](n,t):e[r](n),y(e,function(){E.trigger(R.default.SOURCEBUFFER_APPEND_COMPLETED,{buffer:e,bytes:n})})})}catch(t){E.trigger(R.default.SOURCEBUFFER_APPEND_COMPLETED,{buffer:e,bytes:n,error:new x.default(t.code,t.message,null)})}}function c(e,t,n,r){try{y(e,function(){t>=0&&n>t&&"ended"!==r.readyState&&e.remove(t,n),y(e,function(){E.trigger(R.default.SOURCEBUFFER_REMOVE_COMPLETED,{buffer:e,from:t,to:n})})})}catch(r){E.trigger(R.default.SOURCEBUFFER_REMOVE_COMPLETED,{buffer:e,from:t,to:n,error:new x.default(r.code,r.message,null)})}}function h(e,t){try{"open"===e.readyState?t.abort():t.setTextTrack&&"ended"===e.readyState&&t.abort()}catch(e){}}function m(e){e&&e.dashManifestModel&&(S=e.dashManifestModel)}function y(e,t){var n,r=function(){e.updating||(clearInterval(n),t())},i=function n(){e.updating||(e.removeEventListener("updateend",n,!1),t())};if(!e.updating)return void t();if("function"==typeof e.addEventListener)try{e.addEventListener("updateend",i,!1)}catch(e){n=setInterval(r,50)}else n=setInterval(r,50)}var _=this.context,E=(0,I.default)(_).getInstance(),S=void 0;return{append:u,remove:c,abort:h,createSourceBuffer:e,removeSourceBuffer:t,getBufferRange:n,getAllRanges:r,getTotalBufferedTime:i,getBufferLength:o,getRangeDifference:s,setConfig:m}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(15),a=r(o),s=n(13),l=r(s),u=n(19),d=r(u),c=n(14),f=r(c),h=n(22),p=r(h),m=n(36),g=r(m),y=n(140),v=r(y),_=n(139),b=r(_),E=n(17),T=r(E),S=n(9),x=r(S),w=n(1),I=r(w),D=n(2),R=r(D),A=n(0),P=r(A);i.__dashjs_factory_name="SourceBufferController";var M=P.default.getSingletonFactory(i);M.QUOTA_EXCEEDED_ERROR_CODE=22,t.default=M},function(e,t,n){function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":r(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":r(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(32),l=function(e){return e&&e.__esModule?e:{default:e}}(s),u=function(e){function t(){i(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.METRICS_INITIALISATION_COMPLETE="internal_metricsReportingInitialized",e.BECAME_REPORTING_PLAYER="internal_becameReportingPlayer",e}return a(t,e),t}(l.default),d=new u;t.default=d},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(e){M=e}function n(e){R=e}function r(){return R}function i(e){var t=function(e,t){return e.action===f.default.ACTION_COMPLETE&&e.action===t.action},n=function(e,t){return!isNaN(e.index)&&e.startTime===t.startTime&&e.adaptationIndex===t.adaptationIndex},r=function(e,t){return isNaN(e.index)&&isNaN(t.index)&&e.quality===t.quality};return function(i){var o=!1;return i.some(function(i){if(n(e,i)||r(e,i)||t(e,i))return o=!0}),o}(A)}function o(e){var t=e.state instanceof Array?e.state:[e.state],n=[];return t.forEach(function(t){var r=_(t);n=n.concat(v(r,e))}),n}function s(e){A=A.filter(function(t){return isNaN(t.startTime)||t.startTime>=e})}function u(){M.abort(),P=[]}function d(e){switch(e.action){case f.default.ACTION_COMPLETE:A.push(e),b(e,g),w.trigger(l.default.STREAM_COMPLETED,{request:e,fragmentModel:this});break;case f.default.ACTION_DOWNLOAD:b(e,m),P.push(e),c(e);break;default:x("Unknown request action.")}}function c(e){w.trigger(l.default.FRAGMENT_LOADING_STARTED,{sender:D,request:e}),M.load(e)}function h(e,t,n){for(var r=e.length-1,i=r;i>=0;i--){var o=e[i],a=o.startTime,s=a+o.duration;if(n=void 0!==n?n:o.duration/2,!isNaN(a)&&!isNaN(s)&&t+n>=a&&t-n<s||isNaN(a)&&isNaN(t))return o}return null}function v(e,t){return t.hasOwnProperty("time")?[h(e,t.time,t.threshold)]:e.filter(function(e){for(var n in t)if("state"!==n&&t.hasOwnProperty(n)&&e[n]!=t[n])return!1;return!0})}function _(e){var t=void 0;switch(e){case m:t=P;break;case g:t=A;break;default:t=[]}return t}function b(e,t){I.addSchedulingInfo(e.mediaType,new Date,e.type,e.startTime,e.availabilityStartTime,e.duration,e.quality,e.range,t),I.addRequestsQueue(e.mediaType,P,A)}function E(e){e.sender===M&&(P.splice(P.indexOf(e.request),1),e.response&&!e.error&&A.push(e.request),b(e.request,e.error?y:g),w.trigger(l.default.FRAGMENT_LOADING_COMPLETED,{request:e.request,response:e.response,error:e.error,sender:this}))}function T(){w.off(l.default.LOADING_COMPLETED,E,this),M&&(M.reset(),M=null),A=[],P=[]}var S=this.context,x=(0,p.default)(S).getInstance().log,w=(0,a.default)(S).getInstance(),I=e.metricsModel,D=void 0,R=void 0,A=void 0,P=void 0,M=void 0;return D={setLoader:t,setScheduleController:n,getScheduleController:r,getRequests:o,isFragmentLoaded:i,removeExecutedRequestsBeforeTime:s,abortRequests:u,executeRequest:d,reset:T},function(){R=null,M=null,A=[],P=[],w.on(l.default.LOADING_COMPLETED,E,D)}(),D}Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),a=r(o),s=n(2),l=r(s),u=n(0),d=r(u),c=n(18),f=r(c),h=n(3),p=r(h),m="loading",g="executed",y="failed";i.__dashjs_factory_name="FragmentModel";var v=d.default.getClassFactory(i);v.FRAGMENT_MODEL_LOADING=m,v.FRAGMENT_MODEL_EXECUTED=g,v.FRAGMENT_MODEL_CANCELED="canceled",v.FRAGMENT_MODEL_FAILED=y,t.default=v},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){return i}function t(e){i=e,e&&r.trigger(l.default.MANIFEST_LOADED,{data:e})}var n=this.context,r=(0,a.default)(n).getInstance(),i=void 0;return{getValue:e,setValue:t}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),a=r(o),s=n(2),l=r(s),u=n(0),d=r(u);i.__dashjs_factory_name="ManifestModel",t.default=d.default.getSingletonFactory(i)},function(e,t,n){function r(){function e(e){return e}function t(e){return e}return{modifyRequestURL:e,modifyRequestHeader:t}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=function(e){return e&&e.__esModule?e:{default:e}}(i);r.__dashjs_factory_name="RequestModifier",t.default=o.default.getSingletonFactory(r)},function(e,t,n){function r(e){function t(e){var t=e.localName;return null==t&&(t=e.baseName),null!=t&&""!=t||(t=e.nodeName),t}function n(e){return e.prefix}function r(e){return"string"==typeof e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"):e}function i(e,t,n,r){for(var i=0;i<e.length;i++){var o=e[i];if("string"==typeof o){if(o==r)break}else if(o instanceof RegExp){if(o.test(r))break}else if("function"==typeof o&&o(t,n,r))break}return i!=e.length}function o(t,n,r){switch(e.arrayAccessForm){case"property":t[n]instanceof Array?t[n+"_asArray"]=t[n]:t[n+"_asArray"]=[t[n]]}!(t[n]instanceof Array)&&e.arrayAccessFormPaths.length>0&&i(e.arrayAccessFormPaths,t,n,r)&&(t[n]=[t[n]])}function a(e){var t=e.split(/[-T:+Z]/g),n=new Date(t[0],t[1]-1,t[2]),r=t[5].split(".");if(n.setHours(t[3],t[4],r[0]),r.length>1&&n.setMilliseconds(r[1]),t[6]&&t[7]){var i=60*t[6]+Number(t[7]);i=0+("-"==(/\d\d-\d\d:\d\d$/.test(e)?"-":"+")?-1*i:i),n.setMinutes(n.getMinutes()-i-n.getTimezoneOffset())}else-1!==e.indexOf("Z",e.length-1)&&(n=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds())));return n}function s(t,n,r){if(e.datetimeAccessFormPaths.length>0){var o=r.split(".#")[0];return i(e.datetimeAccessFormPaths,t,n,o)?a(t):t}return t}function l(t,n,r,o){return!(n==T.ELEMENT_NODE&&e.xmlElementsFilter.length>0)||i(e.xmlElementsFilter,t,r,o)}function u(r,i){if(r.nodeType==T.DOCUMENT_NODE){for(var a=new Object,d=r.childNodes,c=0;c<d.length;c++){var f=d.item(c);if(f.nodeType==T.ELEMENT_NODE)if(e.ignoreRoot)a=u(f);else{a={};var h=t(f);a[h]=u(f)}}return a}if(r.nodeType==T.ELEMENT_NODE){var a=new Object;a.__cnt=0;for(var p=[],d=r.childNodes,c=0;c<d.length;c++){var f=d.item(c),h=t(f);if(f.nodeType!=T.COMMENT_NODE){var m=i+"."+h;if(l(a,f.nodeType,h,m))if(a.__cnt++,null==a[h]){var g=u(f,m);if("#text"!=h||/[^\s]/.test(g)){var y={};y[h]=g,p.push(y)}a[h]=g,o(a,h,m)}else{null!=a[h]&&(a[h]instanceof Array||(a[h]=[a[h]],o(a,h,m)));var g=u(f,m);if("#text"!=h||/[^\s]/.test(g)){var y={};y[h]=g,p.push(y)}a[h][a[h].length]=g}}}a.__children=p;for(var v=t(r),_=0;_<r.attributes.length;_++){var b=r.attributes.item(_);a.__cnt++;for(var E=b.value,S=0,x=e.matchers.length;S<x;S++){var w=e.matchers[S];w.test(b,v)&&(E=w.converter(b.value))}a[e.attributePrefix+b.name]=E}var I=n(r);return null!=I&&""!=I&&(a.__cnt++,a.__prefix=I),null!=a["#text"]&&(a.__text=a["#text"],a.__text instanceof Array&&(a.__text=a.__text.join("\n")),e.stripWhitespaces&&(a.__text=a.__text.trim()),delete a["#text"],"property"==e.arrayAccessForm&&delete a["#text_asArray"],a.__text=s(a.__text,h,i+"."+h)),null!=a["#cdata-section"]&&(a.__cdata=a["#cdata-section"],delete a["#cdata-section"],"property"==e.arrayAccessForm&&delete a["#cdata-section_asArray"]),0==a.__cnt&&"text"==e.emptyNodeForm?a="":1==a.__cnt&&null!=a.__text?a=a.__text:1!=a.__cnt||null==a.__cdata||e.keepCData?a.__cnt>1&&null!=a.__text&&e.skipEmptyTextNodesForObj&&(e.stripWhitespaces&&""==a.__text||""==a.__text.trim())&&delete a.__text:a=a.__cdata,delete a.__cnt,!e.enableToStringFunc||null==a.__text&&null==a.__cdata||(a.toString=function(){return(null!=this.__text?this.__text:"")+(null!=this.__cdata?this.__cdata:"")}),a}if(r.nodeType==T.TEXT_NODE||r.nodeType==T.CDATA_SECTION_NODE)return r.nodeValue}function d(t,n,i,o){var a="<"+(null!=t&&null!=t.__prefix?t.__prefix+":":"")+n;if(null!=i)for(var s=0;s<i.length;s++){var l=i[s],u=t[l];e.escapeMode&&(u=r(u)),a+=" "+l.substr(e.attributePrefix.length)+"=",e.useDoubleQuotes?a+='"'+u+'"':a+="'"+u+"'"}return a+=o?"/>":">"}function c(e,t){return"</"+(null!=e.__prefix?e.__prefix+":":"")+t+">"}function f(e,t){return-1!==e.indexOf(t,e.length-t.length)}function h(t,n){return!!("property"==e.arrayAccessForm&&f(n.toString(),"_asArray")||0==n.toString().indexOf(e.attributePrefix)||0==n.toString().indexOf("__")||t[n]instanceof Function)}function p(e){var t=0;if(e instanceof Object)for(var n in e)h(e,n)||t++;return t}function m(t,n,r){return 0==e.jsonPropertiesFilter.length||""==r||i(e.jsonPropertiesFilter,t,n,r)}function g(t){var n=[];if(t instanceof Object)for(var r in t)-1==r.toString().indexOf("__")&&0==r.toString().indexOf(e.attributePrefix)&&n.push(r);return n}function y(t){var n="";return null!=t.__cdata&&(n+="<![CDATA["+t.__cdata+"]]>"),null!=t.__text&&(e.escapeMode?n+=r(t.__text):n+=t.__text),n}function v(t){var n="";return t instanceof Object?n+=y(t):null!=t&&(e.escapeMode?n+=r(t):n+=t),n}function _(e,t){return""===e?t:e+"."+t}function b(e,t,n,r){var i="";if(0==e.length)i+=d(e,t,n,!0);else for(var o=0;o<e.length;o++)i+=d(e[o],t,g(e[o]),!1),i+=E(e[o],_(r,t)),i+=c(e[o],t);return i}function E(e,t){var n="";if(p(e)>0)for(var r in e)if(!h(e,r)&&(""==t||m(e,r,_(t,r)))){var i=e[r],o=g(i);if(null==i||void 0==i)n+=d(i,r,o,!0);else if(i instanceof Object)if(i instanceof Array)n+=b(i,r,o,t);else if(i instanceof Date)n+=d(i,r,o,!1),n+=i.toISOString(),n+=c(i,r);else{var a=p(i);a>0||null!=i.__text||null!=i.__cdata?(n+=d(i,r,o,!1),n+=E(i,_(t,r)),n+=c(i,r)):n+=d(i,r,o,!0)}else n+=d(i,r,o,!1),n+=v(i),n+=c(i,r)}return n+=v(e)}e=e||{},function(){void 0===e.escapeMode&&(e.escapeMode=!0),void 0===e.attributePrefix&&(e.attributePrefix="_"),e.arrayAccessForm=e.arrayAccessForm||"none",e.emptyNodeForm=e.emptyNodeForm||"text",void 0===e.enableToStringFunc&&(e.enableToStringFunc=!0),e.arrayAccessFormPaths=e.arrayAccessFormPaths||[],void 0===e.skipEmptyTextNodesForObj&&(e.skipEmptyTextNodesForObj=!0),void 0===e.stripWhitespaces&&(e.stripWhitespaces=!0),e.datetimeAccessFormPaths=e.datetimeAccessFormPaths||[],void 0===e.useDoubleQuotes&&(e.useDoubleQuotes=!1),e.xmlElementsFilter=e.xmlElementsFilter||[],e.jsonPropertiesFilter=e.jsonPropertiesFilter||[],void 0===e.keepCData&&(e.keepCData=!1),void 0===e.ignoreRoot&&(e.ignoreRoot=!1)}();var T={ELEMENT_NODE:1,TEXT_NODE:3,CDATA_SECTION_NODE:4,COMMENT_NODE:8,DOCUMENT_NODE:9};this.parseXmlString=function(e){var t=window.ActiveXObject||"ActiveXObject"in window;if(void 0===e)return null;var n;if(window.DOMParser){var r=new window.DOMParser,i=null;if(!t)try{i=r.parseFromString("INVALID","text/xml").getElementsByTagName("parsererror")[0].namespaceURI}catch(e){i=null}try{n=r.parseFromString(e,"text/xml"),null!=i&&n.getElementsByTagNameNS(i,"parsererror").length>0&&(n=null)}catch(e){n=null}}else 0==e.indexOf("<?")&&(e=e.substr(e.indexOf("?>")+2)),n=new ActiveXObject("Microsoft.XMLDOM"),n.async="false",n.loadXML(e);return n},this.asArray=function(e){return void 0===e||null==e?[]:e instanceof Array?e:[e]},this.toXmlDateTime=function(e){return e instanceof Date?e.toISOString():"number"==typeof e?new Date(e).toISOString():null},this.asDateTime=function(e){return"string"==typeof e?a(e):e},this.xml2json=function(e){return u(e)},this.xml_str2json=function(e){var t=this.parseXmlString(e);return null!=t?this.xml2json(t):null},this.json2xml_str=function(e){return E(e,"")},this.json2xml=function(e){var t=this.json2xml_str(e);return this.parseXmlString(t)},this.getVersion=function(){return"1.2.0"}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(){r(this,e)}return i(e,[{key:"extend",value:function(e,t){if(e){var n=!!t&&t.override,r=!!t&&t.publicOnly;for(var i in e)!e.hasOwnProperty(i)||this[i]&&!n||r&&-1===e[i].indexOf("public_")||(this[i]=e[i])}}}]),e}();t.default=o},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){x=0,w=!1,I=NaN,S.on(l.default.TIME_SYNCHRONIZATION_COMPLETED,_,this)}function t(){return w}function n(e){w=e}function r(){return x}function i(e){x=e}function o(){return I}function s(e){I=e}function u(e,t,n,r){return r?n&&t.timeShiftBufferDepth!=Number.POSITIVE_INFINITY?new Date(t.availabilityStartTime.getTime()+1e3*(e+t.timeShiftBufferDepth)):t.availabilityEndTime:n?new Date(t.availabilityStartTime.getTime()+1e3*(e-x)):t.availabilityStartTime}function d(e,t,n){return u.call(this,e,t,n)}function c(e,t,n){return u.call(this,e,t,n,!0)}function f(e,t){return(e.getTime()-t.mpd.availabilityStartTime.getTime()+1e3*x)/1e3}function h(e,t){return e+(t.adaptation.period.start-t.presentationTimeOffset)}function p(e,t){return e-t.adaptation.period.start+t.presentationTimeOffset}function m(e,t){var n,r,i;return t&&(n=e.representation.adaptation.period.mpd.suggestedPresentationDelay,r=e.presentationStartTime+n,i=new Date(e.availabilityStartTime.getTime()+1e3*r)),i}function g(e,t){var n=e.adaptation.period,r={start:n.start,end:n.start+n.duration};if(!t)return r;if(!w&&e.segmentAvailabilityRange)return e.segmentAvailabilityRange;var i=e.segmentDuration||(e.segments&&e.segments.length?e.segments[e.segments.length-1].duration:0),o=f(new Date,n),a=n.start+n.duration;return r.start=Math.max(o-n.mpd.timeShiftBufferDepth,n.start),r.end=o>=a&&o-i<a?a-i:o-i,r}function y(e,t){return t-e.adaptation.period.start}function v(e,t){return t+e.adaptation.period.start}function _(e){w||void 0!==e.offset&&(i(e.offset/1e3),w=!0)}function b(e){var t=e.presentationTimeOffset;return e.adaptation.period.start-t}function E(){S.off(l.default.TIME_SYNCHRONIZATION_COMPLETED,_,this),x=0,w=!1,I=NaN}var T=this.context,S=(0,a.default)(T).getInstance(),x=void 0,w=void 0,I=void 0;return{initialize:e,isTimeSyncCompleted:t,setTimeSyncCompleted:n,getClientTimeOffset:r,setClientTimeOffset:i,getExpectedLiveEdge:o,setExpectedLiveEdge:s,calcAvailabilityStartTimeFromPresentationTime:d,calcAvailabilityEndTimeFromPresentationTime:c,calcPresentationTimeFromWallTime:f,calcPresentationTimeFromMediaTime:h,calcPeriodRelativeTimeFromMpdRelativeTime:y,calcMpdRelativeTimeFromPeriodRelativeTime:v,calcMediaTimeFromPresentationTime:p,calcSegmentAvailabilityRange:g,calcWallTimeForSegment:m,calcMSETimeOffset:b,reset:E}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),a=r(o),s=n(2),l=r(s),u=n(0),d=r(u);i.__dashjs_factory_name="TimelineConverter",t.default=d.default.getSingletonFactory(i)},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(){r(this,e),this.id=null,this.index=-1,this.adaptation=null,this.segmentInfoType=null,this.initialization=null,this.segmentDuration=NaN,this.timescale=1,this.startNumber=1,this.indexRange=null,this.range=null,this.presentationTimeOffset=0,this.MSETimeOffset=NaN,this.segmentAvailabilityRange=null,this.availableSegmentsNumber=0,this.bandwidth=NaN,this.maxPlayoutRate=NaN}return i(e,null,[{key:"hasInitialization",value:function(e){return null!==e.initialization||("BaseURL"!==e.segmentInfoType||"SegmentBase"!==e.segmentInfoType)&&null!==e.range}},{key:"hasSegments",value:function(e){return"BaseURL"!==e.segmentInfoType&&"SegmentBase"!==e.segmentInfoType&&!e.indexRange}}]),e}();t.default=o},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){r(this,e),this.indexRange=null,this.index=null,this.mediaRange=null,this.media=null,this.duration=NaN,this.replacementTime=null,this.replacementNumber=NaN,this.mediaStartTime=NaN,this.presentationStartTime=NaN,this.availabilityStartTime=NaN,this.availabilityEndTime=NaN,this.availabilityIdx=NaN,this.wallStartTime=NaN,this.representation=null};t.default=i},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){R=window.VTTCue||window.TextTrackCue,M=[],L=[],C=-1,O=0,k=0,N=0,F=0,B=null,U=null,q=!1,V=2147483647,j=!!navigator.userAgent.match(/Chrome/)&&!navigator.userAgent.match(/Edge/),void 0!==document.fullscreenElement?H="fullscreenElement":void 0!==document.webkitIsFullScreen?H="webkitIsFullScreen":document.msFullscreenElement?H="msFullscreenElement":document.mozFullScreen&&(H="mozFullScreen")}function t(e){var t=M[e].kind,n=void 0!==M[e].label?M[e].label:M[e].lang,r=M[e].lang,i=j?document.createElement("track"):P.addTextTrack(t,n,r);return j&&(i.kind=t,i.label=n,i.srclang=r),i}function n(e){q=e,B&&!document[H]&&(B.style.zIndex=e?V:null)}function r(e,n){if(M.length===n)return void D("Trying to add too many tracks.");if(M.push(e),void 0===P&&(P=e.video),M.length===n){M.sort(function(e,t){return e.index-t.index}),B=A.getTTMLRenderingDiv();for(var r=-1,i=0;i<M.length;i++){var o=t.call(this,i);L.push(o),M[i].defaultTrack&&(o.default=!0,r=i),j&&P.appendChild(o);var a=P.textTracks[i];a.nonAddedCues=[],B&&(M[i].isTTML||M[i].isEmbedded)?a.renderingType="html":a.renderingType="default",this.addCaptions(i,0,M[i].captionData),I.trigger(l.default.TEXT_TRACK_ADDED)}if(g.call(this,r),r>=0){for(var s=0;s<P.textTracks.length;s++)P.textTracks[s].mode=s===r?"showing":"hidden";this.addCaptions(r,0,null)}I.trigger(l.default.TEXT_TRACKS_ADDED,{index:C,tracks:M})}}function i(e,t,n,r,i,o){var a=e/t,s=n/r,l=0,u=0;a>s?(u=t,l=u/r*n):(l=e,u=l/n*r);var d=0,c=0,f=0,h=0;return l/u>i?(h=u,f=u/(1/i),d=(e-f)/2,c=0):(f=l,h=l/i,d=0,c=(t-h)/2),o?{x:d+.1*f,y:c+.1*h,w:.8*f,h:.8*h}:{x:d,y:c,w:f,h:h}}function o(){var e=this.getCurrentTextTrack();if(e&&"html"===e.renderingType){var t=P.clientWidth/P.clientHeight,n=!1;e.isFromCEA608&&(t=3.5/3,n=!0);var r=i.call(this,P.clientWidth,P.clientHeight,P.videoWidth,P.videoHeight,t,n),o=r.w,a=r.h;if(o!=N||a!=F){O=r.x,k=r.y,N=o,F=a,B.style.left=O+"px",B.style.top=k+"px",B.style.width=N+"px",B.style.height=F+"px";for(var s=0;e.activeCues&&s<e.activeCues.length;++s){var l=e.activeCues[s];l.scaleCue(l)}H&&document[H]||q?B.style.zIndex=V:B.style.zIndex=null}}}function s(e,t){return Math.round(.01*e*t).toString()+"px"}function u(e){var t=N,n=F;if(t*n!=0&&e.layout){var r=e.layout,i=s(r.left,t),o=s(r.top,n),a=s(r.width,t),l=s(r.height,n);B.style.left=i,B.style.top=o,B.style.width=a,B.style.height=l;var u=B.firstChild;u&&u.style&&(u.style.left="0px",u.style.top="0px",u.style.width=a,u.style.height=l)}}function d(e){var t,n,r,i,o,a=N,s=F,l=[a/e.cellResolution[0],s/e.cellResolution[1]];if(e.linePadding)for(t in e.linePadding)if(e.linePadding.hasOwnProperty(t)){var u=e.linePadding[t];n=(u*l[0]).toString();for(var d=document.getElementsByClassName("spanPadding"),c=0;c<d.length;c++)d[c].style.cssText=d[c].style.cssText.replace(/(padding-left\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+n),d[c].style.cssText=d[c].style.cssText.replace(/(padding-right\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+n)}if(e.fontSize)for(t in e.fontSize)if(e.fontSize.hasOwnProperty(t)){"%"===e.fontSize[t][0]?r=e.fontSize[t][1]/100:"c"===e.fontSize[t][0]&&(r=e.fontSize[t][1]),n=(r*l[1]).toString(),o="defaultFontSize"!==t?document.getElementsByClassName(t):document.getElementsByClassName("paragraph");for(var f=0;f<o.length;f++)o[f].style.cssText=o[f].style.cssText.replace(/(font-size\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+n)}if(e.lineHeight)for(t in e.lineHeight)if(e.lineHeight.hasOwnProperty(t)){"%"===e.lineHeight[t][0]?i=e.lineHeight[t][1]/100:"c"===e.fontSize[t][0]&&(i=e.lineHeight[t][1]),n=(i*l[1]).toString(),o=document.getElementsByClassName(t);for(var h=0;h<o.length;h++)o[h].style.cssText=o[h].style.cssText.replace(/(line-height\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+n)}}function c(e,t,n){var r=e>=0?P.textTracks[e]:null,i=this;if(r){if("showing"!==r.mode)return void(n&&n.length>0&&(r.nonAddedCues=r.nonAddedCues.concat(n)));if(n||(n=r.nonAddedCues,r.nonAddedCues=[]),n&&0!==n.length)for(var a in n){var s,l=n[a];r.cellResolution=l.cellResolution,r.isFromCEA608=l.isFromCEA608,U||"html"!==l.type&&"image"!==l.type||(U=setInterval(o.bind(this),500)),"image"===l.type?(s=new R(l.start-t,l.end-t,""),s.image=l.data,s.id=l.id,s.size=0,s.type="image",s.layout=l.layout,s.scaleCue=u.bind(i),s.onenter=function(){if(B&&"showing"===r.mode){var e=new Image;e.id="ttmlImage_"+this.id,e.src=this.image,e.style.cssText="z-index: 2147483648; pointer-events: none; display: block; visibility: visible !important; position: relative !important;",B.appendChild(e),u.call(i,this)}},s.onexit=function(){if(B)for(var e=B.childNodes,t=0;t<e.length;t++)e[t].id==="ttmlImage_"+this.id&&B.removeChild(e[t])}):"html"===l.type?(s=new R(l.start-t,l.end-t,""),s.cueHTMLElement=l.cueHTMLElement,s.regions=l.regions,s.regionID=l.regionID,s.cueID=l.cueID,s.videoWidth=l.videoWidth,s.videoHeight=l.videoHeight,s.cellResolution=l.cellResolution,s.fontSize=l.fontSize,s.lineHeight=l.lineHeight,s.linePadding=l.linePadding,s.scaleCue=d.bind(i),B.style.left=O+"px",B.style.top=k+"px",B.style.width=N+"px",B.style.height=F+"px",s.onenter=function(){"showing"===r.mode&&(D("Cue "+this.startTime+"-"+this.endTime+" : "+this.cueHTMLElement.id+" : "+this.cueHTMLElement.innerText),B.appendChild(this.cueHTMLElement),d.call(i,this))},s.onexit=function(){for(var e=B.childNodes,t=0;t<e.length;++t)e[t].id===this.cueID&&B.removeChild(e[t])}):(s=new R(l.start-t,l.end-t,l.data),l.styles&&(void 0!==l.styles.align&&s.hasOwnProperty("align")&&(s.align=l.styles.align),void 0!==l.styles.line&&s.hasOwnProperty("line")&&(s.line=l.styles.line),void 0!==l.styles.position&&s.hasOwnProperty("position")&&(s.position=l.styles.position),void 0!==l.styles.size&&s.hasOwnProperty("size")&&(s.size=l.styles.size))),r.addCue(s)}}}function h(){return C>=0?P.textTracks[C]:null}function p(){return C}function m(e){for(var t=-1,n=0;n<P.textTracks.length;n++)if(P.textTracks[n].label===e){t=n;break}return t}function g(e){C=e,S.call(this),e>=0&&"html"===P.textTracks[e].renderingType?E.call(this):T.call(this)}function y(e){return P.textTracks[e]}function v(e){if(e.cues){for(var t=e.cues,n=t.length-1,r=n;r>=0;r--)e.removeCue(t[r]);e.mode="disabled"}}function _(){for(var e=L.length,t=0;t<e;t++)if(j)P.removeChild(L[t]);else{var n=y.call(this,t);n.nonAddedCues=[],v.call(this,n)}L=[],M=[],U&&(clearInterval(U),U=null),S.call(this)}function b(e){P.removeChild(L[e]),L.splice(e,1)}function E(){if(j){var e=document.getElementById("native-cue-style");if(!e){e=document.createElement("style"),e.id="native-cue-style",document.head.appendChild(e);var t=e.sheet;P.id?t.insertRule("#"+P.id+"::cue {background: transparent}",0):0!==P.classList.length?t.insertRule("."+P.className+"::cue {background: transparent}",0):t.insertRule("video::cue {background: transparent}",0)}}}function T(){if(j){var e=document.getElementById("native-cue-style");e&&document.head.removeChild(e)}}function S(){if(B)for(;B.firstChild;)B.removeChild(B.firstChild)}function x(e){e&&e.videoModel&&(A=e.videoModel)}var w=this.context,I=(0,a.default)(w).getInstance(),D=(0,f.default)(w).getInstance().log,R=void 0,A=void 0,P=void 0,M=void 0,L=void 0,C=void 0,O=void 0,k=void 0,N=void 0,F=void 0,B=void 0,U=void 0,j=void 0,H=void 0,q=void 0,V=void 0;return{initialize:e,displayCConTop:n,addTextTrack:r,addCaptions:c,getTextTrack:y,getCurrentTextTrack:h,getCurrentTrackIdx:p,setCurrentTrackIdx:g,getTrackIdxForId:m,deleteTrackCues:v,deleteAllTextTracks:_,deleteTextTrack:b,setConfig:x}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),a=r(o),s=n(2),l=r(s),u=n(0),d=r(u),c=n(3),f=r(c);i.__dashjs_factory_name="TextTracks",t.default=d.default.getSingletonFactory(i)},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){o=new a.default,s=[],l=!1}function t(){return o}function n(){return s}function r(){return l}function i(e){function t(e,t,n,r){var i=r[0].split(/[=]/);return r.push({key:i[0],value:i[1]}),r.shift(),r}function n(e,t,n){return t>0&&(d&&0===s.length?s=n[t].split(/[&]/):c&&(r=n[t].split(/[&]/))),n}if(!e)return null;var r=[],i=new RegExp(/[?]/),a=new RegExp(/[#]/),u=new RegExp(/^(https:)?\/\//i),d=i.test(e),c=a.test(e);return l=u.test(e),e.split(/[?#]/).map(n),s.length>0&&(s=s.reduce(t,null)),r.length>0&&(r=r.reduce(t,null),r.forEach(function(e){o[e.key]=e.value})),e}var o=void 0,s=void 0,l=void 0;return{initialize:e,parseURI:i,getURIFragmentData:t,getURIQueryData:n,isManifestHTTPS:r}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(151),a=r(o),s=n(0),l=r(s);i.__dashjs_factory_name="URIQueryAndFragmentModel",t.default=l.default.getSingletonFactory(i)},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e){if(!e)return null;void 0===e.fileStart&&(e.fileStart=0);var n=d.default.parseBuffer(e),r=(0,a.default)(t).create();return r.setData(n),r}var t=this.context;return{parse:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(137),a=r(o),s=n(0),l=r(s),u=n(41),d=r(u);i.__dashjs_factory_name="BoxParser",t.default=l.default.getSingletonFactory(i)},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e){if(void 0!==v)return v;v=!1;var t;try{"undefined"!=typeof window&&(t=window[e])}catch(e){return g("Warning: DOMStorage access denied: "+e.message),v}if(!t||e!==p&&e!==m)return v;try{t.setItem("1","1"),t.removeItem("1"),v=!0}catch(e){g("Warning: DOMStorage is supported, but cannot be used: "+e.message)}return v}function t(){e(p)&&c.forEach(function(e){var t=localStorage.getItem(e.oldKey);if(t){localStorage.removeItem(e.oldKey);try{localStorage.setItem(e.newKey,t)}catch(e){g(e.message)}}})}function n(){return 6e5*Math.round((new Date).getTime()/6e5)}function r(t,n){return e(t)&&_["get"+n+"CachingInfo"]().enabled}function i(e){if(!r(p,"LastMediaSettings"))return null;var t=h.replace(/\?/,e),n=JSON.parse(localStorage.getItem(t))||{},i=(new Date).getTime()-parseInt(n.timestamp,10)>=_.getLastMediaSettingsCachingInfo().ttl||!1,o=n.settings;return i&&(localStorage.removeItem(t),o=null),o}function o(e){var t=NaN;if(r(p,"LastBitrate")){var n=f.replace(/\?/,e),i=JSON.parse(localStorage.getItem(n))||{},o=(new Date).getTime()-parseInt(i.timestamp,10)>=_.getLastBitrateCachingInfo().ttl||!1,a=parseInt(i.bitrate,10);isNaN(a)||o?o&&localStorage.removeItem(n):(t=a,g("Last saved bitrate for "+e+" was "+a))}return t}function a(e,t){if(r(p,"LastMediaSettings")){var i=h.replace(/\?/,e);try{localStorage.setItem(i,JSON.stringify({settings:t,timestamp:n()}))}catch(e){g(e.message)}}}function s(e,t){if(r(p,"LastBitrate")&&t){var i=f.replace(/\?/,e);try{localStorage.setItem(i,JSON.stringify({bitrate:t/1e3,timestamp:n()}))}catch(e){g(e.message)}}}var u=this.context,g=(0,d.default)(u).getInstance().log,y=void 0,v=void 0,_=void 0;return y={getSavedBitrateSettings:o,setSavedBitrateSettings:s,getSavedMediaSettings:i,setSavedMediaSettings:a,isSupported:e},function(){_=(0,l.default)(u).getInstance(),t()}(),y}Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),a=r(o),s=n(4),l=r(s),u=n(3),d=r(u),c=[{oldKey:"dashjs_vbitrate",newKey:"dashjs_video_bitrate"},{oldKey:"dashjs_abitrate",newKey:"dashjs_audio_bitrate"},{oldKey:"dashjs_vsettings",newKey:"dashjs_video_settings"},{oldKey:"dashjs_asettings",newKey:"dashjs_audio_settings"}],f="dashjs_?_bitrate",h="dashjs_?_settings",p="localStorage",m="sessionStorage";i.__dashjs_factory_name="DOMStorage";var g=a.default.getSingletonFactory(i);t.default=g},function(e,t,n){function r(){function e(e,t){r=e,i=t}function t(){var e=i.getCurrentRepresentationInfo(),t=e.DVRWindow.end;return e.useCalculatedLiveEdgeTime&&(t=r.getExpectedLiveEdge(),r.setClientTimeOffset(t-e.DVRWindow.end)),t}function n(){r=null,i=null}var r=void 0,i=void 0;return{initialize:e,getLiveEdge:t,reset:n}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=function(e){return e&&e.__esModule?e:{default:e}}(i);r.__dashjs_factory_name="LiveEdgeFinder";var a=o.default.getSingletonFactory(r);t.default=a},function(e,t,n){/*! codem-isoboxer v0.2.7 https://github.com/madebyhiro/codem-isoboxer/blob/master/LICENSE.txt */var r={};r.parseBuffer=function(e){return new i(e).parse()},r.addBoxParser=function(e,t){"string"==typeof e&&"function"==typeof t&&(o.prototype._boxParsers[e]=t)},r.Utils={},r.Utils.dataViewToString=function(e,t){var n=t||"utf-8";if("undefined"!=typeof TextDecoder)return new TextDecoder(n).decode(e);var r=[],i=0;if("utf-8"===n)for(;i<e.byteLength;){var o=e.getUint8(i++);o<128||(o<224?(o=(31&o)<<6,o|=63&e.getUint8(i++)):o<240?(o=(15&o)<<12,o|=(63&e.getUint8(i++))<<6,o|=63&e.getUint8(i++)):(o=(7&o)<<18,o|=(63&e.getUint8(i++))<<12,o|=(63&e.getUint8(i++))<<6,o|=63&e.getUint8(i++))),r.push(String.fromCharCode(o))}else for(;i<e.byteLength;)r.push(String.fromCharCode(e.getUint8(i++)));return r.join("")},t.parseBuffer=r.parseBuffer,t.addBoxParser=r.addBoxParser,t.Utils=r.Utils,r.Cursor=function(e){this.offset=void 0===e?0:e};var i=function(e){this._raw=new DataView(e),this._cursor=new r.Cursor,this.boxes=[]};i.prototype.fetch=function(e){var t=this.fetchAll(e,!0);return t.length?t[0]:null},i.prototype.fetchAll=function(e,t){var n=[];return i._sweep.call(this,e,n,t),n},i.prototype.parse=function(){for(this._cursor.offset=0,this.boxes=[];this._cursor.offset<this._raw.byteLength;){var e=o.parse(this);if(void 0===e.type)break;this.boxes.push(e)}return this},i._sweep=function(e,t,n){this.type&&this.type==e&&t.push(this);for(var r in this.boxes){if(t.length&&n)return;i._sweep.call(this.boxes[r],e,t,n)}};var o=function(){this._cursor=new r.Cursor};o.parse=function(e){var t=new o;return t._offset=e._cursor.offset,t._root=e._root?e._root:e,t._raw=e._raw,t._parent=e,t._parseBox(),e._cursor.offset=t._raw.byteOffset+t._raw.byteLength,t},o.prototype._readInt=function(e){var t=null;switch(e){case 8:t=this._raw.getInt8(this._cursor.offset-this._raw.byteOffset);break;case 16:t=this._raw.getInt16(this._cursor.offset-this._raw.byteOffset);break;case 32:t=this._raw.getInt32(this._cursor.offset-this._raw.byteOffset);break;case 64:var n=this._raw.getInt32(this._cursor.offset-this._raw.byteOffset),r=this._raw.getInt32(this._cursor.offset-this._raw.byteOffset+4);t=n*Math.pow(2,32)+r}return this._cursor.offset+=e>>3,t},o.prototype._readUint=function(e){var t=null;switch(e){case 8:t=this._raw.getUint8(this._cursor.offset-this._raw.byteOffset);break;case 16:t=this._raw.getUint16(this._cursor.offset-this._raw.byteOffset);break;case 24:var n=this._raw.getUint16(this._cursor.offset-this._raw.byteOffset),r=this._raw.getUint8(this._cursor.offset-this._raw.byteOffset+2);t=(n<<8)+r;break;case 32:t=this._raw.getUint32(this._cursor.offset-this._raw.byteOffset);break;case 64:var n=this._raw.getUint32(this._cursor.offset-this._raw.byteOffset),r=this._raw.getUint32(this._cursor.offset-this._raw.byteOffset+4);t=n*Math.pow(2,32)+r}return this._cursor.offset+=e>>3,t},o.prototype._readString=function(e){for(var t="",n=0;n<e;n++){var r=this._readUint(8);t+=String.fromCharCode(r)}return t},o.prototype._readTerminatedString=function(){for(var e="";this._cursor.offset-this._offset<this._raw.byteLength;){var t=this._readUint(8);if(0==t)break;e+=String.fromCharCode(t)}return e},o.prototype._readTemplate=function(e){return this._readUint(e/2)+this._readUint(e/2)/Math.pow(2,e/2)},o.prototype._parseBox=function(){if(this._cursor.offset=this._offset,this._offset+8>this._raw.buffer.byteLength)return void(this._root._incomplete=!0);switch(this.size=this._readUint(32),this.type=this._readString(4),1==this.size&&(this.largesize=this._readUint(64)),"uuid"==this.type&&(this.usertype=this._readString(16)),this.size){case 0:this._raw=new DataView(this._raw.buffer,this._offset,this._raw.byteLength-this._cursor.offset);break;case 1:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.largesize);break;default:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.size)}!this._incomplete&&this._boxParsers[this.type]&&this._boxParsers[this.type].call(this)},o.prototype._parseFullBox=function(){this.version=this._readUint(8),this.flags=this._readUint(24)},o.prototype._boxParsers={},o.prototype._boxParsers.avc1=function(){this.version=this._readUint(16),this.revision_level=this._readUint(16),this.vendor=this._readUint(32),this.temporal_quality=this._readUint(32),this.spatial_quality=this._readUint(32),this.width=this._readUint(16),this.height=this._readUint(16),this.horizontal_resolution=this._readUint(32),this.vertical_resolution=this._readUint(32),this.data_size=this._readUint(32),this.frame_count=this._readUint(16),this.compressor_name=this._readUint(32),this.depth=this._readUint(16),this.color_table_id=this._readUint(16)},["moov","trak","tref","mdia","minf","stbl","edts","dinf","mvex","moof","traf","mfra","udta","meco","strk","vttc"].forEach(function(e){o.prototype._boxParsers[e]=function(){for(this.boxes=[];this._cursor.offset-this._raw.byteOffset<this._raw.byteLength;)this.boxes.push(o.parse(this))}}),o.prototype._boxParsers.elst=function(){this._parseFullBox(),this.entry_count=this._readUint(32),this.entries=[];for(var e=1;e<=this.entry_count;e++){var t={};1==this.version?(t.segment_duration=this._readUint(64),t.media_time=this._readInt(64)):(t.segment_duration=this._readUint(32),t.media_time=this._readInt(32)),t.media_rate_integer=this._readInt(16),t.media_rate_fraction=this._readInt(16),this.entries.push(t)}},o.prototype._boxParsers.emsg=function(){this._parseFullBox(),this.scheme_id_uri=this._readTerminatedString(),this.value=this._readTerminatedString(),this.timescale=this._readUint(32),this.presentation_time_delta=this._readUint(32),this.event_duration=this._readUint(32),this.id=this._readUint(32),this.message_data=new DataView(this._raw.buffer,this._cursor.offset,this._raw.byteLength-(this._cursor.offset-this._offset))},o.prototype._boxParsers.free=o.prototype._boxParsers.skip=function(){this.data=new DataView(this._raw.buffer,this._cursor.offset,this._raw.byteLength-(this._cursor.offset-this._offset))},o.prototype._boxParsers.ftyp=o.prototype._boxParsers.styp=function(){for(this.major_brand=this._readString(4),this.minor_versions=this._readUint(32),this.compatible_brands=[];this._cursor.offset-this._raw.byteOffset<this._raw.byteLength;)this.compatible_brands.push(this._readString(4))},o.prototype._boxParsers.hdlr=function(){this._parseFullBox(),this.pre_defined=this._readUint(32),this.handler_type=this._readString(4),this.reserved=[this._readUint(32),this._readUint(32),this._readUint(32)],this.name=this._readTerminatedString()},o.prototype._boxParsers.mdat=function(){this.data=new DataView(this._raw.buffer,this._cursor.offset,this._raw.byteLength-(this._cursor.offset-this._offset))},o.prototype._boxParsers.mdhd=function(){this._parseFullBox(),1==this.version?(this.creation_time=this._readUint(64),this.modification_time=this._readUint(64),this.timescale=this._readUint(32),this.duration=this._readUint(64)):(this.creation_time=this._readUint(32),this.modification_time=this._readUint(32),this.timescale=this._readUint(32),this.duration=this._readUint(32));var e=this._readUint(16);this.pad=e>>15,this.language=String.fromCharCode(96+(e>>10&31),96+(e>>5&31),96+(31&e)),this.pre_defined=this._readUint(16)},o.prototype._boxParsers.mehd=function(){this._parseFullBox(),1==this.version?this.fragment_duration=this._readUint(64):this.fragment_duration=this._readUint(32)},o.prototype._boxParsers.mfhd=function(){this._parseFullBox(),this.sequence_number=this._readUint(32)},o.prototype._boxParsers.mfro=function(){this._parseFullBox(),this.mfra_size=this._readUint(32)},o.prototype._boxParsers.mp4a=function(){this.reserved1=[this._readUint(32),this._readUint(32)],this.channelcount=this._readUint(16),this.samplesize=this._readUint(16),this.pre_defined=this._readUint(16),this.reserved2=this._readUint(16),this.sample_rate=this._readUint(32)},o.prototype._boxParsers.mvhd=function(){this._parseFullBox(),1==this.version?(this.creation_time=this._readUint(64),this.modification_time=this._readUint(64),this.timescale=this._readUint(32),this.duration=this._readUint(64)):(this.creation_time=this._readUint(32),this.modification_time=this._readUint(32),this.timescale=this._readUint(32),this.duration=this._readUint(32)),this.rate=this._readTemplate(32),this.volume=this._readTemplate(16),this.reserved1=this._readUint(16),this.reserved2=[this._readUint(32),this._readUint(32)],this.matrix=[];for(var e=0;e<9;e++)this.matrix.push(this._readTemplate(32));this.pre_defined=[];for(var e=0;e<6;e++)this.pre_defined.push(this._readUint(32));this.next_track_ID=this._readUint(32)},o.prototype._boxParsers.payl=function(){var e=new DataView(this._raw.buffer,this._cursor.offset,this._raw.byteLength-(this._cursor.offset-this._offset));this.cue_text=r.Utils.dataViewToString(e)},o.prototype._boxParsers.sidx=function(){this._parseFullBox(),this.reference_ID=this._readUint(32),this.timescale=this._readUint(32),0==this.version?(this.earliest_presentation_time=this._readUint(32),this.first_offset=this._readUint(32)):(this.earliest_presentation_time=this._readUint(64),this.first_offset=this._readUint(64)),this.reserved=this._readUint(16),this.reference_count=this._readUint(16),this.references=[];for(var e=0;e<this.reference_count;e++){var t={},n=this._readUint(32);t.reference_type=n>>31&1,t.referenced_size=2147483647&n,t.subsegment_duration=this._readUint(32);var r=this._readUint(32);t.starts_with_SAP=r>>31&1,t.SAP_type=r>>28&7,t.SAP_delta_time=268435455&r,this.references.push(t)}},o.prototype._boxParsers.ssix=function(){this._parseFullBox(),this.subsegment_count=this._readUint(32),this.subsegments=[];for(var e=0;e<this.subsegment_count;e++){var t={};t.ranges_count=this._readUint(32),t.ranges=[];for(var n=0;n<t.ranges_count;n++){var r={};r.level=this._readUint(8),r.range_size=this._readUint(24),t.ranges.push(r)}this.subsegments.push(t)}},o.prototype._boxParsers.stsd=function(){this._parseFullBox(),this.entry_count=this._readUint(32),this.entries=[];for(var e=0;e<this.entry_count;e++)this.entries.push(o.parse(this))},o.prototype._boxParsers.subs=function(){this._parseFullBox(),this.entry_count=this._readUint(32),this.samples_with_subsamples=[];for(var e=0,t=0;t<this.entry_count;t++){e+=this._readUint(32);var n=this._readUint(16);if(n>0){for(var r={nr:e,subsamples:[]},i=0;i<n;i++){var o={};1&this.version?o.size=this._readUint(32):o.size=this._readUint(16),o.priority=this._readUint(8),o.discardable=this._readUint(8),o.codec_specific_parameters=this._readUint(32),r.subsamples.push(o)}this.samples_with_subsamples.push(r)}}},o.prototype._boxParsers.tfdt=function(){this._parseFullBox(),1==this.version?this.baseMediaDecodeTime=this._readUint(64):this.baseMediaDecodeTime=this._readUint(32)},o.prototype._boxParsers.tfhd=function(){this._parseFullBox(),this.track_ID=this._readUint(32),1&this.flags&&(this.base_data_offset=this._readUint(64)),2&this.flags&&(this.sample_description_offset=this._readUint(32)),8&this.flags&&(this.default_sample_duration=this._readUint(32)),16&this.flags&&(this.default_sample_size=this._readUint(32)),32&this.flags&&(this.default_sample_flags=this._readUint(32))},o.prototype._boxParsers.tfra=function(){this._parseFullBox(),this.track_ID=this._readUint(32),this._packed=this._readUint(32),this.reserved=this._packed>>>6,this.length_size_of_traf_num=(this._packed&&0xffff00000000)>>>4,this.length_size_of_trun_num=(this._packed&&4294901760)>>>2,this.length_size_of_sample_num=this._packed&&255,this.number_of_entry=this._readUint(32),this.entries=[];for(var e=0;e<this.number_of_entry;e++){var t={};1==this.version?(t.time=this._readUint(64),t.moof_offset=this._readUint(64)):(t.time=this._readUint(32),t.moof_offset=this._readUint(32)),t.traf_number=this._readUint(8*(this.length_size_of_traf_num+1)),t.trun_number=this._readUint(8*(this.length_size_of_trun_num+1)),t.sample_number=this._readUint(8*(this.length_size_of_sample_num+1)),this.entries.push(t)}},o.prototype._boxParsers.tkhd=function(){this._parseFullBox(),1==this.version?(this.creation_time=this._readUint(64),this.modification_time=this._readUint(64),this.track_ID=this._readUint(32),this.reserved1=this._readUint(32),this.duration=this._readUint(64)):(this.creation_time=this._readUint(32),this.modification_time=this._readUint(32),this.track_ID=this._readUint(32),this.reserved1=this._readUint(32),this.duration=this._readUint(32)),this.reserved2=[this._readUint(32),this._readUint(32)],this.layer=this._readUint(16),this.alternate_group=this._readUint(16),this.volume=this._readTemplate(16),this.reserved3=this._readUint(16),this.matrix=[];for(var e=0;e<9;e++)this.matrix.push(this._readTemplate(32));this.width=this._readUint(32),this.height=this._readUint(32)},o.prototype._boxParsers.trex=function(){this._parseFullBox(),this.track_ID=this._readUint(32),this.default_sample_description_index=this._readUint(32),this.default_sample_duration=this._readUint(32),this.default_sample_size=this._readUint(32),this.default_sample_flags=this._readUint(32)},o.prototype._boxParsers.trun=function(){this._parseFullBox(),this.sample_count=this._readUint(32),1&this.flags&&(this.data_offset=this._readInt(32)),4&this.flags&&(this.first_sample_flags=this._readUint(32)),this.samples=[];for(var e=0;e<this.sample_count;e++){var t={};256&this.flags&&(t.sample_duration=this._readUint(32)),512&this.flags&&(t.sample_size=this._readUint(32)),1024&this.flags&&(t.sample_flags=this._readUint(32)),2048&this.flags&&(0==this.version?t.sample_composition_time_offset=this._readUint(32):t.sample_composition_time_offset=this._readInt(32)),this.samples.push(t)}},o.prototype._boxParsers.vlab=function(){var e=new DataView(this._raw.buffer,this._cursor.offset,this._raw.byteLength-(this._cursor.offset-this._offset));this.source_label=r.Utils.dataViewToString(e)},o.prototype._boxParsers.vttC=function(){var e=new DataView(this._raw.buffer,this._cursor.offset,this._raw.byteLength-(this._cursor.offset-this._offset));this.config=r.Utils.dataViewToString(e)},o.prototype._boxParsers.vtte=function(){}},function(e,t,n){!function(e){var t={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},n=function(e){var n=e;return t.hasOwnProperty(e)&&(n=t[e]),String.fromCharCode(n)},r={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},i={17:2,18:4,21:6,22:8,23:10,19:13,20:15},o={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},a={25:2,26:4,29:6,30:8,31:10,27:13,28:15},s=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],l={verboseFilter:{DATA:3,DEBUG:3,INFO:2,WARNING:2,TEXT:1,ERROR:0},time:null,verboseLevel:0,setTime:function(e){this.time=e},log:function(e,t){var n=this.verboseFilter[e];this.verboseLevel>=n&&console.log(this.time+" ["+e+"] "+t)}},u=function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n].toString(16));return t},d=function(e,t,n,r,i){this.foreground=e||"white",this.underline=t||!1,this.italics=n||!1,this.background=r||"black",this.flash=i||!1};d.prototype={reset:function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},setStyles:function(e){for(var t=["foreground","underline","italics","background","flash"],n=0;n<t.length;n++){var r=t[n];e.hasOwnProperty(r)&&(this[r]=e[r])}},isDefault:function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash},equals:function(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash},copy:function(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash},toString:function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}};var c=function(e,t,n,r,i,o){this.uchar=e||" ",this.penState=new d(t,n,r,i,o)};c.prototype={reset:function(){this.uchar=" ",this.penState.reset()},setChar:function(e,t){this.uchar=e,this.penState.copy(t)},setPenState:function(e){this.penState.copy(e)},equals:function(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)},copy:function(e){this.uchar=e.uchar,this.penState.copy(e.penState)},isEmpty:function(){return" "===this.uchar&&this.penState.isDefault()}};var f=function(){this.chars=[];for(var e=0;e<32;e++)this.chars.push(new c);this.pos=0,this.currPenState=new d};f.prototype={equals:function(e){for(var t=!0,n=0;n<32;n++)if(!this.chars[n].equals(e.chars[n])){t=!1;break}return t},copy:function(e){for(var t=0;t<32;t++)this.chars[t].copy(e.chars[t])},isEmpty:function(){for(var e=!0,t=0;t<32;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e},setCursor:function(e){this.pos!==e&&(this.pos=e),this.pos<0?(l.log("ERROR","Negative cursor position "+this.pos),this.pos=0):this.pos>32&&(l.log("ERROR","Too large cursor position "+this.pos),this.pos=32)},moveCursor:function(e){var t=this.pos+e;if(e>1)for(var n=this.pos+1;n<t+1;n++)this.chars[n].setPenState(this.currPenState);this.setCursor(t)},backSpace:function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},insertChar:function(e){e>=144&&this.backSpace();var t=n(e);if(this.pos>=32)return void l.log("ERROR","Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!");this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1)},clearFromPos:function(e){var t;for(t=e;t<32;t++)this.chars[t].reset()},clear:function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},clearToEndOfRow:function(){this.clearFromPos(this.pos)},getTextString:function(){for(var e=[],t=!0,n=0;n<32;n++){var r=this.chars[n].uchar;" "!==r&&(t=!1),e.push(r)}return t?"":e.join("")},setPenStyles:function(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}};var h=function(){this.rows=[];for(var e=0;e<15;e++)this.rows.push(new f);this.currRow=14,this.nrRollUpRows=null,this.reset()};h.prototype={reset:function(){for(var e=0;e<15;e++)this.rows[e].clear();this.currRow=14},equals:function(e){for(var t=!0,n=0;n<15;n++)if(!this.rows[n].equals(e.rows[n])){t=!1;break}return t},copy:function(e){for(var t=0;t<15;t++)this.rows[t].copy(e.rows[t])},isEmpty:function(){for(var e=!0,t=0;t<15;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e},backSpace:function(){this.rows[this.currRow].backSpace()},clearToEndOfRow:function(){this.rows[this.currRow].clearToEndOfRow()},insertChar:function(e){this.rows[this.currRow].insertChar(e)},setPen:function(e){this.rows[this.currRow].setPenStyles(e)},moveCursor:function(e){this.rows[this.currRow].moveCursor(e)},setCursor:function(e){l.log("INFO","setCursor: "+e),this.rows[this.currRow].setCursor(e)},setPAC:function(e){l.log("INFO","pacData = "+JSON.stringify(e));var t=e.row-1;this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.currRow=t;var n=this.rows[this.currRow];if(null!==e.indent){var r=e.indent,i=Math.max(r-1,0);n.setCursor(e.indent),e.color=n.chars[i].penState.foreground}var o={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(o)},setBkgData:function(e){l.log("INFO","bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)},setRollUpRows:function(e){this.nrRollUpRows=e},rollUp:function(){if(null===this.nrRollUpRows)return void l.log("DEBUG","roll_up but nrRollUpRows not set yet");l.log("TEXT",this.getDisplayText());var e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),l.log("INFO","Rolling up")},getDisplayText:function(e){e=e||!1;for(var t=[],n="",r=-1,i=0;i<15;i++){var o=this.rows[i].getTextString();o&&(r=i+1,e?t.push("Row "+r+': "'+o+'"'):t.push(o.trim()))}return t.length>0&&(n=e?"["+t.join(" | ")+"]":t.join("\n")),n},getTextAndFormat:function(){return this.rows}};var p=function(e,t){this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new h,this.nonDisplayedMemory=new h,this.lastOutputScreen=new h,this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null};p.prototype={modes:["MODE_ROLL-UP","MODE_POP-ON","MODE_PAINT-ON","MODE_TEXT"],reset:function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.lastCueEndTime=null},getHandler:function(){return this.outputFilter},setHandler:function(e){this.outputFilter=e},setPAC:function(e){this.writeScreen.setPAC(e)},setBkgData:function(e){this.writeScreen.setBkgData(e)},setMode:function(e){e!==this.mode&&(this.mode=e,l.log("INFO","MODE="+e),"MODE_POP-ON"==this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)},insertChars:function(e){for(var t=0;t<e.length;t++)this.writeScreen.insertChar(e[t]);var n=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";l.log("INFO",n+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(l.log("TEXT","DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},cc_RCL:function(){l.log("INFO","RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},cc_BS:function(){l.log("INFO","BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},cc_AOF:function(){},cc_AON:function(){},cc_DER:function(){l.log("INFO","DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},cc_RU:function(e){l.log("INFO","RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)},cc_FON:function(){l.log("INFO","FON - Flash On"),this.writeScreen.setPen({flash:!0})},cc_RDC:function(){l.log("INFO","RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},cc_TR:function(){l.log("INFO","TR"),this.setMode("MODE_TEXT")},cc_RTD:function(){l.log("INFO","RTD"),this.setMode("MODE_TEXT")},cc_EDM:function(){l.log("INFO","EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate()},cc_CR:function(){l.log("CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate()},cc_ENM:function(){l.log("INFO","ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},cc_EOC:function(){if(l.log("INFO","EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,l.log("TEXT","DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate()},cc_TO:function(e){l.log("INFO","TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)},cc_MIDROW:function(e){var t={flash:!1};if(t.underline=e%2==1,t.italics=e>=46,t.italics)t.foreground="white";else{var n=Math.floor(e/2)-16,r=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=r[n]}l.log("INFO","MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)},outputDataUpdate:function(){var e=l.time;null!==e&&this.outputFilter&&(this.outputFilter.updateData&&this.outputFilter.updateData(e,this.displayedMemory),null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.lastOutputScreen),this.cueStartTime=this.displayedMemory.isEmpty()?null:e):this.cueStartTime=e,this.lastOutputScreen.copy(this.displayedMemory))},cueSplitAtTime:function(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}};var m=function(e,t,n){this.field=e||1,this.outputs=[t,n],this.channels=[new p(1,t),new p(2,n)],this.currChNr=-1,this.lastCmdA=null,this.lastCmdB=null,this.bufferedData=[],this.startTime=null,this.lastTime=null,this.dataCounters={padding:0,char:0,cmd:0,other:0}};m.prototype={getHandler:function(e){return this.channels[e].getHandler()},setHandler:function(e,t){this.channels[e].setHandler(t)},addData:function(e,t){var n,r,i,o=!1;this.lastTime=e,l.setTime(e);for(var a=0;a<t.length;a+=2)if(r=127&t[a],i=127&t[a+1],0!==r||0!==i){if(l.log("DATA","["+u([t[a],t[a+1]])+"] -> ("+u([r,i])+")"),n=this.parseCmd(r,i),n||(n=this.parseMidrow(r,i)),n||(n=this.parsePAC(r,i)),n||(n=this.parseBackgroundAttributes(r,i)),!n&&(o=this.parseChars(r,i)))if(this.currChNr&&this.currChNr>=0){var s=this.channels[this.currChNr-1];s.insertChars(o)}else l.log("WARNING","No channel found yet. TEXT-MODE?");n?this.dataCounters.cmd+=2:o?this.dataCounters.char+=2:(this.dataCounters.other+=2,l.log("WARNING","Couldn't parse cleaned data "+u([r,i])+" orig: "+u([t[a],t[a+1]])))}else this.dataCounters.padding+=2},parseCmd:function(e,t){var n=null,r=(20===e||28===e)&&32<=t&&t<=47,i=(23===e||31===e)&&33<=t&&t<=35;if(!r&&!i)return!1;if(e===this.lastCmdA&&t===this.lastCmdB)return this.lastCmdA=null,this.lastCmdB=null,l.log("DEBUG","Repeated command ("+u([e,t])+") is dropped"),!0;n=20===e||23===e?1:2;var o=this.channels[n-1];return 20===e||28===e?32===t?o.cc_RCL():33===t?o.cc_BS():34===t?o.cc_AOF():35===t?o.cc_AON():36===t?o.cc_DER():37===t?o.cc_RU(2):38===t?o.cc_RU(3):39===t?o.cc_RU(4):40===t?o.cc_FON():41===t?o.cc_RDC():42===t?o.cc_TR():43===t?o.cc_RTD():44===t?o.cc_EDM():45===t?o.cc_CR():46===t?o.cc_ENM():47===t&&o.cc_EOC():o.cc_TO(t-32),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=n,!0},parseMidrow:function(e,t){var n=null;return(17===e||25===e)&&32<=t&&t<=47&&((n=17===e?1:2)!==this.currChNr?(l.log("ERROR","Mismatch channel in midrow parsing"),!1):(this.channels[n-1].cc_MIDROW(t),l.log("DEBUG","MIDROW ("+u([e,t])+")"),!0))},parsePAC:function(e,t){var n=null,s=null,l=(17<=e&&e<=23||25<=e&&e<=31)&&64<=t&&t<=127,u=(16===e||24===e)&&64<=t&&t<=95;if(!l&&!u)return!1;if(e===this.lastCmdA&&t===this.lastCmdB)return this.lastCmdA=null,this.lastCmdB=null,!0;n=e<=23?1:2,s=64<=t&&t<=95?1===n?r[e]:o[e]:1===n?i[e]:a[e];var d=this.interpretPAC(s,t);return this.channels[n-1].setPAC(d),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=n,!0},interpretPAC:function(e,t){var n=t,r={color:null,italics:!1,indent:null,underline:!1,row:e};return n=t>95?t-96:t-64,r.underline=1==(1&n),n<=13?r.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(n/2)]:n<=15?(r.italics=!0,r.color="white"):r.indent=4*Math.floor((n-16)/2),r},parseChars:function(e,t){var r=null,i=null,o=null;if(e>=25?(r=2,o=e-8):(r=1,o=e),17<=o&&o<=19){var a=t;a=17===o?t+80:18===o?t+112:t+144,l.log("INFO","Special char '"+n(a)+"' in channel "+r),i=[a]}else 32<=e&&e<=127&&(i=0===t?[e]:[e,t]);if(i){var s=u(i);l.log("DEBUG","Char codes =  "+s.join(",")),this.lastCmdA=null,this.lastCmdB=null}return i},parseBackgroundAttributes:function(e,t){var n,r,i,o,a=(16===e||24===e)&&32<=t&&t<=47,l=(23===e||31===e)&&45<=t&&t<=47;return!(!a&&!l||(n={},16===e||24===e?(r=Math.floor((t-32)/2),n.background=s[r],t%2==1&&(n.background=n.background+"_semi")):45===t?n.background="transparent":(n.foreground="black",47===t&&(n.underline=!0)),i=e<24?1:2,o=this.channels[i-1],o.setBkgData(n),this.lastCmdA=null,this.lastCmdB=null,0))},reset:function(){for(var e=0;e<this.channels.length;e++)this.channels[e]&&this.channels[e].reset();this.lastCmdA=null,this.lastCmdB=null},cueSplitAtTime:function(e){for(var t=0;t<this.channels.length;t++)this.channels[t]&&this.channels[t].cueSplitAtTime(e)}};var g=function(e,t,n){for(var r=0,i=t,o=[];i<t+n;){if(r=e.getUint32(i),6==(31&e.getUint8(i+4)))for(var a=i+5,s=-1;a<i+4+r-1;){s=0;for(var l=255;255===l;)l=e.getUint8(a),s+=l,a++;var u=0;for(l=255;255===l;)l=e.getUint8(a),u+=l,a++;(function(e,t,n,r){if(4!==e||t<8)return null;var i=n.getUint8(r),o=n.getUint16(r+1),a=n.getUint32(r+3),s=n.getUint8(r+7);return 181==i&&49==o&&1195456820==a&&3==s})(s,u,e,a)&&o.push([a,u]),a+=u}i+=r+4}return o},y=function(e,t){var n=t[0],r=[[],[]];n+=8;var i=31&e.getUint8(n);n+=2;for(var o=0;o<i;o++){var a=e.getUint8(n),s=4&a,l=3&a;n++;var u=e.getUint8(n);n++;var d=e.getUint8(n);n++,s&&(127&u)+(127&d)!=0&&(0===l?(r[0].push(u),r[0].push(d)):1===l&&(r[1].push(u),r[1].push(d)))}return r};e.logger=l,e.PenState=d,e.CaptionScreen=h,e.Cea608Parser=m,e.findCea608Nalus=g,e.extractCea608DataFromRange=y}(t)},function(e,t,n){function r(){return i}Object.defineProperty(t,"__esModule",{value:!0}),t.getVersionString=r;var i="2.4.1"},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.TCP_CONNECTION="TcpList",t.HTTP_REQUEST="HttpList",t.TRACK_SWITCH="RepSwitchList",t.BUFFER_LEVEL="BufferLevel",t.BUFFER_STATE="BufferState",t.DVR_INFO="DVRInfo",t.DROPPED_FRAMES="DroppedFrames",t.SCHEDULING_INFO="SchedulingInfo",t.REQUESTS_QUEUE="RequestsQueue",t.MANIFEST_UPDATE="ManifestUpdate",t.MANIFEST_UPDATE_STREAM_INFO="ManifestUpdatePeriodInfo",t.MANIFEST_UPDATE_TRACK_INFO="ManifestUpdateRepresentationInfo",t.PLAY_LIST="PlayList",t.DVB_ERRORS="DVBErrors"},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(70),a=function(e){return e&&e.__esModule?e:{default:e}}(o),s=function(){function e(t,n,i,o,s){var l=this;r(this,e),this._name=t||"",this._properties=[],this._children=i||[],this._isRoot=o||!1,this._isArray=s||!0,Array.isArray(n)&&n.forEach(function(e){l._properties.push(new a.default(e))})}return i(e,[{key:"name",get:function(){return this._name}},{key:"isRoot",get:function(){return this._isRoot}},{key:"isArray",get:function(){return this._isArray}},{key:"children",get:function(){return this._children}},{key:"properties",get:function(){return this._properties}}]),e}();t.default=s},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(t,n,i,o){r(this,e),this.url=t||"",this.serviceLocation=n||t||"",this.dvb_priority=i||1,this.dvb_weight=o||1};i.DEFAULT_DVB_PRIORITY=1,i.DEFAULT_DVB_WEIGHT=1,t.default=i},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){r(this,e),this.duration=NaN,this.presentationTime=NaN,this.id=NaN,this.messageData="",this.eventStream=null,this.presentationTimeDelta=NaN};t.default=i},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){r(this,e),this.schemeIdUri="",this.value=""};t.default=i},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e,t,n){if(mn=(0,b.default)(Qt).getInstance(),pn=(0,v.default)(Qt).getInstance(),!mn.supportsMediaSource())return void pn.capabilityError("mediasource");rn||(rn=!0,sn=(0,B.default)(Qt).getInstance(),vn=(0,l.default)(Qt).getInstance(),ln=(0,f.default)(Qt).getInstance(),ln.initialize(),bn=(0,he.default)(Qt).getInstance(),_n=(0,me.default)(Qt).getInstance(),fn=(0,N.default)(Qt).getInstance(),fn.setConfig({adapter:Ut()}),ot(),ge(void 0===n||n),e&&At(e),t&&Ct(t),$t("[dash.js "+V()+"] MediaPlayer has been initialized"))}function t(){return!!En&&!!tn}function n(){if(!on)throw zt;(!an||i()&&on)&&vn.play()}function r(){if(!on)throw zt;vn.pause()}function i(){if(!on)throw zt;return vn.isPaused()}function o(){if(!on)throw zt;return vn.isSeeking()}function s(){if(!on)throw zt;return vn.getIsDynamic()}function u(e){if(!En)throw Yt;Rt().muted=e}function c(){if(!En)throw Yt;return Rt().muted}function h(e){if(!En)throw Yt;Rt().volume=e}function m(){if(!En)throw Yt;return Rt().volume}function y(e){var t=["video","audio","fragmentedText"];if(e){if(-1!==t.indexOf(e)){return Ee().getCurrentBufferLevel(Te(e))||NaN}return $t("Warning  - getBufferLength requested for invalid type"),NaN}return t.map(function(e){return Be(e).length>0?Ee().getCurrentBufferLevel(Te(e)):Number.MAX_VALUE}).reduce(function(e,t){return Math.min(e,t)})}function _(){var e=qt();return e?e.manifestInfo.DVRWindowSize:0}function E(e){var t=qt();if(!t)return 0;var n=t.range.start+e;return n>t.range.end&&(n=t.range.end),n}function S(e){if(!on)throw zt;var t=vn.getIsDynamic()?E(e):e;vn.seek(t)}function w(e){if(!on)throw zt;var t=Rt().currentTime;if(void 0!==e)t=gn.getTimeRelativeToStreamId(t,e);else if(vn.getIsDynamic()){var n=qt();t=null===n?0:D()-(n.range.end-n.time)}return t}function D(){if(!on)throw zt;var e=Rt().duration;if(vn.getIsDynamic()){var t,n=qt();if(!n)return 0;t=n.range.end-n.range.start,e=t<n.manifestInfo.DVRWindowSize?t:n.manifestInfo.DVRWindowSize}return e}function A(){if(!on)throw zt;return w()<0?NaN:Vt(w())}function M(){if(!on)throw zt;return Vt(D())}function C(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=new Date(1e3*e),o=i.toLocaleDateString(t),a=i.toLocaleTimeString(t,{hour12:n});return r?a+" "+o:a}function k(e){e=Math.max(e,0);var t=Math.floor(e/3600),n=Math.floor(e%3600/60),r=Math.floor(e%3600%60);return(0===t?"":t<10?"0"+t.toString()+":":t.toString()+":")+(n<10?"0"+n.toString():n.toString())+":"+(r<10?"0"+r.toString():r.toString())}function F(e,t,n){ae.default.extend(e,t,n,Qt)}function U(e,t,n){Zt.on(e,t,n)}function H(e,t,n){Zt.off(e,t,n)}function V(){return(0,se.getVersionString)()}function K(){return Jt}function Y(){if(!En)throw Yt;return En}function X(e){hn.setLiveDelayFragmentCount(e)}function Z(e){hn.setLiveDelay(e)}function $(){return hn.getLiveDelay()}function te(e){hn.setUseSuggestedPresentationDelay(e)}function re(e,t){hn.setLastBitrateCachingInfo(e,t)}function oe(e,t){hn.setLastMediaSettingsCachingInfo(e,t)}function le(e,t){sn.setMaxAllowedBitrateFor(e,t)}function de(e){return sn.getMaxAllowedBitrateFor(e)}function fe(e,t){sn.setMaxAllowedRepresentationRatioFor(e,t)}function pe(e){return sn.getMaxAllowedRepresentationRatioFor(e)}function ge(e){an=e}function ve(){return an}function _e(e){hn.setScheduleWhilePaused(e)}function be(){return hn.getScheduleWhilePaused()}function Ee(){return _n}function Te(e){return fn.getReadOnlyMetricsFor(e)}function Se(e){if(!on)throw zt;return sn.getQualityFor(e,gn.getActiveStreamInfo())}function xe(e,t){if(!on)throw zt;sn.setPlaybackQuality(e,gn.getActiveStreamInfo(),t)}function we(){sn.setElementSize(),sn.setWindowResizeEventCalled(!0)}function Ie(){return sn.getLimitBitrateByPortal()}function De(e){sn.setLimitBitrateByPortal(e)}function Re(){return sn.getUsePixelRatioInLimitBitrateByPortal()}function Ae(e){sn.setUsePixelRatioInLimitBitrateByPortal(e)}function Pe(e){if(!on)throw zt;void 0===Tn&&(Tn=(0,R.default)(Qt).getInstance());for(var t=Rt().textTracks,n=t.length,r=0;r<n;r++){var i=t[r],o=e===r?"showing":"hidden";i.mode!==o&&(i.mode=o)}Tn.setTextTrack()}function Me(){var e=NaN;return Tn&&(e=Tn.getCurrentTrackIdx()),e}function Le(e){if(!on)throw zt;var t=Gt();return t?t.getBitrateListFor(e):[]}function Ce(e,t){sn.setInitialBitrateFor(e,t)}function Oe(e){if(!on)throw zt;return sn.getInitialBitrateFor(e)}function ke(e,t){sn.setInitialRepresentationRatioFor(e,t)}function Ne(e){return sn.getInitialRepresentationRatioFor(e)}function Fe(e){if(!on)throw zt;return cn.getStreamsInfo(e)}function Be(e){if(!on)throw zt;var t=gn.getActiveStreamInfo();return t?ln.getTracksFor(e,t):[]}function Ue(e,t,n){if(!on)throw zt;return n=n||cn.getStreamsInfo(t)[0],n?cn.getAllMediaInfoForType(t,n,e):[]}function je(e){if(!on)throw zt;var t=gn.getActiveStreamInfo();return t?ln.getCurrentTrackFor(e,t):null}function He(e,t){ln.setInitialSettings(e,t)}function qe(e){return ln.getInitialSettings(e)}function Ve(e){if(!on)throw zt;ln.setTrack(e)}function Ge(e){return ln.getSwitchMode(e)}function Ke(e,t){ln.setSwitchMode(e,t)}function ze(e){ln.setSelectionModeForInitialTrack(e)}function Ye(){return ln.getSelectionModeForInitialTrack()}function We(){return sn.getAutoSwitchBitrateFor("video")||sn.getAutoSwitchBitrateFor("audio")}function Xe(e){sn.setAutoSwitchBitrateFor("video",e),sn.setAutoSwitchBitrateFor("audio",e)}function Qe(e){return sn.getAutoSwitchBitrateFor(e)}function Ze(e,t){sn.setAutoSwitchBitrateFor(e,t)}function Je(e){hn.setFastSwitchEnabled(e)}function $e(){return hn.getFastSwitchEnabled()}function et(e){hn.setBufferOccupancyABREnabled(e)}function tt(e,t){var n=Ft(),r=this,i=function e(i){i.error?t(null,i.error):t(i.manifest),Zt.off(ne.default.INTERNAL_MANIFEST_LOADED,e,r),n.reset()};Zt.on(ne.default.INTERNAL_MANIFEST_LOADED,i,r);var o=(0,P.default)(Qt).getInstance();o.initialize(),n.load(o.parseURI(e))}function nt(e,t){rt(e,t);var n=new a.default;n.schemeIdUri=e,n.value=t,hn.getUTCTimingSources().push(n)}function rt(e,t){var n=hn.getUTCTimingSources();n.forEach(function(r,i){r.schemeIdUri===e&&r.value===t&&n.splice(i,1)})}function it(){hn.setUTCTimingSources([])}function ot(){nt(O.default.DEFAULT_UTC_TIMING_SOURCE.scheme,O.default.DEFAULT_UTC_TIMING_SOURCE.value)}function at(e){hn.setUseManifestDateHeaderTimeSource(e)}function st(e){hn.setBufferToKeep(e)}function lt(e){hn.setBufferPruningInterval(e)}function ut(e){hn.setStableBufferTime(e)}function dt(e){hn.setBufferTimeAtTopQuality(e)}function ct(e){hn.setBufferTimeAtTopQualityLongForm(e)}function ft(e){hn.setLongFormContentDurationThreshold(e)}function ht(e){hn.setRichBufferThreshold(e)}function pt(e){hn.setBandwidthSafetyFactor(e)}function mt(){return hn.getBandwidthSafetyFactor()}function gt(e){hn.setAbandonLoadTimeout(e)}function yt(e){hn.setFragmentRetryAttempts(e)}function vt(e){hn.setFragmentRetryInterval(e)}function _t(e){bt(void 0,e)}function bt(e,t){hn.setXHRWithCredentialsForType(e,t)}function Et(e){return hn.getXHRWithCredentialsForType(e)}function Tt(){return jt()}function St(e){un=e}function xt(e){nn=e}function wt(e){var t=(0,T.default)(Qt).getInstance();t.setConfig({videoModel:En}),t.initialize(),t.displayCConTop(e)}function It(){return En?En.getVideoContainer():null}function Dt(e){if(!En)throw Yt;En.setVideoContainer(e)}function Rt(){if(!En)throw Yt;return En.getElement()}function At(e){if(!rn)throw Xt;En=null,e&&(En=(0,G.default)(Qt).getInstance(),En.initialize(),En.setElement(e),jt(),Ht()),kt()}function Pt(){return En?En.getTTMLRenderingDiv():null}function Mt(e){if(!En)throw Yt;En.setTTMLRenderingDiv(e)}function Lt(){if(!tn)throw Wt;return tn}function Ct(e){if(!rn)throw Xt;if("string"==typeof e){var t=(0,P.default)(Qt).getInstance();t.initialize(),tn=t.parseURI(e)}else tn=e;kt()}function Ot(){Ct(null),At(null),nn=null,un=null}function kt(){on?(on=!1,cn.reset(),gn.reset(),vn.reset(),sn.reset(),yn.reset(),ln.reset(),gn=null,dn=null,t()&&Kt()):t()&&Kt()}function Nt(){var e=(0,q.default)(Qt).getInstance();e.initialize(),(0,x.default)(Qt).getInstance().setConfig({dashManifestModel:bn}),ln.initialize(),ln.setConfig({errHandler:pn}),yn=(0,z.default)(Qt).getInstance(),yn.initialize(),yn.setConfig({abrRulesCollection:e}),gn=(0,d.default)(Qt).getInstance(),gn.setConfig({capabilities:mn,manifestLoader:Ft(),manifestModel:(0,L.default)(Qt).getInstance(),dashManifestModel:bn,protectionController:un,adapter:cn,metricsModel:fn,dashMetrics:_n,liveEdgeFinder:(0,g.default)(Qt).getInstance(),mediaSourceController:(0,W.default)(Qt).getInstance(),timeSyncController:(0,j.default)(Qt).getInstance(),baseURLController:(0,Q.default)(Qt).getInstance(),errHandler:pn,timelineConverter:(0,ye.default)(Qt).getInstance()}),gn.initialize(an,nn),sn.setConfig({abrRulesCollection:e,rulesController:yn,streamController:gn})}function Ft(){return(0,p.default)(Qt).create({errHandler:pn,parser:Bt(),metricsModel:fn,requestModifier:(0,I.default)(Qt).getInstance()})}function Bt(){return(0,ce.default)(Qt).create()}function Ut(){return cn=(0,ue.default)(Qt).getInstance(),cn.initialize(),cn.setConfig({dashManifestModel:bn}),cn}function jt(){if(un)return un;var e=dashjs.Protection;if("function"==typeof e){var t=e(Qt).create();return ne.default.extend(e.events),ie.default.extend(e.events,{publicOnly:!0}),un=t.createProtectionSystem({log:$t,videoModel:En,capabilities:mn,eventBus:Zt,adapter:cn})}return null}function Ht(){if(dn)return dn;var e=dashjs.MetricsReporting;if("function"==typeof e){var t=e(Qt).create();return dn=t.createMetricsReporting({log:$t,eventBus:Zt,mediaElement:Rt(),dashManifestModel:bn,metricsModel:fn})}return null}function qt(){var e=fn.getReadOnlyMetricsFor("video")||fn.getReadOnlyMetricsFor("audio");return _n.getCurrentDVRInfo(e)}function Vt(e){var t,n=qt();return n?(t=n.manifestInfo.availableFrom.getTime()/1e3,e+(t+n.range.start)):0}function Gt(){if(!on)throw zt;var e=gn.getActiveStreamInfo();return e?gn.getStreamById(e.id):null}function Kt(){on||(on=!0,$t("Playback Initialized"),Nt(),"string"==typeof tn?gn.load(tn):gn.loadWithManifest(tn))}var zt="You must first call play() to init playback before calling this method",Yt="You must first call attachView() to set the video element before calling this method",Wt="You must first call attachSource() with a valid source before calling this method",Xt="MediaPlayer not initialized!",Qt=this.context,Zt=(0,ee.default)(Qt).getInstance(),Jt=(0,J.default)(Qt).getInstance(),$t=Jt.log,en=void 0,tn=void 0,nn=void 0,rn=void 0,on=void 0,an=void 0,sn=void 0,ln=void 0,un=void 0,dn=void 0,cn=void 0,fn=void 0,hn=void 0,pn=void 0,mn=void 0,gn=void 0,yn=void 0,vn=void 0,_n=void 0,bn=void 0,En=void 0,Tn=void 0;return en={initialize:e,on:U,off:H,extend:F,attachView:At,attachSource:Ct,isReady:t,play:n,isPaused:i,pause:r,isSeeking:o,isDynamic:s,seek:S,setMute:u,isMuted:c,setVolume:h,getVolume:m,time:w,duration:D,timeAsUTC:A,durationAsUTC:M,getActiveStream:Gt,getDVRWindowSize:_,getDVRSeekOffset:E,convertToTimeCode:k,formatUTC:C,getVersion:V,getDebug:K,getBufferLength:y,getVideoModel:Y,getVideoContainer:It,getTTMLRenderingDiv:Pt,getVideoElement:Rt,getSource:Lt,setLiveDelayFragmentCount:X,setLiveDelay:Z,getLiveDelay:$,useSuggestedPresentationDelay:te,enableLastBitrateCaching:re,enableLastMediaSettingsCaching:oe,setMaxAllowedBitrateFor:le,getMaxAllowedBitrateFor:de,setMaxAllowedRepresentationRatioFor:fe,getMaxAllowedRepresentationRatioFor:pe,setAutoPlay:ge,getAutoPlay:ve,setScheduleWhilePaused:_e,getScheduleWhilePaused:be,getDashMetrics:Ee,getMetricsFor:Te,getQualityFor:Se,setQualityFor:xe,updatePortalSize:we,getLimitBitrateByPortal:Ie,setLimitBitrateByPortal:De,getUsePixelRatioInLimitBitrateByPortal:Re,setUsePixelRatioInLimitBitrateByPortal:Ae,setTextTrack:Pe,getBitrateInfoListFor:Le,setInitialBitrateFor:Ce,getInitialBitrateFor:Oe,setInitialRepresentationRatioFor:ke,getInitialRepresentationRatioFor:Ne,getStreamsFromManifest:Fe,getTracksFor:Be,getTracksForTypeFromManifest:Ue,getCurrentTrackFor:je,setInitialMediaSettingsFor:He,getInitialMediaSettingsFor:qe,setCurrentTrack:Ve,getTrackSwitchModeFor:Ge,setTrackSwitchModeFor:Ke,setSelectionModeForInitialTrack:ze,getSelectionModeForInitialTrack:Ye,getAutoSwitchQuality:We,setAutoSwitchQuality:Xe,setFastSwitchEnabled:Je,getFastSwitchEnabled:$e,getAutoSwitchQualityFor:Qe,setAutoSwitchQualityFor:Ze,enableBufferOccupancyABR:et,setBandwidthSafetyFactor:pt,getBandwidthSafetyFactor:mt,setAbandonLoadTimeout:gt,retrieveManifest:tt,addUTCTimingSource:nt,removeUTCTimingSource:rt,clearDefaultUTCTimingSources:it,restoreDefaultUTCTimingSources:ot,setBufferToKeep:st,setBufferPruningInterval:lt,setStableBufferTime:ut,setBufferTimeAtTopQuality:dt,setFragmentLoaderRetryAttempts:yt,setFragmentLoaderRetryInterval:vt,setXHRWithCredentials:_t,setXHRWithCredentialsForType:bt,getXHRWithCredentialsForType:Et,setBufferTimeAtTopQualityLongForm:ct,setLongFormContentDurationThreshold:ft,setRichBufferThreshold:ht,getProtectionController:Tt,attachProtectionController:St,setProtectionData:xt,enableManifestDateHeaderTimeSource:at,displayCaptionsOnTop:wt,attachVideoContainer:Dt,attachTTMLRenderingDiv:Mt,getCurrentTextTrackIndex:Me,reset:Ot},function(){rn=!1,on=!1,an=!0,un=null,nn=null,cn=null,ne.default.extend(ie.default),hn=(0,O.default)(Qt).getInstance()}(),en}Object.defineProperty(t,"__esModule",{value:!0});var o=n(48),a=r(o),s=n(7),l=r(s),u=n(22),d=r(u),c=n(13),f=r(c),h=n(87),p=r(h),m=n(40),g=r(m),y=n(14),v=r(y),_=n(135),b=r(_),E=n(36),T=r(E),S=n(26),x=r(S),w=n(30),I=r(w),D=n(15),R=r(D),A=n(37),P=r(A),M=n(29),L=r(M),C=n(4),O=r(C),k=n(8),N=r(k),F=n(12),B=r(F),U=n(100),j=r(U),H=n(55),q=r(H),V=n(17),G=r(V),K=n(54),z=r(K),Y=n(97),W=r(Y),X=n(93),Q=r(X),Z=n(3),J=r(Z),$=n(1),ee=r($),te=n(2),ne=r(te),re=n(20),ie=r(re),oe=n(0),ae=r(oe),se=n(43),le=n(19),ue=r(le),de=n(69),ce=r(de),fe=n(11),he=r(fe),pe=n(10),me=r(pe),ge=n(33),ye=r(ge);i.__dashjs_factory_name="MediaPlayer";var ve=ae.default.getClassFactory(i);ve.events=ie.default,t.default=ve},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(t,n){var r,l=t.match(o);if(l){try{r=s[l[1]](a).create({eventBus:e.eventBus}),r.initialize(l[1],n,l[3],l[5])}catch(e){r=null,i("MetricsHandlerFactory: Could not create handler for type "+l[1]+" with args "+l[3]+", "+l[5]+" ("+e.message+")")}return r}}function n(e,t){s[e]=t}function r(e){delete s[e]}var i=e.log,o=/([a-zA-Z]*)(\(([0-9]*)(\,\s*([a-zA-Z]*))?\))?/,a=this.context,s={BufferLevel:l.default,DVBErrors:d.default,HttpList:f.default,PlayList:p.default,RepSwitchList:p.default,TcpList:p.default};return{create:t,register:n,unregister:r}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),a=r(o),s=n(108),l=r(s),u=n(109),d=r(u),c=n(111),f=r(c),h=n(110),p=r(h);i.__dashjs_factory_name="MetricsHandlerFactory",t.default=a.default.getSingletonFactory(i)},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(e,t){var n;try{n=i[e.schemeIdUri](o).create(),n.initialize(e,t)}catch(t){n=null,a("ReportingFactory: could not create Reporting with schemeIdUri "+e.schemeIdUri+" ("+t.message+")")}return n}function n(e,t){i[e]=t}function r(e){delete i[e]}var i={"urn:dvb:dash:reporting:2014":l.default},o=this.context,a=e.log;return{create:t,register:n,unregister:r}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),a=r(o),s=n(112),l=r(s);i.__dashjs_factory_name="ReportingFactory",t.default=a.default.getSingletonFactory(i)},function(e,t,n){function r(){return{reconstructFullMetricName:function(e,t,n){var r=e;return t&&(r+="("+t,n&&n.length&&(r+=","+n),r+=")"),r},validateN:function(e){if(!e)throw new Error("missing n");if(isNaN(e))throw new Error("n is NaN");if(e<0)throw new Error("n must be positive");return e}}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=function(e){return e&&e.__esModule?e:{default:e}}(i);r.__dashjs_factory_name="HandlerHelpers",t.default=o.default.getSingletonFactory(r)},function(e,t,n){function r(e){function t(){return f.mediaInfo.streamInfo}function n(){return f.mediaInfo}function r(){return f}function i(){return p}function o(){return f.mediaInfo.streamInfo.manifestInfo}function a(){return h}function s(){return m}function l(){return g}function u(){return y}function d(){return v}function c(){return _}var f=e.streamProcessor.getCurrentRepresentationInfo(),h=e.streamProcessor,p=e.currentValue,m=e.playbackIndex,g=e.switchHistory,y=e.droppedFramesHistory,v=e.currentRequest,_=e.hasRichBuffer;return{getCurrentValue:i,getManifestInfo:o,getMediaInfo:n,getPlaybackIndex:s,getDroppedFramesHistory:u,getCurrentRequest:d,getSwitchHistory:l,getStreamInfo:t,getStreamProcessor:a,getTrackInfo:r,hasRichBuffer:c}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=function(e){return e&&e.__esModule?e:{default:e}}(i);r.__dashjs_factory_name="RulesContext",t.default=o.default.getClassFactory(r)},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){s={}}function t(e){e&&e.abrRulesCollection&&(s[h]=e.abrRulesCollection)}function n(e,t,n,r,o,a){var s,u,d={},c={},f=e.length,h=f,p=i(t,r),m=function(e){var t,i,o;if(e.value!==l.default.NO_CHANGE){var s=a(d[e.priority],e.value);s!==d[e.priority]&&(d[e.priority]=s,c[e.priority]=e.reason)}--f||(d[l.default.WEAK]!==l.default.NO_CHANGE&&(o=l.default.WEAK,t=d[l.default.WEAK],i=c[l.default.WEAK]),d[l.default.DEFAULT]!==l.default.NO_CHANGE&&(o=l.default.DEFAULT,t=d[l.default.DEFAULT],i=c[l.default.DEFAULT]),d[l.default.STRONG]!==l.default.NO_CHANGE&&(o=l.default.STRONG,t=d[l.default.STRONG],i=c[l.default.STRONG]),o!=l.default.STRONG&&o!=l.default.WEAK&&(o=l.default.DEFAULT),n(void 0!==t?{value:t,confidence:o,reason:i}:{value:r,confidence:o,reason:{name:"NO_CHANGE"}}))};for(d[l.default.STRONG]=l.default.NO_CHANGE,d[l.default.WEAK]=l.default.NO_CHANGE,d[l.default.DEFAULT]=l.default.NO_CHANGE,u=0;u<h;u++)s=e[u],s.execute(p,m)}function r(){var e,t,n=s[h],r=(n.getRules(d.default.QUALITY_SWITCH_RULES)||[]).concat(n.getRules(d.default.ABANDON_FRAGMENT_RULES)||[]),i=r.length;for(t=0;t<i;t++)e=r[t],"function"==typeof e.reset&&e.reset();s={}}function i(e,t){return(0,a.default)(o).create({streamProcessor:e,currentValue:t})}var o=this.context,s=void 0;return{initialize:e,setConfig:t,applyRules:n,reset:r}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(53),a=r(o),s=n(6),l=r(s),u=n(55),d=r(u),c=n(0),f=r(c),h=0;i.__dashjs_factory_name="RulesController";var p=f.default.getSingletonFactory(i);p.ABR_RULE=h,t.default=p},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){u=[],c=[];var e=(0,T.default)(s).getInstance(),t=(0,x.default)(s).getInstance();(0,b.default)(s).getInstance().getBufferOccupancyABREnabled()?(u.push((0,g.default)(s).create({metricsModel:e,dashMetrics:(0,x.default)(s).getInstance()})),c.push((0,v.default)(s).create({metricsModel:e,dashMetrics:(0,x.default)(s).getInstance()}))):(u.push((0,a.default)(s).create({metricsModel:e,dashMetrics:t})),u.push((0,l.default)(s).create({metricsModel:e})),u.push((0,p.default)(s).create()),u.push((0,f.default)(s).create()),c.push((0,d.default)(s).create()))}function t(e){switch(e){case A:return u;case P:return c;default:return null}}function n(e){return e.filter(function(e){return e.value>R.default.NO_CHANGE})}function r(e){if(0!==e.length)return e.reduce(function(e,t){return e.value<t.value?e:t})}function i(e){return r(n(u.map(function(t){return t.getMaxIndex(e)})))||(0,R.default)(s).create()}function o(e){return r(n(c.map(function(t){return t.shouldAbandon(e)})))||(0,R.default)(s).create()}var s=this.context,u=void 0,c=void 0;return{initialize:e,getRules:t,getMaxQuality:i,shouldAbandonFragment:o}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(129),a=r(o),s=n(127),l=r(s),u=n(124),d=r(u),c=n(126),f=r(c),h=n(128),p=r(h),m=n(56),g=r(m),y=n(125),v=r(y),_=n(4),b=r(_),E=n(8),T=r(E),S=n(10),x=r(S),w=n(0),I=r(w),D=n(6),R=r(D),A="qualitySwitchRules",P="abandonFragmentRules";i.__dashjs_factory_name="ABRRulesCollection";var M=I.default.getSingletonFactory(i);M.QUALITY_SWITCH_RULES=A,M.ABANDON_FRAGMENT_RULES=P,t.default=M},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(){j={},H={},q={},V=[],G=(0,d.default)(O).getInstance(),K=(0,f.default)(O).getInstance(),z=(0,m.default)(O).getInstance(),B.on(_.default.BUFFER_EMPTY,g,U),B.on(_.default.PLAYBACK_SEEKING,v,U),B.on(_.default.PERIOD_SWITCH_STARTED,b,U),B.on(_.default.MEDIA_FRAGMENT_LOADED,A,U)}function n(e){return e.map(function(e){return Math.log(e)})}function r(e,t,r,i){var o=NaN;if(i?(o=0,i.forEach(function(e,t){e>i[o]&&(o=t)})):(i=n(r),o=i.length-1),0===o)return null;var a=1-i[0]+(i[o]-i[0])/(t/e-1),s=e/(i[0]+a-1);return{utilities:i,gp:a,Vp:s}}function o(e){var t={},n=e.getMediaInfo(),i=e.getStreamProcessor(),o=e.getStreamInfo(),a=e.getTrackInfo(),s=i.isDynamic(),l=o.manifestInfo.duration,u=a.fragmentDuration,d=n.bitrateList.map(function(e){return e.bandwidth}),c=r(I,D,d,null);if(null===c)return t.state=T,t;if(t.state=S,t.bitrates=d,t.utilities=c.utilities,t.Vp=c.Vp,t.gp=c.gp,t.isDynamic=s,t.movieDuration=l,t.fragmentDuration=u,t.bandwidthSafetyFactor=G.getBandwidthSafetyFactor(),t.rebufferSafetyFactor=R,t.bufferTarget=G.getStableBufferTime(),t.lastQuality=0,t.placeholderBuffer=0,t.throughputCount=s?L:C,w){for(var f="",h=0;h<d.length;++h){var p=c.utilities[h],m=d[h],g=0;if(h>0){var y=c.utilities[h-1],v=d[h-1];g=c.Vp*((y*m-p*v)/(m-v)+c.gp)}var _=c.Vp*(p+c.gp);f+="\n"+h+":"+(1e-6*d[h]).toFixed(3)+"Mbps "+g.toFixed(3)+"/"+_.toFixed(3)}k("BolaDebug "+n.type+" bitrates"+f)}return t}function s(e,t){for(var n=e.bitrates.length,r=NaN,i=NaN,o=0;o<n;++o){var a=(e.Vp*(e.utilities[o]+e.gp)-t)/e.bitrates[o];(isNaN(i)||a>=i)&&(i=a,r=o)}return r}function l(e,t){for(var n=N.getHttpRequests(e),r=[],i=n.length-1;i>=0&&r.length<t;--i){var o=n[i];o.type===h.HTTPRequest.MEDIA_SEGMENT_TYPE&&o._tfinish&&o.tresponse&&o.trace&&r.push(o)}return r}function u(e,t,n){var r=l(e,t);if(0===r.length)return 0;for(var i=0,o="",a=0;a<r.length;++a){var s=.001*(r[a]._tfinish.getTime()-r[a].trequest.getTime()),u=8*r[a].trace.reduce(function(e,t){return e+t.b[0]},0);w&&(o+=" "+(1e-6*u).toFixed(3)+"/"+s.toFixed(3)+"="+(1e-6*u/s).toFixed(3)+"Mbps"),i+=s/u}return w&&k("BolaDebug "+n+" BolaRule recent throughput = "+(r.length/(1e6*i)).toFixed(3)+"Mbps:"+o),r.length/i}function c(e,t){var n=0;return e.bitrates.some(function(e,r){return e>t||(n=r,!1)}),n}function p(e,t){var n=Date.now(),r=j[t],i=q[t],o=NaN;if(j[t]=n,q[t]=!1,!i){var a=l(e,1);a.length>0&&(o=a[0]._tfinish.getTime())>n&&(o=n)}var s=0;return s=i||r>o?n-r:n-o,isNaN(s)||s<=0?0:.001*s}function g(){w&&k("BolaDebug BUFFER_EMPTY"),V.forEach(function(e){var t=F.getReadOnlyMetricsFor(e);if(0!==t.BolaState.length){var n=t.BolaState[0]._s;n.state===x&&(n.placeholderBuffer=0,F.updateBolaState(e,n))}})}function v(e){w&&k("BolaDebug PLAYBACK_SEEKING "+e.seekTime.toFixed(3)),V.forEach(function(e){var t=F.getReadOnlyMetricsFor(e);if(0!==t.BolaState.length){var n=t.BolaState[0]._s;n.state!==T&&(n.state=S),F.updateBolaState(e,n)}}),H={},q={}}function b(){}function A(e){if(e&&e.chunk&&e.chunk.mediaInfo){var t=e.chunk.mediaInfo.type,n=e.chunk.start;void 0===t||isNaN(n)||(n<=H[t]?q[t]=!0:(q[t]=!1,H[t]=n))}}function P(e){var t=e.getStreamProcessor();t.getScheduleController().setTimeToLoadDelay(0);var n=(0,a.default)(O).create(a.default.NO_CHANGE,{name:i.__dashjs_factory_name}),r=e.getMediaInfo(),l=r.type,d=F.getReadOnlyMetricsFor(l);if(0===d.BolaState.length){w&&k("BolaDebug "+l+"\nBolaDebug "+l+" BolaRule for state=- fragmentStart="+z.getIndexHandlerTime(e.getStreamProcessor()).toFixed(3));var f=o(e);F.updateBolaState(l,f);var h=0;if(f.state!==T){V.push(l);var m=u(d,f.throughputCount,l);if(0===m)return w&&k("BolaDebug "+l+" BolaRule quality unchanged for INITIALIZE"),n;h=c(f,m*f.bandwidthSafetyFactor),f.lastQuality=h,n.value=h,n.reason.state=f.state,n.reason.throughput=m}return w&&k("BolaDebug "+l+" BolaRule quality "+h+" for INITIALIZE"),n}var g=d.BolaState[0]._s;if(g.state===T)return w&&k("BolaDebug "+l+" BolaRule quality 0 for ONE_BITRATE"),n;var y=g.bitrates,v=g.utilities;w&&k("BolaDebug "+l+"\nBolaDebug "+l+" EXECUTE BolaRule for state="+g.state+" fragmentStart="+z.getIndexHandlerTime(e.getStreamProcessor()).toFixed(3));var _=N.getCurrentBufferLevel(d)?N.getCurrentBufferLevel(d):0,b=u(d,g.throughputCount,l);_<=.1&&(g.placeholderBuffer=0);var E=p(d,l);E>0&&(g.placeholderBuffer+=E),g.placeholderBuffer<0&&(g.placeholderBuffer=0);var I=_+g.placeholderBuffer,D=s(g,I);if(w&&k("BolaDebug "+l+" BolaRule bufferLevel="+_.toFixed(3)+"(+"+g.placeholderBuffer.toFixed(3)+"="+I.toFixed(3)+") recentThroughput="+(1e-6*b).toFixed(3)+" tentativeQuality="+D),g.state===S){var A=c(g,b*g.bandwidthSafetyFactor);if(_>g.fragmentDuration/R){g.state=x;for(var P=0,M=0;M<A;++M){var L=g.Vp*(g.gp+(y[A]*v[M]-y[M]*v[A])/(y[A]-y[M]));L>P&&(P=L)}P>_&&(g.placeholderBuffer=P-_)}return w&&k("BolaDebug "+l+" BolaRule quality "+A+" for STARTUP"),g.lastQuality=A,F.updateBolaState(l,g),n.value=A,n.reason.state=S,n.reason.throughput=b,n}if(D>g.lastQuality){var C=c(g,b);D>C&&(C<g.lastQuality&&(C=g.lastQuality),D=C)}if(b>0)for(var B=R*b*_/g.fragmentDuration;D>0&&y[D]>B;)--D;var U=0;return U=I-g.Vp*(v[D]+g.gp),U>0&&(U>g.placeholderBuffer?(U-=g.placeholderBuffer,g.placeholderBuffer=0):(g.placeholderBuffer-=U,U=0)),U>0?D===y.length-1?U=0:t.getScheduleController().setTimeToLoadDelay(1e3*U):U=0,g.lastQuality=D,F.updateBolaState(l,g),n.value=D,n.reason.state=g.state,n.reason.throughput=b,n.reason.bufferLevel=_,w&&k("BolaDebug "+l+" BolaRule quality "+D+" delay="+U.toFixed(3)+" for STEADY"),n}function M(){B.off(_.default.BUFFER_EMPTY,g,U),B.off(_.default.PLAYBACK_SEEKING,v,U),B.off(_.default.PERIOD_SWITCH_STARTED,b,U),B.off(_.default.MEDIA_FRAGMENT_LOADED,A,U),t()}var L=2,C=3,O=this.context,k=(0,E.default)(O).getInstance().log,N=e.dashMetrics,F=e.metricsModel,B=(0,y.default)(O).getInstance(),U=void 0,j=void 0,H=void 0,q=void 0,V=void 0,G=void 0,K=void 0,z=void 0;return U={getMaxIndex:P,reset:M},t(),U}Object.defineProperty(t,"__esModule",{value:!0});var o=n(6),a=r(o),s=n(0),l=r(s),u=n(4),d=r(u),c=n(7),f=r(c),h=n(5),p=n(19),m=r(p),g=n(1),y=r(g),v=n(2),_=r(v),b=n(3),E=r(b),T=0,S=1,x=2,w=!1,I=10,D=30,R=.5;i.__dashjs_factory_name="BolaRule";var A=l.default.getClassFactory(i);A.BOLA_STATE_ONE_BITRATE=T,A.BOLA_STATE_STARTUP=S,A.BOLA_STATE_STEADY=x,A.BOLA_DEBUG=w,t.default=A},function(e,t,n){function r(){function e(e,t){var n=0;for(n=0;n<this.customTimeRangeArray.length&&e>this.customTimeRangeArray[n].start;n++);for(this.customTimeRangeArray.splice(n,0,{start:e,end:t}),n=0;n<this.customTimeRangeArray.length-1;n++)this.mergeRanges(n,n+1)&&n--;this.length=this.customTimeRangeArray.length}function t(){this.customTimeRangeArray=[],this.length=0}function n(e,t){for(var n=0;n<this.customTimeRangeArray.length;n++)if(e<=this.customTimeRangeArray[n].start&&t>=this.customTimeRangeArray[n].end)this.customTimeRangeArray.splice(n,1),n--;else{if(e>this.customTimeRangeArray[n].start&&t<this.customTimeRangeArray[n].end){this.customTimeRangeArray.splice(n+1,0,{start:t,end:this.customTimeRangeArray[n].end}),this.customTimeRangeArray[n].end=e;break}e>this.customTimeRangeArray[n].start&&e<this.customTimeRangeArray[n].end?this.customTimeRangeArray[n].end=e:t>this.customTimeRangeArray[n].start&&t<this.customTimeRangeArray[n].end&&(this.customTimeRangeArray[n].start=t)}this.length=this.customTimeRangeArray.length}function r(e,t){var n=this.customTimeRangeArray[e],r=this.customTimeRangeArray[t];return n.start<=r.start&&r.start<=n.end&&n.end<=r.end?(n.end=r.end,this.customTimeRangeArray.splice(t,1),!0):r.start<=n.start&&n.start<=r.end&&r.end<=n.end?(n.start=r.start,this.customTimeRangeArray.splice(t,1),!0):r.start<=n.start&&n.start<=r.end&&n.end<=r.end?(this.customTimeRangeArray.splice(e,1),!0):n.start<=r.start&&r.start<=n.end&&r.end<=n.end&&(this.customTimeRangeArray.splice(t,1),!0)}function i(e){return this.customTimeRangeArray[e].start}function o(e){return this.customTimeRangeArray[e].end}return{customTimeRangeArray:[],length:0,add:e,clear:t,remove:n,mergeRanges:r,start:i,end:o}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=function(e){return e&&e.__esModule?e:{default:e}}(i);r.__dashjs_factory_name="CustomTimeRanges",t.default=o.default.getClassFactory(r)},function(e,t,n){function r(){function e(e){var t=e.streamId,n=e.mediaInfo.type,i=e.quality;r[t]=r[t]||{},r[t][n]=r[t][n]||{},r[t][n][i]=e}function t(e,t,n){return r[e][t][n]}function n(){r={}}var r={};return{save:e,extract:t,reset:n}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=function(e){return e&&e.__esModule?e:{default:e}}(i);r.__dashjs_factory_name="InitCache",t.default=o.default.getSingletonFactory(r)},function(e,t,n){function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":r(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":r(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(18),l=function(e){return e&&e.__esModule?e:{default:e}}(s),u=function(e){function t(e,n){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.url=e||null,r.type=n||null,r.mediaType="stream",r.responseType="text",r}return a(t,e),t}(l.default);t.default=u},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){r(this,e),this.start=null,this.mstart=null,this.starttype=null,this.trace=[]};i.INITIAL_PLAYOUT_START_REASON="initial_playout",i.SEEK_START_REASON="seek",i.RESUME_FROM_PAUSE_START_REASON="resume",i.METRICS_COLLECTION_START_REASON="metrics_collection_start";var o=function e(){r(this,e),this.representationid=null,this.subreplevel=null,this.start=null,this.mstart=null,this.duration=null,this.playbackspeed=null,this.stopreason=null};o.REPRESENTATION_SWITCH_STOP_REASON="representation_switch",o.REBUFFERING_REASON="rebuffering",o.USER_REQUEST_STOP_REASON="user_request",o.END_OF_PERIOD_STOP_REASON="end_of_period",o.END_OF_CONTENT_STOP_REASON="end_of_content",o.METRICS_COLLECTION_STOP_REASON="metrics_collection_end",o.FAILURE_STOP_REASON="failure",t.PlayList=i,t.PlayListTrace=o},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(164),i=function(e){return e&&e.__esModule?e:{default:e}}(r);t.default=i.default},function(e,t,n){function i(e){var t,n,r;for(t=[],r=0,n=e.length;r<n;r+=1)e[r].isRoot?t.push("root"):t.push(e[r].name);var i=function(e,t){var n;if(null!==e&&null!==t)for(n in e)e.hasOwnProperty(n)&&(t.hasOwnProperty(n)||(t[n]=e[n]))},a=function(e,t,n){var r,a,s,l,u;if(null!==e&&0!==e.length)for(r=0,a=e.length;r<a;r+=1)s=e[r],t.hasOwnProperty(s.name)&&(n.hasOwnProperty(s.name)?s.merge&&(l=t[s.name],u=n[s.name],"object"===(void 0===l?"undefined":o(l))&&"object"===(void 0===u?"undefined":o(u))?i(l,u):null!=s.mergeFunction?n[s.name]=s.mergeFunction(l,u):n[s.name]=l+u):n[s.name]=t[s.name])},s=function e(t,n){var r,i,o,s,l,u,d,c=t;if(null!==c.children&&0!==c.children.length)for(r=0,i=c.children.length;r<i;r+=1)if(u=c.children[r],n.hasOwnProperty(u.name))if(u.isArray)for(l=n[u.name+"_asArray"],o=0,s=l.length;o<s;o+=1)d=l[o],a(c.properties,n,d),e(u,d);else d=n[u.name],a(c.properties,n,d),e(u,d)};return{run:function n(r){var i,a,l,u,d,c,f;if(null===r)return r;if("object"!==(void 0===r?"undefined":o(r)))return r;for(i=0,a=t.length;i<a;i+=1)"root"===t[i]&&(d=e[i],c=r,s(d,c));for(u in r)if(r.hasOwnProperty(u)&&"__children"!=u){if(-1!==(l=t.indexOf(u)))if(d=e[l],d.isArray)for(f=r[u+"_asArray"],i=0,a=f.length;i<a;i+=1)c=f[i],s(d,c);else c=r[u],s(d,c);n(r[u])}return r}}}Object.defineProperty(t,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==r(Symbol.iterator)?function(e){return void 0===e?"undefined":r(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":r(e)};t.default=i},function(e,t,n){(function(e){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.MediaPlayerFactory=t.MetricsReporting=t.MediaPlayer=void 0;var i=n(49),o=r(i),a=n(102),s=r(a),l=n(89),u=r(l),d=n(43),c="undefined"!=typeof window&&window||e,f=c.dashjs;f||(f=c.dashjs={}),f.MediaPlayer=o.default,f.MetricsReporting=s.default,f.MediaPlayerFactory=u.default,f.Version=(0,d.getVersionString)(),t.default=f,t.MediaPlayer=o.default,t.MetricsReporting=s.default,t.MediaPlayerFactory=u.default}).call(t,n(163))},function(e,t,n){function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":r(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":r(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(32),l=function(e){return e&&e.__esModule?e:{default:e}}(s),u=function(e){function t(){i(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.BUFFERING_COMPLETED="bufferingCompleted",e.BUFFER_CLEARED="bufferCleared",e.BUFFER_LEVEL_UPDATED="bufferLevelUpdated",e.BYTES_APPENDED="bytesAppended",e.CHECK_FOR_EXISTENCE_COMPLETED="checkForExistenceCompleted",e.CURRENT_TRACK_CHANGED="currentTrackChanged",e.DATA_UPDATE_COMPLETED="dataUpdateCompleted",e.DATA_UPDATE_STARTED="dataUpdateStarted",e.INITIALIZATION_LOADED="initializationLoaded",e.INIT_FRAGMENT_LOADED="initFragmentLoaded",e.INIT_REQUESTED="initRequested",e.INTERNAL_MANIFEST_LOADED="internalManifestLoaded",e.LIVE_EDGE_SEARCH_COMPLETED="liveEdgeSearchCompleted",e.LOADING_COMPLETED="loadingCompleted",e.LOADING_PROGRESS="loadingProgress",e.MANIFEST_UPDATED="manifestUpdated",e.MEDIA_FRAGMENT_LOADED="mediaFragmentLoaded",e.QUOTA_EXCEEDED="quotaExceeded",e.REPRESENTATION_UPDATED="representationUpdated",e.SEGMENTS_LOADED="segmentsLoaded",e.SERVICE_LOCATION_BLACKLIST_CHANGED="serviceLocationBlacklistChanged",e.SOURCEBUFFER_APPEND_COMPLETED="sourceBufferAppendCompleted",e.SOURCEBUFFER_REMOVE_COMPLETED="sourceBufferRemoveCompleted",e.STREAMS_COMPOSED="streamsComposed",e.STREAM_BUFFERING_COMPLETED="streamBufferingCompleted",e.STREAM_COMPLETED="streamCompleted",e.STREAM_TEARDOWN_COMPLETE="streamTeardownComplete",e.TIMED_TEXT_REQUESTED="timedTextRequested",e.TIME_SYNCHRONIZATION_COMPLETED="timeSynchronizationComplete",e.URL_RESOLUTION_FAILED="urlResolutionFailed",e.WALLCLOCK_TIME_UPDATED="wallclockTimeUpdated",e.XLINK_ELEMENT_LOADED="xlinkElementLoaded",e.XLINK_READY="xlinkReady",e}return a(t,e),t}(l.default);t.default=u},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(t){J=t,X=J.getType(),W=J.isDynamic(),$=(0,x.default)(N).create(e,W)}function n(){return J}function r(e){Q=e}function i(){return Q}function o(){return z}function s(){return Z}function d(){$=null,Q=0,Z=NaN,Y=NaN,z=-1,W=null,X=null,J=null,B.off(c.default.INITIALIZATION_LOADED,O,K),B.off(c.default.SEGMENTS_LOADED,k,K)}function f(e){return e?e.split("$$").join("$"):e}function p(e,t){if(null===t||null===e||-1===e.indexOf("$RepresentationID$"))return e;var n=t.toString();return e.split("$RepresentationID$").join(n)}function m(e,t,n){var r,i,o=G.resolve(n.path);return o&&t!==o.url&&U.isRelative(t)?(r=o.url,i=o.serviceLocation,t&&(r=U.resolve(t,r))):r=t,!U.isRelative(r)&&(e.url=r,e.serviceLocation=i,!0)}function g(e,t){var n=new a.default,r=e.adaptation.period,i=r.start;if(n.mediaType=t,n.type=u.HTTPRequest.INIT_SEGMENT_TYPE,n.range=e.range,n.availabilityStartTime=H.calcAvailabilityStartTimeFromPresentationTime(i,r.mpd,W),n.availabilityEndTime=H.calcAvailabilityEndTimeFromPresentationTime(i+r.duration,r.mpd,W),n.quality=e.index,n.mediaInfo=J.getMediaInfo(),m(n,e.initialization,e))return n}function v(e){return e?g(e,X):null}function b(e){var t=!1;if(W||z!==e.availableSegmentsNumber){var n=(0,T.getSegmentByIndex)(z,e);if(n){var r=n.presentationStartTime-e.adaptation.period.start,i=e.adaptation.period.duration;F(e.segmentInfoType+": "+r+" / "+i),t=("SegmentTimeline"!==e.segmentInfoType||!W)&&r>=i}}else t=!0;return t}function S(e){return $.getSegments(e,Y,z,I)}function I(e,t){if(e.segments=t,t&&t.length>0&&(Z=isNaN(Z)?t[0].presentationStartTime:Math.min(t[0].presentationStartTime,Z)),W&&isNaN(H.getExpectedLiveEdge())){var n=t[t.length-1],r=n.presentationStartTime,i=V.getMetricsFor("stream");H.setExpectedLiveEdge(r),V.updateManifestUpdateInfo(q.getCurrentManifestUpdate(i),{presentationStartTime:r})}}function D(e){if(!e)throw new l.default("no representation");return e.segments=null,S(e),e}function R(e,t){var n,r=E.default.hasInitialization(e),i=E.default.hasSegments(e);if(e.segmentDuration||e.segments||D(e),e.segmentAvailabilityRange=null,e.segmentAvailabilityRange=H.calcSegmentAvailabilityRange(e,W),e.segmentAvailabilityRange.end<e.segmentAvailabilityRange.start&&!e.useCalculatedLiveEdgeTime)return n=new l.default(w,"no segments are available yet",{availabilityDelay:e.segmentAvailabilityRange.start-e.segmentAvailabilityRange.end}),void B.trigger(c.default.REPRESENTATION_UPDATED,{sender:this,representation:e,error:n});t||(z=-1),e.segmentDuration&&D(e),r||j.loadInitialization(e),i||j.loadSegments(e,X,e.indexRange),r&&i&&B.trigger(c.default.REPRESENTATION_UPDATED,{sender:this,representation:e})}function A(e,t,n){var r,i,o,a,s,l=t.segments,u=l?l.length:null,d=-1;if(l&&u>0)for(s=0;s<u;s++)if(i=l[s],o=i.presentationStartTime,a=i.duration,r=void 0===n||null===n?a/2:n,e+r>=o&&e-r<o+a){d=i.availabilityIdx;break}return d}function P(e){if(null===e||void 0===e)return null;var t=new a.default,n=e.representation,r=n.adaptation.period.mpd.manifest.Period_asArray[n.adaptation.period.index].AdaptationSet_asArray[n.adaptation.index].Representation_asArray[n.index].bandwidth,i=e.media;return i=(0,T.replaceTokenForTemplate)(i,"Number",e.replacementNumber),i=(0,T.replaceTokenForTemplate)(i,"Time",e.replacementTime),i=(0,T.replaceTokenForTemplate)(i,"Bandwidth",r),i=p(i,n.id),i=f(i),t.mediaType=X,t.type=u.HTTPRequest.MEDIA_SEGMENT_TYPE,t.range=e.mediaRange,t.startTime=e.presentationStartTime,t.duration=e.duration,t.timescale=n.timescale,t.availabilityStartTime=e.availabilityStartTime,t.availabilityEndTime=e.availabilityEndTime,t.wallStartTime=e.wallStartTime,t.quality=n.index,t.index=e.availabilityIdx,t.mediaInfo=J.getMediaInfo(),t.adaptationIndex=n.adaptation.index,m(t,i,n)?t:void 0}function M(e,t,n){var r,i,o,s=z,l=!!n&&n.keepIdx,u=n?n.timeThreshold:null,d=!(!n||!n.ignoreIsFinished);return e?(Y!==t&&(Y=t,F("Getting the request for "+X+" time : "+t)),S(e),z=A(t,e,u),z<0&&(S(e),z=A(t,e,u)),z>0&&F("Index for "+X+" time "+t+" is "+z),o=!d&&b(e),o?(r=new a.default,r.action=a.default.ACTION_COMPLETE,r.index=z,r.mediaType=X,r.mediaInfo=J.getMediaInfo(),F("Signal complete.",r)):(i=(0,T.getSegmentByIndex)(z,e),r=P(i)),l&&s>=0&&(z="SegmentTimeline"===e.segmentInfoType&&W?z:s),r):null}function L(e,t){var n=(e.segmentAvailabilityRange.end-e.segmentAvailabilityRange.start)/2;return e.segments=null,e.segmentAvailabilityRange={start:t-n,end:t+n},M(e,t,{keepIdx:!1,ignoreIsFinished:!0})}function C(e){var t,n,r;return e&&-1!==z?(Y=null,z++,F("Getting the next request at index: "+z),r=b(e),r?(t=new a.default,t.action=a.default.ACTION_COMPLETE,t.index=z,t.mediaType=X,t.mediaInfo=J.getMediaInfo(),F("Signal complete.")):(S(e),n=(0,T.getSegmentByIndex)(z,e),t=P(n),!n&&W&&z--),t):null}function O(e){var t=e.representation;t.segments&&B.trigger(c.default.REPRESENTATION_UPDATED,{sender:this,representation:t})}function k(e){if(!e.error&&X===e.mediaType){var t,n,r,i,o=e.segments,a=e.representation,s=[],l=0;for(t=0,n=o.length;t<n;t++)r=o[t],i=(0,T.getTimeBasedSegment)(H,W,a,r.startTime,r.duration,r.timescale,r.media,r.mediaRange,l),s.push(i),i=null,l++;a.segmentAvailabilityRange={start:s[0].presentationStartTime,end:s[n-1].presentationStartTime},a.availableSegmentsNumber=n,I(a,s),E.default.hasInitialization(a)&&B.trigger(c.default.REPRESENTATION_UPDATED,{sender:this,representation:a})}}var N=this.context,F=(0,y.default)(N).getInstance().log,B=(0,h.default)(N).getInstance(),U=(0,_.default)(N).getInstance(),j=e.segmentBaseLoader,H=e.timelineConverter,q=e.dashMetrics,V=e.metricsModel,G=e.baseURLController,K=void 0,z=void 0,Y=void 0,W=void 0,X=void 0,Q=void 0,Z=void 0,J=void 0,$=void 0;return K={initialize:t,getStreamProcessor:n,getInitRequest:v,getSegmentRequestForTime:M,getNextSegmentRequest:C,generateSegmentRequestForTime:L,updateRepresentation:R,setCurrentTime:r,getCurrentTime:i,getCurrentIndex:o,getEarliestTime:s,reset:d},function(){z=-1,Q=0,Z=NaN,B.on(c.default.INITIALIZATION_LOADED,O,K),B.on(c.default.SEGMENTS_LOADED,k,K)}(),K}Object.defineProperty(t,"__esModule",{value:!0});var o=n(18),a=r(o),s=n(9),l=r(s),u=n(5),d=n(2),c=r(d),f=n(1),h=r(f),p=n(0),m=r(p),g=n(3),y=r(g),v=n(23),_=r(v),b=n(34),E=r(b),T=n(25),S=n(79),x=r(S),w=1;i.__dashjs_factory_name="DashHandler";var I=m.default.getClassFactory(i);I.SEGMENTS_UNAVAILABLE_ERROR_CODE=w,t.default=I},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){_=(0,f.default)(h).getInstance(),b=(0,v.default)(h).getInstance(),E=(0,a.default)(h).getInstance(),I=(0,D.default)(h).create({errHandler:_,metricsModel:x,requestModifier:E})}function t(e){e.baseURLController&&(R=e.baseURLController),e.metricsModel&&(x=e.metricsModel)}function n(e,t){var r=null,i=null,o=R.resolve(e.path),a=t||{init:!0,url:o?o.url:void 0,range:{start:0,end:1500},searching:!1,bytesLoaded:0,bytesToLoad:1500};m("Start searching for initialization.");var l=u(a),d=function(t){a.bytesLoaded=a.range.end,i=b.parse(t),r=s(i),r?(e.range=r,y.trigger(p.default.INITIALIZATION_LOADED,{representation:e})):(a.range.end=a.bytesLoaded+a.bytesToLoad,n(e,a))},c=function(){y.trigger(p.default.INITIALIZATION_LOADED,{representation:e})};I.load({request:l,success:d,error:c}),m("Perform init search: "+a.url)}function r(e,t,n,i,a){if(n&&(void 0===n.start||void 0===n.end)){var s=n?n.toString().split("-"):null;n=s?{start:parseFloat(s[0]),end:parseFloat(s[1])}:null}a=a||c;var l=null,d=null,f=!!n,h=R.resolve(e.path),p={init:!1,url:h?h.url:void 0,range:f?n:{start:0,end:1500},searching:!f,bytesLoaded:i?i.bytesLoaded:0,bytesToLoad:1500},g=u(p),y=function(n){var i=p.bytesToLoad,s=n.byteLength;if(p.bytesLoaded=p.range.end-p.range.start,l=b.parse(n),(d=l.getBox("sidx"))&&d.isComplete){var u,c,f=d.references;if(null!==f&&void 0!==f&&f.length>0&&(u=1===f[0].reference_type),u){m("Initiate multiple SIDX load."),p.range.end=p.range.start+d.size;var h,g,y,v,_,E=[],T=0,S=(d.offset||p.range.start)+d.size,x=function(n){n?(E=E.concat(n),++T>=g&&a(E,e,t)):a(null,e,t)};for(h=0,g=f.length;h<g;h++)y=S,v=S+f[h].referenced_size-1,S+=f[h].referenced_size,_={start:y,end:v},r(e,null,_,p,x)}else m("Parsing segments from SIDX."),c=o(d,p),a(c,e,t)}else{if(d)p.range.start=d.offset||p.range.start,p.range.end=p.range.start+(d.size||i);else{if(s<p.bytesLoaded)return void a(null,e,t);var w=l.getLastBox();w&&w.size?(p.range.start=w.offset+w.size,p.range.end=p.range.start+i):p.range.end+=i}r(e,t,p.range,p,a)}},v=function(){a(null,e,t)};I.load({request:g,success:y,error:v}),m("Perform SIDX load: "+p.url)}function i(){I.abort(),I=null,_=null,b=null,E=null}function o(e,t){for(var n,r,i,o,a=e.references,s=a.length,u=e.timescale,d=e.earliest_presentation_time,c=t.range.start+e.offset+e.first_offset+e.size,f=[],h=0;h<s;h++)i=a[h].subsegment_duration,o=a[h].referenced_size,n=new l.default,n.duration=i,n.startTime=d,n.timescale=u,r=c+o-1,n.mediaRange=c+"-"+r,f.push(n),d+=i,c+=o;return f}function s(e){var t,n,r=e.getBox("ftyp"),i=e.getBox("moov"),o=null;return m("Searching for initialization."),i&&i.isComplete&&(t=r?r.offset:i.offset,n=i.offset+i.size-1,o=t+"-"+n,m("Found the initialization.  Range: "+o)),o}function u(e){if(e.url){var t=new w.default;return t.type=e.init?S.HTTPRequest.INIT_SEGMENT_TYPE:S.HTTPRequest.MEDIA_SEGMENT_TYPE,t.url=e.url,t.range=e.range.start+"-"+e.range.end,t}}function c(e,t,n){e?y.trigger(p.default.SEGMENTS_LOADED,{segments:e,representation:t,mediaType:n}):y.trigger(p.default.SEGMENTS_LOADED,{segments:null,representation:t,mediaType:n,error:new d.default(null,"error loading segments",null)})}var h=this.context,m=(0,T.default)(h).getInstance().log,y=(0,g.default)(h).getInstance(),_=void 0,b=void 0,E=void 0,x=void 0,I=void 0,R=void 0;return{setConfig:t,initialize:e,loadInitialization:n,loadSegments:r,reset:i}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(30),a=r(o),s=n(35),l=r(s),u=n(9),d=r(u),c=n(14),f=r(c),h=n(2),p=r(h),m=n(1),g=r(m),y=n(38),v=r(y),_=n(0),b=r(_),E=n(3),T=r(E),S=n(5),x=n(18),w=r(x),I=n(21),D=r(I);i.__dashjs_factory_name="SegmentBaseLoader",t.default=b.default.getSingletonFactory(i)},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){x=(0,g.default)(h).getInstance(),I=(0,v.default)(h).getInstance(),R=(0,w.default)(h).create({errHandler:x,metricsModel:D,requestModifier:I})}function t(e){if(!e.baseURLController||!e.metricsModel)throw new Error("Missing config parameter(s)");A=e.baseURLController,D=e.metricsModel}function n(e){var t=[],n=void 0,r=void 0,i=void 0,o=(0,d.default)(h).create({data:e}),a=void 0;for(o.consumeTag(T.Segment.Cues),r=o.getMatroskaCodedNum();o.moreData()&&o.consumeTagAndSize(T.Segment.Cues.CuePoint,!0);){for(n={},n.CueTime=o.parseTag(T.Segment.Cues.CuePoint.CueTime),n.CueTracks=[];o.moreData()&&o.consumeTagAndSize(T.Segment.Cues.CuePoint.CueTrackPositions,!0);){if(i={},i.Track=o.parseTag(T.Segment.Cues.CuePoint.CueTrackPositions.CueTrack),0===i.Track)throw new Error("Cue track cannot be 0");i.ClusterPosition=o.parseTag(T.Segment.Cues.CuePoint.CueTrackPositions.CueClusterPosition),o.getPos()+4>r||!o.consumeTag(T.Segment.Cues.CuePoint.CueTrackPositions.CueBlockNumber,!0)?n.CueTracks.push(i):(a=o.getMatroskaCodedNum(),i.BlockNumber=o.getMatroskaUint(a),n.CueTracks.push(i))}if(0===n.CueTracks.length)throw new Error("Mandatory cuetrack not found");t.push(n)}if(0===t.length)throw new Error("mandatory cuepoint not found");return t}function r(e,t,r,i){var o=void 0,a=void 0,s=void 0,l=void 0,u=void 0,d=void 0,c=void 0,f=void 0;for(a=n(e),s=[],u=0,d=a.length;u<d;u+=1)l=new b.default,o=0,o=u<a.length-1?a[u+1].CueTime-a[u].CueTime:i-a[u].CueTime,l.duration=o,l.startTime=a[u].CueTime,l.timescale=1e3,c=a[u].CueTracks[0].ClusterPosition+t,f=u<a.length-1?a[u+1].CueTracks[0].ClusterPosition+t-1:r-1,l.mediaRange=c+"-"+f,s.push(l);return m("Parsed cues: "+s.length+" cues."),s}function i(e,t,n,i){var o=(0,d.default)(h).create({data:e}),a=void 0,s=void 0,l=n.split("-"),u=null,f={url:t,range:{start:parseFloat(l[0]),end:parseFloat(l[1])},request:u},p=void 0,g=void 0;for(m("Parse EBML header: "+f.url),o.skipOverElement(T.EBML),o.consumeTag(T.Segment),p=o.getMatroskaCodedNum(),p+=o.getPos(),g=o.getPos();o.moreData()&&!o.consumeTagAndSize(T.Segment.Info,!0);)if(!(o.skipOverElement(T.Segment.SeekHead,!0)||o.skipOverElement(T.Segment.Tracks,!0)||o.skipOverElement(T.Segment.Cues,!0)||o.skipOverElement(T.Void,!0)))throw new Error("no valid top level element found");for(;void 0===a;){var y=o.getMatroskaCodedNum(!0),v=o.getMatroskaCodedNum();switch(y){case T.Segment.Info.Duration.tag:a=o[T.Segment.Info.Duration.parse](v);break;default:o.setPos(o.getPos()+v)}}u=c(f);var _=function(e){s=r(e,g,p,a),i(s)},b=function(){m("Download Error: Cues "+f.url),i(null)};R.load({request:u,success:_,error:b}),m("Perform cues load: "+f.url+" bytes="+f.range.start+"-"+f.range.end)}function o(e,t){var n=null,r=A.resolve(e.path),i=r?r.url:void 0,o=e.range.split("-"),s=t||{range:{start:parseFloat(o[0]),end:parseFloat(o[1])},request:n,url:i,init:!0};m("Start loading initialization."),n=c(s);var l=function(){y.trigger(a.default.INITIALIZATION_LOADED,{representation:e})},u=function(){y.trigger(a.default.INITIALIZATION_LOADED,{representation:e})};R.load({request:n,success:l,error:u}),m("Perform init load: "+s.url)}function s(e,t,n,r){var o=null,a=A.resolve(e.path),s=a?a.url:void 0,l={bytesLoaded:0,bytesToLoad:8192,range:{start:0,end:8192},request:o,url:s,init:!1};r=r||u,o=c(l),m("Parsing ebml header");var d=function(o){i(o,s,n,function(n){r(n,e,t)})},f=function(){r(null,e,t)};R.load({request:o,success:d,error:f})}function u(e,t,n){e?y.trigger(a.default.SEGMENTS_LOADED,{segments:e,representation:t,mediaType:n}):y.trigger(a.default.SEGMENTS_LOADED,{segments:null,representation:t,mediaType:n,error:new Error(null,"error loading segments",null)})}function c(e){var t=new S.default;return t.type=e.init?E.HTTPRequest.INIT_SEGMENT_TYPE:E.HTTPRequest.MEDIA_SEGMENT_TYPE,t.url=e.url,t.range=e.range.start+"-"+e.range.end,t}function f(){x=null,I=null,m=null}var h=this.context,m=(0,p.default)(h).getInstance().log,y=(0,l.default)(h).getInstance(),_=void 0,T=void 0,x=void 0,I=void 0,D=void 0,R=void 0,A=void 0;return _={setConfig:t,initialize:e,loadInitialization:o,loadSegments:s,reset:f},function(){T={EBML:{tag:440786851,required:!0},Segment:{tag:408125543,required:!0,SeekHead:{tag:290298740,required:!0},Info:{tag:357149030,required:!0,TimecodeScale:{tag:2807729,required:!0,parse:"getMatroskaUint"},Duration:{tag:17545,required:!0,parse:"getMatroskaFloat"}},Tracks:{tag:374648427,required:!0},Cues:{tag:475249515,required:!0,CuePoint:{tag:187,required:!0,CueTime:{tag:179,required:!0,parse:"getMatroskaUint"},CueTrackPositions:{tag:183,required:!0,CueTrack:{tag:247,required:!0,parse:"getMatroskaUint"},CueClusterPosition:{tag:241,required:!0,parse:"getMatroskaUint"},CueBlockNumber:{tag:21368}}}}},Void:{tag:236,required:!0}}}(),_}Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),a=r(o),s=n(1),l=r(s),u=n(136),d=r(u),c=n(0),f=r(c),h=n(3),p=r(h),m=n(14),g=r(m),y=n(30),v=r(y),_=n(35),b=r(_),E=n(5),T=n(18),S=r(T),x=n(21),w=r(x);i.__dashjs_factory_name="WebmSegmentBaseLoader",t.default=f.default.getSingletonFactory(i)},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e){e.abrController&&(Y=e.abrController)}function t(e){z=e,W=z.getIndexHandler()}function n(){return z}function r(){return H}function i(){return q}function o(){return V}function s(){return K}function u(){U.off(P.default.QUALITY_CHANGE_REQUESTED,k,j),U.off(P.default.REPRESENTATION_UPDATED,M,j),U.off(P.default.WALLCLOCK_TIME_UPDATED,C,j),U.off(P.default.BUFFER_LEVEL_UPDATED,O,j),H=null,q=-1,V=!0,G=[],Y=null,X=null,Q=null,Z=null,J=null,$=null,ee=null,te=null,ne=null,re=null}function c(e,t,n){var r,i,o=null,a=z.getStreamInfo(),s=Y.getTopQualityIndexFor(n,a.id);if(V=!0,U.trigger(P.default.DATA_UPDATE_STARTED,{sender:this}),G=S(t),null===H&&"fragmentedText"!==n?(i=Y.getAverageThroughput(n),o=i||Y.getInitialBitrateFor(n,a),r=Y.getQualityForBitrate(z.getMediaInfo(),o)):r=Y.getQualityFor(n,a),r>s&&(r=s),K=y(r),H=e,"video"!==n&&"audio"!==n&&"fragmentedText"!==n)return V=!1,void U.trigger(P.default.DATA_UPDATE_COMPLETED,{sender:this,data:H,currentRepresentation:K});for(var l=0;l<G.length;l++)W.updateRepresentation(G[l],!0)}function h(){var e=new Date,t=s(),n=1e3*Q.getTime();J.addRepresentationSwitch(t.adaptation.type,e,n,t.id)}function m(){var e=ee.calcSegmentAvailabilityRange(K,z.isDynamic());J.addDVRInfo(z.getType(),Q.getTime(),z.getStreamInfo().manifestInfo,e)}function y(e){return G[e]}function _(e){return G.indexOf(e)}function E(){for(var e=0,t=G.length;e<t;e++){var n=G[e].segmentInfoType;if(null===G[e].segmentAvailabilityRange||!N.default.hasInitialization(G[e])||("SegmentBase"===n||"BaseURL"===n)&&!G[e].segments)return!1}return!0}function S(e){var t=Z.getValue();return q=te.getIndexForAdaptation(H,t,e.period.index),te.getRepresentationsForAdaptation(t,e)}function w(e){for(var t,n=0,r=G.length;n<r;n++)t=G[n],t.segmentAvailabilityRange=ee.calcSegmentAvailabilityRange(t,e)}function D(){G.forEach(function(e){e.segmentAvailabilityRange=null})}function A(e){var t=e,n=function(){if(!o()){V=!0,U.trigger(P.default.DATA_UPDATE_STARTED,{sender:j}),D();for(var e=0;e<G.length;e++)W.updateRepresentation(G[e],!0)}};V=!1,U.trigger(L.default.AST_IN_FUTURE,{delay:t}),setTimeout(n,t)}function M(e){if(e.sender.getStreamProcessor()===z&&o()){var t,n,r,i=e.representation,a=J.getMetricsFor("stream"),l=J.getMetricsFor(s().adaptation.type),u=ne.getCurrentManifestUpdate(a),d=!1,c=0;if("dynamic"===i.adaptation.period.mpd.manifest.type){var f=i.segmentAvailabilityRange.end-i.segmentAvailabilityRange.start;c=1e3*(Q.computeLiveDelay(K.segmentDuration,z.getStreamInfo().manifestInfo.DVRWindowSize)-f)}if(c>0)return m(),A(c),n=new I.default(F,"Segments update failed",null),void U.trigger(P.default.DATA_UPDATE_COMPLETED,{sender:this,data:H,currentRepresentation:K,error:n});if(u){for(var p=0;p<u.trackInfo.length;p++)if(t=u.trackInfo[p],t.index===i.index&&t.mediaType===z.getType()){d=!0;break}d||J.addManifestUpdateRepresentationInfo(u,i.id,i.index,i.adaptation.period.index,z.getType(),i.presentationTimeOffset,i.startNumber,i.segmentInfoType)}E()&&(V=!1,Y.setPlaybackQuality(z.getType(),z.getStreamInfo(),_(K)),J.updateManifestUpdateInfo(u,{latency:K.segmentAvailabilityRange.end-Q.getTime()}),r=ne.getCurrentRepresentationSwitch(l),r||h(),U.trigger(P.default.DATA_UPDATE_COMPLETED,{sender:this,data:H,currentRepresentation:K}))}}function C(e){e.isDynamic&&w(e.isDynamic)}function O(e){e.sender.getStreamProcessor()===z&&m()}function k(e){e.mediaType===z.getType()&&z.getStreamInfo().id===e.streamInfo.id&&e.oldQuality!==e.newQuality&&(K=y(e.newQuality),$.setSavedBitrateSettings(e.mediaType,K.bandwidth),h())}var F=1,B=this.context,U=(0,R.default)(B).getInstance(),j=void 0,H=void 0,q=void 0,V=void 0,G=void 0,K=void 0,z=void 0,Y=void 0,W=void 0,X=void 0,Q=void 0,Z=void 0,J=void 0,$=void 0,ee=void 0,te=void 0,ne=void 0,re=void 0;return j={initialize:t,setConfig:e,getData:r,getDataIndex:i,isUpdating:o,updateData:c,getStreamProcessor:n,getCurrentRepresentation:s,getRepresentationForQuality:y,reset:u},function(){H=null,q=-1,V=!0,G=[],Y=(0,f.default)(B).getInstance(),X=(0,g.default)(B).getInstance(),Q=(0,p.default)(B).getInstance(),Z=(0,v.default)(B).getInstance(),J=(0,b.default)(B).getInstance(),$=(0,x.default)(B).getInstance(),ee=(0,d.default)(B).getInstance(),te=(0,a.default)(B).getInstance(),ne=(0,l.default)(B).getInstance(),re=(0,T.default)(B).getInstance(),U.on(P.default.QUALITY_CHANGE_REQUESTED,k,j),U.on(P.default.REPRESENTATION_UPDATED,M,j),U.on(P.default.WALLCLOCK_TIME_UPDATED,C,j),U.on(P.default.BUFFER_LEVEL_UPDATED,O,j)}(),j}Object.defineProperty(t,"__esModule",{value:!0});var o=n(11),a=r(o),s=n(10),l=r(s),u=n(33),d=r(u),c=n(12),f=r(c),h=n(7),p=r(h),m=n(22),g=r(m),y=n(29),v=r(y),_=n(8),b=r(_),E=n(4),T=r(E),S=n(39),x=r(S),w=n(9),I=r(w),D=n(1),R=r(D),A=n(2),P=r(A),M=n(20),L=r(M),C=n(0),O=r(C),k=n(34),N=r(k);i.__dashjs_factory_name="RepresentationController",t.default=O.default.getClassFactory(i)},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e,t){var i;try{var a=window.performance.now();if(!(i=s.xml_str2json(e)))throw new Error("parser error");var u=window.performance.now();l.run(i);var d=window.performance.now();t.setMatchers(o),t.setIron(l),n("Parsing complete: ( xml2json: "+(u-a).toPrecision(3)+"ms, objectiron: "+(d-u).toPrecision(3)+"ms, total: "+((d-a)/1e3).toPrecision(3)+"s)")}catch(t){return r.manifestError("parsing the manifest failed","parse",e,t),null}return i}var t=this.context,n=(0,d.default)(t).getInstance().log,r=(0,a.default)(t).getInstance(),i=void 0,o=void 0,s=void 0,l=void 0;return i={parse:e},function(){o=[new v.default,new b.default,new T.default,new g.default],s=new p.default({escapeMode:!1,attributePrefix:"",arrayAccessForm:"property",emptyNodeForm:"object",stripWhitespaces:!1,enableToStringFunc:!1,ignoreRoot:!0,matchers:o}),l=new f.default([new x.default,new I.default])}(),i}Object.defineProperty(t,"__esModule",{value:!0});var o=n(14),a=r(o),s=n(0),l=r(s),u=n(3),d=r(u),c=n(62),f=r(c),h=n(31),p=r(h),m=n(76),g=r(m),y=n(74),v=r(y),_=n(73),b=r(_),E=n(75),T=r(E),S=n(71),x=r(S),w=n(72),I=r(w);i.__dashjs_factory_name="DashParser",t.default=l.default.getClassFactory(i)},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(t,n){r(this,e),this._name=t,this._merge=void 0!==n?n:function(e){return e&&e.length&&e.charAt(0)===e.charAt(0).toUpperCase()}(t)}return i(e,[{key:"name",get:function(){return this._name}},{key:"merge",get:function(){return this._merge}}]),e}();t.default=o},function(e,t,n){function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":r(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":r(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(45),l=function(e){return e&&e.__esModule?e:{default:e}}(s),u=function(e){function t(){i(this,t);var e=["profiles","width","height","sar","frameRate","audioSamplingRate","mimeType","segmentProfiles","codecs","maximumSAPPeriod","startWithSAP","maxPlayoutRate","codingDependency","scanType","FramePacking","AudioChannelConfiguration","ContentProtection","EssentialProperty","SupplementalProperty","InbandEventStream"];return o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"AdaptationSet",e,[new l.default("Representation",e,[new l.default("SubRepresentation",e)])]))}return a(t,e),t}(l.default);t.default=u},function(e,t,n){function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":r(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":r(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(45),l=function(e){return e&&e.__esModule?e:{default:e}}(s),u=function(e){function t(){i(this,t);var e=["SegmentBase","SegmentTemplate","SegmentList"];return o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Period",e,[new l.default("AdaptationSet",e,[new l.default("Representation",e)])]))}return a(t,e),t}(l.default);t.default=u},function(e,t,n){function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":r(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":r(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(24),l=function(e){return e&&e.__esModule?e:{default:e}}(s),u=60,d=60,c=1e3,f=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+-])([0-9]{2})(?::?)([0-9]{2}))?/,h=function(e){function t(){return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,function(e){return f.test(e.value)},function(e){var t=f.exec(e),n=void 0;if(n=Date.UTC(parseInt(t[1],10),parseInt(t[2],10)-1,parseInt(t[3],10),parseInt(t[4],10),parseInt(t[5],10),t[6]&&parseInt(t[6],10)||0,t[7]&&parseFloat(t[7])*c||0),t[9]&&t[10]){var r=parseInt(t[9],10)*d+parseInt(t[10],10);n+=("+"===t[8]?-1:1)*r*u*c}return new Date(n)}))}return a(t,e),t}(l.default);t.default=h},function(e,t,n){function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":r(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":r(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(24),l=function(e){return e&&e.__esModule?e:{default:e}}(s),u=/^([-])?P(([\d.]*)Y)?(([\d.]*)M)?(([\d.]*)D)?T?(([\d.]*)H)?(([\d.]*)M)?(([\d.]*)S)?/,d=31536e3,c=2592e3,f=86400,h=3600,p=60,m=function(e){function t(){return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,function(e){for(var t=["minBufferTime","mediaPresentationDuration","minimumUpdatePeriod","timeShiftBufferDepth","maxSegmentDuration","maxSubsegmentDuration","suggestedPresentationDelay","start","starttime","duration"],n=t.length,r=0;r<n;r++)if(e.nodeName===t[r])return u.test(e.value);return!1},function(e){var t=u.exec(e),n=parseFloat(t[2]||0)*d+parseFloat(t[4]||0)*c+parseFloat(t[6]||0)*f+parseFloat(t[8]||0)*h+parseFloat(t[10]||0)*p+parseFloat(t[12]||0);return void 0!==t[1]&&(n=-n),n}))}return a(t,e),t}(l.default);t.default=m},function(e,t,n){function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":r(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":r(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(24),l=function(e){return e&&e.__esModule?e:{default:e}}(s),u=/^[-+]?[0-9]+[.]?[0-9]*([eE][-+]?[0-9]+)?$/,d=function(e){function t(){return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,function(e){return u.test(e.value)},function(e){return parseFloat(e)}))}return a(t,e),t}(l.default);t.default=d},function(e,t,n){function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":r(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":r(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(24),l=function(e){return e&&e.__esModule?e:{default:e}}(s),u=function(e){function t(){return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,function(e,t){var n={MPD:["id","profiles"],Period:["id"],BaseURL:["serviceLocation","byteRange"],SegmentBase:["indexRange"],Initialization:["range"],RepresentationIndex:["range"],SegmentList:["indexRange"],BitstreamSwitching:["range"],SegmentURL:["mediaRange","indexRange"],SegmentTemplate:["indexRange","media","index","initialization","bitstreamSwitching"],AssetIdentifier:["value","id"],EventStream:["value"],AdaptationSet:["profiles","mimeType","segmentProfiles","codecs","contentType"],FramePacking:["value","id"],AudioChannelConfiguration:["value","id"],ContentProtection:["value","id"],EssentialProperty:["value","id"],SupplementalProperty:["value","id"],InbandEventStream:["value","id"],Accessibility:["value","id"],Role:["value","id"],Rating:["value","id"],Viewpoint:["value","id"],ContentComponent:["contentType"],Representation:["id","dependencyId","mediaStreamStructureId"],Subset:["id"],Metrics:["metrics"],Reporting:["value","id"]};if(n.hasOwnProperty(t)){var r=n[t];return void 0!==r&&r.indexOf(e.name)>=0}return!1},function(e){return String(e)}))}return a(t,e),t}(l.default);t.default=u},function(e,t,n){function r(){function e(e){e&&e.boxParser&&(r=e.boxParser)}function t(e){var t,n,i,o,a,s,l,u,d,c,f,h,p,m=r.parse(e),g=m.getBox("tfhd"),y=m.getBox("tfdt"),v=m.getBox("trun"),_=m.getBox("moof"),b=m.getBox("mfhd"),E=m.getBox("subs");for(f=b.sequence_number,i=v.sample_count,a=y.baseMediaDecodeTime,c=(g.base_data_offset||0)+(v.data_offset||0),s=[],p=0,u=0;u<i;u++){l=v.samples[u],t=void 0!==l.sample_duration?l.sample_duration:g.default_sample_duration,o=void 0!==l.sample_size?l.sample_size:g.default_sample_size,n=void 0!==l.sample_composition_time_offset?l.sample_composition_time_offset:0;var T={dts:a,cts:a+n,duration:t,offset:_.offset+c,size:o,subSizes:[o]};if(E&&p<E.samples_with_subsamples.length&&E.samples_with_subsamples[p].nr==u+1){for(T.subSizes=[],d=0;d<E.samples_with_subsamples[p].subsamples.length;d++){var S=E.samples_with_subsamples[p].subsamples[d].size;T.subSizes.push(S)}p++}s.push(T),c+=o,a+=t}return h=a-y.baseMediaDecodeTime,{sampleList:s,sequenceNumber:f,totalDuration:h}}function n(e){var t=r.parse(e),n=t.getBox("mdhd");return n?n.timescale:NaN}var r=void 0;return{getSamplesInfo:t,getMediaTimescaleFromMoov:n,setConfig:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=function(e){return e&&e.__esModule?e:{default:e}}(i);r.__dashjs_factory_name="FragmentedTextBoxParser",t.default=o.default.getSingletonFactory(r)},function(e,t,n){function r(e,t){function n(e,n,i,o){var s,l,u,d,c,f,h,p=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentList,m=p.SegmentURL_asArray.length,g=[];for(h=e.startNumber,d=(0,a.decideSegmentListRangeForTemplate)(r,t,e,n,i,o),c=Math.max(d.start,0),f=Math.min(d.end,p.SegmentURL_asArray.length-1),s=c;s<=f;s++)u=p.SegmentURL_asArray[s],l=(0,a.getIndexBasedSegment)(r,t,e,s),l.replacementTime=(h+s-1)*e.segmentDuration,l.media=u.media?u.media:"",l.mediaRange=u.mediaRange,l.index=u.index,l.indexRange=u.indexRange,g.push(l),l=null;return e.availableSegmentsNumber=m,g}var r=e.timelineConverter;return{getSegments:n}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=function(e){return e&&e.__esModule?e:{default:e}}(i),a=n(25);r.__dashjs_factory_name="ListSegmentsGetter";var s=o.default.getClassFactory(r);t.default=s},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){function n(e,t,n,i,o){var l,d=e.segmentInfoType;return"SegmentBase"!==d&&"BaseURL"!==d&&r(e,n)?("SegmentTimeline"===d?l=a.getSegments(e,t,n,o):"SegmentTemplate"===d?l=s.getSegments(e,t,n,o):"SegmentList"===d&&(l=u.getSegments(e,t,n,o)),i&&i(e,l)):l=e.segments,l}function r(e,t){var n,r,i=e.segments,o=!1;return i&&0!==i.length?(r=i[0].availabilityIdx,n=i[i.length-1].availabilityIdx,o=t<r||t>n):o=!0,o}var i=this.context,o=void 0,a=void 0,s=void 0,u=void 0;return o={getSegments:n},function(){a=(0,l.default)(i).create(e,t),s=(0,d.default)(i).create(e,t),u=(0,f.default)(i).create(e,t)}(),o}Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),a=r(o),s=n(81),l=r(s),u=n(80),d=r(u),c=n(78),f=r(c);i.__dashjs_factory_name="SegmentsGetter";var h=a.default.getClassFactory(i);t.default=h},function(e,t,n){function r(e,t){function n(e,n,i,o){var s,l,u,d,c,f=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentTemplate,h=e.segmentDuration,p=e.segmentAvailabilityRange,m=[],g=null,y=null;for(c=e.startNumber,s=isNaN(h)&&!t?{start:c,end:c}:(0,a.decideSegmentListRangeForTemplate)(r,t,e,n,i,o),u=s.start,d=s.end,l=u;l<=d;l++)y=(0,a.getIndexBasedSegment)(r,t,e,l),y.replacementTime=(c+l-1)*e.segmentDuration,g=f.media,g=(0,a.replaceTokenForTemplate)(g,"Number",y.replacementNumber),g=(0,a.replaceTokenForTemplate)(g,"Time",y.replacementTime),y.media=g,m.push(y),y=null;return isNaN(h)?e.availableSegmentsNumber=1:e.availableSegmentsNumber=Math.ceil((p.end-p.start)/h),m}var r=e.timelineConverter;return{getSegments:n}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=function(e){return e&&e.__esModule?e:{default:e}}(i),a=n(25);r.__dashjs_factory_name="TemplateSegmentsGetter";var s=o.default.getClassFactory(r);t.default=s},function(e,t,n){function r(e,t){function n(e,n,i,o){var s,l,u,d,c,f,h,p,m,g,y,v,_,b,E=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentTemplate||e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentList,T=E.SegmentTimeline,S=E.SegmentURL_asArray,x=e.availableSegmentsNumber>0,w=0,I=0,D=-1,R=[],A=!1,P=function(n,i){var o=E.media,s=n.mediaRange;return S&&(o=S[i].media||"",s=S[i].mediaRange),(0,a.getTimeBasedSegment)(r,t,e,w,n.d,b,o,s,D)};for(b=e.timescale,s=T.S_asArray,m=(0,a.decideSegmentListRangeForTimeline)(r,t,n,i,o),m?(v=m.start,_=m.end):y=r.calcMediaTimeFromPresentationTime(n||0,e),u=0,d=s.length;u<d;u++){if(l=s[u],f=0,l.hasOwnProperty("r")&&(f=l.r),l.hasOwnProperty("t")&&(w=l.t,I=w/b),f<0){if((p=s[u+1])&&p.hasOwnProperty("t"))h=p.t/b;else{var M=e.segmentAvailabilityRange?e.segmentAvailabilityRange.end:r.calcSegmentAvailabilityRange(e,t).end;h=r.calcMediaTimeFromPresentationTime(M,e),e.segmentDuration=l.d/b}f=Math.ceil((h-I)/(l.d/b))-1}if(g){if(x)break;D+=f+1}else for(c=0;c<=f;c++){if(D++,m){if(D>_){if(g=!0,x)break;continue}D>=v&&R.push(P(l,D))}else{if(R.length>10){if(g=!0,x)break;continue}A?R.push(P(l,D)):I>=y-l.d/b*1.5&&(A=!0,R.push(P(l,D)))}w+=l.d,I=w/b}}return x||(e.availableSegmentsNumber=D+1),R}var r=e.timelineConverter;return{getSegments:n}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=function(e){return e&&e.__esModule?e:{default:e}}(i),a=n(25);r.__dashjs_factory_name="TimelineSegmentsGetter";var s=o.default.getClassFactory(r);t.default=s},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){r(this,e),this.period=null,this.index=-1,this.type=null};t.default=i},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){r(this,e),this.adaptionSet=null,this.representation=null,this.period=null,this.timescale=1,this.value="",this.schemeIdUri=""};t.default=i},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){r(this,e),this.manifest=null,this.suggestedPresentationDelay=0,this.availabilityStartTime=null,this.availabilityEndTime=Number.POSITIVE_INFINITY,this.timeShiftBufferDepth=Number.POSITIVE_INFINITY,this.maxSegmentDuration=Number.POSITIVE_INFINITY,this.minimumUpdatePeriod=NaN,this.mediaPresentationDuration=NaN};t.default=i},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){r(this,e),this.id=null,this.index=-1,this.duration=NaN,this.start=NaN,this.mpd=null};i.DEFAULT_ID="defaultId",t.default=i},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(e){var t=function(t){s.trigger(p.default.CHECK_FOR_EXISTENCE_COMPLETED,{request:e,exists:t})};if(e){var n=new l.default(e.url);c.load({request:n,success:function(){t(!0)},error:function(){t(!1)}})}else t(!1)}function n(e){var t=function(t,n){s.trigger(p.default.LOADING_COMPLETED,{request:e,response:t||null,error:n||null,sender:u})};e?c.load({request:e,progress:function(){s.trigger(p.default.LOADING_PROGRESS,{request:e})},success:function(e){t(e)},error:function(e,n,r){t(void 0,new d.default(y,r,n))}}):t(void 0,new d.default(v,_))}function r(){c&&c.abort()}function i(){c&&(c.abort(),c=null)}var o=this.context,s=(0,f.default)(o).getInstance(),u=void 0,c=void 0;return u={checkForExistence:t,load:n,abort:r,reset:i},function(){c=(0,a.default)(o).create({errHandler:e.errHandler,metricsModel:e.metricsModel,requestModifier:e.requestModifier})}(),u}Object.defineProperty(t,"__esModule",{value:!0});var o=n(21),a=r(o),s=n(143),l=r(s),u=n(9),d=r(u),c=n(1),f=r(c),h=n(2),p=r(h),m=n(0),g=r(m),y=1,v=2,_="request is null";i.__dashjs_factory_name="FragmentLoader";var b=g.default.getClassFactory(i);b.FRAGMENT_LOADER_ERROR_LOADING_FAILURE=y,b.FRAGMENT_LOADER_ERROR_NULL_REQUEST=v,t.default=b},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(e){o.trigger(_.default.INTERNAL_MANIFEST_LOADED,{manifest:e.manifest})}function n(e){var t=new f.default(e,m.HTTPRequest.MPD_TYPE);h.load({request:t,success:function(t,n,r){var i,a;r.responseURL&&r.responseURL!==e?(a=s.parseBaseUrl(r.responseURL),i=r.responseURL):(s.isRelative(e)&&(e=s.resolve(e,window.location.href)),a=s.parseBaseUrl(e));var l=u.parse(t,g);l?(l.url=i||e,l.originalUrl||(l.originalUrl=l.url),l.baseUri=a,l.loadedTime=new Date,g.resolveManifestOnLoad(l)):o.trigger(_.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new p.default(T,x)})},error:function(t,n,r){o.trigger(_.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new p.default(S,"Failed loading manifest: "+e+", "+r)})}})}function r(){o.off(_.default.XLINK_READY,t,c),g&&(g.reset(),g=null),h&&(h.abort(),h=null)}var i=this.context,o=(0,y.default)(i).getInstance(),s=(0,d.default)(i).getInstance(),u=e.parser,c=void 0,h=void 0,g=void 0;return c={load:n,reset:r},function(){o.on(_.default.XLINK_READY,t,c),h=(0,l.default)(i).create({errHandler:e.errHandler,metricsModel:e.metricsModel,requestModifier:e.requestModifier}),g=(0,a.default)(i).create({errHandler:e.errHandler,metricsModel:e.metricsModel,requestModifier:e.requestModifier})}(),c}Object.defineProperty(t,"__esModule",{value:!0});var o=n(101),a=r(o),s=n(21),l=r(s),u=n(23),d=r(u),c=n(59),f=r(c),h=n(9),p=r(h),m=n(5),g=n(1),y=r(g),v=n(2),_=r(v),b=n(0),E=r(b),T=1,S=2,x="parsing failed";i.__dashjs_factory_name="ManifestLoader";var w=E.default.getClassFactory(i);w.MANIFEST_LOADER_ERROR_PARSING_FAILURE=T,w.MANIFEST_LOADER_ERROR_LOADING_FAILURE=S,t.default=w},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e){e&&(e.manifestModel&&(I=e.manifestModel),e.dashManifestModel&&(D=e.dashManifestModel))}function t(e){w=e,E=NaN,T=null,x=!1,S=!0,R=(0,f.default)(v).getInstance(),b.on(l.default.STREAMS_COMPOSED,y,this),b.on(l.default.PLAYBACK_STARTED,m,this),b.on(l.default.PLAYBACK_PAUSED,g,this),b.on(l.default.INTERNAL_MANIFEST_LOADED,h,this)}function n(e){d(e)}function r(){return w}function i(){b.off(l.default.PLAYBACK_STARTED,m,this),b.off(l.default.PLAYBACK_PAUSED,g,this),b.off(l.default.STREAMS_COMPOSED,y,this),b.off(l.default.INTERNAL_MANIFEST_LOADED,h,this),o(),S=!0,x=!1,E=NaN,R=null}function o(){null!==T&&(clearInterval(T),T=null)}function s(){o(),isNaN(E)||(_("Refresh manifest in "+E+" seconds."),T=setTimeout(c,1e3*E))}function u(){x=!0;var e=I.getValue(),t=e.url,n=D.getLocation(e);n&&(t=n),w.load(t)}function d(e){I.setValue(e);var t=new Date,n=(t.getTime()-e.loadedTime.getTime())/1e3;E=D.getManifestUpdatePeriod(e,n),b.trigger(l.default.MANIFEST_UPDATED,{manifest:e}),_("Manifest has been refreshed at "+t+"["+t.getTime()/1e3+"] "),S||s()}function c(){S&&!R.getScheduleWhilePaused()||x||u()}function h(e){e.error||d(e.manifest)}function m(){S=!1,s()}function g(){S=!0,o()}function y(){x=!1}var v=this.context,_=(0,p.default)(v).getInstance().log,b=(0,a.default)(v).getInstance(),E=void 0,T=void 0,S=void 0,x=void 0,w=void 0,I=void 0,D=void 0,R=void 0;return{initialize:t,setManifest:n,getManifestLoader:r,refreshManifest:u,setConfig:e,reset:i}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),a=r(o),s=n(2),l=r(s),u=n(0),d=r(u),c=n(4),f=r(c),h=n(3),p=r(h);i.__dashjs_factory_name="ManifestUpdater",t.default=d.default.getSingletonFactory(i)},function(e,t,n){function r(){window.removeEventListener("load",r),s.createAll()}function i(){window.dashjs&&(window.clearInterval(l),s.createAll())}Object.defineProperty(t,"__esModule",{value:!0});var o=n(49),a=function(e){return e&&e.__esModule?e:{default:e}}(o),s=function(){function e(e,t,n){if(!e||"VIDEO"!==e.nodeName)return null;if(e._dashjs_player)return e._dashjs_player;var i,o=e.id||e.name||"video element";if(!(t=t||[].slice.call(e.querySelectorAll("source")).filter(function(e){return e.type==r})[0])&&e.src)t=document.createElement("source"),t.src=e.src;else if(!t&&!e.src)return null;return n=n||{},i=(0,a.default)(n).create(),i.initialize(e,t.src,e.autoplay),i.getDebug().log("Converted "+o+" to dash.js player and added content: "+t.src),e._dashjs_player=i,i}function t(t,i){var o=[];t=t||"[data-dashjs-player]",i=i||document;for(var a=i.querySelectorAll(t),s=0;s<a.length;s++){var l=e(a[s],null);o.push(l)}for(var u=i.querySelectorAll('source[type="'+r+'"]'),d=0;d<u.length;d++){var c=n(u[d]),f=e(c,null);o.push(f)}return o}function n(e){return"video"===e.nodeName.toLowerCase()?e:n(e.parentNode)}var r="application/dash+xml";return{create:e,createAll:t}}(),l=void 0;!("undefined"!=typeof window&&window&&window.dashjs&&window.dashjs.skipAutoCreate)&&"undefined"!=typeof window&&window&&window.addEventListener&&("complete"===window.document.readyState?window.dashjs?s.createAll():l=window.setInterval(i,500):window.addEventListener("load",r)),t.default=s},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(e,t){ce=e,(me=t)&&($.on(O.default.KEY_ERROR,D,se),$.on(O.default.SERVER_CERTIFICATE_UPDATED,D,se),$.on(O.default.LICENSE_REQUEST_COMPLETE,D,se),$.on(O.default.KEY_SYSTEM_SELECTED,D,se),$.on(O.default.KEY_SESSION_CREATED,D,se))}function n(e){ue||($.on(O.default.CURRENT_TRACK_CHANGED,C,se),H(e),ue=!0)}function r(){for(var e=le.length,t=0;t<e;t++)le[t].reset();le=[],ue=!1,de=!1,E(),$.off(O.default.CURRENT_TRACK_CHANGED,C,se)}function i(){ye&&(ye.pause(),ye=null),_e&&(_e.reset(),_e=null),r(),ve=null,Ee=null,te=null,ee=null,ne=null,re=null,J=null,ie=null,he=!1,pe=!1,fe={},$.off(O.default.DATA_UPDATE_COMPLETED,z,se),$.off(O.default.BUFFERING_COMPLETED,K,se),$.off(O.default.KEY_ERROR,D,se),$.off(O.default.SERVER_CERTIFICATE_UPDATED,D,se),$.off(O.default.LICENSE_REQUEST_COMPLETE,D,se),$.off(O.default.KEY_SYSTEM_SELECTED,D,se),$.off(O.default.KEY_SESSION_CREATED,D,se)}function o(){return ce.duration}function s(){return ce.start}function u(){return ce.index}function c(){return ce.id}function h(){return ce}function m(e){return null!==V(e)}function y(e){var t=V(e);return Ee.getBitrateList(t)}function _(){be&&be.start()}function E(){be&&be.clear()}function S(){return ue}function w(){return pe}function D(e){e.error&&(ie.mediaKeySessionError(e.error),J(e.error),i())}function A(e){return"text"===e.type?e.mimeType:e.type}function M(e,t,n){var r,i,o=e.type;if("muxed"===o&&e)return i="Multiplexed representations are intentionally not supported, as they are not compliant with the DASH-AVC/264 guidelines",J(i),ie.manifestError(i,"multiplexedrep",ee.getValue()),!1;if("text"===o||"fragmentedText"===o||"embeddedText"===o)return!0;if(r=e.codec,J(o+" codec: "+r),e.contentProtection&&!re.supportsEncryptedMedia())ie.capabilityError("encryptedmedia");else if(!re.supportsCodec((0,v.default)(Z).getInstance().getElement(),r))return i=o+"Codec ("+r+") is not supported.",ie.manifestError(i,"codec",n),J(i),!1;return!0}function C(e){if(e.newMediaInfo.streamInfo.id===ce.id){var t=Y(e.oldMediaInfo);if(t){var n=ye.getTime(),r=t.getBuffer(),i=e.newMediaInfo,o=ee.getValue(),a=le.indexOf(t),s=t.getMediaSource();"fragmentedText"!==i.type?(t.reset(!0),B(i,o,s,{buffer:r,replaceIdx:a,currentTime:n}),ye.seek(ye.getTime())):t.updateMediaInfo(o,i)}}}function k(e){return"webm"===e.split("/")[1].toLowerCase()}function F(e){var t=k(e.mimeType)?(0,R.default)(Z).getInstance():(0,I.default)(Z).getInstance();return t.setConfig({baseURLController:ae,metricsModel:(0,b.default)(Z).getInstance()}),t.initialize(),(0,x.default)(Z).create({segmentBaseLoader:t,timelineConverter:oe,dashMetrics:(0,P.default)(Z).getInstance(),metricsModel:(0,b.default)(Z).getInstance(),baseURLController:ae})}function B(e,t,n,r){var i=(0,l.default)(Z).create({indexHandler:F(e),timelineConverter:oe,adapter:ne,manifestModel:ee}),o=ne.getAllMediaInfoForType(t,ce,e.type);if(i.initialize(A(e),_e,n,se,be),Ee.updateTopQualityIndex(e),r?(i.setBuffer(r.buffer),i.getIndexHandler().setCurrentTime(r.currentTime),le[r.replaceIdx]=i):le.push(i),"text"===e.type||"fragmentedText"===e.type){for(var a,s=0;s<o.length;s++)o[s].index===e.index&&(a=s),i.updateMediaInfo(t,o[s]);"fragmentedText"===e.type&&i.updateMediaInfo(t,o[a])}else i.updateMediaInfo(t,e);return i}function U(e,t){var n,r=ee.getValue(),i=ne.getAllMediaInfoForType(r,ce,e),o=null;if(!i||0===i.length)return void J("No "+e+" data.");for(var a=0,s=i.length;a<s;a++)if(o=i[a],"embeddedText"===e)Te.addEmbeddedTrack(o);else{if(!M(o,t,r))continue;ve.isMultiTrackSupportedByType(o.type)&&ve.addTrack(o,ce)}"embeddedText"!==e&&0!==ve.getTracksFor(e,ce).length&&(ve.checkInitialMediaSettingsForType(e,ce),n=ve.getCurrentTrackFor(e,ce),B(n,r,t))}function H(e){var t,n=ee.getValue();if(be=(0,f.default)(Z).getInstance(),be.initialize(),be.setConfig({manifestModel:ee,manifestUpdater:te}),t=ne.getEventsFor(n,ce),be.addInlineEvents(t),he=!0,U("video",e),U("audio",e),U("text",e),U("fragmentedText",e),U("embeddedText",e),U("muxed",e),G(),de=!0,he=!1,0===le.length){var r="No streams to play.";ie.manifestError(r,"nostreams",n),J(r)}else ge.initialize(oe,le[0]),q()}function q(){var e=le.length,t=!!fe.audio||!!fe.video,n=t?new Error(Q,"Data update failed",null):null,r=0;for(r;r<e;r++)if(le[r].isUpdating()||he)return;pe=!0,de&&(me&&me.initialize(ee.getValue(),V("audio"),V("video")),$.trigger(O.default.STREAM_INITIALIZED,{streamInfo:ce,error:n}))}function V(e){for(var t=le.length,n=null,r=0;r<t;r++)if(n=le[r],n.getType()===e)return n.getMediaInfo();return null}function G(){for(var e=0,t=le.length;e<t;e++)le[e].createBuffer()}function K(e){if(e.streamInfo===ce){var t=W(),n=t.length,r=0;for(r;r<n;r++)if(!t[r].isBufferingCompleted())return;$.trigger(O.default.STREAM_BUFFERING_COMPLETED,{streamInfo:ce})}}function z(e){var t=e.sender.getStreamProcessor();t.getStreamInfo()===ce&&(fe[t.getType()]=e.error,q())}function Y(e){return!!e&&W().filter(function(t){return t.getType()===e.type})[0]}function W(){var e,t,n=le.length,r=[],i=0;for(i;i<n;i++)t=le[i],"audio"!==(e=t.getType())&&"video"!==e&&"fragmentedText"!==e||r.push(t);return r}function X(e){J("Manifest updated... updating data system wide.");var t=ee.getValue();if(ue=!1,he=!0,pe=!1,ce=e,be){var n=ne.getEventsFor(t,ce);be.addInlineEvents(n)}for(var r=0,i=le.length;r<i;r++){var o=le[r],a=ne.getMediaInfoForType(t,ce,o.getType());Ee.updateTopQualityIndex(a),o.updateMediaInfo(t,a)}he=!1,q()}var Q=1,Z=this.context,J=(0,N.default)(Z).getInstance().log,$=(0,L.default)(Z).getInstance(),ee=e.manifestModel,te=e.manifestUpdater,ne=e.adapter,re=e.capabilities,ie=e.errHandler,oe=e.timelineConverter,ae=e.baseURLController,se=void 0,le=void 0,ue=void 0,de=void 0,ce=void 0,fe=void 0,he=void 0,pe=void 0,me=void 0,ge=void 0,ye=void 0,ve=void 0,_e=void 0,be=void 0,Ee=void 0,Te=void 0;return se={initialize:t,activate:n,deactivate:r,getDuration:o,getStartTime:s,getStreamIndex:u,getId:c,getStreamInfo:h,hasMedia:m,getBitrateListFor:y,startEventController:_,isActivated:S,isInitialized:w,updateData:X,reset:i,getProcessors:W},function(){le=[],ue=!1,de=!1,ce=null,fe={},he=!1,pe=!1,ge=(0,a.default)(Z).getInstance(),ye=(0,T.default)(Z).getInstance(),Ee=(0,g.default)(Z).getInstance(),ve=(0,d.default)(Z).getInstance(),_e=(0,p.default)(Z).create(),Te=(0,j.default)(Z).getInstance(),$.on(O.default.BUFFERING_COMPLETED,K,se),$.on(O.default.DATA_UPDATE_COMPLETED,z,se)}(),se}Object.defineProperty(t,"__esModule",{value:!0});var o=n(40),a=r(o),s=n(91),l=r(s),u=n(13),d=r(u),c=n(95),f=r(c),h=n(96),p=r(h),m=n(12),g=r(m),y=n(17),v=r(y),_=n(8),b=r(_),E=n(7),T=r(E),S=n(65),x=r(S),w=n(66),I=r(w),D=n(67),R=r(D),A=n(10),P=r(A),M=n(1),L=r(M),C=n(2),O=r(C),k=n(3),N=r(k),F=n(0),B=r(F),U=n(15),j=r(U);i.__dashjs_factory_name="Stream",t.default=B.default.getClassFactory(i)},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(e,t,n,r,i){ee=e,ne=r,re=i,le=t,J=ne.getStreamInfo().manifestInfo.isDynamic,Y.initialize(this),ie=(0,a.default)(z).getInstance(),ie.initialize(ee,this),oe=K(e),ae=(0,g.default)(z).create({metricsModel:(0,T.default)(z).getInstance(),manifestModel:Q,adapter:X,dashMetrics:(0,O.default)(z).getInstance(),dashManifestModel:(0,L.default)(z).getInstance(),timelineConverter:W,rulesController:(0,v.default)(z).getInstance(),mediaPlayerModel:(0,b.default)(z).getInstance()}),oe.initialize(ee,n,this),ae.initialize(ee,this),ue=(0,x.default)(z).create({metricsModel:(0,T.default)(z).getInstance(),errHandler:(0,B.default)(z).getInstance(),requestModifier:(0,I.default)(z).getInstance()}),de=ae.getFragmentModel(),de.setLoader(ue),se=(0,N.default)(z).create(),se.initialize(this)}function n(e){Y.reset(),oe&&(oe.reset(e),oe=null),ae&&(ae.reset(),ae=null),se&&(se.reset(),se=null),le=null,ue=null,re=null,ne=null,J=null,$=null,te=[],ee=null}function r(){return se.isUpdating()}function i(){return ee}function o(){return ie}function s(){return se}function u(){return ue}function c(){return Y}function h(){return le}function m(){return oe.getBuffer()}function y(e){oe.setBuffer(e)}function _(){return oe}function E(){return de}function S(){return ne?ne.getStreamInfo():null}function w(e,t){t===$||t&&$&&t.type!==$.type||($=t),-1===te.indexOf(t)&&te.push(t),X.updateData(e,this)}function D(){return te}function A(){return $}function M(){return oe.getMediaSource()}function C(){return ae}function k(){return re}function F(){ae.start()}function U(){ae.stop()}function j(){return X.getCurrentRepresentationInfo(Q.getValue(),se)}function H(e){return X.getRepresentationInfoForQuality(Q.getValue(),se,e)}function q(){return oe.getIsBufferingCompleted()}function V(){return oe.getBuffer()||oe.createBuffer($)}function G(){return J}function K(e){return"video"===e||"audio"===e||"fragmentedText"===e?(0,l.default)(z).create({metricsModel:(0,T.default)(z).getInstance(),manifestModel:Q,sourceBufferController:(0,R.default)(z).getInstance(),errHandler:(0,B.default)(z).getInstance(),streamController:(0,d.default)(z).getInstance(),mediaController:(0,f.default)(z).getInstance(),adapter:X,textSourceBuffer:(0,P.default)(z).getInstance()}):(0,p.default)(z).create({errHandler:(0,B.default)(z).getInstance(),sourceBufferController:(0,R.default)(z).getInstance()})}var z=this.context,Y=e.indexHandler,W=e.timelineConverter,X=e.adapter,Q=e.manifestModel,Z=void 0,J=void 0,$=void 0,ee=void 0,te=void 0,ne=void 0,re=void 0,ie=void 0,oe=void 0,ae=void 0,se=void 0,le=void 0,ue=void 0,de=void 0;return Z={initialize:t,isUpdating:r,getType:i,getBufferController:_,getABRController:o,getFragmentLoader:u,getFragmentModel:E,getScheduleController:C,getEventController:k,getFragmentController:h,getRepresentationController:s,getIndexHandler:c,getCurrentRepresentationInfo:j,getRepresentationInfoForQuality:H,isBufferingCompleted:q,createBuffer:V,getStreamInfo:S,updateMediaInfo:w,getMediaInfoArr:D,getMediaInfo:A,getMediaSource:M,getBuffer:m,setBuffer:y,start:F,stop:U,isDynamic:G,reset:n},function(){te=[]}(),Z}Object.defineProperty(t,"__esModule",{value:!0});var o=n(12),a=r(o),s=n(16),l=r(s),u=n(22),d=r(u),c=n(13),f=r(c),h=n(99),p=r(h),m=n(98),g=r(m),y=n(54),v=r(y),_=n(4),b=r(_),E=n(8),T=r(E),S=n(86),x=r(S),w=n(30),I=r(w),D=n(26),R=r(D),A=n(15),P=r(A),M=n(11),L=r(M),C=n(10),O=r(C),k=n(68),N=r(k),F=n(14),B=r(F),U=n(0),j=r(U);i.__dashjs_factory_name="StreamProcessor",t.default=j.default.getClassFactory(i)},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(e,t,n){var i=function(r,i){t.resolved=!0,t.resolvedContent=r||null,o.trigger(m.default.XLINK_ELEMENT_LOADED,{element:t,resolveObject:n,error:r||i?null:new a.default(v,"Failed loading Xlink element: "+e)})};if(e===r)i(null,!0);else{var l=new c.default(e,u.HTTPRequest.XLINK_TYPE);s.load({request:l,success:function(e){i(e)},error:function(){i(null)}})}}function n(){s&&(s.abort(),s=null)}var r="urn:mpeg:dash:resolve-to-zero:2013",i=this.context,o=(0,h.default)(i).getInstance(),s=(0,l.default)(i).create({errHandler:e.errHandler,metricsModel:e.metricsModel,requestModifier:e.requestModifier});return{load:t,reset:n}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(9),a=r(o),s=n(21),l=r(s),u=n(5),d=n(59),c=r(d),f=n(1),h=r(f),p=n(2),m=r(p),g=n(0),y=r(g),v=1;i.__dashjs_factory_name="XlinkLoader";var _=y.default.getClassFactory(i);_.XLINK_LOADER_ERROR_LOADING_FAILURE=v,t.default=_},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e){p.invalidateSelectedIndexes(e.entry)}function t(e){e.baseURLTreeModel&&(p=e.baseURLTreeModel),e.baseURLSelector&&(m=e.baseURLSelector)}function n(e){p.update(e),m.chooseSelectorFromManifest(e)}function r(e){var t=p.getForPath(e),n=t.reduce(function(e,t){var n=m.select(t);return n?(h.isRelative(n.url)?e.url=h.resolve(n.url,e.url):(e.url=n.url,e.serviceLocation=n.serviceLocation),e):new f.default},new f.default);if(!h.isRelative(n.url))return n}function i(){p.reset(),m.reset()}function o(e){n(e)}var s=void 0,u=this.context,c=(0,g.default)(u).getInstance(),h=(0,d.default)(u).getInstance(),p=void 0,m=void 0;return s={reset:i,initialize:o,resolve:r,setConfig:t},function(){p=(0,a.default)(u).create(),m=(0,l.default)(u).create(),c.on(v.default.SERVICE_LOCATION_BLACKLIST_CHANGED,e,s)}(),s}Object.defineProperty(t,"__esModule",{value:!0});var o=n(121),a=r(o),s=n(134),l=r(s),u=n(23),d=r(u),c=n(46),f=r(c),h=n(0),p=r(h),m=n(1),g=r(m),y=n(2),v=r(y);i.__dashjs_factory_name="BaseURLController",t.default=p.default.getSingletonFactory(i)},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(e){return!!(o.length&&e&&e.length)&&-1!==o.indexOf(e)}function n(e){-1===o.indexOf(e)&&(o.push(e),a.trigger(s,{entry:e}))}function r(e){e.error&&n(e.request.serviceLocation)}function i(){o=[]}var o=[],a=(0,l.default)(this.context).getInstance(),s=e.updateEventName,u=e.loadFailedEventName;return function(){u&&a.on(u,r,this)}(),{add:n,contains:t,reset:i}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),a=r(o),s=n(1),l=r(s);i.__dashjs_factory_name="BlackListController",t.default=a.default.getClassFactory(i)},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){R=!1,_={},b={},E={},T=null,S=100,x=S/1e3,D=(0,a.default)(g).getInstance()}function t(){null!==T&&R&&(clearInterval(T),T=null,R=!1)}function n(){y("Start Event Controller"),R||isNaN(S)||(R=!0,T=setInterval(s,S))}function r(e){if(_={},e)for(var t=0;t<e.length;t++){var n=e[t];_[n.id]=n,y("Add inline event with id "+n.id)}y("Added "+e.length+" inline events")}function i(e){for(var t=0;t<e.length;t++){var n=e[t];n.id in b?y("Repeated event with id "+n.id):(b[n.id]=n,y("Add inband event with id "+n.id))}}function o(){if(E)for(var e=D.getTime(),t=Object.keys(E),n=0;n<t.length;n++){var r=t[n],i=E[r];null!==i&&(i.duration+i.presentationTime)/i.eventStream.timescale<e&&(y("Remove Event "+r+" at time "+e),i=null,delete E[r])}}function s(){u(b),u(_),o()}function l(){var e=w.getValue(),t=e.url;e.hasOwnProperty("Location")&&(t=e.Location),y("Refresh manifest @ "+t),I.getManifestLoader().load(t)}function u(e){var t,n=D.getTime();if(e)for(var r=Object.keys(e),i=0;i<r.length;i++){var o=r[i],a=e[o];void 0!==a&&(0==(t=a.presentationTime/a.eventStream.timescale)||t<=n&&t+x>n)&&(y("Start Event "+o+" at "+n),a.duration>0&&(E[o]=a),a.eventStream.schemeIdUri==p&&a.eventStream.value==m?l():v.trigger(a.eventStream.schemeIdUri,{event:a}),delete e[o])}}function c(e){e&&(e.manifestModel&&(w=e.manifestModel),e.manifestUpdater&&(I=e.manifestUpdater))}function h(){t(),_=null,b=null,E=null,D=null}var p="urn:mpeg:dash:event:2012",m=1,g=this.context,y=(0,d.default)(g).getInstance().log,v=(0,f.default)(g).getInstance(),_=void 0,b=void 0,E=void 0,T=void 0,S=void 0,x=void 0,w=void 0,I=void 0,D=void 0,R=void 0;return{initialize:e,addInlineEvents:r,addInbandEvents:i,clear:t,start:n,setConfig:c,reset:h}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(7),a=r(o),s=n(0),l=r(s),u=n(3),d=r(u),c=n(1),f=r(c);i.__dashjs_factory_name="EventController",t.default=l.default.getSingletonFactory(i)},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e){var t=p[e];return t||(t=(0,u.default)(a).create({metricsModel:(0,c.default)(a).getInstance()}),p[e]=t),t}function t(e){return e&&e.type&&e.type===o.HTTPRequest.INIT_SEGMENT_TYPE}function n(){d.off(m.default.FRAGMENT_LOADING_COMPLETED,i,this);for(var e in p)p[e].reset();p={}}function r(e,t,n){var r=new s.default;return r.streamId=n,r.mediaInfo=t.mediaInfo,r.segmentType=t.type,r.start=t.startTime,r.duration=t.duration,r.end=r.start+r.duration,r.bytes=e,r.index=t.index,r.quality=t.quality,r}function i(e){if(p[e.request.mediaType]===e.sender){var n=e.sender.getScheduleController(),i=e.request,o=e.response,a=t(i),s=n.getStreamProcessor().getStreamInfo();if(!o||!s)return void l("No "+i.mediaType+" bytes to push or stream is inactive.");var u=r(o,i,s.id);d.trigger(a?m.default.INIT_FRAGMENT_LOADED:m.default.MEDIA_FRAGMENT_LOADED,{chunk:u,fragmentModel:e.sender})}}var a=this.context,l=(0,_.default)(a).getInstance().log,d=(0,h.default)(a).getInstance(),f=void 0,p=void 0;return f={getModel:e,isInitializationRequest:t,reset:n},function(){p={},d.on(m.default.FRAGMENT_LOADING_COMPLETED,i,f)}(),f}Object.defineProperty(t,"__esModule",{value:!0});var o=n(5),a=n(142),s=r(a),l=n(28),u=r(l),d=n(8),c=r(d),f=n(1),h=r(f),p=n(2),m=r(p),g=n(0),y=r(g),v=n(3),_=r(v);i.__dashjs_factory_name="FragmentController",t.default=y.default.getClassFactory(i)},function(e,t,n){function r(){function e(){var e="WebKitMediaSource"in window;return"MediaSource"in window?new MediaSource:e?new WebKitMediaSource:null}function t(e,t){var n=window.URL.createObjectURL(e);return t.setSource(n),n}function n(e){e.setSource(null)}function r(e,t){return e.duration!=t&&(e.duration=t),e.duration}function i(e){var t=e.sourceBuffers,n=t.length,r=0;if("open"===e.readyState){for(r;r<n;r++){if(t[r].updating)return;if(0===t[r].buffered.length)return}e.endOfStream()}}return{createMediaSource:e,attachMediaSource:t,detachMediaSource:n,setDuration:r,signalEndOfStream:i}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=function(e){return e&&e.__esModule?e:{default:e}}(i);r.__dashjs_factory_name="MediaSourceController",t.default=o.default.getSingletonFactory(r)},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(e,t){ye=e,Ce=t,Pe=(0,s.default)(ae).getInstance(),Me=(0,h.default)(ae).getInstance(),Le=(0,u.default)(ae).getInstance(),Oe=(0,U.default)(ae).getInstance(),ke=Ce.getFragmentController(),Ne=Ce.getBufferController(),ve=ke.getModel(ye),ve.setScheduleController(this),_e=Ce.isDynamic(),Ue=me.getScheduleWhilePaused(),Fe=(0,m.default)(ae).create({dashMetrics:(0,w.default)(ae).getInstance(),metricsModel:(0,E.default)(ae).getInstance(),textSourceBuffer:(0,_.default)(ae).getInstance()}),Be=(0,y.default)(ae).create({adapter:(0,D.default)(ae).getInstance(),sourceBufferController:(0,A.default)(ae).getInstance(),textSourceBuffer:(0,_.default)(ae).getInstance()}),he.getIsTextTrack(ye)&&le.on(k.default.TIMED_TEXT_REQUESTED,G,this),le.on(k.default.QUALITY_CHANGE_REQUESTED,v,this),le.on(k.default.DATA_UPDATE_STARTED,F,this),le.on(k.default.DATA_UPDATE_COMPLETED,T,this),le.on(k.default.FRAGMENT_LOADING_COMPLETED,P,this),le.on(k.default.STREAM_COMPLETED,R,this),le.on(k.default.STREAM_INITIALIZED,x,this),le.on(k.default.BUFFER_LEVEL_STATE_CHANGED,j,this),le.on(k.default.BUFFER_CLEARED,B,this),le.on(k.default.BYTES_APPENDED,O,this),le.on(k.default.INIT_REQUESTED,f,this),le.on(k.default.QUOTA_EXCEEDED,q,this),le.on(k.default.BUFFER_LEVEL_STATE_CHANGED,j,this),le.on(k.default.PLAYBACK_SEEKING,z,this),le.on(k.default.PLAYBACK_STARTED,K,this),le.on(k.default.PLAYBACK_RATE_CHANGED,Y,this),le.on(k.default.PLAYBACK_TIME_UPDATED,L,this),le.on(k.default.URL_RESOLUTION_FAILED,V,this),le.on(k.default.FRAGMENT_LOADING_ABANDONED,N,this)}function n(){be&&!Ne.getIsBufferingCompleted()&&(ie(),Te=!1,Ee?(Ee=!1,p(be.quality)):d(0),se("Schedule controller starting for "+ye))}function r(){Te||(Te=!0,clearTimeout(Re),se("Schedule controller stopping for "+ye))}function i(e,t){He[t]=He[t]||{};var n=Le.getTopQualityIndexFor(e,t);return He[t][e]!=n&&(se("Top quality"+e+" index has changed from "+He[t][e]+" to "+n),He[t][e]=n,!0)}function a(){if(!(Te||Ie||!Ne||Pe.isPaused()&&!Ue)){l();var e=Ve.length>0;if(e||i(be.mediaInfo.type,Ce.getStreamInfo().id)||Fe.execute(Ce,ye,Oe.isVideoTrackPresent())){var t=function(){if(be.quality!==qe)qe=be.quality,Ne.switchInitData(Ce.getStreamInfo().id,be.quality);else{var e=Ve.shift();if(ke.isInitializationRequest(e))p(e.quality);else{var t=Be.execute(Ce,e);t?ve.executeRequest(t):(Ie=!1,d(500))}}};Ie=!0,e?t():(Le.getPlaybackQuality(Ce),t())}else d(500)}}function l(){var e=1.5*be.fragmentDuration,t=ve.getRequests({state:S.default.FRAGMENT_MODEL_EXECUTED,time:Pe.getTime()+e,threshold:0})[0];t&&-1===Ve.indexOf(t)&&!he.getIsTextTrack(ye)&&(!Me.isCurrentTrack(t.mediaInfo)||me.getFastSwitchEnabled()&&t.quality<be.quality&&Ne.getBufferLevel()>=e&&Le.getAbandonmentStateFor(ye)!==u.default.ABANDON_LOAD?(g(t),se("Reloading outdated fragment at index: ",t.index)):t.quality>be.quality&&X(Pe.getTime()+Ne.getBufferLevel()))}function d(e){clearTimeout(Re),Re=setTimeout(a,e)}function f(e){e.sender.getStreamProcessor()===Ce&&p(be.quality)}function p(e){qe=e;var t=ce.getInitRequest(Ce,e);t&&(Ie=!0,ve.executeRequest(t))}function g(e){Ve.push(e)}function v(e){if(ye===e.mediaType&&Ce.getStreamInfo().id===e.streamInfo.id){if(null===(be=Ce.getRepresentationInfoForQuality(e.newQuality))||void 0===be)throw new Error("Unexpected error! - currentRepresentationInfo is null or undefined");re(new Date,o.PlayListTrace.REPRESENTATION_SWITCH_STOP_REASON),ie()}}function b(e){var t=ve.getRequests({state:S.default.FRAGMENT_MODEL_EXECUTED,time:Pe.getTime(),threshold:0})[0];t&&Pe.getTime()>=t.startTime&&(t.quality!==je&&e&&le.trigger(k.default.QUALITY_CHANGE_RENDERED,{mediaType:ye,oldQuality:je,newQuality:t.quality}),je=t.quality)}function T(e){e.error||e.sender.getStreamProcessor()!==Ce||(be=ce.convertDataToTrack(de.getValue(),e.currentRepresentation))}function x(e){e.error||Ce.getStreamInfo().id!==e.streamInfo.id||(be=Ce.getCurrentRepresentationInfo(),_e&&Ee&&(pe.setTimeSyncCompleted(!0),I()),Te&&n())}function I(){var e=(0,M.default)(ae).getInstance().getLiveEdge(),t=be.mediaInfo.streamInfo.manifestInfo.DVRWindowSize/2,n=e-Pe.computeLiveDelay(be.fragmentDuration,t),r=ce.getFragmentRequestForTime(Ce,be,n,{ignoreIsFinished:!0});Ae=Pe.getLiveStartTime(),(isNaN(Ae)||r.startTime>Ae)&&(Pe.setLiveStartTime(r.startTime),Ae=r.startTime);var i=fe.getCurrentManifestUpdate(ue.getMetricsFor("stream"));ue.updateManifestUpdateInfo(i,{currentTime:Ae,presentationStartTime:e,latency:e-Ae,clientTimeOffset:pe.getClientTimeOffset()})}function R(e){e.fragmentModel===ve&&(r(),Ie=!1,se("Stream is complete"))}function P(e){e.sender===ve&&(he.getIsTextTrack(ye)&&(Ie=!1),e.error&&e.request.serviceLocation&&!Te&&(g(e.request),Ie=!1,d(0)))}function L(){b(!0)}function O(e){e.sender.getStreamProcessor()===Ce&&(Ie=!1,d(0))}function N(e){e.streamProcessor===Ce&&(g(e.request),Ie=!1,d(0))}function F(e){e.sender.getStreamProcessor()===Ce&&r()}function B(e){e.sender.getStreamProcessor()===Ce&&(ve.removeExecutedRequestsBeforeTime(e.to),e.hasEnoughSpaceToAppend&&Te&&n())}function j(e){e.sender.getStreamProcessor()!==Ce||e.state!==c.default.BUFFER_EMPTY||Pe.isSeeking()||(se("Buffer is empty! Stalling!"),re(new Date,o.PlayListTrace.REBUFFERING_REASON))}function q(e){e.sender.getStreamProcessor()===Ce&&r()}function V(){ve.abortRequests(),r()}function G(e){e.sender.getStreamProcessor()===Ce&&p(e.index)}function K(){!Te&&Ue||n()}function z(e){Ae=e.seekTime,Z(0),Te&&n();var t=fe.getCurrentManifestUpdate(ue.getMetricsFor("stream")),r=be.DVRWindow?be.DVRWindow.end-Pe.getTime():NaN;ue.updateManifestUpdateInfo(t,{latency:r})}function Y(e){xe&&(xe.playbackspeed=e.playbackRate.toString())}function W(){return Ae}function X(e){Ae=e}function Q(){return ve}function Z(e){De=e}function J(){return De}function $(){return Ce}function ee(){return Fe.getBufferTarget(Ce,ye,Oe.isVideoTrackPresent())}function te(e){Se=e}function ne(e,t){re(e,t),Se=null}function re(e,t){if(Se&&!1===we){var n=xe.start,r=e.getTime()-n.getTime();xe.duration=r,xe.stopreason=t,Se.trace.push(xe),we=!0}}function ie(){Se&&!0===we&&be&&(we=!1,xe=new o.PlayListTrace,xe.representationid=be.id,xe.start=new Date,xe.mstart=1e3*Pe.getTime(),xe.playbackspeed=Pe.getPlaybackRate().toString())}function oe(){le.off(k.default.DATA_UPDATE_STARTED,F,this),le.off(k.default.DATA_UPDATE_COMPLETED,T,this),le.off(k.default.BUFFER_LEVEL_STATE_CHANGED,j,this),le.off(k.default.QUALITY_CHANGE_REQUESTED,v,this),le.off(k.default.FRAGMENT_LOADING_COMPLETED,P,this),le.off(k.default.STREAM_COMPLETED,R,this),le.off(k.default.STREAM_INITIALIZED,x,this),le.off(k.default.QUOTA_EXCEEDED,q,this),le.off(k.default.BYTES_APPENDED,O,this),le.off(k.default.BUFFER_CLEARED,B,this),le.off(k.default.INIT_REQUESTED,f,this),le.off(k.default.PLAYBACK_RATE_CHANGED,Y,this),le.off(k.default.PLAYBACK_SEEKING,z,this),le.off(k.default.PLAYBACK_STARTED,K,this),le.off(k.default.PLAYBACK_TIME_UPDATED,L,this),le.off(k.default.URL_RESOLUTION_FAILED,V,this),le.off(k.default.FRAGMENT_LOADING_ABANDONED,N,this),he.getIsTextTrack(ye)&&le.off(k.default.TIMED_TEXT_REQUESTED,G,this),r(),b(!1),Ie=!1,De=0,Ae=NaN,Pe=null,Se=null}var ae=this.context,se=(0,H.default)(ae).getInstance().log,le=(0,C.default)(ae).getInstance(),ue=e.metricsModel,de=e.manifestModel,ce=e.adapter,fe=e.dashMetrics,he=e.dashManifestModel,pe=e.timelineConverter,me=e.mediaPlayerModel,ge=void 0,ye=void 0,ve=void 0,_e=void 0,be=void 0,Ee=void 0,Te=void 0,Se=void 0,xe=void 0,we=void 0,Ie=void 0,De=void 0,Re=void 0,Ae=void 0,Pe=void 0,Me=void 0,Le=void 0,Ce=void 0,Oe=void 0,ke=void 0,Ne=void 0,Fe=void 0,Be=void 0,Ue=void 0,je=void 0,He=void 0,qe=void 0,Ve=void 0;return ge={initialize:t,getStreamProcessor:$,getSeekTarget:W,setSeekTarget:X,getFragmentModel:Q,setTimeToLoadDelay:Z,getTimeToLoadDelay:J,replaceRequest:g,start:n,stop:r,reset:oe,setPlayList:te,getBufferTarget:ee,finalisePlayList:ne},function(){Ee=!0,qe=NaN,je=NaN,He={},Ve=[],Te=!1,Se=null,xe=null,we=!0,Ie=!1,De=0,Ae=NaN}(),ge}Object.defineProperty(t,"__esModule",{value:!0});var o=n(60),a=n(7),s=r(a),l=n(12),u=r(l),d=n(16),c=r(d),f=n(13),h=r(f),p=n(132),m=r(p),g=n(133),y=r(g),v=n(15),_=r(v),b=n(8),E=r(b),T=n(28),S=r(T),x=n(10),w=r(x),I=n(19),D=r(I),R=n(26),A=r(R),P=n(40),M=r(P),L=n(1),C=r(L),O=n(2),k=r(O),N=n(0),F=r(N),B=n(22),U=r(B),j=n(3),H=r(j);i.__dashjs_factory_name="ScheduleController",t.default=F.default.getClassFactory(i)},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(e,t,n){T=e,o(t),S=n,x=S.getRepresentationController()}function n(e){try{E=m.createSourceBuffer(b,e),_||(E.hasOwnProperty("initialize")&&E.initialize(T,this),_=!0)}catch(e){g.mediaSourceError("Error creating "+T+" source buffer.")}return E}function r(){return E}function i(e){E=e}function o(e){b=e}function s(){return S}function u(e){p.off(l.default.DATA_UPDATE_COMPLETED,d,this),p.off(l.default.INIT_FRAGMENT_LOADED,c,this),e||(m.abort(b,E),m.removeSourceBuffer(b,E))}function d(e){e.sender.getStreamProcessor()===S&&p.trigger(l.default.TIMED_TEXT_REQUESTED,{index:0,sender:e.sender})}function c(e){e.fragmentModel===S.getFragmentModel()&&e.chunk.bytes&&m.append(E,e.chunk)}function f(){return v}var h=this.context,p=(0,a.default)(h).getInstance(),m=e.sourceBufferController,g=e.errHandler,y=void 0,v=void 0,_=void 0,b=void 0,E=void 0,T=void 0,S=void 0,x=void 0;return y={initialize:t,createBuffer:n,getBuffer:r,setBuffer:i,getStreamProcessor:s,getIsBufferingCompleted:f,setMediaSource:o,reset:u},function(){_=!1,b=null,E=null,T=null,S=null,x=null,v=!1,p.on(l.default.DATA_UPDATE_COMPLETED,d,this),p.on(l.default.INIT_FRAGMENT_LOADED,c,this)}(),y}Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),a=r(o),s=n(2),l=r(s),u=n(0),d=r(u);i.__dashjs_factory_name="TextController",t.default=d.default.getClassFactory(i)},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e,t){L=t,A=0,P=!1,M=!1,C={"urn:mpeg:dash:utc:http-head:2014":E,"urn:mpeg:dash:utc:http-xsdate:2014":b.bind(null,f),"urn:mpeg:dash:utc:http-iso:2014":b.bind(null,h),"urn:mpeg:dash:utc:direct:2014":_,"urn:mpeg:dash:utc:http-head:2012":E,"urn:mpeg:dash:utc:http-xsdate:2012":b.bind(null,f),"urn:mpeg:dash:utc:http-iso:2012":b.bind(null,h),"urn:mpeg:dash:utc:direct:2012":_,"urn:mpeg:dash:utc:http-ntp:2014":v,"urn:mpeg:dash:utc:ntp:2014":v,"urn:mpeg:dash:utc:sntp:2014":v},i()||(x(e),o(!0))}function t(e){e&&(e.metricsModel&&(O=e.metricsModel),e.dashMetrics&&(k=e.dashMetrics))}function n(){return u()}function r(e){P=e}function i(){return P}function o(e){M=e}function s(e){A=e}function u(){return A}function c(e){var t,n,r=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+\-])([0-9]{2})([0-9]{2}))?/,i=r.exec(e);return t=Date.UTC(parseInt(i[1],10),parseInt(i[2],10)-1,parseInt(i[3],10),parseInt(i[4],10),parseInt(i[5],10),i[6]&&(parseInt(i[6],10)||0),i[7]&&1e3*parseFloat(i[7])||0),i[9]&&i[10]&&(n=60*parseInt(i[9],10)+parseInt(i[10],10),t+=("+"===i[8]?-1:1)*n*60*1e3),new Date(t).getTime()}function f(e){var t=Date.parse(e);return isNaN(t)&&(t=c(e)),t}function h(e){return Date.parse(e)}function y(e){return Date.parse(e)}function v(e,t,n){n()}function _(e,t,n){var r=f(e);if(!isNaN(r))return void t(r);n()}function b(e,t,n,r,i){var o,a,s=!1,l=new XMLHttpRequest,u=i?"HEAD":"GET",d=t.match(/\S+/g);t=d.shift(),o=function(){s||(s=!0,d.length?b(e,d.join(" "),n,r,i):r())},a=function(){var t,r;200===l.status&&(t=i?l.getResponseHeader("Date"):l.response,r=e(t),isNaN(r)||(n(r),s=!0))},l.open(u,t),l.timeout=g||0,l.onload=a,l.onloadend=o,l.send()}function E(e,t,n){b(y,e,t,n,!0)}function T(){var e=O.getReadOnlyMetricsFor("stream"),t=k.getLatestMPDRequestHeaderValueByID(e,"Date"),n=null!==t?new Date(t).getTime():Number.NaN;isNaN(n)?S(!0):(s(n-(new Date).getTime()),S(!1,n/1e3,A))}function S(e,t,n){r(!1),R.trigger(d.default.TIME_SYNCHRONIZATION_COMPLETED,{time:t,offset:n,error:e?new a.default(m):null})}function x(e,t){var n=t||0,i=e[n],o=function(e,t){var n=!e||!t;n&&L?T():S(n,e,t)};r(!0),i?C.hasOwnProperty(i.schemeIdUri)?C[i.schemeIdUri](i.value,function(e){var t=(new Date).getTime(),n=e-t;s(n),D("Local time:      "+new Date(t)),D("Server time:     "+new Date(e)),D("Difference (ms): "+n),o(e,n)},function(){x(e,n+1)}):x(e,n+1):(s(0),o())}function w(){o(!1),r(!1)}var I=this.context,D=(0,p.default)(I).getInstance().log,R=(0,l.default)(I).getInstance(),A=void 0,P=void 0,M=void 0,L=void 0,C=void 0,O=void 0,k=void 0;return{initialize:e,getOffsetToDeviceTimeMs:n,setConfig:t,reset:w}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(9),a=r(o),s=n(1),l=r(s),u=n(2),d=r(u),c=n(0),f=r(c),h=n(3),p=r(h),m=1,g=5e3;i.__dashjs_factory_name="TimeSyncController";var y=f.default.getSingletonFactory(i);y.TIME_SYNC_FAILED_ERROR_CODE=m,y.HTTP_TIMEOUT_MS=g,t.default=y},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(e){D=e}function n(e){R=e}function r(e){var t;P=new p.default({escapeMode:!1,attributePrefix:"",arrayAccessForm:"property",emptyNodeForm:"object",stripWhitespaces:!1,enableToStringFunc:!1,ignoreRoot:!0,matchers:D}),A=e,t=c(A.Period_asArray,A,_,y),o(t,_,y)}function i(){x.off(d.default.XLINK_ELEMENT_LOADED,s,I),M&&(M.reset(),M=null)}function o(e,t,n){var r,i,o,a={};for(a.elements=e,a.type=t,a.resolveType=n,0===a.elements.length&&u(a),o=0;o<a.elements.length;o++)r=a.elements[o],i=w.isHTTPURL(r.url)?r.url:r.originalContent.BaseURL+r.url,M.load(i,r,a)}function s(e){var t,n,r,i="";t=e.element,n=e.resolveObject,t.resolvedContent&&(r=t.resolvedContent.indexOf(">")+1,i=t.resolvedContent.substr(0,r)+"<response>"+t.resolvedContent.substr(r)+"</response>",t.resolvedContent=P.xml_str2json(i)),m(n)&&u(n)}function u(e){var t,n,r=[];if(f(e),e.resolveType===v&&x.trigger(d.default.XLINK_READY,{manifest:A}),e.resolveType===y)switch(e.type){case _:for(t=0;t<A[_+"_asArray"].length;t++)n=A[_+"_asArray"][t],n.hasOwnProperty(b+"_asArray")&&(r=r.concat(c(n[b+"_asArray"],n,b,y))),n.hasOwnProperty(E+"_asArray")&&(r=r.concat(c(n[E+"_asArray"],n,E,y)));o(r,b,y);break;case b:x.trigger(d.default.XLINK_READY,{manifest:A})}}function c(e,t,n,r){var i,o,a,s=[];for(o=e.length-1;o>=0;o--)i=e[o],i.hasOwnProperty("xlink:href")&&i["xlink:href"]===T&&e.splice(o,1);for(o=0;o<e.length;o++)i=e[o],i.hasOwnProperty("xlink:href")&&i.hasOwnProperty("xlink:actuate")&&i["xlink:actuate"]===r&&(a=h(i["xlink:href"],t,n,o,r,i),s.push(a));return s}function f(e){var t,n,r,i,o,a,s=[];for(i=e.elements.length-1;i>=0;i--){if(t=e.elements[i],n=t.type+"_asArray",t.resolvedContent){if(t.resolvedContent)for(o=0;o<t.resolvedContent[n].length;o++)r=t.resolvedContent[n][o],s.push(r)}else delete t.originalContent["xlink:actuate"],delete t.originalContent["xlink:href"],s.push(t.originalContent);for(t.parentElement[n].splice(t.index,1),a=0;a<s.length;a++)t.parentElement[n].splice(t.index+a,0,s[a]);s=[]}e.elements.length>0&&R.run(A)}function h(e,t,n,r,i,o){return{url:e,parentElement:t,type:n,index:r,resolveType:i,originalContent:o,resolvedContent:null,resolved:!1}}function m(e){var t,n;for(t=0;t<e.elements.length;t++)if(n=e.elements[t],!1===n.resolved)return!1;return!0}var S=this.context,x=(0,l.default)(S).getInstance(),w=(0,g.default)(S).getInstance(),I=void 0,D=void 0,R=void 0,A=void 0,P=void 0,M=void 0;return I={resolveManifestOnLoad:r,setMatchers:t,setIron:n,reset:i},function(){x.on(d.default.XLINK_ELEMENT_LOADED,s,I),M=(0,a.default)(S).create({errHandler:e.errHandler,metricsModel:e.metricsModel,requestModifier:e.requestModifier})}(),I}Object.defineProperty(t,"__esModule",{value:!0});var o=n(92),a=r(o),s=n(1),l=r(s),u=n(2),d=r(u),c=n(0),f=r(c),h=n(31),p=r(h),m=n(23),g=r(m),y="onLoad",v="onActuate",_="Period",b="AdaptationSet",E="EventStream",T="urn:mpeg:dash:resolve-to-zero:2013";i.__dashjs_factory_name="XlinkController",t.default=f.default.getClassFactory(i)},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e){return i=(0,a.default)(r).getInstance({eventBus:e.eventBus,metricsModel:e.metricsModel}),(0,d.default)(r).create(e)}function t(){return(0,p.default)(r).getInstance()}function n(){return(0,f.default)(r).getInstance()}var r=this.context,i=void 0;return{createMetricsReporting:e,getReportingFactory:t,getMetricsHandlerFactory:n}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(113),a=r(o),s=n(27),l=r(s),u=n(103),d=r(u),c=n(50),f=r(c),h=n(51),p=r(h),m=n(0),g=r(m);i.__dashjs_factory_name="MetricsReporting";var y=g.default.getClassFactory(i);y.events=l.default,t.default=y},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(t){if(!t.error){var n=Object.keys(r);(0,l.default)(i).getInstance({dashManifestModel:e.dashManifestModel}).getMetrics(t.manifest).forEach(function(t){var o=JSON.stringify(t);if(r.hasOwnProperty(o))n.splice(o,1);else try{var s=(0,a.default)(i).create(e);s.initialize(t),r[o]=s}catch(e){}}),n.forEach(function(e){r[e].reset(),delete r[e]}),o.trigger(f.default.METRICS_INITIALISATION_COMPLETE)}}function n(){Object.keys(r).forEach(function(e){r[e].reset()}),r={}}var r={},i=this.context,o=e.eventBus;return function(){o.on(p.default.MANIFEST_UPDATED,t),o.on(p.default.STREAM_TEARDOWN_COMPLETE,n)}(),{}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(104),a=r(o),s=n(114),l=r(s),u=n(0),d=r(u),c=n(27),f=r(c),h=n(2),p=r(h);i.__dashjs_factory_name="MetricsCollectionController",t.default=d.default.getClassFactory(i)},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(t){try{o=(0,l.default)(a).create({mediaElement:e.mediaElement}),o.initialize(t.Range),i=(0,d.default)(a).create({log:e.log}),i.initialize(t.Reporting,o),r=(0,f.default)(a).create({log:e.log,eventBus:e.eventBus}),r.initialize(t.metrics,i)}catch(e){throw n(),e}}function n(){r&&r.reset(),i&&i.reset(),o&&o.reset()}var r=void 0,i=void 0,o=void 0,a=this.context;return{initialize:t,reset:n}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),a=r(o),s=n(106),l=r(s),u=n(107),d=r(u),c=n(105),f=r(c);i.__dashjs_factory_name="MetricsController",t.default=a.default.getClassFactory(i)},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(e){i.forEach(function(t){t.handleNewMetric(e.metric,e.value,e.mediaType)})}function n(e,n){e.split(",").forEach(function(e,t,r){var o;if(-1!==e.indexOf("(")&&-1===e.indexOf(")")){var a=r[t+1];a&&-1===a.indexOf("(")&&-1!==a.indexOf(")")&&(e+=","+a,delete r[t+1])}(o=u.create(e,n))&&i.push(o)}),l.on(d.default.METRIC_ADDED,t,o),l.on(d.default.METRIC_UPDATED,t,o)}function r(){l.off(d.default.METRIC_ADDED,t,o),l.off(d.default.METRIC_UPDATED,t,o),i.forEach(function(e){return e.reset()}),i=[]}var i=[],o=void 0,s=this.context,l=e.eventBus,u=(0,a.default)(s).getInstance({log:e.log,eventBus:e.eventBus});return o={initialize:n,reset:r}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(50),a=r(o),s=n(0),l=r(s),u=n(20),d=r(u);i.__dashjs_factory_name="MetricsHandlersController",t.default=l.default.getClassFactory(i)},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(e){e&&e.length&&(e.forEach(function(e){var t=e.starttime,n=t+e.duration;s.add(t,n)}),i=!!e[0]._useWallClockTime)}function n(){s.clear()}function r(){var e,t=s.length;if(!t)return!0;e=i?(new Date).getTime()/1e3:u.currentTime;for(var n=0;n<t;n+=1){var r=s.start(n),o=s.end(n);if(r<=e&&e<o)return!0}return!1}var i=!1,o=this.context,a=void 0,s=void 0,u=e.mediaElement;return a={initialize:t,reset:n,isEnabled:r},function(){s=(0,l.default)(o).create()}(),a}Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),a=r(o),s=n(57),l=r(s);i.__dashjs_factory_name="RangeController",t.default=a.default.getClassFactory(i)},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(e,t){e.some(function(e){var n=o.create(e,t);if(n)return i.push(n),!0})}function n(){i.forEach(function(e){return e.reset()}),i=[]}function r(e,t){i.forEach(function(n){return n.report(e,t)})}var i=[],o=(0,l.default)(this.context).getInstance({log:e.log});return{initialize:t,reset:n,report:r}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),a=r(o),s=n(51),l=r(s);i.__dashjs_factory_name="ReportingController",t.default=a.default.getClassFactory(i)},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){try{return Object.keys(h).map(function(e){return h[e]}).reduce(function(e,t){return e.level<t.level?e:t})}catch(e){return}}function t(){var t=e();t&&d!==t.t&&(d=t.t,o.report(s,t))}function n(e,n,r){n&&(a=f.validateN(r),o=n,s=f.reconstructFullMetricName(e,r),u=setInterval(t,a))}function r(){clearInterval(u),u=null,a=0,o=null,d=null}function i(e,t,n){"BufferLevel"===e&&(h[n]=t)}var o=void 0,a=void 0,s=void 0,u=void 0,d=void 0,c=this.context,f=(0,l.default)(c).getInstance(),h=[];return{initialize:n,reset:r,handleNewMetric:i}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),a=r(o),s=n(52),l=r(s);i.__dashjs_factory_name="BufferLevelHandler",t.default=a.default.getClassFactory(i)},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(){a.off(l.default.METRICS_INITIALISATION_COMPLETE,t,this),a.trigger(l.default.BECAME_REPORTING_PLAYER)}function n(e,n){n&&(o=n,a.on(l.default.METRICS_INITIALISATION_COMPLETE,t,this))}function r(){o=null}function i(e,t){"DVBErrors"===e&&o&&o.report(e,t)}var o=void 0,a=e.eventBus;return{initialize:n,reset:r,handleNewMetric:i}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),a=r(o),s=n(27),l=r(s);t.default=a.default.getClassFactory(i)},function(e,t,n){function r(){function e(e,t){r=e,i=t}function t(){i=null,r=void 0}function n(e,t){e===r&&i&&i.report(r,t)}var r=void 0,i=void 0;return{initialize:e,reset:t,handleNewMetric:n}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=function(e){return e&&e.__esModule?e:{default:e}}(i);r.__dashjs_factory_name="GenericMetricHandler",t.default=o.default.getClassFactory(r)},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){var e=d;e.length&&i&&i.report(s,e),d=[]}function t(t,n,r,l){n&&(o=c.validateN(r),i=n,l&&l.length&&(a=l),s=c.reconstructFullMetricName(t,r,l),u=setInterval(e,o))}function n(){clearInterval(u),u=null,o=null,a=null,d=[],i=null}function r(e,t){"HttpList"===e&&(a&&a!==t.type||d.push(t))}var i=void 0,o=void 0,a=void 0,s=void 0,u=void 0,d=[],c=(0,l.default)(this.context).getInstance();return{initialize:t,reset:n,handleNewMetric:r}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),a=r(o),s=n(52),l=r(s);i.__dashjs_factory_name="HttpListHandler",t.default=a.default.getClassFactory(i)},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e,t,n){var r=new XMLHttpRequest,i=function(){var e=m.indexOf(r);-1!==e&&(m.splice(e,1),r.status>=200&&r.status<300?t&&t():n&&n())};m.push(r);try{r.open("GET",e),r.onloadend=i,r.onerror=i,r.send()}catch(e){r.onerror()}}function t(t,n){Array.isArray(n)||(n=[n]),u&&h.isEnabled()&&n.forEach(function(n){var r=o.serialise(n);s&&"DVBErrors"!==t&&(r="metricname="+t+"&"+r),r=f+"?"+r,e(r,null,function(){u=!1})})}function n(e,t){var n;if(h=t,!(f=e["dvb:reportingUrl"]))throw new Error("required parameter missing (dvb:reportingUrl)");c||(n=e["dvb:probability"]||e["dvb:priority"]||0,n&&(1e3===n||n/1e3>=a.random())&&(u=!0),c=!0)}function r(){p||(m.forEach(function(e){return e.abort()}),m=[]),c=!1,u=!1,f=null,h=null}var i=this.context,o=(0,l.default)(i).getInstance(),a=(0,d.default)(i).getInstance(),s=!0,u=!1,c=!1,f=null,h=null,p=!0,m=[];return{report:t,initialize:n,reset:r}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),a=r(o),s=n(115),l=r(s),u=n(116),d=r(u);i.__dashjs_factory_name="DVBReporting",t.default=a.default.getClassFactory(i)},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(e){var t=new a.default;if(y){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.mpdurl||(t.mpdurl=y.originalUrl||y.url),t.terror||(t.terror=new Date),g.addDVBErrors(t)}}function n(e){e.error||(y=e.manifest)}function r(e){t({errorcode:a.default.BASE_URL_CHANGED,servicelocation:e.entry})}function i(){t({errorcode:a.default.BECAME_REPORTER})}function o(e){(0===e.responsecode||e.responsecode>=400||e.responsecode<100||e.responsecode>=600)&&t({errorcode:e.responsecode||a.default.CONNECTION_ERROR,url:e.url,terror:e.tresponse,servicelocation:e._serviceLocation})}function s(e){switch(e.metric){case"HttpList":o(e.value)}}function u(e){var n;switch(e.error?e.error.code:0){case MediaError.MEDIA_ERR_NETWORK:n=a.default.CONNECTION_ERROR;break;case MediaError.MEDIA_ERR_DECODE:n=a.default.CORRUPT_MEDIA_OTHER;break;default:return}t({errorcode:n})}function c(){m.on(l.default.MANIFEST_UPDATED,n,p),m.on(l.default.SERVICE_LOCATION_BLACKLIST_CHANGED,r,p),m.on(d.default.METRIC_ADDED,s,p),m.on(d.default.METRIC_UPDATED,s,p),m.on(d.default.PLAYBACK_ERROR,u,p),m.on(f.default.BECAME_REPORTING_PLAYER,i,p)}function h(){m.off(l.default.MANIFEST_UPDATED,n,p),m.off(l.default.SERVICE_LOCATION_BLACKLIST_CHANGED,r,p),m.off(d.default.METRIC_ADDED,s,p),m.off(d.default.METRIC_UPDATED,s,p),m.off(d.default.PLAYBACK_ERROR,u,p),m.off(f.default.BECAME_REPORTING_PLAYER,i,p)}var p=void 0,m=e.eventBus,g=e.metricsModel,y=void 0;return p={initialise:c,reset:h},c(),p}Object.defineProperty(t,"__esModule",{value:!0});var o=n(117),a=r(o),s=n(2),l=r(s),u=n(20),d=r(u),c=n(27),f=r(c),h=n(0),p=r(h);i.__dashjs_factory_name="DVBErrorsTranslator",t.default=p.default.getSingletonFactory(i)},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(e,t,n){var i,o,a=r.getMpd(e),s=0;return t?s=a.availabilityStartTime.getTime()/1e3:(i=this.getRegularPeriods(e,a),i.length&&(s=i[0].start)),o=s,n&&n.hasOwnProperty("starttime")&&(o+=n.starttime),o}function n(e){var n=[];return e.Metrics_asArray&&e.Metrics_asArray.forEach(function(i){var o=new a.default,s=r.getIsDynamic(e);i.hasOwnProperty("metrics")&&(o.metrics=i.metrics,i.Range_asArray&&i.Range_asArray.forEach(function(n){var i=new l.default;i.starttime=t(e,s,n),n.hasOwnProperty("duration")?i.duration=n.duration:i.duration=r.getDuration(e),i._useWallClockTime=s,o.Range.push(i)}),i.Reporting_asArray&&(i.Reporting_asArray.forEach(function(e){var t=new d.default;if(e.hasOwnProperty("schemeIdUri")){t.schemeIdUri=e.schemeIdUri;for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);o.Reporting.push(t)}}),n.push(o)))}),n}var r=e.dashManifestModel;return{getMetrics:n}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(118),a=r(o),s=n(119),l=r(s),u=n(120),d=r(u),c=n(0),f=r(c);i.__dashjs_factory_name="ManifestParsing",t.default=f.default.getSingletonFactory(i)},function(e,t,n){function r(){function e(t){var n,r,i=[],o=[];for(n in t)if(t.hasOwnProperty(n)&&0!==n.indexOf("_")){if(r=t[n],void 0!==r&&null!==r||(r=""),Array.isArray(r)){if(!r.length)continue;o=[],r.forEach(function(t){var n="Object"!==Object.prototype.toString.call(t).slice(8,-1);o.push(n?t:e(t))}),r=o.map(encodeURIComponent).join(",")}else"string"==typeof r?r=encodeURIComponent(r):r instanceof Date?r=r.toISOString():"number"==typeof r&&(r=Math.round(r));i.push(n+"="+r)}return i.join("&")}return{serialise:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=function(e){return e&&e.__esModule?e:{default:e}}(i);r.__dashjs_factory_name="MetricSerialiser",t.default=o.default.getSingletonFactory(r)},function(e,t,n){function r(){function e(){n&&(a||(a=new r(o)),n.getRandomValues(a),s=0)}function t(t,r){var o;return t||(t=0),r||(r=1),n?(s===a.length&&e(),o=a[s]/i,s+=1):o=Math.random(),o*(r-t)+t}var n=window.crypto||window.msCrypto,r=Uint32Array,i=Math.pow(2,8*r.BYTES_PER_ELEMENT)-1,o=10,a=void 0,s=void 0,l=void 0;return l={random:t},e(),l}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=function(e){return e&&e.__esModule?e:{default:e}}(i);r.__dashjs_factory_name="RNG",t.default=o.default.getSingletonFactory(r)},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){r(this,e),this.mpdurl=null,this.errorcode=null,this.terror=null,this.url=null,this.ipaddress=null,this.servicelocation=null};i.SSL_CONNECTION_FAILED_PREFIX="SSL",i.DNS_RESOLUTION_FAILED="C00",i.HOST_UNREACHABLE="C01",i.CONNECTION_REFUSED="C02",i.CONNECTION_ERROR="C03",i.CORRUPT_MEDIA_ISOBMFF="M00",i.CORRUPT_MEDIA_OTHER="M01",i.BASE_URL_CHANGED="F00",i.BECAME_REPORTER="S00",t.default=i},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){r(this,e),this.metrics="",this.Range=[],this.Reporting=[]};t.default=i},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){r(this,e),this.starttime=0,this.duration=1/0,this._useWallClockTime=!1};t.default=i},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){r(this,e),this.schemeIdUri="",this.value=""};t.default=i},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(){function e(e,t,n){var r=p.getBaseURLsFromElement(n);e[t]?m.areSimpleEquivalent(r,e[t].data.baseUrls)||(e[t].data.baseUrls=r,e[t].data.selectedIdx=f):e[t]=new h(r)}function t(t){var n=p.getBaseURLsFromElement(t);m.areSimpleEquivalent(n,d.data.baseUrls)||(d.data.baseUrls=n,d.data.selectedIdx=f),t.Period_asArray&&t.Period_asArray.forEach(function(t,n){e(d.children,n,t),t.AdaptationSet_asArray&&t.AdaptationSet_asArray.forEach(function(t,r){e(d.children[n].children,r,t),t.Representation_asArray&&t.Representation_asArray.sort(p.getRepresentationSortFunction()).forEach(function(t,i){e(d.children[n].children[r].children,i,t)})})})}function n(e,t){var r=t||d;e(r.data),r.children&&r.children.forEach(function(t){return n(e,t)})}function r(e){n(function(t){isNaN(t.selectedIdx)||e===t.baseUrls[t.selectedIdx].serviceLocation&&(t.selectedIdx=f)})}function i(e){t(e)}function o(){d=new h}function a(e){var t=d,n=[t.data];return e.forEach(function(e){(t=t.children[e])&&n.push(t.data)}),n.filter(function(e){return e.baseUrls.length})}var l=void 0,d=void 0,c=this.context,p=(0,s.default)(c).getInstance(),m=(0,u.default)(c).getInstance();return l={reset:o,update:i,getForPath:a,invalidateSelectedIndexes:r},function(){d=new h}(),l}Object.defineProperty(t,"__esModule",{value:!0});var a=n(11),s=r(a),l=n(138),u=r(l),d=n(0),c=r(d),f=NaN,h=function e(t,n){i(this,e),this.data={baseUrls:t||null,selectedIdx:n||f},this.children=[]};o.__dashjs_factory_name="BaseURLTreeModel",t.default=c.default.getClassFactory(o)},function(e,t,n){function r(){function e(e,t){var n=t.droppedVideoFrames-i;i=t.droppedVideoFrames;var a=t.totalVideoFrames-o;o=t.totalVideoFrames,r[e]?(r[e].droppedVideoFrames+=n,r[e].totalVideoFrames+=a):r[e]={droppedVideoFrames:n,totalVideoFrames:a}}function t(){return r}function n(e){r=[],i=e.droppedVideoFrames,o=e.totalVideoFrames}var r=[],i=0,o=0;return{push:e,getFrameHistory:t,reset:n}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=function(e){return e&&e.__esModule?e:{default:e}}(i);r.__dashjs_factory_name="DroppedFramesHistory";var a=o.default.getClassFactory(r);t.default=a},function(e,t,n){function r(){function e(e){r[e.oldValue]||(r[e.oldValue]={noDrops:0,drops:0,dropSize:0});var t=e.newValue-e.oldValue,n=t<0?1:0,o=n?-t:0,s=n?0:1;if(r[e.oldValue].drops+=n,r[e.oldValue].dropSize+=o,r[e.oldValue].noDrops+=s,i.push({idx:e.oldValue,noDrop:s,drop:n,dropSize:o}),i.length>a){var l=i.shift();r[l.idx].drops-=l.drop,r[l.idx].dropSize-=l.dropSize,r[l.idx].noDrops-=l.noDrop}}function t(){return r}function n(){r=[],i=[]}var r=[],i=[];return{push:e,getSwitchRequests:t,reset:n}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=function(e){return e&&e.__esModule?e:{default:e}}(i),a=8;r.__dashjs_factory_name="SwitchRequestHistory";var s=o.default.getClassFactory(r);t.default=s},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){m={},y={},v=[],_=(0,l.default)(h).getInstance(),b=(0,d.default)(h).getInstance(),E=(0,f.default)(h).getInstance()}function t(e,t){m[e]=m[e]||{},m[e][t]=m[e][t]||{}}function n(e,t){v[e]=v[e]||[],v[e].push(t)}function r(e){var r=e.getMediaInfo(),o=r.type,l=e.getCurrentRequest(),d=(0,a.default)(h).create(a.default.NO_CHANGE,{name:i.__dashjs_factory_name});if(!isNaN(l.index)){t(o,l.index);var f=_.getStableBufferTime();if(b.getCurrentBufferLevel(E.getReadOnlyMetricsFor(o))>f)return d;var g=m[o][l.index];if(null===g||null===l.firstByteDate||y.hasOwnProperty(g.id))return d;if(void 0===g.firstByteTime&&(v[o]=[],g.firstByteTime=l.firstByteDate.getTime(),g.segmentDuration=l.duration,g.bytesTotal=l.bytesTotal,g.id=l.index),g.bytesLoaded=l.bytesLoaded,g.elapsedTime=(new Date).getTime()-g.firstByteTime,g.bytesLoaded>0&&g.elapsedTime>0&&n(o,Math.round(8*g.bytesLoaded/g.elapsedTime)),v[o].length>=c&&g.elapsedTime>u&&g.bytesLoaded<g.bytesTotal){var T=v[o].reduce(function(e,t){return e+t},0);if(g.measuredBandwidthInKbps=Math.round(T/v[o].length),g.estimatedTimeOfDownload=+(8*g.bytesTotal/g.measuredBandwidthInKbps/1e3).toFixed(2),g.estimatedTimeOfDownload<g.segmentDuration*s||0===e.getTrackInfo().quality)return d;if(!y.hasOwnProperty(g.id)){var S=e.getStreamProcessor().getABRController(),x=g.bytesTotal-g.bytesLoaded,w=S.getBitrateList(r),I=S.getQualityForBitrate(r,g.measuredBandwidthInKbps*_.getBandwidthSafetyFactor());x>g.bytesTotal*w[I].bitrate/w[S.getQualityFor(o,r.streamInfo)].bitrate&&(d.value=I,d.reason.throughput=g.measuredBandwidthInKbps,d.reason.fragmentID=g.id,y[g.id]=g,p("AbandonRequestsRule ( ",o,"frag id",g.id,") is asking to abandon and switch to quality to ",I," measured bandwidth was",g.measuredBandwidthInKbps),delete m[o][g.id])}}else g.bytesLoaded===g.bytesTotal&&delete m[o][g.id]}return d}function o(){e()}var s=1.8,u=500,c=5,h=this.context,p=(0,g.default)(h).getInstance().log,m=void 0,y=void 0,v=void 0,_=void 0,b=void 0,E=void 0,T={shouldAbandon:r,reset:o};return e(),T}Object.defineProperty(t,"__esModule",{value:!0});var o=n(6),a=r(o),s=n(4),l=r(s),u=n(10),d=r(u),c=n(8),f=r(c),h=n(0),p=r(h),m=n(3),g=r(m);i.__dashjs_factory_name="AbandonRequestsRule",t.default=p.default.getClassFactory(i)},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(e,t,n){y[e]={index:t,quality:n}}function n(e,t,n){var r=y[e];return!r||t!==r.index||n<r.quality}function r(e){var r=e.getMediaInfo(),o=r.type,l=m.getReadOnlyMetricsFor(o),f=e.getCurrentRequest(),g=(0,a.default)(d).create(a.default.NO_CHANGE,{name:i.__dashjs_factory_name});if(0===l.BolaState.length)return c("WARNING: executing BolaAbandonRule before initializing BolaRule"),y[o]=null,g;var v=l.BolaState[0]._s,_=f.index,b=f.quality;if(isNaN(_)||0===b||!n(o,_,b)||!f.firstByteDate)return g;var E=Date.now(),T=E-f.firstByteDate.getTime(),S=f.bytesLoaded,x=f.bytesTotal,w=x-S,I=f.duration,D=h.getCurrentBufferLevel(l)?h.getCurrentBufferLevel(l):0,R=D+v.placeholderBuffer,A=8*S/(.001*T),P=v.bandwidthSafetyFactor*A,M=.001*(f.firstByteDate.getTime()-f.requestStartDate.getTime());M<.001*u&&(M=.001*u);var L=M+8*x/P,C="";p.default.BOLA_DEBUG&&(C="index="+_+" quality="+b+" bytesLoaded/bytesTotal="+S+"/"+x+" bufferLevel="+D+" timeSince1stByte="+(T/1e3).toFixed(3)+" estThroughput="+(P/1e6).toFixed(3)+" latency="+M.toFixed(3));var O=x*v.bitrates[0]/v.bitrates[b],k=w-M*P/8;if(k<1&&(k=1),T<s||w<=O||D>v.bufferTarget||k<=O||L<=I)return g;var N=R-M;N<0&&(N=0);for(var F=0;F+1<b&&x*v.bitrates[F+1]/v.bitrates[b]<k;)++F;var B=b;if(v.state===p.default.BOLA_STATE_STARTUP){B=0;for(var U=0;U<=F&&!(8*(O=x*v.bitrates[U]/v.bitrates[b])/I>P);++U)B=U}else for(var j=(v.Vp*(v.utilities[b]+v.gp)-N)/k,H=0;H<=F;++H){O=x*v.bitrates[H]/v.bitrates[b];var q=(v.Vp*(v.utilities[H]+v.gp)-N)/O;q>j&&(B=H,j=q)}var V=v.rebufferSafetyFactor*A*(D-M)/8;if(B===b&&k>V&&(B=F),B===b)return g;for(;B>0&&!((O=x*v.bitrates[B]/v.bitrates[b])<=V);)--B;var G=NaN;if(B>0){var K=v.utilities[B],z=v.utilities[B-1],Y=v.bitrates[B],W=v.bitrates[B-1];G=v.Vp*((Y*z-W*K)/(Y-W)+v.gp)}else{var X=v.utilities[0],Q=v.utilities[1],Z=v.bitrates[0],J=v.bitrates[1];G=v.Vp*((Z*Q-J*X)/(Z-J)+v.gp),G-=I}return R>G&&(v.placeholderBuffer=G-D,v.placeholderBuffer<0&&(v.placeholderBuffer=0)),v.lastQuality=B,m.updateBolaState(o,v),p.default.BOLA_DEBUG&&c("BolaDebug "+o+" BolaAbandonRule abandon to "+B+" - "+C),t(o,_,b),g.value=B,g.reason.state=v.state,g.reason.throughput=A,g.reason.bufferLevel=D,g.reason.bytesLoaded=f.bytesLoaded,g.reason.bytesTotal=f.bytesTotal,g.reason.elapsedTimeMs=T,g}function o(){y={}}var s=500,u=200,d=this.context,c=(0,f.default)(d).getInstance().log,h=e.dashMetrics,m=e.metricsModel,g=void 0,y=void 0,v=void 0;return g={shouldAbandon:r,reset:o},function(){y={},v=(0,l.default)(d).getInstance()}(),g}Object.defineProperty(t,"__esModule",{value:!0});var o=n(6),a=r(o),s=n(4),l=r(s),u=n(0),d=r(u),c=n(3),f=r(c),h=n(56),p=r(h);i.__dashjs_factory_name="BolaAbandonRule",t.default=d.default.getClassFactory(i)},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e){var o=e.getDroppedFramesHistory();if(o){for(var a=o.getFrameHistory(),s=0,u=0,d=l.default.NO_CHANGE,c=1;c<a.length;c++)if(a[c]&&(s=a[c].droppedVideoFrames,(u=a[c].totalVideoFrames)>i&&s/u>r)){d=c-1,n("DroppedFramesRule, index: "+d+" Dropped Frames: "+s+" Total Frames: "+u);break}return(0,l.default)(t).create(d,{droppedFrames:s})}return(0,l.default)(t).create()}var t=this.context,n=(0,d.default)(t).getInstance().log,r=.15,i=375;return{getMaxIndex:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),a=r(o),s=n(6),l=r(s),u=n(3),d=r(u);i.__dashjs_factory_name="DroppedFramesRule";var c=a.default.getClassFactory(i);t.default=c},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(e){var t=(new Date).getTime(),r=e.getMediaInfo().type,i=c.getReadOnlyMetricsFor(r),l=i.BufferState.length>0?i.BufferState[i.BufferState.length-1]:null,u=(0,g.default)(o).create();return t-m<y||null===l?u:(n(r,l.state),l.state===a.default.BUFFER_EMPTY&&void 0!==h[r].firstBufferLoadedEvent&&(s("Switch to index 0; buffer is empty."),u.value=0,u.reason="InsufficientBufferRule: Buffer is empty"),m=t,u)}function n(e,t){h[e]=h[e]||{},h[e].state=t,t!==a.default.BUFFER_LOADED||h[e].firstBufferLoadedEvent||(h[e].firstBufferLoadedEvent=!0)}function r(){h={}}function i(){u.off(d.default.PLAYBACK_SEEKING,r,f),h={},m=0}var o=this.context,s=(0,p.default)(o).getInstance().log,u=(0,l.default)(o).getInstance(),c=e.metricsModel,f=void 0,h=void 0,m=void 0,y=void 0;return f={getMaxIndex:t,reset:i},function(){h={},m=0,y=1e3,u.on(d.default.PLAYBACK_SEEKING,r,f)}(),f}Object.defineProperty(t,"__esModule",{value:!0});var o=n(16),a=r(o),s=n(1),l=r(s),u=n(2),d=r(u),c=n(0),f=r(c),h=n(3),p=r(h),m=n(6),g=r(m);i.__dashjs_factory_name="InsufficientBufferRule",t.default=f.default.getClassFactory(i)},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e){for(var o=e.getSwitchHistory(),a=o.getSwitchRequests(),s=0,l=0,u=0,c=(0,d.default)(t).create(),f=0;f<a.length;f++)if(void 0!==a[f]&&(s+=a[f].drops,l+=a[f].noDrops,u+=a[f].dropSize,s+l>=i&&s/l>r)){c.value=f>0?f-1:0,c.reason={index:c.value,drops:s,noDrops:l,dropSize:u},n("Switch history rule index: "+c.value+" samples: "+(s+l)+" drops: "+s);break}return c}var t=this.context,n=(0,l.default)(t).getInstance().log,r=.075,i=6;return{getMaxIndex:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),a=r(o),s=n(3),l=r(s),u=n(6),d=r(u);i.__dashjs_factory_name="SwitchRequest";var c=a.default.getClassFactory(i);t.default=c},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(){A=[],P=[],M=(0,d.default)(w).getInstance()}function n(e,t){A[e]=A[e]||[],A[e].push(t)}function r(e,t){if(P[e]||(P[e]=[]),P[e].push(t),P[e].length>_)return P[e].shift()}function i(e){var t=void 0;return P[e]&&P[e].length>0&&(t=P[e].reduce(function(e,t){return e+t})/P[e].length),t}function o(e,t){var n=Math.min(A[e].length,t?g:v),r=A[e].slice(-1*n,A[e].length);return r.length>1&&r.reduce(function(e,t){return(e*x<=t||e>=t*S)&&n++,t}),n=Math.min(A[e].length,n),A[e].slice(-1*n,A[e].length)}function s(e,t){var n=o(e,t),r=0;return n.length>0&&(r=n.reduce(function(e,t){return e+t},0)/n.length),A[e].length>=p&&A[e].shift(),r/1e3*M.getBandwidthSafetyFactor()}function u(e,t,n){var r=!1;if(e<T&&(r=!0),!r)switch(n){case"video":r=t<b;break;case"audio":r=t<E}return r}function f(e){var t=e.getMediaInfo(),o=t.type,d=R.getReadOnlyMetricsFor(o),f=e.getStreamProcessor(),h=f.getABRController(),p=f.isDynamic(),m=D.getCurrentHttpRequest(d),g=d.BufferState.length>0?d.BufferState[d.BufferState.length-1]:null,v=e.hasRichBuffer(),_=(0,y.default)(w).create();if(!d||!m||m.type!==c.HTTPRequest.MEDIA_SEGMENT_TYPE||!g||v)return _;var b=void 0,E=void 0;if(m.trace&&m.trace.length){E=m.tresponse.getTime()-m.trequest.getTime()||1,b=m._tfinish.getTime()-m.tresponse.getTime()||1;var T=m.trace.reduce(function(e,t){return e+t.b[0]},0),S=Math.round(8*T/(b/1e3)),x=void 0,M=void 0;u(E,b,o)?A[o]&&P[o]?(x=s(o,p),M=i(o)):(x=S/1e3,M=E):(n(o,S),x=s(o,p),r(o,E),M=i(o,p)),h.setAverageThroughput(o,x),h.getAbandonmentStateFor(o)!==l.default.ABANDON_LOAD&&(g.state===a.default.BUFFER_LOADED||p)&&(_.value=h.getQualityForBitrate(t,x,M),f.getScheduleController().setTimeToLoadDelay(0),I("ThroughputRule requesting switch to index: ",_.value,"type: ",o,"Average throughput",Math.round(x),"kbps"),_.reason={throughput:x,latency:M})}return _}function h(){t()}var p=20,g=3,v=4,_=v,b=50,E=5,T=50,S=1.3,x=1.3,w=this.context,I=(0,m.default)(w).getInstance().log,D=e.dashMetrics,R=e.metricsModel,A=void 0,P=void 0,M=void 0,L={getMaxIndex:f,reset:h};return t(),L}Object.defineProperty(t,"__esModule",{value:!0});var o=n(16),a=r(o),s=n(12),l=r(s),u=n(4),d=r(u),c=n(5),f=n(0),h=r(f),p=n(3),m=r(p),g=n(6),y=r(g);i.__dashjs_factory_name="ThroughputRule",t.default=h.default.getClassFactory(i)},function(e,t,n){function r(e){function t(e){var t,r=0;return e&&e.some(function(e,t){return r=t,!n.contains(e.serviceLocation)})&&(t=e[r]),t}var n=e.blacklistController;return{select:t}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=function(e){return e&&e.__esModule?e:{default:e}}(i);r.__dashjs_factory_name="BasicSelector",t.default=o.default.getClassFactory(r)},function(e,t,n){function r(e){function t(e){var t=[],n=function(e){return!t.length||!e.dvb_priority||-1===t.indexOf(e.dvb_priority)},r=function(e){return!i.contains(e.serviceLocation)||(e.dvb_priority&&t.push(e.dvb_priority),!1)};return e.filter(r).filter(n)}function n(e){var t,n,r=function(e,t){var n=e.dvb_priority-t.dvb_priority;return isNaN(n)?0:n},i=function(e,t,n){return!t||n[0].dvb_priority&&e.dvb_priority&&n[0].dvb_priority===e.dvb_priority},o=0,a=[],s=0;if(n=e.sort(r).filter(i),n.length)return n.length>1&&(n.forEach(function(e){o+=e.dvb_weight,a.push(o)}),t=Math.floor(Math.random()*(o-1)),a.every(function(e,n){return s=n,!(t<e)})),n[s]}function r(e){return e&&n(t(e))}var i=e.blacklistController;return{select:r}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=function(e){return e&&e.__esModule?e:{default:e}}(i);r.__dashjs_factory_name="DVBSelector",t.default=o.default.getClassFactory(r)},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(e,t,r){return i.getCurrentBufferLevel(o.getReadOnlyMetricsFor(t))<n(e,t,r)}function n(e,t,n){var r=NaN,a=e.getCurrentRepresentationInfo();if("fragmentedText"===t)r=s.getAllTracksAreDisabled()?0:a.fragmentDuration;else if("audio"===t&&n){var l=i.getCurrentBufferLevel(o.getReadOnlyMetricsFor("video"));r=Math.floor(Math.max(l,a.fragmentDuration))}else{var d=a.mediaInfo.streamInfo,c=e.getABRController();if(c.isPlayingAtTopQuality(d)){var f=d.manifestInfo.duration>=u.getLongFormContentDurationThreshold();r=f?u.getBufferTimeAtTopQualityLongForm():u.getBufferTimeAtTopQuality()}else r=u.getStableBufferTime()}return r}var r=this.context,i=e.dashMetrics,o=e.metricsModel,s=e.textSourceBuffer,u=void 0,d=void 0,c={execute:t,getBufferTarget:n};return function(){u=(0,a.default)(r).getInstance(),d=(0,l.default)(r).getInstance()}(),c}Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),a=r(o),s=n(7),l=r(s),u=n(0),d=r(u);i.__dashjs_factory_name="BufferLevelRule",t.default=d.default.getClassFactory(i)},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(e,t){var n=e.getCurrentRepresentationInfo(),a=n.mediaInfo,l=a.type,u=e.getScheduleController(),d=u.getSeekTarget(),c=!isNaN(d),f=e.getBuffer(),h=c?d:i.getIndexHandlerTime(e);if(isNaN(h)||"fragmentedText"===l&&s.getAllTracksAreDisabled())return null;if(c&&u.setSeekTarget(NaN),f){var p=o.getBufferRange(e.getBuffer(),h);null!==p&&(r("Prior to making a request for time, NextFragmentRequestRule is aligning index handler's currentTime with bufferedRange.end.",h," was changed to ",p.end),h=p.end)}var m=void 0;return t?(h=t.startTime+t.duration/2,m=i.getFragmentRequestForTime(e,n,h,{timeThreshold:0,ignoreIsFinished:!0})):(m=i.getFragmentRequestForTime(e,n,h,{keepIdx:!c}),m&&e.getFragmentModel().isFragmentLoaded(m)&&(m=i.getNextFragmentRequest(e,n)),m&&(i.setIndexHandlerTime(e,m.startTime+m.duration),m.delayLoadingTime=(new Date).getTime()+u.getTimeToLoadDelay(),u.setTimeToLoadDelay(0))),m}var n=this.context,r=(0,a.default)(n).getInstance().log,i=e.adapter,o=e.sourceBufferController,s=e.textSourceBuffer;return{execute:t}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(3),a=r(o),s=n(0),l=r(s);i.__dashjs_factory_name="NextFragmentRequestRule",t.default=l.default.getClassFactory(i)},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e){e.selector&&(y=e.selector)}function t(e){y=s.getIsDVB(e)?m:h}function n(e){var t=e.baseUrls,n=e.selectedIdx;if(!isNaN(n))return t[n];var r=y.select(t);return r?(e.selectedIdx=t.indexOf(r),r):void o.trigger(l.default.URL_RESOLUTION_FAILED,{error:new Error(_,b)})}function r(){c.reset()}var i=this.context,o=(0,a.default)(i).getInstance(),s=(0,d.default)(i).getInstance(),u=void 0,c=void 0,h=void 0,m=void 0,y=void 0;return u={chooseSelectorFromManifest:t,select:n,reset:r,setConfig:e},function(){c=(0,f.default)(i).create({updateEventName:l.default.SERVICE_LOCATION_BLACKLIST_CHANGED,loadFailedEventName:l.default.FRAGMENT_LOADING_COMPLETED}),h=(0,g.default)(i).create({blacklistController:c}),m=(0,p.default)(i).create({blacklistController:c}),y=h}(),u}Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),a=r(o),s=n(2),l=r(s),u=n(11),d=r(u),c=n(94),f=r(c),h=n(131),p=r(h),m=n(130),g=r(m),y=n(0),v=r(y),_=1,b="Failed to resolve a valid URL";i.__dashjs_factory_name="BaseURLSelector";var E=v.default.getClassFactory(i);E.URL_RESOLUTION_FAILED_GENERIC_ERROR_CODE=_,E.URL_RESOLUTION_FAILED_GENERIC_ERROR_MESSAGE=b,t.default=E},function(e,t,n){function r(){function e(){var e="WebKitMediaSource"in window,t="MediaSource"in window;return e||t}function t(){return o}function n(e){o=e}function r(e,t){var n=e.canPlayType(t);return"probably"===n||"maybe"===n}var i=void 0,o=void 0;return i={supportsMediaSource:e,supportsEncryptedMedia:t,supportsCodec:r,setEncryptedMediaSupported:n},function(){o=!1}(),i}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=function(e){return e&&e.__esModule?e:{default:e}}(i);r.__dashjs_factory_name="Capabilities",t.default=o.default.getSingletonFactory(r)},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(){return p}function n(e){p=e}function r(e,t){var n=!0,r=0,i=void 0,o=void 0;if(void 0===t&&(t=!1),e.tag>16777215?(h.getUint32(p)!==e.tag&&(n=!1),r=4):e.tag>65535?(i=h.getUint16(p),o=h.getUint8(p+2),256*i+o!==e.tag&&(n=!1),r=3):e.tag>255?(h.getUint16(p)!==e.tag&&(n=!1),r=2):(h.getUint8(p)!==e.tag&&(n=!1),r=1),!n&&e.required&&!t)throw new l.default("required tag not found");return n&&(p+=r),n}function i(e,t){var n=r(e,t);return n&&s(),n}function o(e){var t=void 0;return r(e),t=s(),f[e.parse](t)}function a(e,t){var n=r(e,t),i=void 0;return n&&(i=s(),p+=i),n}function s(e){var t=1,n=128,r=-1,i=0,o=h.getUint8(p),a=void 0;for(a=0;a<8;a+=1){if((o&n)===n){i=void 0===e?o&~n:o,r=a;break}n>>=1}for(a=0;a<r;a+=1,t+=1)i=i<<8|255&h.getUint8(p+t);return p+=t,i}function u(e){var t=void 0;switch(e){case 4:t=h.getFloat32(p),p+=4;break;case 8:t=h.getFloat64(p),p+=8}return t}function d(e){var t=0,n=void 0;for(n=0;n<e;n+=1)t<<=8,t|=255&h.getUint8(p+n);return p+=e,t}function c(){return p<h.byteLength}var f=void 0,h=new DataView(e.data),p=0;return f={getPos:t,setPos:n,consumeTag:r,consumeTagAndSize:i,parseTag:o,skipOverElement:a,getMatroskaCodedNum:s,getMatroskaFloat:u,getMatroskaUint:d,moreData:c}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),a=r(o),s=n(9),l=r(s);i.__dashjs_factory_name="EBMLParser",t.default=a.default.getClassFactory(i)},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e){return e&&u&&u.boxes&&0!==u.boxes.length?s(u.fetch(e)):null}function t(e){for(var t,n=u.fetchAll(e),r=[],i=0,o=n.length;i<o;i++)(t=s(n[i]))&&r.push(t);return r}function n(e){u=e}function r(){if(!u||!u.boxes||!u.boxes.length)return null;var e=u.boxes[u.boxes.length-1].type,n=t(e);return n[n.length-1]}function i(){return u._cursor.offset}function o(e,t,n){for(var r in n)t[r]=e[n[r]]}function s(e){if(!e)return null;var t,n,r=new a.default;switch(o(e,r,d),e.hasOwnProperty("_incomplete")&&(r.isComplete=!e._incomplete),r.type){case"sidx":if(o(e,r,c),r.references)for(t=0,n=r.references.length;t<n;t++)o(e.references[t],r.references[t],f);break;case"emsg":o(e,r,h);break;case"mdhd":o(e,r,p);break;case"mfhd":o(e,r,m);break;case"subs":o(e,r,g);break;case"tfhd":o(e,r,y);break;case"tfdt":o(e,r,v);break;case"trun":if(o(e,r,_),r.samples)for(t=0,n=r.samples.length;t<n;t++)o(e.samples[t],r.samples[t],b)}return r}var l=void 0,u=void 0,d=void 0,c=void 0,f=void 0,h=void 0,p=void 0,m=void 0,g=void 0,y=void 0,v=void 0,_=void 0,b=void 0;return l={getBox:e,getBoxes:t,setData:n,getLastBox:r,getOffset:i},function(){d={offset:"_offset",size:"size",type:"type"},c={references:"references",timescale:"timescale",earliest_presentation_time:"earliest_presentation_time",first_offset:"first_offset"},f={reference_type:"reference_type",referenced_size:"referenced_size",subsegment_duration:"subsegment_duration"},h={id:"id",value:"value",timescale:"timescale",scheme_id_uri:"scheme_id_uri",presentation_time_delta:"presentation_time_delta",event_duration:"event_duration",message_data:"message_data"},p={timescale:"timescale"},m={sequence_number:"sequence_number"},g={samples_with_subsamples:"samples_with_subsamples"},y={base_data_offset:"base_data_offset",sample_description_index:"sample_description_index",default_sample_duration:"default_sample_duration",default_sample_size:"default_sample_size",default_sample_flags:"default_sample_flags",flags:"flags"},v={version:"version",baseMediaDecodeTime:"baseMediaDecodeTime",flags:"flags"},_={sample_count:"sample_count",first_sample_flags:"first_sample_flags",data_offset:"data_offset",flags:"flags",samples:"samples"},b={sample_size:"sample_size",sample_duration:"sample_duration",sample_composition_time_offset:"sample_composition_time_offset"}}(),l}Object.defineProperty(t,"__esModule",{value:!0});var o=n(144),a=r(o),s=n(0),l=r(s);i.__dashjs_factory_name="IsoFile",t.default=l.default.getClassFactory(i)},function(e,t,n){function r(){function e(e,t){return JSON.stringify(e)===JSON.stringify(t)}return{areSimpleEquivalent:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=function(e){return e&&e.__esModule?e:{default:e}}(i);r.__dashjs_factory_name="ObjectUtils",t.default=o.default.getSingletonFactory(r)},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}function o(){function e(e){e&&e.videoModel&&(re=e.videoModel)}function t(e){return e.hasOwnProperty("begin")&&e.hasOwnProperty("end")?[c(e.begin),c(e.end)]:null}function n(){var e="cue_TTML_"+oe;return oe++,e}function r(e,t,n){function r(e,t){if(e.hasOwnProperty(t)){var n=e[t];o.indexOf(n)<0&&o.push(n)}}for(var i=[],o=[],a=[],s=0;s<e.length;s++){var l=e[s];r(l,"begin"),r(l,"end")}if(0===o.length)return a;if(void 0!==t&&void 0!==n){for(var u=0;u<o.length;u++){var d=c(o[u]);t<d&&d<n&&i.push(d)}i.push(t),i.push(n)}else for(var f=0;f<o.length;f++)i.push(c(o[f]));i.sort(function(e,t){return e-t});for(var h=0;h<i.length-1;h++)a.push([i[h],i[h+1]]);return a}function i(e,t){return"undefined"!=typeof startInterval&&e<t&&(e=t),e}function o(e,t){return void 0!==t&&e>t&&(e=t),e}function s(e,t,n){var r=c(e.begin),a=c(e.end);return r=i(r,t),a=o(a,n),void 0!==t&&void 0!==n&&(a<t||r>n)?(U("TTML: Cue "+r+"-"+a+" outside interval "+t+"-"+n),null):[r,a]}function l(e,n){var r=!0;if(e.hasOwnProperty("span")){var i=t(e.span);null!==i&&(r=i[0]<n[1]&&i[1]>n[0])}return r}function u(e,i,o,a){var u=void 0,d=void 0,c=void 0,f=void 0,h=void 0,p="";if(!(q=ie.xml_str2json(e)))throw new Error("TTML document could not be parsed");if(re.getTTMLRenderingDiv()&&(f="html"),!(u=q.tt))throw new Error("TTML document lacks tt element");var y=m(u,"http://www.w3.org/ns/ttml");if(y&&g(u,y),c=u["tts:extent"],!(d=u.head))throw new Error("TTML document lacks head element");d.layout&&(G=d.layout.region_asArray),d.styling&&(V=d.styling.style_asArray);var v={};if(a)for(h=0;h<a.length;h++){var _="urn:mpeg:14496-30:subs:"+(h+1).toString(),S="data:image/png;base64,"+btoa(a[h]);v[_]=S}if(d.metadata){var x=d.metadata.image_asArray;if(x)for(h=0;h<x.length;h++){var w="#"+x[h]["xml:id"],I=x[h].imagetype.toLowerCase(),D="data:image/"+I+";base64,"+x[h].__text;v[w]=D}}if(!u.body)throw new Error("TTML document lacks body element");var M=L(),F=re.getElement().clientWidth,B=re.getElement().clientHeight,j=[F/M[0],B/M[1]];X["font-size"]=j[1]+"px;";var H=[];if(G)for(h=0;h<G.length;h++)H.push(A(JSON.parse(JSON.stringify(G[h])),j));var W=m(q.tt,"http://www.w3.org/ns/ttml#parameter");u.hasOwnProperty(W+":frameRate")&&(u.frameRate=parseInt(u[W+":frameRate"],10));for(var Q=[],Z=u.body_asArray[0].__children,J=0;J<Z.length;J++){var $=Z[J].div,ee=null;if(null===(ee=t($))){var te=$.p_asArray;if(null===ee&&(!te||0===te.length))return p="TTML has div that contains no timing and no paragraphs.",U(p),Q;for(var ne=0;ne<te.length;ne++){var oe=te[ne],ae=oe.span_asArray,se=[];if(oe.hasOwnProperty("begin")&&oe.hasOwnProperty("end")){var le=s(oe,i,o);null!==le&&se.push(le)}else se=r(ae,i,o);if(0!==se.length)for(var ue=oe.__children,de=0;de<se.length;de++){for(var ce=se[de],fe=[],he=0;he<ue.length;he++){var pe=ue[he];l(pe,ce)&&fe.push(pe)}if(0!==fe.length)if("html"===f){z={},Y={},K={};var me=k(oe,$,j),ge=N(oe,j),ye=ge[1];ge=ge[0];var ve=document.createElement("div");ve.className=ye;var _e=O(fe,j);_e.className="cueDirUniWrapper",b("unicode-bidi",ge)&&(_e.style.cssText+=E("unicode-bidi",ge),T("unicode-bidi",ge)),b("direction",ge)&&(_e.style.cssText+=E("direction",ge),T("direction",ge)),b("padding-left",ge)&&b("padding-right",ge)&&(_e.innerHTML=C(_e,ge)),b("padding-left",ge)&&b("padding-right",ge)&&(T("padding-left",ge),T("padding-right",ge));var be="";if(b("regionID",me)){var Ee=E("regionID",me);be=Ee.slice(Ee.indexOf(":")+1,Ee.length-1)}ge&&(ve.style.cssText=ge.join(" ")+"display:flex;"),me&&(me=me.join(" ")),ve.appendChild(_e);var Te=document.createElement("div");Te.appendChild(ve),Te.id=n(),Te.style.cssText="position: absolute; margin: 0; display: flex; box-sizing: border-box; pointer-events: none;"+me,0===Object.keys(K).length&&(K.defaultFontSize="100"),Q.push({start:ce[0],end:ce[1],type:"html",cueHTMLElement:Te,regions:H,regionID:be,cueID:Te.id,videoHeight:B,videoWidth:F,cellResolution:M,fontSize:K||{defaultFontSize:"100"},lineHeight:z,linePadding:Y})}else{var Se="",xe=fe;xe.length&&xe.forEach(function(e){if(e.hasOwnProperty("span")){var t=e.span.__children;t.forEach(function(e){t.hasOwnProperty("metadata")||(e.hasOwnProperty("#text")?Se+=e["#text"].replace(/[\r\n]+/gm," ").trim():"br"in e&&(Se+="\n"))})}else e.hasOwnProperty("br")?Se+="\n":Se+=e["#text"].replace(/[\r\n]+/gm," ").trim()}),Q.push({start:ce[0],end:ce[1],data:Se,type:"text"})}}else p="TTML: Empty paragraph"}}else{var we=void 0;$.region&&(we=R(P(G,$.region),c)),we||(we=R($,c));var Ie=$["smpte:backgroundImage"];void 0!==Ie&&void 0!==v[Ie]&&Q.push({start:ee[0],end:ee[1],id:n(),data:v[Ie],type:"image",layout:we})}}if(""!==p&&U(p),Q.length>0)return Q;throw new Error(p)}function c(e){var t,n,r;if(!H.test(e))return NaN;if(t=e.split(":"),n=parseFloat(t[0])*h+parseFloat(t[1])*p+parseFloat(t[2]),t[3]){if(!(r=q.tt.frameRate)||isNaN(r))return NaN;n+=parseFloat(t[3])/r}return n}function m(e,t){var n=Object.keys(e).filter(function(n){return("xmlns"===n.split(":")[0]||"xmlns"===n.split(":")[1])&&e[n]===t}).map(function(e){return e.split(":")[2]||e.split(":")[1]});return 1!=n.length?null:n[0]}function g(e,t){for(var n in e)if(e.hasOwnProperty(n)){if(("object"===a(e[n])||e[n]instanceof Object)&&!Array.isArray(e[n]))g(e[n],t);else if(Array.isArray(e[n]))for(var r=0;r<e[n].length;r++)g(e[n][r],t);var i=t+":",o=n.indexOf(i);if(o>=0){var s=n.slice(o+i.length);e[s]=e[n],delete e[n]}}}function y(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function v(e){var t=e.slice(1),n=t.match(/.{2}/g),r=parseFloat(parseInt(parseInt(n[3],16)/255*1e3,10)/1e3);return"rgba("+n.slice(0,3).map(function(e){return parseInt(e,16)}).join(",")+","+r+");"}function _(e){var t=void 0,n=void 0;return t=e.replace(/^(rgb|rgba)\(/,"").replace(/\)$/,"").replace(/\s/g,"").split(","),n=parseInt(t[t.length-1],10)/255,"rgba("+t[0]+","+t[1]+","+t[2]+","+n+");"}function b(e,t){for(var n=0;n<t.length;n++)if(t[n].indexOf(e)>-1)return!0;return!1}function E(e,t){for(var n=0;n<t.length;n++)if(t[n].indexOf(e)>-1)return t[n];return null}function T(e,t){t.splice(t.indexOf(E(e,t)),1)}function S(e,t){for(var n=0;n<e.length;n++)for(var r=0;r<t.length;r++)e[n]&&e[n].split(":")[0].indexOf(t[r].split(":")[0])>-1&&e.splice(n,1);return e.concat(t)}function x(e){var t=new Array(2),n=-1===e.indexOf(":")?0:e.indexOf(":"),r=void 0;return-1===e.indexOf("%")?-1===e.indexOf("c")?-1===e.indexOf("p")?t[0]=t[1]=null:(t[0]="p",r=e.indexOf("p")):(t[0]="c",r=e.indexOf("c")):(t[0]="%",r=e.indexOf("%")),t[1]=e.slice(n,r),t}function w(e,t,n){var r,i,o=[];for(var a in e)if(e.hasOwnProperty(a)){var s=a.replace("ebutts:","");s=s.replace("xml:",""),s=s.replace("tts:",""),s=y(s),e[s]=e[a],delete e[a]}if("line-padding"in e){var l=parseFloat(e["line-padding"].slice(e["line-padding"].indexOf(":")+1,e["line-padding"].indexOf("c")));"id"in e&&(Y[e.id]=l);var u=l*t[0]+"px;";o.push("padding-left:"+u),o.push("padding-right:"+u)}if("font-size"in e){var d=x(e["font-size"]),c=parseFloat(d[1]);"id"in e&&(K[e.id]=d),"%"===d[0]?r=c/100*t[1]+"px;":"c"===d[0]&&(r=c*t[1]+"px;"),o.push("font-size:"+r)}if("line-height"in e)if("normal"===e["line-height"])o.push("line-height: normal;");else{var f=x(e["line-height"]),h=parseFloat(f[1]);"id"in e&&(z[e.id]=f),"%"===f[0]?i=h/100*t[1]+"px;":"c"===f[0]&&(i=h*t[1]+"px;"),o.push("line-height:"+i)}"font-family"in e&&(e["font-family"]in Q?o.push(Q[e["font-family"]]):o.push("font-family:"+e["font-family"]+";")),"text-align"in e&&e["text-align"]in Z&&(o.push(Z[e["text-align"]][0]),o.push(Z[e["text-align"]][1])),"multi-row-align"in e&&(b("text-align",o)&&"auto"!=e["multi-row-align"]&&T("text-align",o),e["multi-row-align"]in J&&o.push(J[e["multi-row-align"]]));var p;return"background-color"in e&&(p=e["background-color"].indexOf("#")>-1&&e["background-color"].length-1==8?v(e["background-color"]):e["background-color"].indexOf("rgba")>-1?_(e["background-color"]):e["background-color"]+";",o.push("background-color: "+p)),"color"in e&&(p=e.color.indexOf("#")>-1&&e.color.length-1==8?v(e.color):e.color.indexOf("rgba")>-1?_(e.color):e.color+";",o.push("color: "+p)),"wrap-option"in e&&(e["wrap-option"]in $?o.push($[e["wrap-option"]]):o.push("white-space:"+e["wrap-option"])),"unicode-bidi"in e&&(e["unicode-bidi"]in ee?o.push(ee[e["unicode-bidi"]]):o.push("unicode-bidi:"+e["unicode-bidi"])),"font-style"in e&&o.push("font-style:"+e["font-style"]+";"),"font-weight"in e&&o.push("font-weight:"+e["font-weight"]+";"),"direction"in e&&o.push("direction:"+e.direction+";"),"text-decoration"in e&&o.push("text-decoration:"+e["text-decoration"]+";"),n&&(o=o.concat(A(e,t))),q.tt.hasOwnProperty("xml:space")&&"preserve"===q.tt["xml:space"]&&o.push("white-space: pre;"),o}function I(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(r["xml:id"]===t||r.id===t)return r}return null}function D(e,t,n){var r=[];return e.match(/\S+/g).forEach(function(e){var i=I(V,e);if(i){var o=w(JSON.parse(JSON.stringify(i)),t,n);r=r.concat(o)}}),r}function R(e,t){var n=/([\d\.]+)(%|px)\s+([\d\.]+)(%|px)/;if("tts:extent"in e&&"tts:origin"in e){var r=n.exec(e["tts:extent"]),i=n.exec(e["tts:origin"]);if(null===r||null===i)return U("Bad extent or origin: "+e["tts:extent"]+" "+e["tts:origin"]),null;var o=parseFloat(r[1]),a=parseFloat(r[3]),s=parseFloat(i[1]),l=parseFloat(i[3]);if(t){var u=n.exec(t);if(null===u||"px"!==u[2]||"px"!==u[4])return U("Bad tt.extent: "+t),null;var d=parseFloat(u[1]),c=parseFloat(u[3]);"px"===r[2]&&(o=o/d*100),"px"===r[4]&&(a=a/c*100),"px"===i[2]&&(s=s/d*100),"px"===i[4]&&(l=l/c*100)}return{left:s,top:l,width:o,height:a}}return null}function A(e,t){var n=[];for(var r in e){var i=r.replace("tts:","");i=i.replace("xml:",""),i=y(i),e[i]=e[r],i!==r&&delete e[r]}if("extent"in e){var o=e.extent.split(/\s/);n.push("width: "+o[0]+";"),n.push("height: "+o[1]+";")}if("origin"in e){var a=e.origin.split(/\s/);n.push("left: "+a[0]+";"),n.push("top: "+a[1]+";")}if("display-align"in e&&n.push(te[e["display-align"]]),"writing-mode"in e&&n.push(ne[e["writing-mode"]]),"style"in e){var s=D(e.style,t,!0);n=n.concat(s)}return"padding"in e&&n.push("padding:"+e.padding+";"),"overflow"in e&&n.push("overflow:"+e.overflow+";"),"show-background"in e&&n.push("show-background:"+e["show-background"]+";"),"id"in e&&n.push("regionID:"+e.id+";"),n}function P(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(r["xml:id"]===t||r.id===t)return r}return null}function M(e,t){var n=[];return e.match(/\S+/g).forEach(function(e){var r=P(G,e);if(r){var i=A(JSON.parse(JSON.stringify(r)),t);n=n.concat(i)}}),n}function L(){var e=[32,15];return q.tt.hasOwnProperty("ttp:cellResolution")?q.tt["ttp:cellResolution"].split(" ").map(parseFloat):e}function C(e,t){for(var n=E("padding-left",t),r=E("padding-right",t),i=n.concat(" "+r+" "),o="",a="",s="",l=Array.prototype.slice.call(e.children),u=e.getElementsByClassName("lineBreak")[0],d=l.indexOf(u),c=[];-1!=d;)c.push(d),d=l.indexOf(u,d+1);var f="<br>",h='<span class="spanPadding" style="-webkit-box-decoration-break: clone; box-decoration-break: clone; ';if(c.length)c.forEach(function(e,t){if(0===t){for(var n="",r=0;r<e;r++)o+=l[r].outerHTML,0===r&&(n=i.concat(l[r].style.cssText));o=h+n+'">'+o}for(var u="",d=e+1;d<l.length;d++)a+=l[d].outerHTML,d===l.length-1&&(u+=i.concat(l[d].style.cssText));a=h+u+'">'+a,o&&a&&t===c.length-1?s+=o+"</span>"+f+a+"</span>":o&&a&&t!==c.length-1?s+=o+"</span>"+f+a+"</span>"+f:o&&!a?s+=o+"</span>":!o&&a&&t===c.length-1?s+=a+"</span>":!o&&a&&t!==c.length-1&&(s+=a+"</span>"+f)});else{for(var p="",m=0;m<l.length;m++)p+=l[m].style.cssText;s=h+i+p+'">'+e.innerHTML+"</span>"}return s}function O(e,t){var n=document.createElement("div");return e.forEach(function(e){if(!e.hasOwnProperty("metadata"))if(e.hasOwnProperty("span")){var r=e.span.__children,i=document.createElement("span");if(e.span.hasOwnProperty("style")){var o=D(e.span.style,t);i.className="spanPadding "+e.span.style,i.style.cssText=o.join(" ")}r.forEach(function(e){if(!r.hasOwnProperty("metadata"))if(e.hasOwnProperty("#text")){var t=document.createTextNode(e["#text"]);i.appendChild(t)}else if("br"in e){i.hasChildNodes()&&n.appendChild(i);var o=document.createElement("br");o.className="lineBreak",n.appendChild(o);var a=document.createElement("span");a.className=i.className,a.style.cssText=i.style.cssText,i=a}}),n.appendChild(i)}else if(e.hasOwnProperty("br")){var a=document.createElement("br");a.className="lineBreak",n.appendChild(a)}else if(e.hasOwnProperty("#text")){var s=document.createElement("span");s.textContent=e["#text"],n.appendChild(s)}}),n}function k(e,t,n){var r,i,o=[],a=e.region,s=t.region;return s&&(r=M(s,n)),a?(i=o.concat(M(a,n)),o=r?S(r,i):i):r&&(o=r),F(o,W),o}function N(e,t){var n,r,i,o=[],a=e.style,s=q.tt.body.style,l=q.tt.body.div.style,u="";return s&&(n=D(s,t),u="paragraph "+s),l&&(r=D(l,t),n?(r=S(n,r),u+=" "+l):u="paragraph "+l),a?(i=D(a,t),n&&r?(o=S(r,i),u+=" "+a):n?(o=S(n,i),u+=" "+a):r?(o=S(r,i),u+=" "+a):(o=i,u="paragraph "+a)):n&&!r?o=n:!n&&r&&(o=r),F(o,X),[o,u]}function F(e,t){for(var n in t)t.hasOwnProperty(n)&&(b(n,e)||e.push(n+":"+t[n]))}var B=this.context,U=(0,f.default)(B).getInstance().log,j=void 0,H=void 0,q=void 0,V=void 0,G=void 0,K=void 0,z=void 0,Y=void 0,W=void 0,X=void 0,Q=void 0,Z=void 0,J=void 0,$=void 0,ee=void 0,te=void 0,ne=void 0,re=void 0,ie=void 0,oe=0;return j={parse:u,setConfig:e},function(){H=/^([0-9][0-9]+):([0-5][0-9]):([0-5][0-9])|(60)(\.([0-9])+)?$/,K={},z={},Y={},W={top:"auto;",left:"auto;",width:"90%;",height:"10%;","align-items":"flex-start;",overflow:"visible;","-ms-writing-mode":"lr-tb, horizontal-tb;","-webkit-writing-mode":"horizontal-tb;","-moz-writing-mode":"horizontal-tb;","writing-mode":"horizontal-tb;"},X={color:"rgb(255,255,255);",direction:"ltr;","font-family":"monospace, sans-serif;","font-style":"normal;","line-height":"normal;","font-weight":"normal;","text-align":"start;","justify-content":"flex-start;","text-decoration":"none;","unicode-bidi":"normal;","white-space":"normal;",width:"100%;"},Q={monospace:"font-family: monospace;",sansSerif:"font-family: sans-serif;",serif:"font-family: serif;",monospaceSansSerif:"font-family: monospace, sans-serif;",monospaceSerif:"font-family: monospace, serif;",proportionalSansSerif:"font-family: Arial;",proportionalSerif:"font-family: Times New Roman;",default:"font-family: monospace, sans-serif;"},Z={right:["justify-content: flex-end;","text-align: right;"],start:["justify-content: flex-start;","text-align: start;"],center:["justify-content: center;","text-align: center;"],end:["justify-content: flex-end;","text-align: end;"],left:["justify-content: flex-start;","text-align: left;"]},J={start:"text-align: start;",center:"text-align: center;",end:"text-align: end;",auto:""},$={wrap:"white-space: normal;",noWrap:"white-space: nowrap;"},ee={normal:"unicode-bidi: normal;",embed:"unicode-bidi: embed;",bidiOverride:"unicode-bidi: bidi-override;"},te={before:"align-items: flex-start;",center:"align-items: center;",after:"align-items: flex-end;"},ne={lrtb:"-webkit-writing-mode: horizontal-tb;writing-mode: horizontal-tb;",rltb:"-webkit-writing-mode: horizontal-tb;writing-mode: horizontal-tb;direction: rtl;unicode-bidi: bidi-override;",tbrl:"-webkit-writing-mode: vertical-rl;writing-mode: vertical-rl;-webkit-text-orientation: upright;text-orientation: upright;",tblr:"-webkit-writing-mode: vertical-lr;writing-mode: vertical-lr;-webkit-text-orientation: upright;text-orientation: upright;",lr:"-webkit-writing-mode: horizontal-tb;writing-mode: horizontal-tb;",rl:"-webkit-writing-mode: horizontal-tb;writing-mode: horizontal-tb;direction: rtl;",tb:"-webkit-writing-mode: vertical-rl;writing-mode: vertical-rl;-webkit-text-orientation: upright;text-orientation: upright;"},ie=new d.default({escapeMode:!1,attributePrefix:"",arrayAccessForm:"property",emptyNodeForm:"object",stripWhitespaces:!1,enableToStringFunc:!1,matchers:[]})}(),j}Object.defineProperty(t,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==r(Symbol.iterator)?function(e){return void 0===e?"undefined":r(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":r(e)},s=n(0),l=i(s),u=n(31),d=i(u),c=n(3),f=i(c),h=3600,p=60;o.__dashjs_factory_name="TTMLParser",t.default=l.default.getSingletonFactory(o)},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e){var r,o,s=[];e=e.split(u),r=e.length,o=-1;for(var l=0;l<r;l++){var f=e[l];if(f.length>0&&"WEBVTT"!==f&&f.match(d)){var h=n(f),p=h.cuePoints,m=h.styles,g=i(e,l+1),y=t(p[0].replace(c,"")),v=t(p[1].replace(c,""));!isNaN(y)&&!isNaN(v)&&y>=o&&v>y?""!==g?(o=y,s.push({start:y,end:v,data:g,styles:m})):a("Skipping cue due to empty/malformed cue text"):a("Skipping cue due to incorrect cue timing")}}return s}function t(e){var t=e.split(":"),n=t.length-1;return e=60*parseInt(t[n-1],10)+parseFloat(t[n]),2===n&&(e+=3600*parseInt(t[0],10)),e}function n(e){var t=e.split(d),n=t[1].split(f);return n.shift(),t[1]=n[0],n.shift(),{cuePoints:t,styles:r(n)}}function r(e){var t={};return e.forEach(function(e){if(e.split(/:/).length>1){var n=e.split(/:/)[1];n&&-1!=n.search(/%/)&&(n=parseInt(n.replace(/%/,""),10)),(e.match(/align/)||e.match(/A/))&&(t.align=n),(e.match(/line/)||e.match(/L/))&&(t.line=n),(e.match(/position/)||e.match(/P/))&&(t.position=n),(e.match(/size/)||e.match(/S/))&&(t.size=n)}}),t}function i(e,t){for(var n,r=t,i="",o="";""!==e[r]&&r<e.length;)r++;if((n=r-t)>1)for(var a=0;a<n;a++){if(o=e[t+a],o.match(d)){i="";break}i+=o,a!==n-1&&(i+="\n")}else o=e[t],o.match(d)||(i=o);return decodeURI(i)}var o=this.context,a=(0,l.default)(o).getInstance().log,s=void 0,u=void 0,d=void 0,c=void 0,f=void 0;return s={parse:e},function(){u=/(?:\r\n|\r|\n)/gm,d=/-->/,c=/(^[\s]+|[\s]+$)/g,f=/\s\b/g}(),s}Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),a=r(o),s=n(3),l=r(s);i.__dashjs_factory_name="VTTParser",t.default=a.default.getSingletonFactory(i)},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){r(this,e),this.mediaType=null,this.bitrate=null,this.width=null,this.height=null,this.qualityIndex=NaN};t.default=i},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){r(this,e),this.streamId=null,this.mediaInfo=null,this.segmentType=null,this.quality=NaN,this.index=NaN,this.bytes=null,this.start=NaN,this.end=NaN,this.duration=NaN};t.default=i},function(e,t,n){function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":r(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":r(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(18),l=function(e){return e&&e.__esModule?e:{default:e}}(s),u=function(e){function t(e){i(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.url=e||null,n.checkForExistenceOnly=!0,n}return a(t,e),t}(l.default);t.default=u},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){r(this,e),this.offset=NaN,this.type=null,this.size=NaN,this.isComplete=!0};t.default=i},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){r(this,e),this.DVRWindowSize=NaN,this.loadedTime=null,this.availableFrom=null,this.minBufferTime=NaN,this.duration=NaN,this.isDynamic=!1,this.maxFragmentDuration=null};t.default=i},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){r(this,e),this.id=null,this.index=null,this.type=null,this.streamInfo=null,this.representationCount=0,this.lang=null,this.viewpoint=null,this.accessibility=null,this.audioChannelConfiguration=null,this.roles=null,this.codec=null,this.mimeType=null,this.contentProtection=null,this.isText=!1,this.KID=null,this.bitrateList=null};t.default=i},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){r(this,e),this.TcpList=[],this.HttpList=[],this.RepSwitchList=[],this.BufferLevel=[],this.BufferState=[],this.PlayList=[],this.DroppedFrames=[],this.SchedulingInfo=[],this.DVRInfo=[],this.ManifestUpdate=[],this.RequestsQueue=null,this.DVBErrors=[],this.BolaState=[]};t.default=i},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){r(this,e),this.id=null,this.index=null,this.start=NaN,this.duration=NaN,this.manifestInfo=null,this.isLast=!0,this.isFirst=!0};t.default=i},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){r(this,e),this.video=null,this.captionData=null,this.label=null,this.lang=null,this.defaultTrack=!1,this.kind=null,this.isFragmented=!1,this.isEmbedded=!1};t.default=i},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){r(this,e),this.id=null,this.quality=null,this.DVRWindow=null,this.fragmentDuration=null,this.mediaInfo=null,this.MSETimeOffset=null};t.default=i},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){r(this,e),this.t=null,this.xywh=null,this.track=null,this.id=null,this.s=null};t.default=i},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){r(this,e),this._s=void 0};t.default=i},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){r(this,e),this.t=null,this.level=null};t.default=i},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=n(16),o=function(e){return e&&e.__esModule?e:{default:e}}(i),a=function e(){r(this,e),this.target=null,this.state=o.default.BUFFER_EMPTY};t.default=a},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){r(this,e),this.time=null,this.range=null,this.manifestInfo=null};t.default=i},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){r(this,e),this.time=null,this.droppedFrames=null};t.default=i},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){r(this,e),this.mediaType=null,this.type=null,this.requestTime=null,this.fetchTime=null,this.availabilityStartTime=null,this.presentationStartTime=0,this.clientTimeOffset=0,this.currentTime=null,this.buffered=null,this.latency=0,this.streamInfo=[],this.trackInfo=[]},o=function e(){r(this,e),this.id=null,this.index=null,this.start=null,this.duration=null},a=function e(){r(this,e),this.id=null,this.index=null,this.mediaType=null,this.streamIndex=null,this.presentationTimeOffset=null,this.startNumber=null,this.fragmentInfoType=null};t.ManifestUpdate=i,t.ManifestUpdateStreamInfo=o,t.ManifestUpdateTrackInfo=a},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){r(this,e),this.t=null,this.mt=null,this.to=null,this.lto=null};t.default=i},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){r(this,e),this.loadingRequests=[],this.executedRequests=[]};t.default=i},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){r(this,e),this.mediaType=null,this.t=null,this.type=null,this.startTime=null,this.availabilityStartTime=null,this.duration=null,this.quality=null,this.range=null,this.state=null};t.default=i},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){r(this,e),this.tcpid=null,this.dest=null,this.topen=null,this.tclose=null,this.tconnect=null};t.default=i},function(e,t,n){var r=t.decimalAdjust=function(e,t,n){return void 0===n||0==+n?Math[e](t):(t=+t,n=+n,isNaN(t)||"number"!=typeof n||n%1!=0?NaN:(t=t.toString().split("e"),t=Math[e](+(t[0]+"e"+(t[1]?+t[1]-n:-n))),t=t.toString().split("e"),+(t[0]+"e"+(t[1]?+t[1]+n:n))))};e.exports={round10:function(e,t){return r("round",e,t)},floor10:function(e,t){return r("floor",e,t)},ceil10:function(e,t){return r("ceil",e,t)}},e.exports.polyfill=function(){Math.round10||(Math.round10=e.exports.round10),Math.floor10||(Math.floor10=e.exports.floor10),Math.ceil10||(Math.ceil10=e.exports.ceil10)}},function(e,t,n){var i,o="function"==typeof Symbol&&"symbol"==r(Symbol.iterator)?function(e){return void 0===e?"undefined":r(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":r(e)};i=function(){return this}();try{i=i||Function("return this")()||(0,eval)("this")}catch(e){"object"===("undefined"==typeof window?"undefined":o(window))&&(i=window)}e.exports=i},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":r(t))&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":r(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l="function"==typeof Symbol&&"symbol"==r(Symbol.iterator)?function(e){return void 0===e?"undefined":r(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":r(e)},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),d=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0},c=n(63),f=i(c),h=n(168),p=n(171),m=i(p),g=n(169),y=i(g),v=n(166),_=i(v),b=n(170),E=i(b),T=["dash","mpd"],S=function(e){function t(e,n){o(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.dash=null,r.foundBitrates=!1,r.gotFirstManifest=!1,r.drmSupportList=[],r.hasDrmSupportList=!1,n.Localization.setFromFormattedObject(y.default),r}return s(t,e),u(t,[{key:"isItemSupported",value:function(e){var t=this;return new Promise(function(n){T.includes(e.type)||n({supported:!1,errorCode:Meister.ErrorCodes.WRONG_TYPE}),window.MediaSource||n({supported:!1,errorCode:Meister.ErrorCodes.NOT_SUPPORTED}),e.drm||e.drmConfig?(t.meister.one("drmKeySystemSupport",function(e){var t=!1;Object.keys(e).forEach(function(n){"com.apple.fps"===n&&e[n]||"com.apple.fps.1_0"===n&&e[n]||"com.apple.fps.2_0"===n&&e[n]||"org.w3.clearkey"!==n&&e[n]&&(t=!0)}),n({supported:t,errorCode:t?null:Meister.ErrorCodes.NO_DRM})}),t.meister.trigger("requestDrmKeySystemSupport",{})):n({supported:!0})})}},{key:"process",value:function(e){var t=this;return new Promise(function(n,r){t.player=t.meister.getPlayerByType("html5",e),t.player?n(e):r(t.name+": Unable to play item "+e.src+", no player available.")})}},{key:"load",value:function(e){var n=this;return d(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"load",this).call(this,e),new Promise(function(t){n.dash=f.default.MediaPlayer().create(),n.dash.getDebug().setLogToBrowserConsole(n.config.debug||!1),n.dash.setFastSwitchEnabled(!0),n.dash.setLiveDelayFragmentCount(8),n.config.lowMemoryMode&&(n.dash.setBufferPruningInterval(15),n.dash.setBufferTimeAtTopQuality(10),n.dash.setBufferTimeAtTopQualityLongForm(10),n.dash.setBufferToKeep(10)),n.config.settings&&(0,h.setDashOptions)(n.name,n.dash,n.config.settings),e.startFromLive&&n.dash.setLiveDelayFragmentCount(0),n.on("requestGoLive",n.goLive.bind(n)),n.on("requestBitrate",n.onRequestBitrate.bind(n)),n.dash.on(f.default.MediaPlayer.events.MANIFEST_LOADED,n.onManifestLoaded.bind(n)),n.dash.on(f.default.MediaPlayer.events.STREAM_INITIALIZED,n.onStreamInitialized.bind(n)),n.dash.on(f.default.MediaPlayer.events.QUALITY_CHANGE_RENDERED,n.onQualityChanged.bind(n)),n.dash.on(f.default.MediaPlayer.events.ERROR,n.onError.bind(n)),n.dash.on(f.default.MediaPlayer.events.METRIC_ADDED,function(e){"HttpList"!==e.metric||"MPD"!==e.value.type||n.gotFirstManifest||(n.gotFirstManifest=!0,n.meister.trigger("showLoading",{code:"VIDEO_ACQUIRING_MANIFEST"}))}),n.didBeginSeek=!1,n.on("playerCanPlay",function(){if(e.startFromBeginning&&!n.didBeginSeek){n.didBeginSeek=!0;var t=0;"object"===l(e.startFromBeginning)&&(t=e.startFromBeginning.offset/n.dash.duration()),n.onRequestSeek({relativePosition:t})}});var r=n.meister.playlist.list[n.meister.playlist.index];(0,E.default)(r)&&(n.meister.browser.isMobile||n.meister.browser.isNonAutoPlay)?n.one("GoogleIma:initialUserActionCompleted",function(){n.dash.initialize(n.player.mediaElement,e.src,!1)}):n.dash.initialize(n.player.mediaElement,e.src,!1),n.one("playerPlay",function(){n.dash.pause(),n.dash.play()}),n.one("requestPlay",function(){n.dash.play()}),t()})}},{key:"unload",value:function(){d(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"unload",this).call(this),this.gotFirstManifest=!1,this.dash&&this.dash.reset(),this.foundBitrates=!1,this.drmSupportList=[],this.hasDrmSupportList=!1}},{key:"_onPlayerTimeUpdate",value:function(){var e=this.dash.time();e=e<0?0:e,this.meister.trigger("playerTimeUpdate",{currentTime:e,duration:this.dash.duration()})}},{key:"_onPlayerSeek",value:function(){var e=this.dash.time(),t=this.dash.duration(),n=e/t;this.meister.trigger("playerSeek",{relativePosition:n,currentTime:e,duration:t})}},{key:"onError",value:function(e){"download"===e.error&&(this.meister.error(this.meister.Localization.get("COULD_NOT_DOWNLOAD_FRAGMENTS"),"DSH-0001"),this.meister.pause())}},{key:"onManifestLoaded",value:function(e){var t=this;if(e.data){var n=!1,r=!1,i=e.data.mediaPresentationDuration;i||(n=!0),e.data.timeShiftBufferDepth>this.config.dvrThreshold&&(this.liveSyncDelay=e.data.minBufferTime,r=!0,i=e.data.timeShiftBufferDepth),this.config.dvrEnabled||(r=!1),this.meister.trigger("itemTimeInfo",{isLive:n,hasDVR:r,duration:i});var o=e.data.Period.AdaptationSet,a=null;if(o.ContentProtection)a=o.ContentProtection;else{if(!o.length)return;if(!o[0].ContentProtection)return;a=o[0].ContentProtection}var s=a.find(function(e){return!!e["cenc:default_KID"]}),l=s["cenc:default_KID"];l&&this.meister.trigger("drmKidAvailable",l);var u=(0,_.default)(a);this.meister.trigger("drmLicenseInfoAvailable",u),this.hasDrmSupportList||a.forEach(function(e){"urn:uuid:EDEF8BA9-79D6-4ACE-A3C8-27DCD51D21ED"===e.schemeIdUri?t.drmSupportList.push("com.widevine.alpha"):"urn:uuid:9A04F079-9840-4286-AB92-E65BE0885F95"===e.schemeIdUri&&t.drmSupportList.push("com.microsoft.playready")}),this.drmSupportList.length&&!this.hasDrmSupportList&&(this.hasDrmSupportList=!0,this.meister.trigger("drmSupportedListAvailable",this.drmSupportList))}}},{key:"onStreamInitialized",value:function(){if(!this.foundBitrates){var e=this.dash.getBitrateInfoListFor("video"),t=e.map(function(e){return{bitrate:e.bitrate,index:e.qualityIndex}});t.unshift({bitrate:0,index:-1}),this.meister.trigger("itemBitrates",{bitrates:t,currentIndex:-1}),this.foundBitrates=!0}}},{key:"onQualityChanged",value:function(e){if("video"===e.mediaType){var t=e.newQuality,n=this.dash.getBitrateInfoListFor("video"),r=n.find(function(e){return e.qualityIndex===t});this.meister.trigger("playerAutoSwitchBitrate",{newBitrate:r.bitrate,newBitrateIndex:t})}}},{key:"onRequestBitrate",value:function(e){if(-1===e.bitrateIndex)return void this.dash.setAutoSwitchQualityFor("video",!0);this.dash.setAutoSwitchQualityFor("video",!1),this.dash.setQualityFor("video",e.bitrateIndex);var t=this.dash.getBitrateInfoListFor("video"),n=t.find(function(t){return e.qualityIndex===t.qualityIndex});this.meister.trigger("playerSwitchBitrate",{newBitrate:n.bitrate,newBitrateIndex:e.bitrateIndex})}},{key:"onRequestSeek",value:function(e){var t=void 0;Number.isFinite(e.relativePosition)?t=e.relativePosition*this.dash.duration():Number.isFinite(e.timeOffset)?t=this.dash.time()+e.timeOffset:Number.isFinite(e.targetTime)&&(t=e.targetTime),!e.forcedStart&&this.blockSeekForward&&t>this.dash.time()||Number.isFinite(t)&&this.dash.seek(t)}},{key:"goLive",value:function(){var e=this.dash.duration(),t=e-30;this.player.currentTime=this.dash.getDVRSeekOffset(t)}},{key:"duration",get:function(){return this.dash?this.dash.duration():NaN}},{key:"currentTime",get:function(){return this.dash?this.dash.time():NaN},set:function(e){this.dash&&this.dash.seek(e)}}],[{key:"pluginName",get:function(){return"Dash"}},{key:"pluginVersion",get:function(){return m.default.version}}]),t}(Meister.MediaPlugin);Meister.registerPlugin(S.pluginName,S),Meister.registerPlugin("dash",S),t.default=S},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.WIDEVINE_SCHEME_URI="urn:uuid:EDEF8BA9-79D6-4ACE-A3C8-27DCD51D21ED",t.PLAYREADY_SCHEME_URI="urn:uuid:9A04F079-9840-4286-AB92-E65BE0885F95"},function(e,t,n){function r(e){var t={drmServerUrl:null,kid:null};return e.laurl&&e.laurl.licenseUrl&&(t.drmServerUrl=e.laurl.licenseUrl),(e.KID||e["cenc:default_KID"])&&(t.kid=e.KID||e["cenc:default_KID"]),t}function i(e){var t={drmServerUrl:null,kid:null};if(e.pro&&e.pro.__text){var n=window.atob(e.pro.__text),r=n.substring(n.indexOf("<"));r=r.split("").filter(function(e){return!(0,u.default)(e.charCodeAt(0))}).join("");var i=new DOMParser,o=i.parseFromString(r,"text/xml"),a=o.getElementsByTagName("LA_URL"),s=o.getElementsByTagName("KID");a.length&&a[0]&&(t.drmServerUrl=a[0].textContent),s.length&&s[0]&&(t.kid=s[0].textContent)}return t}function o(e){return"urn:uuid:"+e.toUpperCase().replace("URN:UUID:","")}function a(e){var t={playready:null,widevine:null};return e.forEach(function(e){o(e.schemeIdUri)===s.WIDEVINE_SCHEME_URI?t.widevine=r(e):o(e.schemeIdUri)===s.PLAYREADY_SCHEME_URI&&(t.playready=i(e))}),t}Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var s=n(165),l=n(167),u=function(e){return e&&e.__esModule?e:{default:e}}(l)},function(e,t,n){function r(e){return e>=i&&e<=o}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var i=0,o=31},function(e,t,n){function r(e,t,n){return!(e<t||e>n)}function i(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!t)throw new Error("Dashjs instance is required.");var i=n.abandonLoadTimeout,o=n.bandwidthSafetyFactor,a=n.bufferPruningInterval,s=n.bufferTimeAtTopQuality,l=n.bufferTimeAtTopQualityLongForm,u=n.bufferToKeep,d=n.fastSwitchEnabled,c=n.fragmentLoaderRetryAttempts,f=n.fragmentLoaderRetryInterval,h=n.liveDelay,p=n.liveDelayFragmentCount,m=n.longFormContentDurationThreshold,g=n.richBufferThreshold,y=n.stableBufferTime,v=n.useSuggestedPresentationDelay;Number.isFinite(i)&&(i>0?t.setAbandonLoadTimeout(i):console.error(e+": incorrect abandonLoadTimeout. Please use a number in seconds higher than 0.")),Number.isFinite(o)&&(r(o,0,1)?t.setBandwidthSafetyFactor(o):console.error(e+": incorrect bandwidthSafetyFactor. Please use a percentage between 0.0 and 1.")),Number.isFinite(a)&&(a>0?t.setBufferPruningInterval(a):console.error(e+": incorrect bufferPruningInterval. Please use a number in seconds higher than 0.")),Number.isFinite(s)&&(s>0?t.setBufferTimeAtTopQuality(s):console.error(e+": incorrect bufferTimeAtTopQuality. Please use a number in seconds higher than 0.")),Number.isFinite(l)&&(l>0?t.setBufferTimeAtTopQualityLongForm(l):console.error(e+": incorrect bufferTimeAtTopQualityLongForm. Please use a number in seconds higher than 0.")),Number.isFinite(u)&&(u>0?t.setBufferToKeep(u):console.error(e+": incorrect bufferToKeep. Please use a number in seconds higher than 0.")),d&&t.setFastSwitchEnabled(!!d),Number.isFinite(c)&&(c>0?t.setFragmentLoaderRetryAttempts(c):console.error(e+": incorrect fragmentLoaderRetryAttempts. Please use a number in seconds higher than 0.")),Number.isFinite(f)&&(f>0?t.setFragmentLoaderRetryInterval(f):console.error(e+": incorrect fragmentLoaderRetryInterval. Please use a number in milliseconds higher than 0.")),Number.isFinite(h)&&(h>0?t.setLiveDelay(h):console.error(e+": incorrect liveDelay. Please use a number in seconds higher than 0.")),Number.isFinite(p)&&(p>0?t.setLiveDelayFragmentCount(p):console.error(e+": incorrect liveDelayFragmentCount. Please use a number higher than 0.")),Number.isFinite(m)&&(m>0?t.setLongFormContentDurationThreshold(m):console.error(e+": incorrect longFormContentDurationThreshold. Please use a number in seconds higher than 0.")),Number.isFinite(g)&&(g>0?t.setRichBufferThreshold(g):console.error(e+": incorrect richBufferThreshold. Please use a number in seconds higher than 0.")),Number.isFinite(y)&&(y>0?t.setStableBufferTime(y):console.error(e+": incorrect stableBufferTime. Please use a number in seconds higher than 0.")),v&&t.useSuggestedPresentationDelay(!!v)}Object.defineProperty(t,"__esModule",{value:!0}),t.setDashOptions=i,t.default=i},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r={COULD_NOT_DOWNLOAD_FRAGMENTS:{nl:"Kan videofragmenten niet downloaden",en:"Could not download fragments"}};t.default=r},function(e,t,n){function r(e){return!("media"!==e.type||!e.parallel||!e.parallel.find(function(e){return"vmap"===e.type}))}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r},function(e,t){e.exports={name:"@meisterplayer/plugin-dash",version:"5.7.1",description:"Meister plugin wrapping the dashjs player.",main:"dist/Dash.js",keywords:["meister","video","plugin"],repository:{type:"git",url:"https://github.com/meisterplayer/media-dash.git"},scripts:{lint:"eslint ./src/js",test:"jest","test:coverage":"jest --coverage",build:"gulp build",dist:"gulp build:min && gulp build:dist"},author:"Triple",license:"Apache-2.0",dependencies:{dashjs:"git+https://github.com/meisterplayer/dashjs-fork.git#triple_2.4.1"},devDependencies:{"@meisterplayer/meister-mock":"^1.0.0","babel-preset-es2015":"^6.24.0","babel-preset-es2017":"^6.22.0",gulp:"^3.9.1",jest:"^20.0.4","meister-gulp-webpack-tasks":"^1.0.6","meister-js-dev":"^3.1.0"},peerDependencies:{"@meisterplayer/meisterplayer":">= 5.1.0"}}},function(e,t,n){e.exports=n(61)}])},function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports=function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/",t(t.s=11)}([function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),i=function(e){return e&&e.__esModule?e:{default:e}}(r);t.default=i.default},function(e,t,n){function r(e,t,n){function r(r){var c=e[d++],f=r.which||r.keyCode,h=i[f];return o(h,r),"*"!=c&&c!=h?a():t.ms&&s&&new Date-s>t.ms?a():(t.ms&&(s=new Date),void(u.push(h)==l&&(a(),n(r))))}function o(n,r){e.some(function(e){return n==e})&&(t.preventDefault&&r.preventDefault(),t.stopPropagation&&r.stopPropagation())}function a(){s=null,u=[],d=0}var s,e=e.split(/ +/),l=e.length,u=[],d=0;2==arguments.length&&(n=t,t={}),function(){t.ms=t.ms||1e3,t.el=t.el||window}(),t.el.addEventListener("keydown",r)}var i=n(3);e.exports=r,r.vkeys=i,r.getKey=i.getKey,r.findCode=i.findCode,r.findAllCodes=i.findAllCodes,r.press=function(e,t){var n=i.findCode(e),t=t||window,r=document.createEvent("Event");r.initEvent("keydown",!0,!0),r.keyCode=r.which=n,t.dispatchEvent(r),r=document.createEvent("Event"),r.initEvent("keyup",!0,!0),r.keyCode=r.which=n,t.dispatchEvent(r)}},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];r(this,e),this.intervalTime=Number.isFinite(t)?1e3*t:5e3,this.debug=n,this.shouldCallCallback=!0,this.lastBeat=0,this.intervalId=0}return i(e,[{key:"beat",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};this.intervalId&&(this.debug&&console.log("Removing previous interval"),clearInterval(this.intervalId)),this.lastBeat=Date.now(),this.intervalId=setInterval(function(){var n=Date.now(),r=n-e.lastBeat;e.lastBeat=n,e.shouldCallCallback&&t(r)},this.intervalTime)}},{key:"mute",value:function(){this.shouldCallCallback=!1}},{key:"unmute",value:function(){this.shouldCallCallback=!0}},{key:"kill",value:function(){clearInterval(this.intervalId)}}]),e}();t.default=o},function(e,t,n){var r=t=e.exports={0:"unk",1:"mouse1",2:"mouse2",3:"break",4:"mouse3",5:"mouse4",6:"mouse5",8:"backspace",9:"tab",12:"clear",13:"enter",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",21:"imehangul",23:"imejunja",24:"imefinal",25:"imekanji",27:"escape",28:"imeconvert",29:"imenonconvert",30:"imeaccept",31:"imemodechange",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",41:"select",42:"print",43:"execute",44:"snapshot",45:"insert",46:"delete",47:"help",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",58:":",59:";",60:"<",61:"=",62:">",63:"?",64:"@",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",91:"meta",92:"meta",93:"menu",95:"sleep",96:"num0",97:"num1",98:"num2",99:"num3",100:"num4",101:"num5",102:"num6",103:"num7",104:"num8",105:"num9",106:"num*",107:"num+",108:"numenter",109:"num-",110:"num.",111:"num/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",124:"f13",125:"f14",126:"f15",127:"f16",128:"f17",129:"f18",130:"f19",131:"f20",132:"f21",133:"f22",134:"f23",135:"f24",144:"numlock",145:"scrolllock",160:"shiftleft",161:"shiftright",162:"ctrlleft",163:"ctrlright",164:"altleft",165:"altright",166:"browserback",167:"browserforward",168:"browserrefresh",169:"browserstop",170:"browsersearch",171:"browserfavorites",172:"browserhome",173:"volumemute",174:"volumedown",175:"volumeup",176:"nexttrack",177:"prevtrack",178:"stop",179:"playpause",180:"launchmail",181:"launchmediaselect",182:"launchapp1",183:"launchapp2",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",223:"meta",224:"meta",226:"altgr",229:"imeprocess",231:"unicode",246:"attention",247:"crsel",248:"exsel",249:"eraseeof",250:"play",251:"zoom",252:"noname",253:"pa1",254:"clear"};t.findCode=function(e){for(var t in r)if(r.hasOwnProperty(t)&&e==r[t])return parseInt(t);return null},t.findAllCodes=function(e){return Object.keys(r).filter(function(t){return e==r[t]}).map(function(e){return parseInt(e)})},t.getKey=function(e){return r[e]}},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":r(t))&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":r(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(1),d=i(u),c=n(9),f=i(c),h=n(2),p=i(h),m=n(6),g=i(m),y=n(8),v=(i(y),n(5)),_=i(v),b=n(10),E=i(b),T=function(e){function t(e,n){o(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.isActivated=!1,(0,d.default)("ctrl m j s",function(){r.isActivated?(r.deactivate(),r.isActivated=!1):(r.activate(),r.isActivated=!0)}),r.positionEl=null,r.totalTimeEl=null,r.downloadSpeedChart=null,r.averageBandwidth=0,r.qualitysEls=[],r.hearbeat=new p.default(.1),r.hearbeat.beat(r.onBeat.bind(r)),r.hearbeat.mute(),r.hijackAjax=new _.default,r}return s(t,e),l(t,[{key:"onBeat",value:function(){this.positionEl.innerHTML=this.meister.currentTime,this.totalTimeEl.innerHTML=this.meister.duration,this.decodedFramesEl.innerHTML=this.meister.playerPlugin.mediaElement.webkitDecodedFrameCount,this.droppedFramesEl.innerHTML=this.meister.playerPlugin.mediaElement.webkitDroppedFrameCount,this.activeRequestsEl.innerHTML=this.hijackAjax.activeXHRs.length,this.bandwidthEl.innerHTML=this.hijackAjax.averageBandwidthText,this.meister.playerPlugin.mediaElement.buffered.length&&(this.videoBufferedEl.innerHTML=this.meister.playerPlugin.mediaElement.buffered.start(0)+" - "+this.meister.playerPlugin.mediaElement.buffered.end(0)),this.downloadSpeedChart.appendValue(this.hijackAjax.averageBandwidth),this.downloadSpeedChart.draw()}},{key:"activate",value:function(){this.hearbeat.unmute(),this.wrapperElement.style.display="block"}},{key:"deactivate",value:function(){this.wrapperElement.style.display="none",this.hearbeat.mute()}},{key:"initializeRightPanel",value:function(){this.downloadSpeedChart=new g.default(this.downloadSpeedChartEl,600)}},{key:"setElements",value:function(){var e=this;this.positionEl=document.getElementById("pf-debug-overlay-text-position"),this.totalTimeEl=document.getElementById("pf-debug-overlay-text-totalTime"),this.decodedFramesEl=document.getElementById("pf-debug-overlay-text-decoded-frames"),this.droppedFramesEl=document.getElementById("pf-debug-overlay-text-dropped-frames"),this.downloadSpeedChartEl=document.getElementById("pf-debug-overlay-download-speed"),this.activeRequestsEl=document.getElementById("pf-debug-overlay-text-active-requests"),this.bandwidthEl=document.getElementById("pf-debug-overlay-text-average-bandwidth"),this.videoBufferedEl=document.getElementById("pf-debug-overlay-text-video-buffered-range"),this.theadSegmentTableEl=document.getElementById("pf-debug-overlay-segment-header"),this.segmentTableActiveEl=document.getElementById("pf-debug-overlay-segment-active"),this.playerStateEl=document.getElementById("pf-debug-overlay-state"),this.nudgeAmountEl=document.getElementById("pf-debug-overlay-text-nudge-amount"),this.meister.on("itemBitrates",function(t){e.createSegmentInterface(t.bitrates)}),this.meister.on("requestBitrate",function(t){var n=!0,r=!1,i=void 0;try{for(var o,a=e.qualitysEls[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){o.value.innerHTML=" "}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}e.qualitysEls[e.qualitysEls.length-(t.bitrateIndex+2)].innerHTML="x"}),this.meister.on("playerPlay",function(){e.playerStateEl.innerHTML="Playing"}),this.meister.on("playerPause",function(){e.playerStateEl.innerHTML="Paused"}),this.meister.on("playerSeek",function(){e.playerStateEl.innerHTML="Seeking"}),this.meister.on("playerNudge",function(t){e.nudgeAmountEl.parentElement.style.display="block",e.nudgeAmountEl.innerHTML=t.totalNudges}),this.meister.on("playerAutoSwitchBitrate",function(t){var n=!0,r=!1,i=void 0;try{for(var o,a=e.qualitysEls[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){o.value.innerHTML=" "}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}e.qualitysEls[e.qualitysEls.length-(t.newBitrateIndex+2)].innerHTML="x"}),this.initializeRightPanel()}},{key:"createSegmentInterface",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,o=e[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value,s=document.createElement("th");s.style.color=this.getRandomColor(),s.innerHTML=a.bitrate,this.theadSegmentTableEl.appendChild(s);var l=document.createElement("td");l.innerHTML=0===a.bitrate?"x":" ",this.segmentTableActiveEl.appendChild(l),this.qualitysEls.push(l)}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}}},{key:"getRandomColor",value:function(){for(var e="#",t=0;t<6;t+=1)e+="0123456789ABCDEF"[Math.floor(16*Math.random())];return e}},{key:"onUiReady",value:function(){var e=document.createElement("div");e.classList.add("pf-debug-overlay"),e.innerHTML=f.default,this.wrapperElement=e,this.meister.defaultWrapper.appendChild(e),this.setElements()}}],[{key:"pluginName",get:function(){return"DebugOverlay"}},{key:"pluginVersion",get:function(){return E.default.version}}]),t}(Meister.UiPlugin);Meister.registerPlugin(T.pluginName,T),t.default=T},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e){for(var t=0;t<d.length;t++)if(d[t].url===e)return t}function o(e,t){t.loaded<e.bytesDownloaded&&(e.bytesDownloaded=0);var n=t.loaded-e.bytesDownloaded,r=Date.now()-e.timestamp;p+=r,m+=n,g+=n,e.bytesDownloaded+=t.loaded,e.totalSizeInBytes+=t.total,e.timestamp=Date.now(),e.downloadProgress=e.bytesDownloaded/e.totalSizeInBytes}function a(){p>0&&(c.push(p),p=0,c.length>h&&c.shift()),m>0&&(f.push(m),m=0,f.length>h&&f.shift());var e=0,t=!0,n=!1,r=void 0;try{for(var i,o=c[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){e+=i.value}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}var a=0,s=!0,l=!1,u=void 0;try{for(var d,g=f[Symbol.iterator]();!(s=(d=g.next()).done);s=!0){a+=d.value}}catch(e){l=!0,u=e}finally{try{!s&&g.return&&g.return()}finally{if(l)throw u}}var v=null;e>0&&(v=1e3*a/e),y=0==y?v:(y+v)/2,p=0,m=0}function s(e){if(isNaN(e)||0===e)return e+"";var t=["bits/s","kbit/s","Mbit/s","Gbit/s","Tbit/s","Pbit/s"],n=e,r=Math.floor(Math.log(n)/Math.log(1024)),i=(n/Math.pow(1024,Math.floor(r))).toString();return i.substr(0,i.indexOf(".")+2)+" "+t[r]}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=window.XMLHttpRequest.prototype.open,d=[],c=[],f=[],h=32,p=0,m=0,g=0,y=0;window.XMLHttpRequest.prototype.open=function(){var e=arguments;return d.push({url:arguments[1],bytesDownloaded:0,timestamp:0,timeOfRequest:Date.now(),timeOfResponse:0,roundTripTime:0,totalSizeInBytes:0,downloadProgress:0,bandwidth:0}),this.addEventListener("progress",function(t){o(d[i(e[1])],t)}),this.addEventListener("loadstart",function(t){d[i(e[1])].timestamp=Date.now()}),this.addEventListener("load",function(t){o(d[i(e[1])],t),a();for(var n=0;n<d.length;n++)d[n].url==e[1]&&d.splice(n,1)}),u.apply(this,[].slice.call(arguments))};var v=function(){function e(){r(this,e)}return l(e,[{key:"activeXHRs",get:function(){return d}},{key:"averageBandwidthText",get:function(){return s(y)}},{key:"averageBandwidth",get:function(){return y}}]),e}();t.default=v},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(t,n){r(this,e),this.canvas=t,this.context=this.canvas.getContext("2d"),this.maxValue=0,this.data=[];for(var i=0;i<n;i++)this.data[i]=0}return i(e,[{key:"draw",value:function(){this.canvas.clientWidth!=this.canvas.width&&(this.canvas.width=this.canvas.clientWidth);var e=0;if(this.maxValue>0&&(e=1/this.maxValue),this.context.clearRect(0,0,this.canvas.width,this.canvas.height),0!=this.data.length){var t=this.canvas.width,n=this.canvas.height,r=t/(this.data.length-1);this.context.beginPath(),this.context.moveTo(0,0),this.context.lineWidth=1,this.context.fillStyle="#FFFFFF",this.context.moveTo(0,n),this.context.lineTo(0,n-this.data[0]*e*n);for(var i=0,o=0;o<this.data.length;o++){var a=this.data[o];a>i&&(i=a),this.context.lineTo(o*r,n-a*e*n)}this.maxValue=1.1*i,this.context.lineTo(t,n),this.context.closePath(),this.context.fill()}}},{key:"appendValue",value:function(e){this.data.shift(),this.data.push(e)}}]),e}();t.default=o},function(e,t,n){function i(e,t,n,r){if(r=r||{},!e||!t||!n||"object"!==(void 0===n?"undefined":a(n)))throw"Missing or invalid Hijacker proxy initialization options";this.name=e,this.condition="function"==typeof t?t:function(e){return t===e},this.callbacks={beforeSend:[],receive:[],complete:[],progress:[]};var i={text:String,html:function(e){return e},xml:function(e){return e},json:JSON.parse},o=(this.dataParsers=i,r.dataParsers);if(o)for(var s in o)o.hasOwnProperty(s)&&(this.dataParsers[s]=o[s]);for(var l in n)n.hasOwnProperty(l)&&this.callbacks[l].push(n[l]);return this}function o(e){var t={},n={text:"responseText",json:"responseJSON",xml:"responseXML"};for(var r in n)e.hasOwnProperty(n[r])&&(t[r]=e[n[r]]);return t}Object.defineProperty(t,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"===r(Symbol.iterator)?function(e){return void 0===e?"undefined":r(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":r(e)},s={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4};i.prototype.getResponseHeader=function(e,t){var n,r,i=/^(.*?):[ \t]*([^\r\n]*)$/gm;if([s.HEADERS_RECEIVED,s.LOADING,s.DONE].indexOf(e.readyState)>-1){if(r=e.getAllResponseHeaders(),!this.responseHeaders)for(this.responseHeaders={};n=i.exec(r);)this.responseHeaders[n[1].toLowerCase()]=n[2];n=this.responseHeaders[t.toLowerCase()]}return null===n?null:n},i.prototype.getResponseHeaderType=function(e){var t=this.getResponseHeader(e,"Content-Type")||"text/html",n={html:/html/,json:/json/,script:/(?:java|ecma)script/};for(var r in n)if(n.hasOwnProperty(r)&&n[r].test(t))return r;return"text"},i.prototype.parseResponse=function(e){var t=this.dataParsers,n=this.getResponseHeaderType(e),r=o(e);return r[n]?r[n]:t[n]?t[n](e.response||e.responseText):e.responseText},i.prototype.fireEvent=function(e,t){var n=this.callbacks[e];if(this.condition(t.url,t))for(var r=0;r<n.length;r++)"complete"===e||"receive"===e?n[r].call(this,this.parseResponse(t),t):n[r].call(this,t)},i.prototype.addListener=function(e,t){this.callbacks[e].push(t)},i.prototype.removeListener=function(e,t){var n;if(!(e in this.callbacks))throw e+" listener does not exist!";if(n=this.callbacks[e],t){var r=n.indexOf(t);if(r<0)throw t+" callback does not exist!";n=n.slice(0,r).concat(n.slice(r+1))}else n=[];this.callbacks[e]=n},t.default=i},function(e,t,n){function r(e,t,n){return function(){var r;if("function"!=typeof e)throw e+" is not a function, and cannot be proxied!";return"function"==typeof t&&t.apply(this,arguments),r=e.apply(this,arguments),"function"==typeof n&&n.apply(this,arguments),r}}function i(e){this.proxies={},this.adapter=e,this.active=0,e?e.init.call(this):this.proxyXHREvents()}Object.defineProperty(t,"__esModule",{value:!0});var o=n(7),a=function(e){return e&&e.__esModule?e:{default:e}}(o);i.prototype.getXHRMethod=function(e){return window.XMLHttpRequest.prototype[e]},i.prototype.setXHRMethod=function(e,t){window.XMLHttpRequest.prototype[e]=t},i.prototype.proxyXhrMethod=function(e,t,n){var i=r(this.getXHRMethod(e),t,n);this.setXHRMethod(e,i)},i.prototype.createProxy=function(e,t,n,r){var i=new a.default(e,t,n,r);return this.proxies[e]=i,i},i.prototype.set=function(e,t,n,r){return this.createProxy(e,t,n,r)},i.prototype.addListener=function(e,t,n){if(!(e in this.proxies))throw e+" proxy does not exist!";this.proxies[e].addListener(t,n)},i.prototype.removeListener=function(e,t,n){if(!(e in this.proxies))throw e+" proxy does not exist!";this.proxies[e].removeListener(t,n)},i.prototype.dispatch=function(e,t,n){var r=this.proxies;for(var i in r)r.hasOwnProperty(i)&&r[i].fireEvent(e,t);"function"==typeof n&&n()},i.prototype.proxyXHREvents=function(){var e=this;e.proxyXhrMethod("open",function(t,n){this.url=n,this.rscProxied=!1,this.onLoadProxied=!1,e.active++,e.dispatch("beforeSend",this)}),e.proxyXhrMethod("send",function(){function t(e){return e.readyState>=1&&e.readyState<=3}function n(){t(o)||e.dispatch("receive",o)}function i(){t(o)||e.dispatch("complete",o,function(){e.active--})}var o=this;"function"==typeof o.onload?(o._originalOnLoadHandler=o.onload,o.onLoadProxied=!0,o.onload=r(o.onload,n,i)):"function"==typeof o.onreadystatechange?(o._originalRSCHandler=o.onreadystatechange,o.rscProxied=!0,o.onreadystatechange=r(o.onreadystatechange,n,i)):(window.console&&console.warn&&console.warn("Couldn't find desktop handlers. `complete` might fire before desktop handler."),o.onload=r(i,n))})},t.default=i},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="pf-debug-overlay-section">\n    <div class="pf-debug-overlay-left">\n        <div class="pf-debug-overlay-text">\n            <div>Total time: <span id="pf-debug-overlay-text-totalTime">0</span></div>\n            <div>Position: <span id="pf-debug-overlay-text-position">0</span></div>\n            <div>State: <span id="pf-debug-overlay-state">Playing</span></div>\n            <br>\n            <div>Decoded video frames: <span id="pf-debug-overlay-text-decoded-frames">0</span></div>\n            <div>Dropped frames: <span id="pf-debug-overlay-text-dropped-frames">11</span></div>\n            <div style="display:none">Nudge count: <span id="pf-debug-overlay-text-nudge-amount">0</span></div>\n            <br>\n            <div>Buffered: <span id="pf-debug-overlay-text-video-buffered-range">0.32 - 23.23</span></div>\n            <div>Average Bandwidth: <span id="pf-debug-overlay-text-average-bandwidth">5 Mbit/s</span></div>\n\n        </div>\n    </div>\n    <div class="pf-debug-overlay-right">\n        <div class="pf-debug-overlay-text">\n            <div>Active requests: <span id="pf-debug-overlay-text-active-requests">0</span></div>\n            <div>&nbsp;</div>\n            <div>Bandwidth Graph: </div>\n            <canvas id="pf-debug-overlay-download-speed"></canvas>\n            <div>Segments: </div>\n            <div id="pf-debug-overlay-segments-wrapper">\n                <table>\n                    <thead>\n                        <tr id="pf-debug-overlay-segment-header">\n\n                        </tr>\n                    </thead>\n                    <tbody id="pf-debug-overlay-segment-body">\n                        <tr id="pf-debug-overlay-segment-active"></tr>\n                    </tbody>\n                </table>\n            </div>\n        </div>\n    </div>\n</div>\n'},function(e,t){e.exports={name:"@meisterplayer/plugin-debugoverlay",version:"5.2.0",description:"Debug overlay plugin for Meister",main:"dist/DebugOverlay.js",scripts:{},keywords:["meister","video","plugin"],repository:{type:"git",url:"https://github.com/meisterplayer/ui-debugoverlay.git"},author:"Triple",license:"Apache-2.0",devDependencies:{"meister-gulp-webpack-tasks":"^1.0.6","meister-js-dev":"^3.1.0","babel-preset-es2015":"^6.24.0","babel-preset-es2017":"^6.22.0",gulp:"^3.9.1"},dependencies:{"meister-heartbeat":"^1.0.2","keyboard-shortcut":"^1.2.0"}}},function(e,t,n){e.exports=n(0)}])},function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports=function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/",t(t.s=68)}([function(e,t,n){function i(){}function o(e,t){return t="["+e+"] > "+t}function a(e){var t=self.console[e];return t?function(){for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];r[0]&&(r[0]=o(e,r[0])),t.apply(self.console,r)}:i}function s(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];n.forEach(function(t){c[t]=e[t]?e[t].bind(e):a(t)})}var l="function"==typeof Symbol&&"symbol"==r(Symbol.iterator)?function(e){return void 0===e?"undefined":r(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":r(e)};Object.defineProperty(t,"__esModule",{value:!0});var u="function"==typeof Symbol&&"symbol"===l(Symbol.iterator)?function(e){return void 0===e?"undefined":l(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":l(e)},d={trace:i,debug:i,log:i,warn:i,info:i,error:i},c=d;t.enableLogs=function(e){if(!0===e||"object"===(void 0===e?"undefined":u(e))){s(e,"debug","log","info","warn","error");try{c.log()}catch(e){c=d}}else c=d},t.logger=c},function(e,t,n){e.exports={MEDIA_ATTACHING:"hlsMediaAttaching",MEDIA_ATTACHED:"hlsMediaAttached",MEDIA_DETACHING:"hlsMediaDetaching",MEDIA_DETACHED:"hlsMediaDetached",BUFFER_RESET:"hlsBufferReset",BUFFER_CODECS:"hlsBufferCodecs",BUFFER_CREATED:"hlsBufferCreated",BUFFER_APPENDING:"hlsBufferAppending",BUFFER_APPENDED:"hlsBufferAppended",BUFFER_EOS:"hlsBufferEos",BUFFER_FLUSHING:"hlsBufferFlushing",BUFFER_FLUSHED:"hlsBufferFlushed",MANIFEST_LOADING:"hlsManifestLoading",MANIFEST_LOADED:"hlsManifestLoaded",MANIFEST_PARSED:"hlsManifestParsed",LEVEL_SWITCH:"hlsLevelSwitch",LEVEL_SWITCHING:"hlsLevelSwitching",LEVEL_SWITCHED:"hlsLevelSwitched",LEVEL_LOADING:"hlsLevelLoading",LEVEL_LOADED:"hlsLevelLoaded",LEVEL_UPDATED:"hlsLevelUpdated",LEVEL_PTS_UPDATED:"hlsLevelPtsUpdated",AUDIO_TRACKS_UPDATED:"hlsAudioTracksUpdated",AUDIO_TRACK_SWITCH:"hlsAudioTrackSwitch",AUDIO_TRACK_SWITCHING:"hlsAudioTrackSwitching",AUDIO_TRACK_SWITCHED:"hlsAudioTrackSwitched",AUDIO_TRACK_LOADING:"hlsAudioTrackLoading",AUDIO_TRACK_LOADED:"hlsAudioTrackLoaded",SUBTITLE_TRACKS_UPDATED:"hlsSubtitleTracksUpdated",SUBTITLE_TRACK_SWITCH:"hlsSubtitleTrackSwitch",SUBTITLE_TRACK_LOADING:"hlsSubtitleTrackLoading",SUBTITLE_TRACK_LOADED:"hlsSubtitleTrackLoaded",SUBTITLE_FRAG_PROCESSED:"hlsSubtitleFragProcessed",INIT_PTS_FOUND:"hlsInitPtsFound",FRAG_LOADING:"hlsFragLoading",FRAG_LOAD_PROGRESS:"hlsFragLoadProgress",FRAG_LOAD_EMERGENCY_ABORTED:"hlsFragLoadEmergencyAborted",FRAG_LOADED:"hlsFragLoaded",FRAG_DECRYPTED:"hlsFragDecrypted",FRAG_PARSING_INIT_SEGMENT:"hlsFragParsingInitSegment",FRAG_PARSING_USERDATA:"hlsFragParsingUserdata",FRAG_PARSING_METADATA:"hlsFragParsingMetadata",FRAG_PARSING_DATA:"hlsFragParsingData",FRAG_PARSED:"hlsFragParsed",FRAG_BUFFERED:"hlsFragBuffered",FRAG_CHANGED:"hlsFragChanged",FPS_DROP:"hlsFpsDrop",FPS_DROP_LEVEL_CAPPING:"hlsFpsDropLevelCapping",ERROR:"hlsError",DESTROYING:"hlsDestroying",KEY_LOADING:"hlsKeyLoading",KEY_LOADED:"hlsKeyLoaded",STREAM_STATE_TRANSITION:"hlsStreamStateTransition"}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorTypes={NETWORK_ERROR:"networkError",MEDIA_ERROR:"mediaError",MUX_ERROR:"muxError",OTHER_ERROR:"otherError"},t.ErrorDetails={MANIFEST_LOAD_ERROR:"manifestLoadError",MANIFEST_LOAD_TIMEOUT:"manifestLoadTimeOut",MANIFEST_PARSING_ERROR:"manifestParsingError",MANIFEST_INCOMPATIBLE_CODECS_ERROR:"manifestIncompatibleCodecsError",LEVEL_LOAD_ERROR:"levelLoadError",LEVEL_LOAD_TIMEOUT:"levelLoadTimeOut",LEVEL_SWITCH_ERROR:"levelSwitchError",AUDIO_TRACK_LOAD_ERROR:"audioTrackLoadError",AUDIO_TRACK_LOAD_TIMEOUT:"audioTrackLoadTimeOut",FRAG_LOAD_ERROR:"fragLoadError",FRAG_LOOP_LOADING_ERROR:"fragLoopLoadingError",FRAG_LOAD_TIMEOUT:"fragLoadTimeOut",FRAG_DECRYPT_ERROR:"fragDecryptError",FRAG_PARSING_ERROR:"fragParsingError",REMUX_ALLOC_ERROR:"remuxAllocError",KEY_LOAD_ERROR:"keyLoadError",KEY_LOAD_TIMEOUT:"keyLoadTimeOut",BUFFER_ADD_CODEC_ERROR:"bufferAddCodecError",BUFFER_APPEND_ERROR:"bufferAppendError",BUFFER_APPENDING_ERROR:"bufferAppendingError",BUFFER_STALLED_ERROR:"bufferStalledError",BUFFER_FULL_ERROR:"bufferFullError",BUFFER_SEEK_OVER_HOLE:"bufferSeekOverHole",BUFFER_NUDGE_ON_STALL:"bufferNudgeOnStall",INTERNAL_EXCEPTION:"internalException",WEBVTT_EXCEPTION:"webVTTException"}},function(e,t,n){function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o="function"==typeof Symbol&&"symbol"==r(Symbol.iterator)?function(e){return void 0===e?"undefined":r(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":r(e)};Object.defineProperty(t,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"===o(Symbol.iterator)?function(e){return void 0===e?"undefined":o(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":o(e)},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=n(2),d=n(1),c=function(e){return e&&e.__esModule?e:{default:e}}(d),f=function(){function e(t){i(this,e),this.hls=t,this.onEvent=this.onEvent.bind(this);for(var n=arguments.length,r=Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];this.handledEvents=r,this.useGenericHandler=!0,this.registerListeners()}return s(e,[{key:"destroy",value:function(){this.unregisterListeners()}},{key:"isEventHandler",value:function(){return"object"===a(this.handledEvents)&&this.handledEvents.length&&"function"==typeof this.onEvent}},{key:"registerListeners",value:function(){this.isEventHandler()&&this.handledEvents.forEach(function(e){if("hlsEventGeneric"===e)throw new Error("Forbidden event name: "+e);this.hls.on(e,this.onEvent)},this)}},{key:"unregisterListeners",value:function(){this.isEventHandler()&&this.handledEvents.forEach(function(e){this.hls.off(e,this.onEvent)},this)}},{key:"onEvent",value:function(e,t){this.onEventGeneric(e,t)}},{key:"onEventGeneric",value:function(e,t){var n=function(e,t){var n="on"+e.replace("hls","");if("function"!=typeof this[n])throw new Error("Event "+e+" has no generic handler in this "+this.constructor.name+" class (tried "+n+")");return this[n].bind(this,t)};try{n.call(this,e,t).call()}catch(t){l.logger.error("internal error happened while processing "+e+":"+t.message),this.hls.trigger(c.default.ERROR,{type:u.ErrorTypes.OTHER_ERROR,details:u.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:e,err:t})}}}]),e}();t.default=f},function(e,t,n){var r={isBuffered:function(e,t){if(e)for(var n=e.buffered,r=0;r<n.length;r++)if(t>=n.start(r)&&t<=n.end(r))return!0;return!1},bufferInfo:function(e,t,n){if(e){var r,i=e.buffered,o=[];for(r=0;r<i.length;r++)o.push({start:i.start(r),end:i.end(r)});return this.bufferedInfo(o,t,n)}return{len:0,start:t,end:t,nextStart:void 0}},bufferedInfo:function(e,t,n){var r,i,o,a,s,l=[];for(e.sort(function(e,t){return e.start-t.start||t.end-e.end}),s=0;s<e.length;s++){var u=l.length;if(u){var d=l[u-1].end;e[s].start-d<n?e[s].end>d&&(l[u-1].end=e[s].end):l.push(e[s])}else l.push(e[s])}for(s=0,r=0,i=o=t;s<l.length;s++){var c=l[s].start,f=l[s].end;if(t+n>=c&&t<f)i=c,o=f,r=o-t;else if(t+n<c){a=c;break}}return{len:r,start:i,end:o,nextStart:a}}};e.exports=r},function(e,t,n){function i(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function o(e){return"function"==typeof e}function a(e){return"number"==typeof e}function s(e){return"object"===(void 0===e?"undefined":u(e))&&null!==e}function l(e){return void 0===e}var u="function"==typeof Symbol&&"symbol"==r(Symbol.iterator)?function(e){return void 0===e?"undefined":r(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":r(e)};e.exports=i,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._maxListeners=void 0,i.defaultMaxListeners=10,i.prototype.setMaxListeners=function(e){if(!a(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},i.prototype.emit=function(e){var t,n,r,i,a,u;if(this._events||(this._events={}),"error"===e&&(!this._events.error||s(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var d=new Error('Uncaught, unspecified "error" event. ('+t+")");throw d.context=t,d}if(n=this._events[e],l(n))return!1;if(o(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:i=Array.prototype.slice.call(arguments,1),n.apply(this,i)}else if(s(n))for(i=Array.prototype.slice.call(arguments,1),u=n.slice(),r=u.length,a=0;a<r;a++)u[a].apply(this,i);return!0},i.prototype.addListener=function(e,t){var n;if(!o(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,o(t.listener)?t.listener:t),this._events[e]?s(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,s(this._events[e])&&!this._events[e].warned&&(n=l(this._maxListeners)?i.defaultMaxListeners:this._maxListeners)&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},i.prototype.on=i.prototype.addListener,i.prototype.once=function(e,t){function n(){this.removeListener(e,n),r||(r=!0,t.apply(this,arguments))}if(!o(t))throw TypeError("listener must be a function");var r=!1;return n.listener=t,this.on(e,n),this},i.prototype.removeListener=function(e,t){var n,r,i,a;if(!o(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],i=n.length,r=-1,n===t||o(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(s(n)){for(a=i;a-- >0;)if(n[a]===t||n[a].listener&&n[a].listener===t){r=a;break}if(r<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},i.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],o(n))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},i.prototype.listeners=function(e){return this._events&&this._events[e]?o(this._events[e])?[this._events[e]]:this._events[e].slice():[]},i.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(o(t))return 1;if(t)return t.length}return 0},i.listenerCount=function(e,t){return e.listenerCount(t)}},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(){r(this,e)}return i(e,null,[{key:"isHeader",value:function(e,t){return t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128}},{key:"isFooter",value:function(e,t){return t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128}},{key:"getID3Data",value:function(t,n){for(var r=n,i=0;e.isHeader(t,n);)i+=10,i+=e._readSize(t,n+6),e.isFooter(t,n+10)&&(i+=10),n+=i;if(i>0)return t.subarray(r,r+i)}},{key:"_readSize",value:function(e,t){var n=0;return n=(127&e[t])<<21,n|=(127&e[t+1])<<14,n|=(127&e[t+2])<<7,n|=127&e[t+3]}},{key:"getTimeStamp",value:function(t){for(var n=e.getID3Frames(t),r=0;r<n.length;r++){var i=n[r];if(e.isTimeStampFrame(i))return e._readTimeStamp(i)}}},{key:"isTimeStampFrame",value:function(e){return e&&"PRIV"===e.key&&"com.apple.streaming.transportStreamTimestamp"===e.info}},{key:"_getFrameData",value:function(t){var n=String.fromCharCode(t[0],t[1],t[2],t[3]),r=e._readSize(t,4);return{type:n,size:r,data:t.subarray(10,10+r)}}},{key:"getID3Frames",value:function(t){for(var n=0,r=[];e.isHeader(t,n);){var i=e._readSize(t,n+6);n+=10;for(var o=n+i;n+8<o;){var a=e._getFrameData(t.subarray(n)),s=e._decodeFrame(a);s&&r.push(s),n+=a.size+10}e.isFooter(t,n)&&(n+=10)}return r}},{key:"_decodeFrame",value:function(t){return"PRIV"===t.type?e._decodePrivFrame(t):"T"===t.type[0]?e._decodeTextFrame(t):"W"===t.type[0]?e._decodeURLFrame(t):void 0}},{key:"_readTimeStamp",value:function(e){if(8===e.data.byteLength){var t=new Uint8Array(e.data),n=1&t[3],r=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return r/=45,n&&(r+=47721858.84),Math.round(r)}}},{key:"_decodePrivFrame",value:function(t){if(!(t.size<2)){var n=e._utf8ArrayToStr(t.data),r=new Uint8Array(t.data.subarray(n.length+1));return{key:t.type,info:n,data:r.buffer}}}},{key:"_decodeTextFrame",value:function(t){if(!(t.size<2)){if("TXXX"===t.type){var n=1,r=e._utf8ArrayToStr(t.data.subarray(n));n+=r.length+1;var i=e._utf8ArrayToStr(t.data.subarray(n));return{key:t.type,info:r,data:i}}var o=e._utf8ArrayToStr(t.data.subarray(1));return{key:t.type,data:o}}}},{key:"_decodeURLFrame",value:function(t){if("WXXX"===t.type){if(t.size<2)return;var n=1,r=e._utf8ArrayToStr(t.data.subarray(n));n+=r.length+1;var i=e._utf8ArrayToStr(t.data.subarray(n));return{key:t.type,info:r,data:i}}var o=e._utf8ArrayToStr(t.data);return{key:t.type,data:o}}},{key:"_utf8ArrayToStr",value:function(e){for(var t=void 0,n=void 0,r="",i=0,o=e.length;i<o;){var a=e[i++];switch(a>>4){case 0:return r;case 1:case 2:case 3:case 4:case 5:case 6:case 7:r+=String.fromCharCode(a);break;case 12:case 13:t=e[i++],r+=String.fromCharCode((31&a)<<6|63&t);break;case 14:t=e[i++],n=e[i++],r+=String.fromCharCode((15&a)<<12|(63&t)<<6|(63&n)<<0)}}return r}}]),e}();t.default=o},function(e,t,n){var r={search:function(e,t){for(var n=0,r=e.length-1,i=null,o=null;n<=r;){i=(n+r)/2|0,o=e[i];var a=t(o);if(a>0)n=i+1;else{if(!(a<0))return o;r=i-1}}return null}};e.exports=r},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(31),s=r(a),l=n(33),u=r(l),d=n(32),c=r(d),f=n(2),h=n(0),p=function(){function e(t,n){i(this,e),this.observer=t,this.config=n,this.logEnabled=!0;try{var r=crypto||self.crypto;this.subtle=r.subtle||r.webkitSubtle}catch(e){}this.disableWebCrypto=!this.subtle}return o(e,[{key:"isSync",value:function(){return this.disableWebCrypto&&this.config.enableSoftwareAES}},{key:"decrypt",value:function(e,t,n,r){var i=this;if(this.disableWebCrypto&&this.config.enableSoftwareAES){this.logEnabled&&(h.logger.log("JS AES decrypt"),this.logEnabled=!1);var o=this.decryptor;o||(this.decryptor=o=new c.default),o.expandKey(t),r(o.decrypt(e,0,n))}else{this.logEnabled&&(h.logger.log("WebCrypto AES decrypt"),this.logEnabled=!1);var a=this.subtle;this.key!==t&&(this.key=t,this.fastAesKey=new u.default(a,t)),this.fastAesKey.expandKey().then(function(o){new s.default(a,n).decrypt(e,o).catch(function(o){i.onWebCryptoError(o,e,t,n,r)}).then(function(e){r(e)})}).catch(function(o){i.onWebCryptoError(o,e,t,n,r)})}}},{key:"onWebCryptoError",value:function(e,t,n,r,i){this.config.enableSoftwareAES?(h.logger.log("WebCrypto Error, disable WebCrypto API"),this.disableWebCrypto=!0,this.logEnabled=!0,this.decrypt(t,n,r,i)):(h.logger.error("decrypting error : "+e.message),this.observer.trigger(Event.ERROR,{type:f.ErrorTypes.MEDIA_ERROR,details:f.ErrorDetails.FRAG_DECRYPT_ERROR,fatal:!0,reason:e.message}))}},{key:"destroy",value:function(){var e=this.decryptor;e&&(e.destroy(),this.decryptor=void 0)}}]),e}();t.default=p},function(e,t,n){var r=n(0),i=n(2),o={getAudioConfig:function(e,t,n,o){var a,s,l,u,d,c=navigator.userAgent.toLowerCase(),f=o,h=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];return a=1+((192&t[n+2])>>>6),(s=(60&t[n+2])>>>2)>h.length-1?void e.trigger(Event.ERROR,{type:i.ErrorTypes.MEDIA_ERROR,details:i.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+s}):(u=(1&t[n+2])<<2,u|=(192&t[n+3])>>>6,r.logger.log("manifest codec:"+o+",ADTS data:type:"+a+",sampleingIndex:"+s+"["+h[s]+"Hz],channelConfig:"+u),/firefox/i.test(c)?s>=6?(a=5,d=new Array(4),l=s-3):(a=2,d=new Array(2),l=s):-1!==c.indexOf("android")?(a=2,d=new Array(2),l=s):(a=5,d=new Array(4),o&&(-1!==o.indexOf("mp4a.40.29")||-1!==o.indexOf("mp4a.40.5"))||!o&&s>=6?l=s-3:((o&&-1!==o.indexOf("mp4a.40.2")&&(s>=6&&1===u||/vivaldi/i.test(c))||!o&&1===u)&&(a=2,d=new Array(2)),l=s)),d[0]=a<<3,d[0]|=(14&s)>>1,d[1]|=(1&s)<<7,d[1]|=u<<3,5===a&&(d[1]|=(14&l)>>1,d[2]=(1&l)<<7,d[2]|=8,d[3]=0),{config:d,samplerate:h[s],channelCount:u,codec:"mp4a.40."+a,manifestCodec:f})},isHeaderPattern:function(e,t){return 255===e[t]&&240==(246&e[t+1])},getHeaderLength:function(e,t){return 1&e[t+1]?7:9},getFullFrameLength:function(e,t){return(3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5},isHeader:function(e,t){return!!(t+1<e.length&&this.isHeaderPattern(e,t))},probe:function(e,t){if(t+1<e.length&&this.isHeaderPattern(e,t)){var n=this.getHeaderLength(e,t),r=n;t+5<e.length&&(r=this.getFullFrameLength(e,t));var i=t+r;if(i===e.length||i+1<e.length&&this.isHeaderPattern(e,i))return!0}return!1},initTrackConfig:function(e,t,n,i,o){if(!e.samplerate){var a=this.getAudioConfig(t,n,i,o);e.config=a.config,e.samplerate=a.samplerate,e.channelCount=a.channelCount,e.codec=a.codec,e.manifestCodec=a.manifestCodec,r.logger.log("parsed codec:"+e.codec+",rate:"+a.samplerate+",nb channel:"+a.channelCount)}},getFrameDuration:function(e){return 9216e4/e},appendFrame:function(e,t,n,r,i){var o=this.getFrameDuration(e.samplerate),a=this.parseFrameHeader(t,n,r,i,o);if(a){var s=a.stamp,l=a.headerLength,u=a.frameLength,d={unit:t.subarray(n+l,n+l+u),pts:s,dts:s};return e.samples.push(d),e.len+=u,{sample:d,length:u+l}}},parseFrameHeader:function(e,t,n,r,i){var o,a,s,l=e.length;if(o=this.getHeaderLength(e,t),a=this.getFullFrameLength(e,t),(a-=o)>0&&t+o+a<=l)return s=n+r*i,{headerLength:o,frameLength:a,stamp:s}}};e.exports=o},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(1),s=r(a),l=n(2),u=n(8),d=r(u),c=n(34),f=r(c),h=n(38),p=r(h),m=n(40),g=r(m),y=n(37),v=r(y),_=n(47),b=r(_),E=n(48),T=r(E),S=function(){function e(t,n,r,o){i(this,e),this.observer=t,this.typeSupported=n,this.config=r,this.vendor=o}return o(e,[{key:"destroy",value:function(){var e=this.demuxer;e&&e.destroy()}},{key:"push",value:function(e,t,n,r,i,o,a,l,u,c,f,h){if(e.byteLength>0&&null!=t&&null!=t.key&&"AES-128"===t.method){var p=this.decrypter;null==p&&(p=this.decrypter=new d.default(this.observer,this.config));var m,g=this;try{m=performance.now()}catch(e){m=Date.now()}p.decrypt(e,t.key.buffer,t.iv.buffer,function(e){var d;try{d=performance.now()}catch(e){d=Date.now()}g.observer.trigger(s.default.FRAG_DECRYPTED,{stats:{tstart:m,tdecrypt:d}}),g.pushDecrypted(new Uint8Array(e),t,new Uint8Array(n),r,i,o,a,l,u,c,f,h)})}else this.pushDecrypted(new Uint8Array(e),t,new Uint8Array(n),r,i,o,a,l,u,c,f,h)}},{key:"pushDecrypted",value:function(e,t,n,r,i,o,a,u,d,c,h,m){var y=this.demuxer;if(!y||a&&!this.probe(e)){for(var _=this.observer,E=this.typeSupported,S=this.config,x=[{demux:f.default,remux:b.default},{demux:v.default,remux:b.default},{demux:g.default,remux:b.default},{demux:p.default,remux:T.default}],w=0,I=x.length;w<I;w++){var D=x[w],R=D.demux.probe;if(R(e)){var A=this.remuxer=new D.remux(_,S,E,this.vendor);y=new D.demux(_,A,S,E),this.probe=R;break}}if(!y)return void _.trigger(s.default.ERROR,{type:l.ErrorTypes.MEDIA_ERROR,details:l.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"});this.demuxer=y}var P=this.remuxer;(a||u)&&(y.resetInitSegment(n,r,i,c),P.resetInitSegment()),a&&(y.resetTimeStamp(m),P.resetTimeStamp(m)),"function"==typeof y.setDecryptData&&y.setDecryptData(t),y.append(e,o,d,h)}}]),e}();t.default=S},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(1),s=r(a),l=n(10),u=r(l),d=n(35),c=r(d),f=n(0),h=n(2),p=n(5),m=r(p),g=function(){function e(t,r){i(this,e),this.hls=t,this.id=r;var o=this.observer=new m.default,a=t.config;o.trigger=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];o.emit.apply(o,[e,e].concat(n))},o.off=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];o.removeListener.apply(o,[e].concat(n))};var l=function(e,n){n=n||{},n.frag=this.frag,n.id=this.id,t.trigger(e,n)}.bind(this);o.on(s.default.FRAG_DECRYPTED,l),o.on(s.default.FRAG_PARSING_INIT_SEGMENT,l),o.on(s.default.FRAG_PARSING_DATA,l),o.on(s.default.FRAG_PARSED,l),o.on(s.default.ERROR,l),o.on(s.default.FRAG_PARSING_METADATA,l),o.on(s.default.FRAG_PARSING_USERDATA,l),o.on(s.default.INIT_PTS_FOUND,l);var d={mp4:MediaSource.isTypeSupported("video/mp4"),mpeg:MediaSource.isTypeSupported("audio/mpeg"),mp3:MediaSource.isTypeSupported('audio/mp4; codecs="mp3"')},p=navigator.vendor;if(a.enableWorker&&"undefined"!=typeof Worker){f.logger.log("demuxing in webworker");var g=void 0;try{var y=n(59);g=this.w=y(c.default),this.onwmsg=this.onWorkerMessage.bind(this),g.addEventListener("message",this.onwmsg),g.onerror=function(e){t.trigger(s.default.ERROR,{type:h.ErrorTypes.OTHER_ERROR,details:h.ErrorDetails.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",err:{message:e.message+" ("+e.filename+":"+e.lineno+")"}})},g.postMessage({cmd:"init",typeSupported:d,vendor:p,id:r,config:JSON.stringify(a)})}catch(e){f.logger.error("error while initializing DemuxerWorker, fallback on DemuxerInline"),g&&URL.revokeObjectURL(g.objectURL),this.demuxer=new u.default(o,d,a,p),this.w=void 0}}else this.demuxer=new u.default(o,d,a,p)}return o(e,[{key:"destroy",value:function(){var e=this.w;if(e)e.removeEventListener("message",this.onwmsg),e.terminate(),this.w=null;else{var t=this.demuxer;t&&(t.destroy(),this.demuxer=null)}var n=this.observer;n&&(n.removeAllListeners(),this.observer=null)}},{key:"push",value:function(e,t,n,r,i,o,a,s){var l=this.w,u=isNaN(i.startDTS)?i.start:i.startDTS,d=i.decryptdata,c=this.frag,h=!(c&&i.cc===c.cc),p=!(c&&i.level===c.level),m=c&&i.sn===c.sn+1,g=!p&&m;if(h&&f.logger.log(this.id+":discontinuity detected"),p&&f.logger.log(this.id+":switch detected"),this.frag=i,l)l.postMessage({cmd:"demux",data:e,decryptdata:d,initSegment:t,audioCodec:n,videoCodec:r,timeOffset:u,discontinuity:h,trackSwitch:p,contiguous:g,duration:o,accurateTimeOffset:a,defaultInitPTS:s},[e]);else{var y=this.demuxer;y&&y.push(e,d,t,n,r,u,h,p,g,o,a,s)}}},{key:"onWorkerMessage",value:function(e){var t=e.data,n=this.hls;switch(t.event){case"init":URL.revokeObjectURL(this.w.objectURL);break;case s.default.FRAG_PARSING_DATA:t.data.data1=new Uint8Array(t.data1),t.data2&&(t.data.data2=new Uint8Array(t.data2));default:t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,n.trigger(t.event,t.data)}}}]),e}();t.default=g},function(e,t,n){var r={BitratesMap:[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],SamplingRateMap:[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],appendFrame:function(e,t,n,r,i){if(!(n+24>t.length)){var o=this.parseHeader(t,n);if(o&&n+o.frameLength<=t.length){var a=10368e4/o.sampleRate,s=r+i*a,l={unit:t.subarray(n,n+o.frameLength),pts:s,dts:s};return e.config=[],e.channelCount=o.channelCount,e.samplerate=o.sampleRate,e.samples.push(l),e.len+=o.frameLength,{sample:l,length:o.frameLength}}}},parseHeader:function(e,t){var n=e[t+1]>>3&3,i=e[t+1]>>1&3,o=e[t+2]>>4&15,a=e[t+2]>>2&3,s=!!(2&e[t+2]);if(1!==n&&0!==o&&15!==o&&3!==a){var l=3===n?3-i:3===i?3:4,u=1e3*r.BitratesMap[14*l+o-1],d=3===n?0:2===n?1:2,c=r.SamplingRateMap[3*d+a],f=s?1:0;return{sampleRate:c,channelCount:e[t+3]>>6==3?1:2,frameLength:3===i?(3===n?12:6)*u/c+f<<2:(3===n?144:72)*u/c+f|0}}},isHeaderPattern:function(e,t){return 255===e[t]&&224==(224&e[t+1])&&0!=(6&e[t+1])},isHeader:function(e,t){return!!(t+1<e.length&&this.isHeaderPattern(e,t))},probe:function(e,t){if(t+1<e.length&&this.isHeaderPattern(e,t)){var n=this.parseHeader(e,t),r=4;n&&n.frameLength&&(r=n.frameLength);var i=t+r;if(i===e.length||i+1<e.length&&this.isHeaderPattern(e,i))return!0}return!1}};e.exports=r},function(e,t,n){var r=n(0),i={mergeDetails:function(e,t){var n,o=Math.max(e.startSN,t.startSN)-t.startSN,a=Math.min(e.endSN,t.endSN)-t.startSN,s=t.startSN-e.startSN,l=e.fragments,u=t.fragments,d=0;if(a<o)return void(t.PTSKnown=!1);for(var c=o;c<=a;c++){var f=l[s+c],h=u[c];h&&f&&(d=f.cc-h.cc,isNaN(f.startPTS)||(h.start=h.startPTS=f.startPTS,h.endPTS=f.endPTS,h.duration=f.duration,h.backtracked=f.backtracked,h.dropped=f.dropped,n=h))}if(d)for(r.logger.log("discontinuity sliding from playlist, take drift into account"),c=0;c<u.length;c++)u[c].cc+=d;if(n)i.updateFragPTSDTS(t,n,n.startPTS,n.endPTS,n.startDTS,n.endDTS);else if(s>=0&&s<l.length){var p=l[s].start;for(c=0;c<u.length;c++)u[c].start+=p}t.PTSKnown=e.PTSKnown},updateFragPTSDTS:function(e,t,n,r,o,a){var s=n;if(!isNaN(t.startPTS)){var l=Math.abs(t.startPTS-n);isNaN(t.deltaPTS)?t.deltaPTS=l:t.deltaPTS=Math.max(l,t.deltaPTS),s=Math.max(n,t.startPTS),n=Math.min(n,t.startPTS),r=Math.max(r,t.endPTS),o=Math.min(o,t.startDTS),a=Math.max(a,t.endDTS)}var u=n-t.start;t.start=t.startPTS=n,t.maxStartPTS=s,t.endPTS=r,t.startDTS=o,t.endDTS=a,t.duration=r-n;var d=t.sn;if(!e||d<e.startSN||d>e.endSN)return 0;var c,f,h;for(c=d-e.startSN,f=e.fragments,f[c]=t,h=c;h>0;h--)i.updatePTS(f,h,h-1);for(h=c;h<f.length-1;h++)i.updatePTS(f,h,h+1);return e.PTSKnown=!0,u},updatePTS:function(e,t,n){var i=e[t],o=e[n],a=o.startPTS;isNaN(a)?o.start=n>t?i.start+i.duration:Math.max(i.start-o.duration,0):n>t?(i.duration=a-i.start,i.duration<0&&r.logger.warn("negative duration computed for frag "+i.sn+",level "+i.level+", there should be some duration drift between playlist and fragment!")):(o.duration=i.start-a,o.duration<0&&r.logger.warn("negative duration computed for frag "+o.sn+",level "+o.level+", there should be some duration drift between playlist and fragment!"))}};e.exports=i},function(e,t,n){var r={toString:function(e){for(var t="",n=e.length,r=0;r<n;r++)t+="["+e.start(r).toFixed(3)+","+e.end(r).toFixed(3)+"]";return t}};e.exports=r},function(e,t,n){function r(){this.window=window,this.state="INITIAL",this.buffer="",this.decoder=new c,this.regionList=[]}function i(e){function t(e,t,n,r){return 3600*(0|e)+60*(0|t)+(0|n)+(0|r)/1e3}var n=e.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return n?n[3]?t(n[1],n[2],n[3].replace(":",""),n[4]):n[1]>59?t(n[1],n[2],0,n[4]):t(0,n[1],n[2],n[4]):null}function o(){this.values=Object.create(null)}function a(e,t,n,r){var i=r?e.split(r):[e];for(var o in i)if("string"==typeof i[o]){var a=i[o].split(n);if(2===a.length){var s=a[0],l=a[1];t(s,l)}}}function s(e,t,n){function r(){var t=i(e);if(null===t)throw new Error("Malformed timestamp: "+l);return e=e.replace(/^[^\sa-zA-Z-]+/,""),t}function s(){e=e.replace(/^\s+/,"")}var l=e;if(s(),t.startTime=r(),s(),"--\x3e"!==e.substr(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+l);e=e.substr(3),s(),t.endTime=r(),s(),function(e,t){var r=new o;a(e,function(e,t){switch(e){case"region":for(var i=n.length-1;i>=0;i--)if(n[i].id===t){r.set(e,n[i].region);break}break;case"vertical":r.alt(e,t,["rl","lr"]);break;case"line":var o=t.split(","),a=o[0];r.integer(e,a),r.percent(e,a)&&r.set("snapToLines",!1),r.alt(e,a,["auto"]),2===o.length&&r.alt("lineAlign",o[1],["start",h,"end"]);break;case"position":o=t.split(","),r.percent(e,o[0]),2===o.length&&r.alt("positionAlign",o[1],["start",h,"end","line-left","line-right","auto"]);break;case"size":r.percent(e,t);break;case"align":r.alt(e,t,["start",h,"end","left","right"])}},/:/,/\s/),t.region=r.get("region",null),t.vertical=r.get("vertical","");var i=r.get("line","auto");"auto"===i&&-1===f.line&&(i=-1),t.line=i,t.lineAlign=r.get("lineAlign","start"),t.snapToLines=r.get("snapToLines",!0),t.size=r.get("size",100),t.align=r.get("align",h);var s=r.get("position","auto");"auto"===s&&50===f.position&&(s="start"===t.align||"left"===t.align?0:"end"===t.align||"right"===t.align?100:50),t.position=s}(e,t)}function l(e){return e.replace(/<br(?: \/)?>/gi,"\n")}Object.defineProperty(t,"__esModule",{value:!0}),t.fixLineBreaks=void 0;var u=n(55),d=function(e){return e&&e.__esModule?e:{default:e}}(u),c=function(){return{decode:function(e){if(!e)return"";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}};o.prototype={set:function(e,t){this.get(e)||""===t||(this.values[e]=t)},get:function(e,t,n){return n?this.has(e)?this.values[e]:t[n]:this.has(e)?this.values[e]:t},has:function(e){return e in this.values},alt:function(e,t,n){for(var r=0;r<n.length;++r)if(t===n[r]){this.set(e,t);break}},integer:function(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))},percent:function(e,t){return!!(t.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(t=parseFloat(t))>=0&&t<=100)&&(this.set(e,t),!0)}};var f=new d.default(0,0,0),h="middle"===f.align?"middle":"center";r.prototype={parse:function(e){function t(){var e=n.buffer,t=0;for(e=l(e);t<e.length&&"\r"!==e[t]&&"\n"!==e[t];)++t;var r=e.substr(0,t);return"\r"===e[t]&&++t,"\n"===e[t]&&++t,n.buffer=e.substr(t),r}var n=this;e&&(n.buffer+=n.decoder.decode(e,{stream:!0}));try{var r;if("INITIAL"===n.state){if(!/\r\n|\n/.test(n.buffer))return this;r=t();var i=r.match(/^WEBVTT([ \t].*)?$/);if(!i||!i[0])throw new Error("Malformed WebVTT signature.");n.state="HEADER"}for(var o=!1;n.buffer;){if(!/\r\n|\n/.test(n.buffer))return this;switch(o?o=!1:r=t(),n.state){case"HEADER":/:/.test(r)?function(e){a(e,function(e,t){switch(e){case"Region":console.log("parse region",t)}},/:/)}(r):r||(n.state="ID");continue;case"NOTE":r||(n.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(r)){n.state="NOTE";break}if(!r)continue;if(n.cue=new d.default(0,0,""),n.state="CUE",-1===r.indexOf("--\x3e")){n.cue.id=r;continue}case"CUE":try{s(r,n.cue,n.regionList)}catch(e){n.cue=null,n.state="BADCUE";continue}n.state="CUETEXT";continue;case"CUETEXT":var u=-1!==r.indexOf("--\x3e");if(!r||u&&(o=!0)){n.oncue&&n.oncue(n.cue),n.cue=null,n.state="ID";continue}n.cue.text&&(n.cue.text+="\n"),n.cue.text+=r;continue;case"BADCUE":r||(n.state="ID");continue}}}catch(e){"CUETEXT"===n.state&&n.cue&&n.oncue&&n.oncue(n.cue),n.cue=null,n.state="INITIAL"===n.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){var e=this;try{if(e.buffer+=e.decoder.decode(),(e.cue||"HEADER"===e.state)&&(e.buffer+="\n\n",e.parse()),"INITIAL"===e.state)throw new Error("Malformed WebVTT signature.")}catch(e){throw e}return e.onflush&&e.onflush(),this}},t.fixLineBreaks=l,t.default=r},function(e,t,n){(function(e){var n,i,o="function"==typeof Symbol&&"symbol"==r(Symbol.iterator)?function(e){return void 0===e?"undefined":r(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":r(e)};!function(r){var a=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/\;?#]*)?(.*?)??(;.*?)?(\?.*?)?(#.*?)?$/,s=/^([^\/;?#]*)(.*)$/,l=/(?:\/|^)\.(?=\/)/g,u=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g,d={buildAbsoluteURL:function(e,t,n){if(n=n||{},e=e.trim(),!(t=t.trim())){if(!n.alwaysNormalize)return e;var r=d.parseURL(e);if(!r)throw new Error("Error trying to parse base URL.");return r.path=d.normalizePath(r.path),d.buildURLFromParts(r)}var i=d.parseURL(t);if(!i)throw new Error("Error trying to parse relative URL.");if(i.scheme)return n.alwaysNormalize?(i.path=d.normalizePath(i.path),d.buildURLFromParts(i)):t;var o=d.parseURL(e);if(!o)throw new Error("Error trying to parse base URL.");if(!o.netLoc&&o.path&&"/"!==o.path[0]){var a=s.exec(o.path);o.netLoc=a[1],o.path=a[2]}o.netLoc&&!o.path&&(o.path="/");var l={scheme:o.scheme,netLoc:i.netLoc,path:null,params:i.params,query:i.query,fragment:i.fragment};if(!i.netLoc&&(l.netLoc=o.netLoc,"/"!==i.path[0]))if(i.path){var u=o.path,c=u.substring(0,u.lastIndexOf("/")+1)+i.path;l.path=d.normalizePath(c)}else l.path=o.path,i.params||(l.params=o.params,i.query||(l.query=o.query));return null===l.path&&(l.path=n.alwaysNormalize?d.normalizePath(i.path):i.path),d.buildURLFromParts(l)},parseURL:function(e){var t=a.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(l,"");e.length!==(e=e.replace(u,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}};"object"===o(t)&&"object"===o(e)?e.exports=d:(n=[],void 0!==(i=function(){return d}.apply(t,n))&&(e.exports=i))}()}).call(t,n(58)(e))},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(60),i=function(e){return e&&e.__esModule?e:{default:e}}(r);t.default=i.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.hlsDefaultConfig=void 0;var i=n(19),o=r(i),a=n(22),s=r(a),l=n(23),u=r(l),d=n(24),c=r(d),f=n(57),h=r(f),p=n(21),m=r(p),g=n(20),y=r(g),v=n(51),_=r(v),b=n(30),E=r(b),T=n(29),S=r(T),x=n(28),w=r(x);t.hlsDefaultConfig={autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,maxBufferSize:6e7,maxBufferHole:.5,maxSeekHole:2,lowBufferWatchdogPeriod:.5,highBufferWatchdogPeriod:3,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,fragLoadingLoopThreshold:3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:h.default,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,fetchSetup:void 0,abrController:o.default,bufferController:s.default,capLevelController:u.default,fpsController:c.default,audioStreamController:y.default,audioTrackController:m.default,subtitleStreamController:w.default,subtitleTrackController:S.default,timelineController:E.default,cueHandler:_.default,enableCEA708Captions:!0,enableWebVTT:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",stretchShortVideoTrack:!1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0}},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":l(t))&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":l(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l="function"==typeof Symbol&&"symbol"==r(Symbol.iterator)?function(e){return void 0===e?"undefined":r(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":r(e)};Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),d=n(1),c=i(d),f=n(3),h=i(f),p=n(4),m=i(p),g=n(2),y=n(0),v=n(53),_=i(v),b=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,c.default.FRAG_LOADING,c.default.FRAG_LOADED,c.default.FRAG_BUFFERED,c.default.ERROR));return n.lastLoadedFragLevel=0,n._nextAutoLevel=-1,n.hls=e,n.timer=null,n._bwEstimator=null,n.onCheck=n._abandonRulesCheck.bind(n),n}return s(t,e),u(t,[{key:"destroy",value:function(){this.clearTimer(),h.default.prototype.destroy.call(this)}},{key:"onFragLoading",value:function(e){var t=e.frag;if("main"===t.type){if(this.timer||(this.timer=setInterval(this.onCheck,100)),!this._bwEstimator){var n=this.hls,r=e.frag.level,i=n.levels[r].details.live,o=n.config,a=void 0,s=void 0;i?(a=o.abrEwmaFastLive,s=o.abrEwmaSlowLive):(a=o.abrEwmaFastVoD,s=o.abrEwmaSlowVoD),this._bwEstimator=new _.default(n,s,a,o.abrEwmaDefaultEstimate)}this.fragCurrent=t}}},{key:"_abandonRulesCheck",value:function(){var e=this.hls,t=e.media,n=this.fragCurrent,r=n.loader,i=e.minAutoLevel;if(!r||r.stats&&r.stats.aborted)return y.logger.warn("frag loader destroy or aborted, disarm abandonRules"),void this.clearTimer();var o=r.stats;if(t&&o&&(!t.paused&&0!==t.playbackRate||!t.readyState)&&n.autoLevel&&n.level){var a=performance.now()-o.trequest,s=Math.abs(t.playbackRate);if(a>500*n.duration/s){var l=e.levels,u=Math.max(1,o.bw?o.bw/8:1e3*o.loaded/a),d=l[n.level],f=d.realBitrate?Math.max(d.realBitrate,d.bitrate):d.bitrate,h=o.total?o.total:Math.max(o.loaded,Math.round(n.duration*f/8)),p=t.currentTime,g=(h-o.loaded)/u,v=(m.default.bufferInfo(t,p,e.config.maxBufferHole).end-p)/s;if(v<2*n.duration/s&&g>v){var _=void 0,b=void 0;for(b=n.level-1;b>i;b--){var E=l[b].realBitrate?Math.max(l[b].realBitrate,l[b].bitrate):l[b].bitrate;if((_=n.duration*E/(6.4*u))<v)break}_<g&&(y.logger.warn("loading too slow, abort fragment loading and switch to level "+b+":fragLoadedDelay["+b+"]<fragLoadedDelay["+(n.level-1)+"];bufferStarvationDelay:"+_.toFixed(1)+"<"+g.toFixed(1)+":"+v.toFixed(1)),e.nextLoadLevel=b,this._bwEstimator.sample(a,o.loaded),r.abort(),this.clearTimer(),e.trigger(c.default.FRAG_LOAD_EMERGENCY_ABORTED,{frag:n,stats:o}))}}}}},{key:"onFragLoaded",value:function(e){var t=e.frag;if("main"===t.type&&!isNaN(t.sn)){if(this.clearTimer(),this.lastLoadedFragLevel=t.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var n=this.hls.levels[t.level],r=(n.loaded?n.loaded.bytes:0)+e.stats.loaded,i=(n.loaded?n.loaded.duration:0)+e.frag.duration;n.loaded={bytes:r,duration:i},n.realBitrate=Math.round(8*r/i)}if(e.frag.bitrateTest){var o=e.stats;o.tparsed=o.tbuffered=o.tload,this.onFragBuffered(e)}}}},{key:"onFragBuffered",value:function(e){var t=e.stats,n=e.frag;if(!(!0===t.aborted||1!==n.loadCounter||"main"!==n.type||isNaN(n.sn)||n.bitrateTest&&t.tload!==t.tbuffered)){var r=t.tparsed-t.trequest;y.logger.log("latency/loading/parsing/append/kbps:"+Math.round(t.tfirst-t.trequest)+"/"+Math.round(t.tload-t.tfirst)+"/"+Math.round(t.tparsed-t.tload)+"/"+Math.round(t.tbuffered-t.tparsed)+"/"+Math.round(8*t.loaded/(t.tbuffered-t.trequest))),this._bwEstimator.sample(r,t.loaded),t.bwEstimate=this._bwEstimator.getEstimate(),n.bitrateTest?this.bitrateTestDelay=r/1e3:this.bitrateTestDelay=0}}},{key:"onError",value:function(e){switch(e.details){case g.ErrorDetails.FRAG_LOAD_ERROR:case g.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer()}}},{key:"clearTimer",value:function(){clearInterval(this.timer),this.timer=null}},{key:"_findBestLevel",value:function(e,t,n,r,i,o,a,s,l){for(var u=i;u>=r;u--){var d=l[u],c=d.details,f=c?c.totalduration/c.fragments.length:t,h=!!c&&c.live,p=void 0;p=u<=e?a*n:s*n;var m=l[u].realBitrate?Math.max(l[u].realBitrate,l[u].bitrate):l[u].bitrate,g=m*f/p;if(y.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+u+"/"+Math.round(p)+"/"+m+"/"+f+"/"+o+"/"+g),p>m&&(!g||h&&!this.bitrateTestDelay||g<o))return u}return-1}},{key:"nextAutoLevel",get:function(){var e=this._nextAutoLevel,t=this._bwEstimator;if(!(-1===e||t&&t.canEstimate()))return e;var n=this._nextABRAutoLevel;return-1!==e&&(n=Math.min(e,n)),n},set:function(e){this._nextAutoLevel=e}},{key:"_nextABRAutoLevel",get:function(){var e=this.hls,t=e.maxAutoLevel,n=e.levels,r=e.config,i=e.minAutoLevel,o=e.media,a=this.lastLoadedFragLevel,s=this.fragCurrent?this.fragCurrent.duration:0,l=o?o.currentTime:0,u=o&&0!==o.playbackRate?Math.abs(o.playbackRate):1,d=this._bwEstimator?this._bwEstimator.getEstimate():r.abrEwmaDefaultEstimate,c=(m.default.bufferInfo(o,l,r.maxBufferHole).end-l)/u,f=this._findBestLevel(a,s,d,i,t,c,r.abrBandWidthFactor,r.abrBandWidthUpFactor,n);if(f>=0)return f;y.logger.trace("rebuffering expected to happen, lets try to find a quality level minimizing the rebuffering");var h=s?Math.min(s,r.maxStarvationDelay):r.maxStarvationDelay,p=r.abrBandWidthFactor,g=r.abrBandWidthUpFactor;if(0===c){var v=this.bitrateTestDelay;v&&(h=(s?Math.min(s,r.maxLoadingDelay):r.maxLoadingDelay)-v,y.logger.trace("bitrate test took "+Math.round(1e3*v)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*h)+" ms"),p=g=1)}return f=this._findBestLevel(a,s,d,i,t,c+h,p,g,n),Math.max(f,0)}}]),t}(h.default);t.default=b},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":l(t))&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":l(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l="function"==typeof Symbol&&"symbol"==r(Symbol.iterator)?function(e){return void 0===e?"undefined":r(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":r(e)};Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),d=n(7),c=i(d),f=n(4),h=i(f),p=n(11),m=i(p),g=n(1),y=i(g),v=n(3),_=i(v),b=n(13),E=i(b),T=n(14),S=i(T),x=n(2),w=n(0),I=n(52),D={STOPPED:"STOPPED",STARTING:"STARTING",IDLE:"IDLE",PAUSED:"PAUSED",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",BUFFER_FLUSHING:"BUFFER_FLUSHING",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS"},R=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,y.default.MEDIA_ATTACHED,y.default.MEDIA_DETACHING,y.default.AUDIO_TRACKS_UPDATED,y.default.AUDIO_TRACK_SWITCHING,y.default.AUDIO_TRACK_LOADED,y.default.KEY_LOADED,y.default.FRAG_LOADED,y.default.FRAG_PARSING_INIT_SEGMENT,y.default.FRAG_PARSING_DATA,y.default.FRAG_PARSED,y.default.ERROR,y.default.BUFFER_CREATED,y.default.BUFFER_APPENDED,y.default.BUFFER_FLUSHED,y.default.INIT_PTS_FOUND));return n.config=e.config,n.audioCodecSwap=!1,n.ticks=0,n._state=D.STOPPED,n.ontick=n.tick.bind(n),n.initPTS=[],n.waitingFragment=null,n.videoTrackCC=null,n}return s(t,e),u(t,[{key:"destroy",value:function(){this.stopLoad(),this.timer&&(clearInterval(this.timer),this.timer=null),_.default.prototype.destroy.call(this),this.state=D.STOPPED}},{key:"onInitPtsFound",value:function(e){var t=e.id,n=e.frag.cc,r=e.initPTS;"main"===t&&(this.initPTS[n]=r,this.videoTrackCC=n,w.logger.log("InitPTS for cc:"+n+" found from video track:"+r),this.state===D.WAITING_INIT_PTS&&this.tick())}},{key:"startLoad",value:function(e){if(this.tracks){var t=this.lastCurrentTime;this.stopLoad(),this.timer||(this.timer=setInterval(this.ontick,100)),this.fragLoadError=0,t>0&&-1===e?(w.logger.log("audio:override startPosition with lastCurrentTime @"+t.toFixed(3)),this.state=D.IDLE):(this.lastCurrentTime=this.startPosition?this.startPosition:e,this.state=D.STARTING),this.nextLoadPosition=this.startPosition=this.lastCurrentTime,this.tick()}else this.startPosition=e,this.state=D.STOPPED}},{key:"stopLoad",value:function(){var e=this.fragCurrent;e&&(e.loader&&e.loader.abort(),this.fragCurrent=null),this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=D.STOPPED}},{key:"tick",value:function(){1==++this.ticks&&(this.doTick(),this.ticks>1&&setTimeout(this.tick,1),this.ticks=0)}},{key:"doTick",value:function(){var e,t,n,r=this.hls,i=r.config;switch(this.state){case D.ERROR:case D.PAUSED:case D.BUFFER_FLUSHING:break;case D.STARTING:this.state=D.WAITING_TRACK,this.loadedmetadata=!1;break;case D.IDLE:var o=this.tracks;if(!o)break;if(!this.media&&(this.startFragRequested||!i.startFragPrefetch))break;if(this.loadedmetadata)e=this.media.currentTime;else if(void 0===(e=this.nextLoadPosition))break;var a=this.mediaBuffer?this.mediaBuffer:this.media,s=h.default.bufferInfo(a,e,i.maxBufferHole),l=s.len,u=s.end,d=this.fragPrevious,f=i.maxMaxBufferLength,p=this.audioSwitch,m=this.trackId;if((l<f||p)&&m<o.length){if(void 0===(n=o[m].details)){this.state=D.WAITING_TRACK;break}if(!p&&!n.live&&d&&d.sn===n.endSN&&(!this.media.seeking||this.media.duration-u<d.duration/2)){this.hls.trigger(y.default.BUFFER_EOS,{type:"audio"}),this.state=D.ENDED;break}var g=n.fragments,v=g.length,_=g[0].start,b=g[v-1].start+g[v-1].duration,E=void 0;if(p)if(n.live&&!n.PTSKnown)w.logger.log("switching audiotrack, live stream, unknown PTS,load first fragment"),u=0;else if(u=e,n.PTSKnown&&e<_){if(!(s.end>_||s.nextStart))return;w.logger.log("alt audio track ahead of main track, seek to start of alt audio track"),this.media.currentTime=_+.05}if(n.initSegment&&!n.initSegment.data)E=n.initSegment;else if(u<=_){if(E=g[0],null!==this.videoTrackCC&&E.cc!==this.videoTrackCC&&(E=(0,I.findFragWithCC)(g,this.videoTrackCC)),n.live&&E.loadIdx&&E.loadIdx===this.fragLoadIdx){var T=s.nextStart?s.nextStart:_;return w.logger.log("no alt audio available @currentTime:"+this.media.currentTime+", seeking @"+(T+.05)),void(this.media.currentTime=T+.05)}}else{var S=void 0,R=i.maxFragLookUpTolerance,A=d?g[d.sn-g[0].sn+1]:void 0,P=function(e){var t=Math.min(R,e.duration);return e.start+e.duration-t<=u?1:e.start-t>u&&e.start?-1:0};u<b?(u>b-R&&(R=0),S=A&&!P(A)?A:c.default.search(g,P)):S=g[v-1],S&&(E=S,_=S.start,d&&E.level===d.level&&E.sn===d.sn&&(E.sn<n.endSN?(E=g[E.sn+1-n.startSN],w.logger.log("SN just loaded, load next one: "+E.sn)):E=null))}if(E)if(E.decryptdata&&null!=E.decryptdata.uri&&null==E.decryptdata.key)w.logger.log("Loading key for "+E.sn+" of ["+n.startSN+" ,"+n.endSN+"],track "+m),this.state=D.KEY_LOADING,r.trigger(y.default.KEY_LOADING,{frag:E});else{if(w.logger.log("Loading "+E.sn+", cc: "+E.cc+" of ["+n.startSN+" ,"+n.endSN+"],track "+m+", currentTime:"+e+",bufferEnd:"+u.toFixed(3)),void 0!==this.fragLoadIdx?this.fragLoadIdx++:this.fragLoadIdx=0,E.loadCounter){E.loadCounter++;var M=i.fragLoadingLoopThreshold;if(E.loadCounter>M&&Math.abs(this.fragLoadIdx-E.loadIdx)<M)return void r.trigger(y.default.ERROR,{type:x.ErrorTypes.MEDIA_ERROR,details:x.ErrorDetails.FRAG_LOOP_LOADING_ERROR,fatal:!1,frag:E})}else E.loadCounter=1;E.loadIdx=this.fragLoadIdx,this.fragCurrent=E,this.startFragRequested=!0,isNaN(E.sn)||(this.nextLoadPosition=E.start+E.duration),r.trigger(y.default.FRAG_LOADING,{frag:E}),this.state=D.FRAG_LOADING}}break;case D.WAITING_TRACK:(t=this.tracks[this.trackId])&&t.details&&(this.state=D.IDLE);break;case D.FRAG_LOADING_WAITING_RETRY:var L=performance.now(),C=this.retryDate;a=this.media;var O=a&&a.seeking;(!C||L>=C||O)&&(w.logger.log("audioStreamController: retryDate reached, switch back to IDLE state"),this.state=D.IDLE);break;case D.WAITING_INIT_PTS:var k=this.videoTrackCC;if(void 0===this.initPTS[k])break;var N=this.waitingFragment;if(N){var F=N.frag.cc;k!==F?(t=this.tracks[this.trackId],t.details&&t.details.live&&(w.logger.warn("Waiting fragment CC ("+F+") does not match video track CC ("+k+")"),this.waitingFragment=null,this.state=D.IDLE)):(this.state=D.FRAG_LOADING,this.onFragLoaded(this.waitingFragment),this.waitingFragment=null)}else this.state=D.IDLE;break;case D.STOPPED:case D.FRAG_LOADING:case D.PARSING:case D.PARSED:case D.ENDED:}}},{key:"onMediaAttached",value:function(e){var t=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),t.addEventListener("seeking",this.onvseeking),t.addEventListener("ended",this.onvended);var n=this.config;this.tracks&&n.autoStartLoad&&this.startLoad(n.startPosition)}},{key:"onMediaDetaching",value:function(){var e=this.media;e&&e.ended&&(w.logger.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);var t=this.tracks;t&&t.forEach(function(e){e.details&&e.details.fragments.forEach(function(e){e.loadCounter=void 0})}),e&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.stopLoad()}},{key:"onMediaSeeking",value:function(){this.state===D.ENDED&&(this.state=D.IDLE),this.media&&(this.lastCurrentTime=this.media.currentTime),void 0!==this.fragLoadIdx&&(this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold),this.tick()}},{key:"onMediaEnded",value:function(){this.startPosition=this.lastCurrentTime=0}},{key:"onAudioTracksUpdated",value:function(e){w.logger.log("audio tracks updated"),this.tracks=e.audioTracks}},{key:"onAudioTrackSwitching",value:function(e){var t=!!e.url;this.trackId=e.id,this.fragCurrent=null,this.state=D.PAUSED,this.waitingFragment=null,t?this.timer||(this.timer=setInterval(this.ontick,100)):this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),t&&(this.audioSwitch=!0,this.state=D.IDLE,void 0!==this.fragLoadIdx&&(this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold)),this.tick()}},{key:"onAudioTrackLoaded",value:function(e){var t=e.details,n=e.id,r=this.tracks[n],i=t.totalduration,o=0;if(w.logger.log("track "+n+" loaded ["+t.startSN+","+t.endSN+"],duration:"+i),t.live){var a=r.details;a&&t.fragments.length>0?(E.default.mergeDetails(a,t),o=t.fragments[0].start,t.PTSKnown?w.logger.log("live audio playlist sliding:"+o.toFixed(3)):w.logger.log("live audio playlist - outdated PTS, unknown sliding")):(t.PTSKnown=!1,w.logger.log("live audio playlist - first load, unknown sliding"))}else t.PTSKnown=!1;if(r.details=t,!this.startFragRequested){if(-1===this.startPosition){var s=t.startTimeOffset;isNaN(s)?this.startPosition=0:(w.logger.log("start time offset found in playlist, adjust startPosition to "+s),this.startPosition=s)}this.nextLoadPosition=this.startPosition}this.state===D.WAITING_TRACK&&(this.state=D.IDLE),this.tick()}},{key:"onKeyLoaded",value:function(){this.state===D.KEY_LOADING&&(this.state=D.IDLE,this.tick())}},{key:"onFragLoaded",value:function(e){var t=this.fragCurrent,n=e.frag;if(this.state===D.FRAG_LOADING&&t&&"audio"===n.type&&n.level===t.level&&n.sn===t.sn){var r=this.tracks[this.trackId],i=r.details,o=i.totalduration,a=t.level,s=t.sn,l=t.cc,u=this.config.defaultAudioCodec||r.audioCodec||"mp4a.40.2",d=this.stats=e.stats;if("initSegment"===s)this.state=D.IDLE,d.tparsed=d.tbuffered=performance.now(),i.initSegment.data=e.payload,this.hls.trigger(y.default.FRAG_BUFFERED,{stats:d,frag:t,id:"audio"}),this.tick();else{this.state=D.PARSING,this.appended=!1,this.demuxer||(this.demuxer=new m.default(this.hls,"audio"));var c=this.initPTS[l],f=i.initSegment?i.initSegment.data:[];i.initSegment||void 0!==c?(this.pendingBuffering=!0,w.logger.log("Demuxing "+s+" of ["+i.startSN+" ,"+i.endSN+"],track "+a),this.demuxer.push(e.payload,f,u,null,t,o,!1,c)):(w.logger.log("unknown video PTS for continuity counter "+l+", waiting for video PTS before demuxing audio frag "+s+" of ["+i.startSN+" ,"+i.endSN+"],track "+a),this.waitingFragment=e,this.state=D.WAITING_INIT_PTS)}}this.fragLoadError=0}},{key:"onFragParsingInitSegment",value:function(e){var t=this.fragCurrent,n=e.frag;if(t&&"audio"===e.id&&n.sn===t.sn&&n.level===t.level&&this.state===D.PARSING){var r=e.tracks,i=void 0;if(r.video&&delete r.video,i=r.audio){i.levelCodec=i.codec,i.id=e.id,this.hls.trigger(y.default.BUFFER_CODECS,r),w.logger.log("audio track:audio,container:"+i.container+",codecs[level/parsed]=["+i.levelCodec+"/"+i.codec+"]");var o=i.initSegment;if(o){var a={type:"audio",data:o,parent:"audio",content:"initSegment"};this.audioSwitch?this.pendingData=[a]:(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(y.default.BUFFER_APPENDING,a))}this.tick()}}}},{key:"onFragParsingData",value:function(e){var t=this,n=this.fragCurrent,r=e.frag;if(n&&"audio"===e.id&&"audio"===e.type&&r.sn===n.sn&&r.level===n.level&&this.state===D.PARSING){var i=this.trackId,o=this.tracks[i],a=this.hls;isNaN(e.endPTS)&&(e.endPTS=e.startPTS+n.duration,e.endDTS=e.startDTS+n.duration),w.logger.log("parsed "+e.type+",PTS:["+e.startPTS.toFixed(3)+","+e.endPTS.toFixed(3)+"],DTS:["+e.startDTS.toFixed(3)+"/"+e.endDTS.toFixed(3)+"],nb:"+e.nb),E.default.updateFragPTSDTS(o.details,n,e.startPTS,e.endPTS);var s=this.audioSwitch,l=this.media,u=!1;if(s&&l)if(l.readyState){var d=l.currentTime;w.logger.log("switching audio track : currentTime:"+d),d>=e.startPTS&&(w.logger.log("switching audio track : flushing all audio"),this.state=D.BUFFER_FLUSHING,a.trigger(y.default.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),u=!0,this.audioSwitch=!1,a.trigger(y.default.AUDIO_TRACK_SWITCHED,{id:i}))}else this.audioSwitch=!1,a.trigger(y.default.AUDIO_TRACK_SWITCHED,{id:i});var c=this.pendingData;this.audioSwitch||([e.data1,e.data2].forEach(function(t){t&&t.length&&c.push({type:e.type,data:t,parent:"audio",content:"data"})}),!u&&c.length&&(c.forEach(function(e){t.state===D.PARSING&&(t.pendingBuffering=!0,t.hls.trigger(y.default.BUFFER_APPENDING,e))}),this.pendingData=[],this.appended=!0)),this.tick()}}},{key:"onFragParsed",value:function(e){var t=this.fragCurrent,n=e.frag;t&&"audio"===e.id&&n.sn===t.sn&&n.level===t.level&&this.state===D.PARSING&&(this.stats.tparsed=performance.now(),this.state=D.PARSED,this._checkAppendedParsed())}},{key:"onBufferCreated",value:function(e){var t=e.tracks.audio;t&&(this.mediaBuffer=t.buffer,this.loadedmetadata=!0)}},{key:"onBufferAppended",value:function(e){if("audio"===e.parent){var t=this.state;t!==D.PARSING&&t!==D.PARSED||(this.pendingBuffering=e.pending>0,this._checkAppendedParsed())}}},{key:"_checkAppendedParsed",value:function(){if(!(this.state!==D.PARSED||this.appended&&this.pendingBuffering)){var e=this.fragCurrent,t=this.stats,n=this.hls;if(e){this.fragPrevious=e,t.tbuffered=performance.now(),n.trigger(y.default.FRAG_BUFFERED,{stats:t,frag:e,id:"audio"});var r=this.mediaBuffer?this.mediaBuffer:this.media;w.logger.log("audio buffered : "+S.default.toString(r.buffered)),this.audioSwitch&&this.appended&&(this.audioSwitch=!1,n.trigger(y.default.AUDIO_TRACK_SWITCHED,{id:this.trackId})),this.state=D.IDLE}this.tick()}}},{key:"onError",value:function(e){var t=e.frag;if(!t||"audio"===t.type)switch(e.details){case x.ErrorDetails.FRAG_LOAD_ERROR:case x.ErrorDetails.FRAG_LOAD_TIMEOUT:if(!e.fatal){var n=this.fragLoadError;n?n++:n=1;var r=this.config;if(n<=r.fragLoadingMaxRetry){this.fragLoadError=n,t.loadCounter=0;var i=Math.min(Math.pow(2,n-1)*r.fragLoadingRetryDelay,r.fragLoadingMaxRetryTimeout);w.logger.warn("audioStreamController: frag loading failed, retry in "+i+" ms"),this.retryDate=performance.now()+i,this.state=D.FRAG_LOADING_WAITING_RETRY}else w.logger.error("audioStreamController: "+e.details+" reaches max retry, redispatch as fatal ..."),e.fatal=!0,this.state=D.ERROR}break;case x.ErrorDetails.FRAG_LOOP_LOADING_ERROR:case x.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case x.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:case x.ErrorDetails.KEY_LOAD_ERROR:case x.ErrorDetails.KEY_LOAD_TIMEOUT:this.state!==D.ERROR&&(this.state=e.fatal?D.ERROR:D.IDLE,w.logger.warn("audioStreamController: "+e.details+" while loading frag,switch to "+this.state+" state ..."));break;case x.ErrorDetails.BUFFER_FULL_ERROR:if("audio"===e.parent&&(this.state===D.PARSING||this.state===D.PARSED)){var o=this.mediaBuffer,a=this.media.currentTime;if(o&&h.default.isBuffered(o,a)&&h.default.isBuffered(o,a+.5)){var s=this.config;s.maxMaxBufferLength>=s.maxBufferLength&&(s.maxMaxBufferLength/=2,w.logger.warn("audio:reduce max buffer length to "+s.maxMaxBufferLength+"s"),this.fragLoadIdx+=2*s.fragLoadingLoopThreshold),this.state=D.IDLE}else w.logger.warn("buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,this.state=D.BUFFER_FLUSHING,this.hls.trigger(y.default.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"})}}}},{key:"onBufferFlushed",value:function(){var e=this,t=this.pendingData;t&&t.length?(w.logger.log("appending pending audio data on Buffer Flushed"),t.forEach(function(t){e.hls.trigger(y.default.BUFFER_APPENDING,t)}),this.appended=!0,this.pendingData=[],this.state=D.PARSED):(this.state=D.IDLE,this.fragPrevious=null,this.tick())}},{key:"state",set:function(e){if(this.state!==e){var t=this.state;this._state=e,w.logger.log("audio stream:"+t+"->"+e)}},get:function(){return this._state}}]),t}(_.default);t.default=R},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":l(t))&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":l(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l="function"==typeof Symbol&&"symbol"==r(Symbol.iterator)?function(e){return void 0===e?"undefined":r(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":r(e)};Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),d=n(1),c=i(d),f=n(3),h=i(f),p=n(0),m=n(2),g=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,c.default.MANIFEST_LOADING,c.default.MANIFEST_LOADED,c.default.AUDIO_TRACK_LOADED,c.default.ERROR));return n.ticks=0,n.ontick=n.tick.bind(n),n}return s(t,e),u(t,[{key:"destroy",value:function(){this.cleanTimer(),h.default.prototype.destroy.call(this)}},{key:"cleanTimer",value:function(){this.timer&&(clearTimeout(this.timer),this.timer=null)}},{key:"tick",value:function(){1==++this.ticks&&(this.doTick(),this.ticks>1&&setTimeout(this.tick,1),this.ticks=0)}},{key:"doTick",value:function(){this.updateTrack(this.trackId)}},{key:"onError",value:function(e){e.fatal&&e.type===m.ErrorTypes.NETWORK_ERROR&&this.cleanTimer()}},{key:"onManifestLoading",value:function(){this.tracks=[],this.trackId=-1}},{key:"onManifestLoaded",value:function(e){var t=this,n=e.audioTracks||[],r=!1;this.tracks=n,this.hls.trigger(c.default.AUDIO_TRACKS_UPDATED,{audioTracks:n});var i=0;n.forEach(function(e){if(e.default&&!r)return t.audioTrack=i,void(r=!0);i++}),!1===r&&n.length&&(p.logger.log("no default audio track defined, use first audio track as default"),this.audioTrack=0)}},{key:"onAudioTrackLoaded",value:function(e){e.id<this.tracks.length&&(p.logger.log("audioTrack "+e.id+" loaded"),this.tracks[e.id].details=e.details,e.details.live&&!this.timer&&(this.timer=setInterval(this.ontick,1e3*e.details.targetduration)),!e.details.live&&this.timer&&this.cleanTimer())}},{key:"setAudioTrackInternal",value:function(e){if(e>=0&&e<this.tracks.length){this.cleanTimer(),this.trackId=e,p.logger.log("switching to audioTrack "+e);var t=this.tracks[e],n=this.hls,r=t.type,i=t.url,o={id:e,type:r,url:i};n.trigger(c.default.AUDIO_TRACK_SWITCH,o),n.trigger(c.default.AUDIO_TRACK_SWITCHING,o);var a=t.details;!i||void 0!==a&&!0!==a.live||(p.logger.log("(re)loading playlist for audioTrack "+e),n.trigger(c.default.AUDIO_TRACK_LOADING,{url:i,id:e}))}}},{key:"updateTrack",value:function(e){if(e>=0&&e<this.tracks.length){this.cleanTimer(),this.trackId=e,p.logger.log("updating audioTrack "+e);var t=this.tracks[e],n=t.url,r=t.details;!n||void 0!==r&&!0!==r.live||(p.logger.log("(re)loading playlist for audioTrack "+e),this.hls.trigger(c.default.AUDIO_TRACK_LOADING,{url:n,id:e}))}}},{key:"audioTracks",get:function(){return this.tracks}},{key:"audioTrack",get:function(){return this.trackId},set:function(e){this.trackId===e&&void 0!==this.tracks[e].details||this.setAudioTrackInternal(e)}}]),t}(h.default);t.default=g},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":l(t))&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":l(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l="function"==typeof Symbol&&"symbol"==r(Symbol.iterator)?function(e){return void 0===e?"undefined":r(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":r(e)};Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),d=n(1),c=i(d),f=n(3),h=i(f),p=n(0),m=n(2),g=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,c.default.MEDIA_ATTACHING,c.default.MEDIA_DETACHING,c.default.MANIFEST_PARSED,c.default.BUFFER_RESET,c.default.BUFFER_APPENDING,c.default.BUFFER_CODECS,c.default.BUFFER_EOS,c.default.BUFFER_FLUSHING,c.default.LEVEL_PTS_UPDATED,c.default.LEVEL_UPDATED));return n._msDuration=null,n._levelDuration=null,n.onsbue=n.onSBUpdateEnd.bind(n),n.onsbe=n.onSBUpdateError.bind(n),n.pendingTracks={},n.tracks={},n}return s(t,e),u(t,[{key:"destroy",value:function(){h.default.prototype.destroy.call(this)}},{key:"onLevelPtsUpdated",value:function(e){var t=e.type,n=this.tracks.audio;if("audio"===t&&n&&"audio/mpeg"===n.container){var r=this.sourceBuffer.audio;if(Math.abs(r.timestampOffset-e.start)>.1){var i=r.updating;try{r.abort()}catch(e){i=!0,p.logger.warn("can not abort audio buffer: "+e)}i?this.audioTimestampOffset=e.start:(p.logger.warn("change mpeg audio timestamp offset from "+r.timestampOffset+" to "+e.start),r.timestampOffset=e.start)}}}},{key:"onManifestParsed",value:function(e){var t=e.audio,n=e.video||e.levels.length&&e.audio,r=0;e.altAudio&&(t||n)&&(r=(t?1:0)+(n?1:0),p.logger.log(r+" sourceBuffer(s) expected")),this.sourceBufferNb=r}},{key:"onMediaAttaching",value:function(e){var t=this.media=e.media;if(t){var n=this.mediaSource=new MediaSource;this.onmso=this.onMediaSourceOpen.bind(this),this.onmse=this.onMediaSourceEnded.bind(this),this.onmsc=this.onMediaSourceClose.bind(this),n.addEventListener("sourceopen",this.onmso),n.addEventListener("sourceended",this.onmse),n.addEventListener("sourceclose",this.onmsc),t.src=URL.createObjectURL(n)}}},{key:"onMediaDetaching",value:function(){p.logger.log("media source detaching");var e=this.mediaSource;if(e){if("open"===e.readyState)try{e.endOfStream()}catch(e){p.logger.warn("onMediaDetaching:"+e.message+" while calling endOfStream")}e.removeEventListener("sourceopen",this.onmso),e.removeEventListener("sourceended",this.onmse),e.removeEventListener("sourceclose",this.onmsc),this.media&&(URL.revokeObjectURL(this.media.src),this.media.removeAttribute("src"),this.media.load()),this.mediaSource=null,this.media=null,this.pendingTracks={},this.tracks={},this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0}this.onmso=this.onmse=this.onmsc=null,this.hls.trigger(c.default.MEDIA_DETACHED)}},{key:"onMediaSourceOpen",value:function(){p.logger.log("media source opened"),this.hls.trigger(c.default.MEDIA_ATTACHED,{media:this.media});var e=this.mediaSource;e&&e.removeEventListener("sourceopen",this.onmso),this.checkPendingTracks()}},{key:"checkPendingTracks",value:function(){var e=this.pendingTracks,t=Object.keys(e).length;t&&(this.sourceBufferNb<=t||0===this.sourceBufferNb)&&(this.createSourceBuffers(e),this.pendingTracks={},this.doAppending())}},{key:"onMediaSourceClose",value:function(){p.logger.log("media source closed")}},{key:"onMediaSourceEnded",value:function(){p.logger.log("media source ended")}},{key:"onSBUpdateEnd",value:function(){if(this.audioTimestampOffset){var e=this.sourceBuffer.audio;p.logger.warn("change mpeg audio timestamp offset from "+e.timestampOffset+" to "+this.audioTimestampOffset),e.timestampOffset=this.audioTimestampOffset,delete this.audioTimestampOffset}this._needsFlush&&this.doFlush(),this._needsEos&&this.checkEos(),this.appending=!1;var t=this.parent,n=this.segments.reduce(function(e,n){return n.parent===t?e+1:e},0);this.hls.trigger(c.default.BUFFER_APPENDED,{parent:t,pending:n}),this._needsFlush||this.doAppending(),this.updateMediaElementDuration()}},{key:"onSBUpdateError",value:function(e){p.logger.error("sourceBuffer error:",e),this.hls.trigger(c.default.ERROR,{type:m.ErrorTypes.MEDIA_ERROR,details:m.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1})}},{key:"onBufferReset",value:function(){var e=this.sourceBuffer;for(var t in e){var n=e[t];try{this.mediaSource.removeSourceBuffer(n),n.removeEventListener("updateend",this.onsbue),n.removeEventListener("error",this.onsbe)}catch(e){}}this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0}},{key:"onBufferCodecs",value:function(e){if(0===Object.keys(this.sourceBuffer).length){for(var t in e)this.pendingTracks[t]=e[t];var n=this.mediaSource;n&&"open"===n.readyState&&this.checkPendingTracks()}}},{key:"createSourceBuffers",value:function(e){var t=this.sourceBuffer,n=this.mediaSource;for(var r in e)if(!t[r]){var i=e[r],o=i.levelCodec||i.codec,a=i.container+";codecs="+o;p.logger.log("creating sourceBuffer("+a+")");try{var s=t[r]=n.addSourceBuffer(a);s.addEventListener("updateend",this.onsbue),s.addEventListener("error",this.onsbe),this.tracks[r]={codec:o,container:i.container},i.buffer=s}catch(e){p.logger.error("error while trying to add sourceBuffer:"+e.message),this.hls.trigger(c.default.ERROR,{type:m.ErrorTypes.MEDIA_ERROR,details:m.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,err:e,mimeType:a})}}this.hls.trigger(c.default.BUFFER_CREATED,{tracks:e})}},{key:"onBufferAppending",value:function(e){this._needsFlush||(this.segments?this.segments.push(e):this.segments=[e],this.doAppending())}},{key:"onBufferAppendFail",value:function(e){p.logger.error("sourceBuffer error:",e.event),this.hls.trigger(c.default.ERROR,{type:m.ErrorTypes.MEDIA_ERROR,details:m.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1})}},{key:"onBufferEos",value:function(e){var t=this.sourceBuffer,n=e.type;for(var r in t)n&&r!==n||t[r].ended||(t[r].ended=!0,p.logger.log(r+" sourceBuffer now EOS"));this.checkEos()}},{key:"checkEos",value:function(){var e=this.sourceBuffer,t=this.mediaSource;if(!t||"open"!==t.readyState)return void(this._needsEos=!1);for(var n in e){var r=e[n];if(!r.ended)return;if(r.updating)return void(this._needsEos=!0)}p.logger.log("all media data available, signal endOfStream() to MediaSource and stop loading fragment");try{t.endOfStream()}catch(e){p.logger.warn("exception while calling mediaSource.endOfStream()")}this._needsEos=!1}},{key:"onBufferFlushing",value:function(e){this.flushRange.push({start:e.startOffset,end:e.endOffset,type:e.type}),this.flushBufferCounter=0,this.doFlush()}},{key:"onLevelUpdated",value:function(e){var t=e.details;0!==t.fragments.length&&(this._levelDuration=t.totalduration+t.fragments[0].start,this.updateMediaElementDuration())}},{key:"updateMediaElementDuration",value:function(){var e=this.media,t=this.mediaSource,n=this.sourceBuffer,r=this._levelDuration;if(null!==r&&e&&t&&n&&0!==e.readyState&&"open"===t.readyState){for(var i in n)if(n[i].updating)return;null===this._msDuration&&(this._msDuration=t.duration);var o=e.duration;(r>this._msDuration&&r>o||o===1/0||isNaN(o))&&(p.logger.log("Updating mediasource duration to "+r.toFixed(3)),this._msDuration=t.duration=r)}}},{key:"doFlush",value:function(){for(;this.flushRange.length;){var e=this.flushRange[0];if(!this.flushBuffer(e.start,e.end,e.type))return void(this._needsFlush=!0);this.flushRange.shift(),this.flushBufferCounter=0}if(0===this.flushRange.length){this._needsFlush=!1;var t=0,n=this.sourceBuffer;try{for(var r in n)t+=n[r].buffered.length}catch(e){p.logger.error("error while accessing sourceBuffer.buffered")}this.appended=t,this.hls.trigger(c.default.BUFFER_FLUSHED)}}},{key:"doAppending",value:function(){var e=this.hls,t=this.sourceBuffer,n=this.segments;if(Object.keys(t).length){if(this.media.error)return this.segments=[],void p.logger.error("trying to append although a media error occured, flush segment and abort");if(this.appending)return;if(n&&n.length){var r=n.shift();try{var i=r.type,o=t[i];o?o.updating?n.unshift(r):(o.ended=!1,this.parent=r.parent,o.appendBuffer(r.data),this.appendError=0,this.appended++,this.appending=!0):this.onSBUpdateEnd()}catch(t){p.logger.error("error while trying to append buffer:"+t.message),n.unshift(r);var a={type:m.ErrorTypes.MEDIA_ERROR,parent:r.parent};if(22===t.code)return this.segments=[],a.details=m.ErrorDetails.BUFFER_FULL_ERROR,a.fatal=!1,void e.trigger(c.default.ERROR,a);if(this.appendError?this.appendError++:this.appendError=1,a.details=m.ErrorDetails.BUFFER_APPEND_ERROR,this.appendError>e.config.appendErrorMaxRetry)return p.logger.log("fail "+e.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),n=[],a.fatal=!0,void e.trigger(c.default.ERROR,a);a.fatal=!1,e.trigger(c.default.ERROR,a)}}}}},{key:"flushBuffer",value:function(e,t,n){var r,i,o,a,s,l,u=this.sourceBuffer;if(Object.keys(u).length){if(p.logger.log("flushBuffer,pos/start/end: "+this.media.currentTime.toFixed(3)+"/"+e+"/"+t),this.flushBufferCounter<this.appended){for(var d in u)if(!n||d===n){if(r=u[d],r.ended=!1,r.updating)return p.logger.warn("cannot flush, sb updating in progress"),!1;try{for(i=0;i<r.buffered.length;i++)if(o=r.buffered.start(i),a=r.buffered.end(i),-1!==navigator.userAgent.toLowerCase().indexOf("firefox")&&t===Number.POSITIVE_INFINITY?(s=e,l=t):(s=Math.max(o,e),l=Math.min(a,t)),Math.min(l,a)-s>.5)return this.flushBufferCounter++,p.logger.log("flush "+d+" ["+s+","+l+"], of ["+o+","+a+"], pos:"+this.media.currentTime),r.remove(s,l),!1}catch(e){p.logger.warn("exception while accessing sourcebuffer, it might have been removed from MediaSource")}}}else p.logger.warn("abort flushing too many retries");p.logger.log("buffer flushed")}return!0}}]),t}(h.default);t.default=g},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":l(t))&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":l(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l="function"==typeof Symbol&&"symbol"==r(Symbol.iterator)?function(e){return void 0===e?"undefined":r(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":r(e)};Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),d=n(1),c=i(d),f=n(3),h=i(f),p=function(e){function t(e){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,c.default.FPS_DROP_LEVEL_CAPPING,c.default.MEDIA_ATTACHING,c.default.MANIFEST_PARSED))}return s(t,e),u(t,[{key:"destroy",value:function(){this.hls.config.capLevelToPlayerSize&&(this.media=this.restrictedLevels=null,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(this.timer=clearInterval(this.timer)))}},{key:"onFpsDropLevelCapping",value:function(e){t.isLevelAllowed(e.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(e.droppedLevel)}},{key:"onMediaAttaching",value:function(e){this.media=e.media instanceof HTMLVideoElement?e.media:null}},{key:"onManifestParsed",value:function(e){var t=this.hls;this.restrictedLevels=[],t.config.capLevelToPlayerSize&&(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.levels=e.levels,t.firstLevel=this.getMaxLevel(e.firstLevel),clearInterval(this.timer),this.timer=setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}},{key:"detectPlayerSize",value:function(){if(this.media){var e=this.levels?this.levels.length:0;if(e){var t=this.hls;t.autoLevelCapping=this.getMaxLevel(e-1),t.autoLevelCapping>this.autoLevelCapping&&t.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}},{key:"getMaxLevel",value:function(e){var n=this;if(!this.levels)return-1;var r=this.levels.filter(function(r,i){return t.isLevelAllowed(i,n.restrictedLevels)&&i<=e});return t.getMaxLevelByMediaSize(r,this.mediaWidth,this.mediaHeight)}},{key:"mediaWidth",get:function(){var e=void 0,n=this.media;return n&&(e=n.width||n.clientWidth||n.offsetWidth,e*=t.contentScaleFactor),e}},{key:"mediaHeight",get:function(){var e=void 0,n=this.media;return n&&(e=n.height||n.clientHeight||n.offsetHeight,e*=t.contentScaleFactor),e}}],[{key:"isLevelAllowed",value:function(e){return-1===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).indexOf(e)}},{key:"getMaxLevelByMediaSize",value:function(e,t,n){if(!e||e&&!e.length)return-1;for(var r=e.length-1,i=0;i<e.length;i+=1){var o=e[i];if((o.width>=t||o.height>=n)&&function(e,t){return!t||e.width!==t.width||e.height!==t.height}(o,e[i+1])){r=i;break}}return r}},{key:"contentScaleFactor",get:function(){var e=1;try{e=window.devicePixelRatio}catch(e){}return e}}]),t}(h.default);t.default=p},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":l(t))&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":l(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l="function"==typeof Symbol&&"symbol"==r(Symbol.iterator)?function(e){return void 0===e?"undefined":r(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":r(e)};Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),d=n(1),c=i(d),f=n(3),h=i(f),p=n(0),m=function(e){function t(e){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,c.default.MEDIA_ATTACHING))}return s(t,e),u(t,[{key:"destroy",value:function(){this.timer&&clearInterval(this.timer),this.isVideoPlaybackQualityAvailable=!1}},{key:"onMediaAttaching",value:function(e){var t=this.hls.config;t.capLevelOnFPSDrop&&("function"==typeof(this.video=e.media instanceof HTMLVideoElement?e.media:null).getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),clearInterval(this.timer),this.timer=setInterval(this.checkFPSInterval.bind(this),t.fpsDroppedMonitoringPeriod))}},{key:"checkFPS",value:function(e,t,n){var r=performance.now();if(t){if(this.lastTime){var i=r-this.lastTime,o=n-this.lastDroppedFrames,a=t-this.lastDecodedFrames,s=1e3*o/i,l=this.hls;if(l.trigger(c.default.FPS_DROP,{currentDropped:o,currentDecoded:a,totalDroppedFrames:n}),s>0&&o>l.config.fpsDroppedMonitoringThreshold*a){var u=l.currentLevel;p.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+u),u>0&&(-1===l.autoLevelCapping||l.autoLevelCapping>=u)&&(u-=1,l.trigger(c.default.FPS_DROP_LEVEL_CAPPING,{level:u,droppedLevel:l.currentLevel}),l.autoLevelCapping=u,l.streamController.nextLevelSwitch())}}this.lastTime=r,this.lastDroppedFrames=n,this.lastDecodedFrames=t}}},{key:"checkFPSInterval",value:function(){var e=this.video;if(e)if(this.isVideoPlaybackQualityAvailable){var t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}}]),t}(h.default);t.default=m},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":l(t))&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":l(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l="function"==typeof Symbol&&"symbol"==r(Symbol.iterator)?function(e){return void 0===e?"undefined":r(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":r(e)};Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),d=n(1),c=i(d),f=n(3),h=i(f),p=n(6),m=i(p),g=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,c.default.MEDIA_ATTACHED,c.default.MEDIA_DETACHING,c.default.FRAG_PARSING_METADATA));return n.id3Track=void 0,n.media=void 0,n}return s(t,e),u(t,[{key:"destroy",value:function(){h.default.prototype.destroy.call(this)}},{key:"onMediaAttached",value:function(e){this.media=e.media,this.media&&(this.id3Track=this.media.addTextTrack("metadata","id3"),this.id3Track.mode="hidden")}},{key:"onMediaDetaching",value:function(){this.media=void 0}},{key:"onFragParsingMetadata",value:function(e){for(var t=e.frag,n=e.samples,r=window.WebKitDataCue||window.VTTCue||window.TextTrackCue,i=0;i<n.length;i++){var o=m.default.getID3Frames(n[i].data);if(o){var a=n[i].pts,s=i<n.length-1?n[i+1].pts:t.endPTS;a===s&&(s+=1e-4);for(var l=0;l<o.length;l++){var u=o[l];if(!m.default.isTimeStampFrame(u)){var d=new r(a,s,"");d.value=u,this.id3Track.addCue(d)}}}}}}]),t}(h.default);t.default=g},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":l(t))&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":l(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l="function"==typeof Symbol&&"symbol"==r(Symbol.iterator)?function(e){return void 0===e?"undefined":r(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":r(e)};Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),d=n(1),c=i(d),f=n(3),h=i(f),p=n(0),m=n(2),g=n(4),y=i(g),v=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,c.default.MANIFEST_LOADED,c.default.LEVEL_LOADED,c.default.FRAG_LOADED,c.default.ERROR));return n.ontick=n.tick.bind(n),n._manualLevel=-1,n}return s(t,e),u(t,[{key:"destroy",value:function(){this.cleanTimer(),this._manualLevel=-1}},{key:"cleanTimer",value:function(){this.timer&&(clearTimeout(this.timer),this.timer=null)}},{key:"startLoad",value:function(){this.canload=!0;var e=this._levels;e&&e.forEach(function(e){e.loadError=0;var t=e.details;t&&t.live&&(e.details=void 0)}),this.timer&&this.tick()}},{key:"stopLoad",value:function(){this.canload=!1}},{key:"onManifestLoaded",value:function(e){var t,n=[],r=[],i={},o=!1,a=!1,s=this.hls,l=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),u=function(e,t){return MediaSource.isTypeSupported(e+"/mp4;codecs="+t)};if(e.levels.forEach(function(e){e.videoCodec&&(o=!0),l&&e.audioCodec&&-1!==e.audioCodec.indexOf("mp4a.40.34")&&(e.audioCodec=void 0),(e.audioCodec||e.attrs&&e.attrs.AUDIO)&&(a=!0);var t=i[e.bitrate];void 0===t?(i[e.bitrate]=n.length,e.url=[e.url],e.urlId=0,n.push(e)):n[t].url.push(e.url)}),o&&a?n.forEach(function(e){e.videoCodec&&r.push(e)}):r=n,r=r.filter(function(e){var t=e.audioCodec,n=e.videoCodec;return(!t||u("audio",t))&&(!n||u("video",n))}),r.length){t=r[0].bitrate,r.sort(function(e,t){return e.bitrate-t.bitrate}),this._levels=r;for(var d=0;d<r.length;d++)if(r[d].bitrate===t){this._firstLevel=d,p.logger.log("manifest loaded,"+r.length+" level(s) found, first bitrate:"+t);break}s.trigger(c.default.MANIFEST_PARSED,{levels:r,firstLevel:this._firstLevel,stats:e.stats,audio:a,video:o,altAudio:e.audioTracks.length>0})}else s.trigger(c.default.ERROR,{type:m.ErrorTypes.MEDIA_ERROR,details:m.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:s.url,reason:"no level with compatible codecs found in manifest"})}},{key:"setLevelInternal",value:function(e){var t=this._levels,n=this.hls;if(e>=0&&e<t.length){if(this.cleanTimer(),this._level!==e){p.logger.log("switching to level "+e),this._level=e;var r=t[e];r.level=e,n.trigger(c.default.LEVEL_SWITCH,r),n.trigger(c.default.LEVEL_SWITCHING,r)}var i=t[e],o=i.details;if(!o||!0===o.live){var a=i.urlId;n.trigger(c.default.LEVEL_LOADING,{url:i.url[a],level:e,id:a})}}else n.trigger(c.default.ERROR,{type:m.ErrorTypes.OTHER_ERROR,details:m.ErrorDetails.LEVEL_SWITCH_ERROR,level:e,fatal:!1,reason:"invalid level idx"})}},{key:"onError",value:function(e){if(e.fatal)return void(e.type===m.ErrorTypes.NETWORK_ERROR&&this.cleanTimer());var t=e.details,n=this.hls,r=void 0,i=void 0,o=!1;switch(t){case m.ErrorDetails.FRAG_LOAD_ERROR:case m.ErrorDetails.FRAG_LOAD_TIMEOUT:case m.ErrorDetails.FRAG_LOOP_LOADING_ERROR:case m.ErrorDetails.KEY_LOAD_ERROR:case m.ErrorDetails.KEY_LOAD_TIMEOUT:r=e.frag.level;break;case m.ErrorDetails.LEVEL_LOAD_ERROR:case m.ErrorDetails.LEVEL_LOAD_TIMEOUT:r=e.context.level,o=!0;break;case m.ErrorDetails.REMUX_ALLOC_ERROR:r=e.level}if(void 0!==r){i=this._levels[r],i.loadError?i.loadError++:i.loadError=1;var a=i.url.length;if(a>1&&i.loadError<a)i.urlId=(i.urlId+1)%a,i.details=void 0,p.logger.warn("level controller,"+t+" for level "+r+": switching to redundant stream id "+i.urlId);else if(-1===this._manualLevel&&r)p.logger.warn("level controller,"+t+": switch-down for next fragment"),n.nextAutoLevel=Math.max(0,r-1);else if(i&&i.details&&i.details.live)p.logger.warn("level controller,"+t+" on live stream, discard"),o&&(this._level=void 0);else if(t===m.ErrorDetails.LEVEL_LOAD_ERROR||t===m.ErrorDetails.LEVEL_LOAD_TIMEOUT){var s=n.media,l=s&&y.default.isBuffered(s,s.currentTime)&&y.default.isBuffered(s,s.currentTime+.5);if(l){var u=n.config.levelLoadingRetryDelay;p.logger.warn("level controller,"+t+", but media buffered, retry in "+u+"ms"),this.timer=setTimeout(this.ontick,u),e.levelRetry=!0}else p.logger.error("cannot recover "+t+" error"),this._level=void 0,this.cleanTimer(),e.fatal=!0}}}},{key:"onFragLoaded",value:function(e){var t=e.frag;if(t&&"main"===t.type){var n=this._levels[t.level];n&&(n.loadError=0)}}},{key:"onLevelLoaded",value:function(e){var t=e.level;if(t===this._level){var n=this._levels[t];n.loadError=0;var r=e.details;if(r.live){var i=1e3*(r.averagetargetduration?r.averagetargetduration:r.targetduration),o=n.details;o&&r.endSN===o.endSN&&(i/=2,p.logger.log("same live playlist, reload twice faster")),i-=performance.now()-e.stats.trequest,i=Math.max(1e3,Math.round(i)),p.logger.log("live playlist, reload in "+i+" ms"),this.timer=setTimeout(this.ontick,i)}else this.timer=null}}},{key:"tick",value:function(){var e=this._level;if(void 0!==e&&this.canload){var t=this._levels[e];if(t&&t.url){var n=t.urlId;this.hls.trigger(c.default.LEVEL_LOADING,{url:t.url[n],level:e,id:n})}}}},{key:"levels",get:function(){return this._levels}},{key:"level",get:function(){return this._level},set:function(e){var t=this._levels;t&&t.length>e&&(this._level===e&&void 0!==t[e].details||this.setLevelInternal(e))}},{key:"manualLevel",get:function(){return this._manualLevel},set:function(e){this._manualLevel=e,void 0===this._startLevel&&(this._startLevel=e),-1!==e&&(this.level=e)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(e){this._firstLevel=e}},{key:"startLevel",get:function(){if(void 0===this._startLevel){var e=this.hls.config.startLevel;return void 0!==e?e:this._firstLevel}return this._startLevel},set:function(e){this._startLevel=e}},{key:"nextLoadLevel",get:function(){return-1!==this._manualLevel?this._manualLevel:this.hls.nextAutoLevel},set:function(e){this.level=e,-1===this._manualLevel&&(this.hls.nextAutoLevel=e)}}]),t}(h.default);t.default=v},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":l(t))&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":l(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l="function"==typeof Symbol&&"symbol"==r(Symbol.iterator)?function(e){return void 0===e?"undefined":r(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":r(e)};Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),d=n(7),c=i(d),f=n(4),h=i(f),p=n(11),m=i(p),g=n(1),y=i(g),v=n(3),_=i(v),b=n(13),E=i(b),T=n(14),S=i(T),x=n(2),w=n(0),I={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_LEVEL:"WAITING_LEVEL",PARSING:"PARSING",PARSED:"PARSED",BUFFER_FLUSHING:"BUFFER_FLUSHING",ENDED:"ENDED",ERROR:"ERROR"},D=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,y.default.MEDIA_ATTACHED,y.default.MEDIA_DETACHING,y.default.MANIFEST_LOADING,y.default.MANIFEST_PARSED,y.default.LEVEL_LOADED,y.default.KEY_LOADED,y.default.FRAG_LOADED,y.default.FRAG_LOAD_EMERGENCY_ABORTED,y.default.FRAG_PARSING_INIT_SEGMENT,y.default.FRAG_PARSING_DATA,y.default.FRAG_PARSED,y.default.ERROR,y.default.AUDIO_TRACK_SWITCHING,y.default.AUDIO_TRACK_SWITCHED,y.default.BUFFER_CREATED,y.default.BUFFER_APPENDED,y.default.BUFFER_FLUSHED));return n.config=e.config,n.audioCodecSwap=!1,n.ticks=0,n._state=I.STOPPED,n.ontick=n.tick.bind(n),n}return s(t,e),u(t,[{key:"destroy",value:function(){this.stopLoad(),this.timer&&(clearInterval(this.timer),this.timer=null),_.default.prototype.destroy.call(this),this.state=I.STOPPED}},{key:"startLoad",value:function(e){if(this.levels){var t=this.lastCurrentTime,n=this.hls;if(this.stopLoad(),this.timer||(this.timer=setInterval(this.ontick,100)),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var r=n.startLevel;-1===r&&(r=0,this.bitrateTest=!0),this.level=n.nextLoadLevel=r,this.loadedmetadata=!1}t>0&&-1===e&&(w.logger.log("override startPosition with lastCurrentTime @"+t.toFixed(3)),e=t),this.state=I.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this.forceStartLoad=!0,this.state=I.STOPPED}},{key:"stopLoad",value:function(){var e=this.fragCurrent;e&&(e.loader&&e.loader.abort(),this.fragCurrent=null),this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=I.STOPPED,this.forceStartLoad=!1}},{key:"tick",value:function(){1==++this.ticks&&(this.doTick(),this.ticks>1&&setTimeout(this.tick,1),this.ticks=0)}},{key:"doTick",value:function(){switch(this.state){case I.ERROR:break;case I.BUFFER_FLUSHING:this.fragLoadError=0;break;case I.IDLE:this._doTickIdle();break;case I.WAITING_LEVEL:var e=this.levels[this.level];e&&e.details&&(this.state=I.IDLE);break;case I.FRAG_LOADING_WAITING_RETRY:var t=performance.now(),n=this.retryDate;(!n||t>=n||this.media&&this.media.seeking)&&(w.logger.log("mediaController: retryDate reached, switch back to IDLE state"),this.state=I.IDLE);break;case I.ERROR:case I.STOPPED:case I.FRAG_LOADING:case I.PARSING:case I.PARSED:case I.ENDED:}this._checkBuffer(),this._checkFragmentChanged()}},{key:"_doTickIdle",value:function(){var e=this.hls,t=e.config,n=this.media;if(void 0===this.levelLastLoaded||n||!this.startFragRequested&&t.startFragPrefetch){var r=void 0;r=this.loadedmetadata?n.currentTime:this.nextLoadPosition;var i=e.nextLoadLevel,o=this.levels[i];if(o){var a=o.bitrate,s=void 0;s=a?Math.max(8*t.maxBufferSize/a,t.maxBufferLength):t.maxBufferLength,s=Math.min(s,t.maxMaxBufferLength);var l=h.default.bufferInfo(this.mediaBuffer?this.mediaBuffer:n,r,t.maxBufferHole),u=l.len;if(!(u>=s)){w.logger.trace("buffer length of "+u.toFixed(3)+" is below max of "+s.toFixed(3)+". checking for more payload ..."),this.level=e.nextLoadLevel=i;var d=o.details;if(void 0===d||d.live&&this.levelLastLoaded!==i)return void(this.state=I.WAITING_LEVEL);var c=this.fragPrevious;if(!d.live&&c&&c.sn===d.endSN&&u&&!l.nextStart&&Math.min(n.duration,c.start+c.duration)-Math.max(l.end,c.start)<=Math.max(.2,c.duration)){var f={};return this.altAudio&&(f.type="video"),this.hls.trigger(y.default.BUFFER_EOS,f),void(this.state=I.ENDED)}this._fetchPayloadOrEos(r,l,d)}}}}},{key:"_fetchPayloadOrEos",value:function(e,t,n){var r=this.fragPrevious,i=this.level,o=n.fragments,a=o.length;if(0!==a){var s=o[0].start,l=o[a-1].start+o[a-1].duration,u=t.end,d=void 0;if(n.initSegment&&!n.initSegment.data)d=n.initSegment;else if(n.live){var c=this.config.initialLiveManifestSize;if(a<c)return void w.logger.warn("Can not start playback of a level, reason: not enough fragments "+a+" < "+c);if(null===(d=this._ensureFragmentAtLivePoint(n,u,s,l,r,o,a)))return}else u<s&&(d=o[0]);d||(d=this._findFragment(s,r,a,o,u,l,n)),d&&this._loadFragmentOrKey(d,i,n,e,u)}}},{key:"_ensureFragmentAtLivePoint",value:function(e,t,n,r,i,o,a){var s=this.hls.config,l=this.media,u=void 0,d=void 0!==s.liveMaxLatencyDuration?s.liveMaxLatencyDuration:s.liveMaxLatencyDurationCount*e.targetduration;if(t<Math.max(n-s.maxFragLookUpTolerance,r-d)){var f=this.liveSyncPosition=this.computeLivePosition(n,e);w.logger.log("buffer end: "+t.toFixed(3)+" is located too far from the end of live sliding playlist, reset currentTime to : "+f.toFixed(3)),t=f,l&&l.readyState&&l.duration>f&&(l.currentTime=f),this.nextLoadPosition=f}if(e.PTSKnown&&t>r&&l&&l.readyState)return null;if(this.startFragRequested&&!e.PTSKnown){if(i){var h=i.sn+1;if(h>=e.startSN&&h<=e.endSN){var p=o[h-e.startSN];i.cc===p.cc&&(u=p,w.logger.log("live playlist, switching playlist, load frag with next SN: "+u.sn))}u||(u=c.default.search(o,function(e){return i.cc-e.cc}))&&w.logger.log("live playlist, switching playlist, load frag with same CC: "+u.sn)}u||(u=o[Math.min(a-1,Math.round(a/2))],w.logger.log("live playlist, switching playlist, unknown, load middle frag : "+u.sn))}return u}},{key:"_findFragment",value:function(e,t,n,r,i,o,a){var s=this.hls.config,l=void 0,u=void 0,d=s.maxFragLookUpTolerance,f=t?r[t.sn-r[0].sn+1]:void 0,h=function(e){var t=Math.min(d,e.duration);return e.start+e.duration-t<=i?1:e.start-t>i&&e.start?-1:0};if(i<o?(i>o-d&&(d=0),u=f&&!h(f)?f:c.default.search(r,h)):u=r[n-1],u){l=u;var p=l.sn-a.startSN,m=t&&l.level===t.level,g=r[p-1],y=r[p+1];if(t&&l.sn===t.sn)if(m&&!l.backtracked)if(l.sn<a.endSN){var v=t.deltaPTS;v&&v>s.maxBufferHole&&t.dropped&&p?(l=g,w.logger.warn("SN just loaded, with large PTS gap between audio and video, maybe frag is not starting with a keyframe ? load previous one to try to overcome this"),t.loadCounter--):(l=y,w.logger.log("SN just loaded, load next one: "+l.sn))}else l=null;else l.backtracked&&(y&&y.backtracked?(w.logger.warn("Already backtracked from fragment "+y.sn+", will not backtrack to fragment "+l.sn+". Loading fragment "+y.sn),l=y):(w.logger.warn("Loaded fragment with dropped frames, backtracking 1 segment to find a keyframe"),l.dropped=0,g?(g.loadCounter&&g.loadCounter--,l=g,l.backtracked=!0):p&&(l=null)))}return l}},{key:"_loadFragmentOrKey",value:function(e,t,n,r,i){var o=this.hls,a=o.config;if(!e.decryptdata||null==e.decryptdata.uri||null!=e.decryptdata.key){if(w.logger.log("Loading "+e.sn+" of ["+n.startSN+" ,"+n.endSN+"],level "+t+", currentTime:"+r.toFixed(3)+",bufferEnd:"+i.toFixed(3)),void 0!==this.fragLoadIdx?this.fragLoadIdx++:this.fragLoadIdx=0,e.loadCounter){e.loadCounter++;var s=a.fragLoadingLoopThreshold;if(e.loadCounter>s&&Math.abs(this.fragLoadIdx-e.loadIdx)<s)return void o.trigger(y.default.ERROR,{type:x.ErrorTypes.MEDIA_ERROR,details:x.ErrorDetails.FRAG_LOOP_LOADING_ERROR,fatal:!1,frag:e})}else e.loadCounter=1;return e.loadIdx=this.fragLoadIdx,this.fragCurrent=e,this.startFragRequested=!0,isNaN(e.sn)||(this.nextLoadPosition=e.start+e.duration),e.autoLevel=o.autoLevelEnabled,e.bitrateTest=this.bitrateTest,o.trigger(y.default.FRAG_LOADING,{frag:e}),this.demuxer||(this.demuxer=new m.default(o,"main")),void(this.state=I.FRAG_LOADING)}w.logger.log("Loading key for "+e.sn+" of ["+n.startSN+" ,"+n.endSN+"],level "+t),this.state=I.KEY_LOADING,o.trigger(y.default.KEY_LOADING,{frag:e})}},{key:"getBufferedFrag",value:function(e){return c.default.search(this._bufferedFrags,function(t){return e<t.startPTS?-1:e>t.endPTS?1:0})}},{key:"followingBufferedFrag",value:function(e){return e?this.getBufferedFrag(e.endPTS+.5):null}},{key:"_checkFragmentChanged",value:function(){var e,t,n=this.media;if(n&&n.readyState&&!1===n.seeking&&(t=n.currentTime,t>n.playbackRate*this.lastCurrentTime&&(this.lastCurrentTime=t),h.default.isBuffered(n,t)?e=this.getBufferedFrag(t):h.default.isBuffered(n,t+.1)&&(e=this.getBufferedFrag(t+.1)),e)){var r=e;if(r!==this.fragPlaying){this.hls.trigger(y.default.FRAG_CHANGED,{frag:r});var i=r.level;this.fragPlaying&&this.fragPlaying.level===i||this.hls.trigger(y.default.LEVEL_SWITCHED,{level:i}),this.fragPlaying=r}}}},{key:"immediateLevelSwitch",value:function(){if(w.logger.log("immediateLevelSwitch"),!this.immediateSwitch){this.immediateSwitch=!0;var e=this.media,t=void 0;e?(t=e.paused,e.pause()):t=!0,this.previouslyPaused=t}var n=this.fragCurrent;n&&n.loader&&n.loader.abort(),this.fragCurrent=null,this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}},{key:"immediateLevelSwitchEnd",value:function(){var e=this.media;e&&e.buffered.length&&(this.immediateSwitch=!1,h.default.isBuffered(e,e.currentTime)&&(e.currentTime-=1e-4),this.previouslyPaused||e.play())}},{key:"nextLevelSwitch",value:function(){var e=this.media;if(e&&e.readyState){var t=void 0,n=void 0,r=void 0;if(this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold,n=this.getBufferedFrag(e.currentTime),n&&n.startPTS>1&&this.flushMainBuffer(0,n.startPTS-1),e.paused)t=0;else{var i=this.hls.nextLoadLevel,o=this.levels[i],a=this.fragLastKbps;t=a&&this.fragCurrent?this.fragCurrent.duration*o.bitrate/(1e3*a)+1:0}if((r=this.getBufferedFrag(e.currentTime+t))&&(r=this.followingBufferedFrag(r))){var s=this.fragCurrent;s&&s.loader&&s.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(r.maxStartPTS,Number.POSITIVE_INFINITY)}}}},{key:"flushMainBuffer",value:function(e,t){this.state=I.BUFFER_FLUSHING;var n={startOffset:e,endOffset:t};this.altAudio&&(n.type="video"),this.hls.trigger(y.default.BUFFER_FLUSHING,n)}},{key:"onMediaAttached",value:function(e){var t=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),this.onvended=this.onMediaEnded.bind(this),t.addEventListener("seeking",this.onvseeking),t.addEventListener("seeked",this.onvseeked),t.addEventListener("ended",this.onvended);var n=this.config;this.levels&&n.autoStartLoad&&this.hls.startLoad(n.startPosition)}},{key:"onMediaDetaching",value:function(){var e=this.media;e&&e.ended&&(w.logger.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);var t=this.levels;t&&t.forEach(function(e){e.details&&e.details.fragments.forEach(function(e){e.loadCounter=void 0,e.backtracked=void 0})}),e&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("seeked",this.onvseeked),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.stopLoad()}},{key:"onMediaSeeking",value:function(){var e=this.media,t=e?e.currentTime:void 0,n=this.config;isNaN(t)||w.logger.log("media seeking to "+t.toFixed(3));var r=this.mediaBuffer?this.mediaBuffer:e,i=h.default.bufferInfo(r,t,this.config.maxBufferHole);if(this.state===I.FRAG_LOADING){var o=this.fragCurrent;if(0===i.len&&o){var a=n.maxFragLookUpTolerance,s=o.start-a,l=o.start+o.duration+a;t<s||t>l?(o.loader&&(w.logger.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),o.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.state=I.IDLE):w.logger.log("seeking outside of buffer but within currently loaded fragment range")}}else this.state===I.ENDED&&(0===i.len&&(this.fragPrevious=0),this.state=I.IDLE);e&&(this.lastCurrentTime=t),this.state!==I.FRAG_LOADING&&void 0!==this.fragLoadIdx&&(this.fragLoadIdx+=2*n.fragLoadingLoopThreshold),this.loadedmetadata||(this.nextLoadPosition=this.startPosition=t),this.tick()}},{key:"onMediaSeeked",value:function(){var e=this.media,t=e?e.currentTime:void 0;isNaN(t)||w.logger.log("media seeked to "+t.toFixed(3)),this.tick()}},{key:"onMediaEnded",value:function(){w.logger.log("media ended"),this.startPosition=this.lastCurrentTime=0}},{key:"onManifestLoading",value:function(){w.logger.log("trigger BUFFER_RESET"),this.hls.trigger(y.default.BUFFER_RESET),this._bufferedFrags=[],this.stalled=!1,this.startPosition=this.lastCurrentTime=0}},{key:"onManifestParsed",value:function(e){var t,n=!1,r=!1;e.levels.forEach(function(e){(t=e.audioCodec)&&(-1!==t.indexOf("mp4a.40.2")&&(n=!0),-1!==t.indexOf("mp4a.40.5")&&(r=!0))}),this.audioCodecSwitch=n&&r,this.audioCodecSwitch&&w.logger.log("both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=e.levels,this.startLevelLoaded=!1,this.startFragRequested=!1;var i=this.config;(i.autoStartLoad||this.forceStartLoad)&&this.hls.startLoad(i.startPosition)}},{key:"onLevelLoaded",value:function(e){var t=e.details,n=e.level,r=this.levels[n],i=t.totalduration,o=0;if(w.logger.log("level "+n+" loaded ["+t.startSN+","+t.endSN+"],duration:"+i),this.levelLastLoaded=n,t.live){var a=r.details;a&&t.fragments.length>0?(E.default.mergeDetails(a,t),o=t.fragments[0].start,this.liveSyncPosition=this.computeLivePosition(o,a),t.PTSKnown?w.logger.log("live playlist sliding:"+o.toFixed(3)):w.logger.log("live playlist - outdated PTS, unknown sliding")):(t.PTSKnown=!1,w.logger.log("live playlist - first load, unknown sliding"))}else t.PTSKnown=!1;if(r.details=t,this.hls.trigger(y.default.LEVEL_UPDATED,{details:t,level:n}),!1===this.startFragRequested){if(-1===this.startPosition||-1===this.lastCurrentTime){var s=t.startTimeOffset;isNaN(s)?t.live?(this.startPosition=this.computeLivePosition(o,t),w.logger.log("configure startPosition to "+this.startPosition)):this.startPosition=0:(s<0&&(w.logger.log("negative start time offset "+s+", count from end of last fragment"),s=o+i+s),w.logger.log("start time offset found in playlist, adjust startPosition to "+s),this.startPosition=s),this.lastCurrentTime=this.startPosition}this.nextLoadPosition=this.startPosition}this.state===I.WAITING_LEVEL&&(this.state=I.IDLE),this.tick()}},{key:"onKeyLoaded",value:function(){this.state===I.KEY_LOADING&&(this.state=I.IDLE,this.tick())}},{key:"onFragLoaded",value:function(e){var t=this.fragCurrent,n=e.frag;if(this.state===I.FRAG_LOADING&&t&&"main"===n.type&&n.level===t.level&&n.sn===t.sn){var r=e.stats,i=this.levels[t.level],o=i.details;if(w.logger.log("Loaded  "+t.sn+" of ["+o.startSN+" ,"+o.endSN+"],level "+t.level),this.bitrateTest=!1,this.stats=r,!0===n.bitrateTest&&this.hls.nextLoadLevel)this.state=I.IDLE,this.startFragRequested=!1,r.tparsed=r.tbuffered=performance.now(),this.hls.trigger(y.default.FRAG_BUFFERED,{stats:r,frag:t,id:"main"}),this.tick();else if("initSegment"===n.sn)this.state=I.IDLE,r.tparsed=r.tbuffered=performance.now(),o.initSegment.data=e.payload,this.hls.trigger(y.default.FRAG_BUFFERED,{stats:r,frag:t,id:"main"}),this.tick();else{this.state=I.PARSING;var a=o.totalduration,s=t.level,l=t.sn,u=this.config.defaultAudioCodec||i.audioCodec;this.audioCodecSwap&&(w.logger.log("swapping playlist audio codec"),void 0===u&&(u=this.lastAudioCodec),u&&(u=-1!==u.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5")),this.pendingBuffering=!0,this.appended=!1,w.logger.log("Parsing "+l+" of ["+o.startSN+" ,"+o.endSN+"],level "+s+", cc "+t.cc);var d=this.demuxer;d||(d=this.demuxer=new m.default(this.hls,"main"));var c=this.media,f=c&&c.seeking,h=!f&&(o.PTSKnown||!o.live),p=o.initSegment?o.initSegment.data:[];d.push(e.payload,p,u,i.videoCodec,t,a,h,void 0)}}this.fragLoadError=0}},{key:"onFragParsingInitSegment",value:function(e){var t=this.fragCurrent,n=e.frag;if(t&&"main"===e.id&&n.sn===t.sn&&n.level===t.level&&this.state===I.PARSING){var r,i,o=e.tracks;if(o.audio&&this.altAudio&&delete o.audio,i=o.audio){var a=this.levels[this.level].audioCodec,s=navigator.userAgent.toLowerCase();a&&this.audioCodecSwap&&(w.logger.log("swapping playlist audio codec"),a=-1!==a.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),this.audioCodecSwitch&&1!==i.metadata.channelCount&&-1===s.indexOf("firefox")&&(a="mp4a.40.5"),-1!==s.indexOf("android")&&"audio/mpeg"!==i.container&&(a="mp4a.40.2",w.logger.log("Android: force audio codec to "+a)),i.levelCodec=a,i.id=e.id}i=o.video,i&&(i.levelCodec=this.levels[this.level].videoCodec,i.id=e.id),this.hls.trigger(y.default.BUFFER_CODECS,o);for(r in o){i=o[r],w.logger.log("main track:"+r+",container:"+i.container+",codecs[level/parsed]=["+i.levelCodec+"/"+i.codec+"]");var l=i.initSegment;l&&(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(y.default.BUFFER_APPENDING,{type:r,data:l,parent:"main",content:"initSegment"}))}this.tick()}}},{key:"onFragParsingData",value:function(e){var t=this,n=this.fragCurrent,r=e.frag;if(n&&"main"===e.id&&r.sn===n.sn&&r.level===n.level&&("audio"!==e.type||!this.altAudio)&&this.state===I.PARSING){var i=this.levels[this.level],o=n;if(isNaN(e.endPTS)&&(e.endPTS=e.startPTS+n.duration,e.endDTS=e.startDTS+n.duration),w.logger.log("Parsed "+e.type+",PTS:["+e.startPTS.toFixed(3)+","+e.endPTS.toFixed(3)+"],DTS:["+e.startDTS.toFixed(3)+"/"+e.endDTS.toFixed(3)+"],nb:"+e.nb+",dropped:"+(e.dropped||0)),"video"===e.type)if(o.dropped=e.dropped,o.dropped){if(!o.backtracked)return w.logger.warn("missing video frame(s), backtracking fragment"),o.backtracked=!0,this.nextLoadPosition=e.startPTS,this.state=I.IDLE,this.fragPrevious=o,void this.tick();w.logger.warn("Already backtracked on this fragment, appending with the gap")}else o.backtracked=!1;var a=E.default.updateFragPTSDTS(i.details,o,e.startPTS,e.endPTS,e.startDTS,e.endDTS),s=this.hls;s.trigger(y.default.LEVEL_PTS_UPDATED,{details:i.details,level:this.level,drift:a,type:e.type,start:e.startPTS,end:e.endPTS}),[e.data1,e.data2].forEach(function(n){n&&n.length&&t.state===I.PARSING&&(t.appended=!0,t.pendingBuffering=!0,s.trigger(y.default.BUFFER_APPENDING,{type:e.type,data:n,parent:"main",content:"data"}))}),this.tick()}}},{key:"onFragParsed",value:function(e){var t=this.fragCurrent,n=e.frag;t&&"main"===e.id&&n.sn===t.sn&&n.level===t.level&&this.state===I.PARSING&&(this.stats.tparsed=performance.now(),this.state=I.PARSED,this._checkAppendedParsed())}},{key:"onAudioTrackSwitching",value:function(e){var t=!!e.url,n=e.id;if(!t){if(this.mediaBuffer!==this.media){w.logger.log("switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var r=this.fragCurrent;r.loader&&(w.logger.log("switching to main audio track, cancel main fragment load"),r.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=I.IDLE}var i=this.hls;i.trigger(y.default.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),i.trigger(y.default.AUDIO_TRACK_SWITCHED,{id:n}),this.altAudio=!1}}},{key:"onAudioTrackSwitched",value:function(e){var t=e.id,n=!!this.hls.audioTracks[t].url;if(n){var r=this.videoBuffer;r&&this.mediaBuffer!==r&&(w.logger.log("switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=r)}this.altAudio=n,this.tick()}},{key:"onBufferCreated",value:function(e){var t=e.tracks,n=void 0,r=void 0,i=!1;for(var o in t){var a=t[o];"main"===a.id?(r=o,n=a,"video"===o&&(this.videoBuffer=t[o].buffer)):i=!0}i&&n?(w.logger.log("alternate track found, use "+r+".buffered to schedule main fragment loading"),this.mediaBuffer=n.buffer):this.mediaBuffer=this.media}},{key:"onBufferAppended",value:function(e){if("main"===e.parent){var t=this.state;t!==I.PARSING&&t!==I.PARSED||(this.pendingBuffering=e.pending>0,this._checkAppendedParsed())}}},{key:"_checkAppendedParsed",value:function(){if(!(this.state!==I.PARSED||this.appended&&this.pendingBuffering)){var e=this.fragCurrent;if(e){var t=this.mediaBuffer?this.mediaBuffer:this.media;w.logger.log("main buffered : "+S.default.toString(t.buffered));var n=this._bufferedFrags.filter(function(e){return h.default.isBuffered(t,(e.startPTS+e.endPTS)/2)});n.push(e),this._bufferedFrags=n.sort(function(e,t){return e.startPTS-t.startPTS}),this.fragPrevious=e;var r=this.stats;r.tbuffered=performance.now(),this.fragLastKbps=Math.round(8*r.total/(r.tbuffered-r.tfirst)),this.hls.trigger(y.default.FRAG_BUFFERED,{stats:r,frag:e,id:"main"}),this.state=I.IDLE}this.tick()}}},{key:"onError",value:function(e){var t=e.frag||this.fragCurrent;if(!t||"main"===t.type){var n=this.media,r=n&&h.default.isBuffered(n,n.currentTime)&&h.default.isBuffered(n,n.currentTime+.5);switch(e.details){case x.ErrorDetails.FRAG_LOAD_ERROR:case x.ErrorDetails.FRAG_LOAD_TIMEOUT:case x.ErrorDetails.KEY_LOAD_ERROR:case x.ErrorDetails.KEY_LOAD_TIMEOUT:if(!e.fatal){var i=this.fragLoadError;i?i++:i=1;var o=this.config;if(i<=o.fragLoadingMaxRetry||r||t.autoLevel&&t.level){this.fragLoadError=i,t.loadCounter=0;var a=Math.min(Math.pow(2,i-1)*o.fragLoadingRetryDelay,o.fragLoadingMaxRetryTimeout);w.logger.warn("mediaController: frag loading failed, retry in "+a+" ms"),this.retryDate=performance.now()+a,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.state=I.FRAG_LOADING_WAITING_RETRY}else w.logger.error("mediaController: "+e.details+" reaches max retry, redispatch as fatal ..."),e.fatal=!0,this.state=I.ERROR}break;case x.ErrorDetails.FRAG_LOOP_LOADING_ERROR:e.fatal||(r?(this._reduceMaxBufferLength(t.duration),this.state=I.IDLE):t.autoLevel&&0!==t.level||(e.fatal=!0,this.state=I.ERROR));break;case x.ErrorDetails.LEVEL_LOAD_ERROR:case x.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==I.ERROR&&(e.fatal?(this.state=I.ERROR,w.logger.warn("streamController: "+e.details+",switch to "+this.state+" state ...")):e.levelRetry||this.state!==I.WAITING_LEVEL||(this.state=I.IDLE));break;case x.ErrorDetails.BUFFER_FULL_ERROR:"main"!==e.parent||this.state!==I.PARSING&&this.state!==I.PARSED||(r?(this._reduceMaxBufferLength(this.config.maxBufferLength),this.state=I.IDLE):(w.logger.warn("buffer full error also media.currentTime is not buffered, flush everything"),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)))}}}},{key:"_reduceMaxBufferLength",value:function(e){var t=this.config;t.maxMaxBufferLength>=e&&(t.maxMaxBufferLength/=2,w.logger.warn("main:reduce max buffer length to "+t.maxMaxBufferLength+"s"),this.fragLoadIdx+=2*t.fragLoadingLoopThreshold)}},{key:"_checkBuffer",value:function(){var e=this.media,t=this.config;if(e&&e.readyState){var n=e.currentTime,r=this.mediaBuffer?this.mediaBuffer:e,i=r.buffered;if(!this.loadedmetadata&&i.length){this.loadedmetadata=!0;var o=e.seeking?n:this.startPosition,a=h.default.isBuffered(r,o),s=i.start(0);(n!==o||!a&&Math.abs(o-s)<t.maxSeekHole)&&(w.logger.log("target start position:"+o),a||(o=s,w.logger.log("target start position not buffered, seek to buffered.start(0) "+o)),w.logger.log("adjust currentTime from "+n+" to "+o),e.currentTime=o)}else if(this.immediateSwitch)this.immediateLevelSwitchEnd();else{var l=h.default.bufferInfo(e,n,0),u=!(e.paused||e.ended||0===e.buffered.length),d=n!==this.lastCurrentTime;if(d)this.stallReported&&(w.logger.warn("playback not stuck anymore @"+n+", after "+Math.round(performance.now()-this.stalled)+"ms"),this.stallReported=!1),this.stalled=void 0,this.nudgeRetry=0;else if(u){var c=performance.now(),f=this.hls;if(this.stalled){var p=c-this.stalled,m=l.len,g=this.nudgeRetry||0;if(m<=.5&&p>1e3*t.lowBufferWatchdogPeriod){this.stallReported||(this.stallReported=!0,w.logger.warn("playback stalling in low buffer @"+n),f.trigger(y.default.ERROR,{type:x.ErrorTypes.MEDIA_ERROR,details:x.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:m}));var v=l.nextStart,_=v-n;if(v&&_<t.maxSeekHole&&_>0){this.nudgeRetry=++g;var b=g*t.nudgeOffset;w.logger.log("adjust currentTime from "+e.currentTime+" to next buffered @ "+v+" + nudge "+b),e.currentTime=v+b,this.stalled=void 0,f.trigger(y.default.ERROR,{type:x.ErrorTypes.MEDIA_ERROR,details:x.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,hole:v+b-n})}}else if(m>.5&&p>1e3*t.highBufferWatchdogPeriod)if(this.stallReported||(this.stallReported=!0,w.logger.warn("playback stalling in high buffer @"+n),f.trigger(y.default.ERROR,{type:x.ErrorTypes.MEDIA_ERROR,details:x.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:m})),this.stalled=void 0,this.nudgeRetry=++g,g<t.nudgeMaxRetry){var E=e.currentTime,T=E+g*t.nudgeOffset;w.logger.log("adjust currentTime from "+E+" to "+T),e.currentTime=T,f.trigger(y.default.ERROR,{type:x.ErrorTypes.MEDIA_ERROR,details:x.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})}else w.logger.error("still stuck in high buffer @"+n+" after "+t.nudgeMaxRetry+", raise fatal error"),f.trigger(y.default.ERROR,{type:x.ErrorTypes.MEDIA_ERROR,details:x.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0})}else this.stalled=c,this.stallReported=!1}}}}},{key:"onFragLoadEmergencyAborted",value:function(){this.state=I.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tick()}},{key:"onBufferFlushed",value:function(){var e=this.mediaBuffer?this.mediaBuffer:this.media;this._bufferedFrags=this._bufferedFrags.filter(function(t){return h.default.isBuffered(e,(t.startPTS+t.endPTS)/2)}),this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold,this.state=I.IDLE,this.fragPrevious=null}},{key:"swapAudioCodec",value:function(){this.audioCodecSwap=!this.audioCodecSwap}},{key:"computeLivePosition",value:function(e,t){var n=void 0!==this.config.liveSyncDuration?this.config.liveSyncDuration:this.config.liveSyncDurationCount*t.targetduration;return e+Math.max(0,t.totalduration-n)}},{key:"state",set:function(e){if(this.state!==e){var t=this.state;this._state=e,w.logger.log("main stream:"+t+"->"+e),this.hls.trigger(y.default.STREAM_STATE_TRANSITION,{previousState:t,nextState:e})}},get:function(){return this._state}},{key:"currentLevel",get:function(){var e=this.media;if(e){var t=this.getBufferedFrag(e.currentTime);if(t)return t.level}return-1}},{key:"nextBufferedFrag",get:function(){var e=this.media;return e?this.followingBufferedFrag(this.getBufferedFrag(e.currentTime)):null}},{key:"nextLevel",get:function(){var e=this.nextBufferedFrag;return e?e.level:-1}},{key:"liveSyncPosition",get:function(){return this._liveSyncPosition},set:function(e){this._liveSyncPosition=e}}]),t}(_.default);t.default=D},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":l(t))&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":l(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l="function"==typeof Symbol&&"symbol"==r(Symbol.iterator)?function(e){return void 0===e?"undefined":r(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":r(e)};Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),d=n(1),c=i(d),f=n(3),h=i(f),p=n(0),m=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,c.default.ERROR,c.default.SUBTITLE_TRACKS_UPDATED,c.default.SUBTITLE_TRACK_SWITCH,c.default.SUBTITLE_TRACK_LOADED,c.default.SUBTITLE_FRAG_PROCESSED));return n.config=e.config,n.vttFragSNsProcessed={},n.vttFragQueues=void 0,n.currentlyProcessing=null,n.currentTrackId=-1,n}return s(t,e),u(t,[{key:"destroy",value:function(){h.default.prototype.destroy.call(this)}},{key:"clearVttFragQueues",value:function(){var e=this;this.vttFragQueues={},this.tracks.forEach(function(t){e.vttFragQueues[t.id]=[]})}},{key:"nextFrag",value:function(){if(null===this.currentlyProcessing&&this.currentTrackId>-1&&this.vttFragQueues[this.currentTrackId].length){var e=this.currentlyProcessing=this.vttFragQueues[this.currentTrackId].shift();this.hls.trigger(c.default.FRAG_LOADING,{frag:e})}}},{key:"onSubtitleFragProcessed",value:function(e){e.success&&this.vttFragSNsProcessed[e.frag.trackId].push(e.frag.sn),this.currentlyProcessing=null,this.nextFrag()}},{key:"onError",value:function(e){var t=e.frag;t&&"subtitle"!==t.type||this.currentlyProcessing&&(this.currentlyProcessing=null,this.nextFrag())}},{key:"onSubtitleTracksUpdated",value:function(e){var t=this;p.logger.log("subtitle tracks updated"),this.tracks=e.subtitleTracks,this.clearVttFragQueues(),this.vttFragSNsProcessed={},this.tracks.forEach(function(e){t.vttFragSNsProcessed[e.id]=[]})}},{key:"onSubtitleTrackSwitch",value:function(e){this.currentTrackId=e.id,this.clearVttFragQueues()}},{key:"onSubtitleTrackLoaded",value:function(e){var t=this.vttFragSNsProcessed[e.id],n=this.vttFragQueues[e.id],r=this.currentlyProcessing?this.currentlyProcessing.sn:-1,i=function(e){return t.indexOf(e.sn)>-1},o=function(e){return n.some(function(t){return t.sn===e.sn})};e.details.fragments.forEach(function(t){i(t)||t.sn===r||o(t)||(t.trackId=e.id,n.push(t))}),this.nextFrag()}}]),t}(h.default);t.default=m},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":u(t))&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":u(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function l(e){for(var t=[],n=0;n<e.length;n++)"subtitles"===e[n].kind&&t.push(e[n]);return t}var u="function"==typeof Symbol&&"symbol"==r(Symbol.iterator)?function(e){return void 0===e?"undefined":r(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":r(e)};Object.defineProperty(t,"__esModule",{value:!0});var d=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(1),f=i(c),h=n(3),p=i(h),m=n(0),g=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,f.default.MEDIA_ATTACHED,f.default.MEDIA_DETACHING,f.default.MANIFEST_LOADING,f.default.MANIFEST_LOADED,f.default.SUBTITLE_TRACK_LOADED));return n.tracks=[],n.trackId=-1,n.media=void 0,n}return s(t,e),d(t,[{key:"_onTextTracksChanged",value:function(){if(this.media){for(var e=-1,t=l(this.media.textTracks),n=0;n<t.length;n++)"showing"===t[n].mode&&(e=n);this.subtitleTrack=e}}},{key:"destroy",value:function(){p.default.prototype.destroy.call(this)}},{key:"onMediaAttached",value:function(e){this.media=e.media,this.media&&(this.trackChangeListener=this._onTextTracksChanged.bind(this),this.media.textTracks.addEventListener("change",this.trackChangeListener))}},{key:"onMediaDetaching",value:function(){this.media&&(this.media.textTracks.removeEventListener("change",this.trackChangeListener),this.media=void 0)}},{key:"onManifestLoading",value:function(){this.tracks=[],this.trackId=-1}},{key:"onManifestLoaded",value:function(e){var t=this,n=e.subtitles||[],r=!1;this.tracks=n,this.trackId=-1,this.hls.trigger(f.default.SUBTITLE_TRACKS_UPDATED,{subtitleTracks:n}),n.forEach(function(e){e.default&&(t.subtitleTrack=e.id,r=!0)})}},{key:"onTick",value:function(){var e=this.trackId,t=this.tracks[e];if(t){var n=t.details;void 0!==n&&!0!==n.live||(m.logger.log("(re)loading playlist for subtitle track "+e),this.hls.trigger(f.default.SUBTITLE_TRACK_LOADING,{url:t.url,id:e}))}}},{key:"onSubtitleTrackLoaded",value:function(e){var t=this;e.id<this.tracks.length&&(m.logger.log("subtitle track "+e.id+" loaded"),this.tracks[e.id].details=e.details,e.details.live&&!this.timer&&(this.timer=setInterval(function(){t.onTick()},1e3*e.details.targetduration,this)),!e.details.live&&this.timer&&(clearInterval(this.timer),this.timer=null))}},{key:"setSubtitleTrackInternal",value:function(e){if(e>=0&&e<this.tracks.length){this.timer&&(clearInterval(this.timer),this.timer=null),this.trackId=e,m.logger.log("switching to subtitle track "+e);var t=this.tracks[e];this.hls.trigger(f.default.SUBTITLE_TRACK_SWITCH,{id:e});var n=t.details;void 0!==n&&!0!==n.live||(m.logger.log("(re)loading playlist for subtitle track "+e),this.hls.trigger(f.default.SUBTITLE_TRACK_LOADING,{url:t.url,id:e}))}}},{key:"subtitleTracks",get:function(){return this.tracks}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(e){this.trackId!==e&&this.setSubtitleTrackInternal(e)}}]),t}(p.default);t.default=g},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":c(t))&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":c(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function l(e){if(e&&e.cues)for(;e.cues.length>0;)e.removeCue(e.cues[0])}function u(e,t){return e&&e.label===t.name&&!(e.textTrack1||e.textTrack2)}function d(e,t,n,r){return Math.min(t,r)-Math.max(e,n)}var c="function"==typeof Symbol&&"symbol"==r(Symbol.iterator)?function(e){return void 0===e?"undefined":r(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":r(e)};Object.defineProperty(t,"__esModule",{value:!0});var f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),h=n(1),p=i(h),m=n(3),g=i(m),y=n(50),v=i(y),_=n(56),b=i(_),E=n(0),T=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,p.default.MEDIA_ATTACHING,p.default.MEDIA_DETACHING,p.default.FRAG_PARSING_USERDATA,p.default.MANIFEST_LOADING,p.default.MANIFEST_LOADED,p.default.FRAG_LOADED,p.default.LEVEL_SWITCHING,p.default.INIT_PTS_FOUND));if(n.hls=e,n.config=e.config,n.enabled=!0,n.Cues=e.config.cueHandler,n.textTracks=[],n.tracks=[],n.unparsedVttFrags=[],n.initPTS=void 0,n.cueRanges=[],n.config.enableCEA708Captions){var r=n,i=function(e,t){var n=null;try{n=new window.Event("addtrack")}catch(e){n=document.createEvent("Event"),n.initEvent("addtrack",!1,!1)}n.track=e,t.dispatchEvent(n)},s={newCue:function(e,t,n){if(!r.textTrack1){var o=r.getExistingTrack("1");if(o)r.textTrack1=o,l(r.textTrack1),i(r.textTrack1,r.media);else{var a=r.createTextTrack("captions",r.config.captionsTextTrack1Label,r.config.captionsTextTrack1LanguageCode);a&&(a.textTrack1=!0,r.textTrack1=a)}}r.addCues("textTrack1",e,t,n)}},u={newCue:function(e,t,n){if(!r.textTrack2){var o=r.getExistingTrack("2");if(o)r.textTrack2=o,l(r.textTrack2),i(r.textTrack2,r.media);else{var a=r.createTextTrack("captions",r.config.captionsTextTrack2Label,r.config.captionsTextTrack1LanguageCode);a&&(a.textTrack2=!0,r.textTrack2=a)}}r.addCues("textTrack2",e,t,n)}};n.cea608Parser=new v.default(0,s,u)}return n}return s(t,e),f(t,[{key:"addCues",value:function(e,t,n,r){for(var i=this.cueRanges,o=!1,a=i.length;a--;){var s=i[a],l=d(s[0],s[1],t,n);if(l>=0&&(s[0]=Math.min(s[0],t),s[1]=Math.max(s[1],n),o=!0,l/(n-t)>.5))return}o||i.push([t,n]),this.Cues.newCue(this[e],t,n,r)}},{key:"onInitPtsFound",value:function(e){var t=this;void 0===this.initPTS&&(this.initPTS=e.initPTS),this.unparsedVttFrags.length&&(this.unparsedVttFrags.forEach(function(e){t.onFragLoaded(e)}),this.unparsedVttFrags=[])}},{key:"getExistingTrack",value:function(e){var t=this.media;if(t)for(var n=0;n<t.textTracks.length;n++){var r=t.textTracks[n],i="textTrack"+e;if(!0===r[i])return r}return null}},{key:"createTextTrack",value:function(e,t,n){var r=this.media;if(r)return r.addTextTrack(e,t,n)}},{key:"destroy",value:function(){g.default.prototype.destroy.call(this)}},{key:"onMediaAttaching",value:function(e){this.media=e.media}},{key:"onMediaDetaching",value:function(){l(this.textTrack1),l(this.textTrack2)}},{key:"onManifestLoading",value:function(){this.lastSn=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0};var e=this.media;if(e){var t=e.textTracks;if(t)for(var n=0;n<t.length;n++)l(t[n])}}},{key:"onManifestLoaded",value:function(e){var t=this;if(this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=void 0,this.cueRanges=[],this.config.enableWebVTT){this.tracks=e.subtitles||[];var n=this.media?this.media.textTracks:[];this.tracks.forEach(function(e,r){var i=void 0;if(r<n.length){var o=n[r];u(o,e)&&(i=o)}i||(i=t.createTextTrack("subtitles",e.name,e.lang)),i.mode=e.default?"showing":"hidden",t.textTracks.push(i)})}}},{key:"onLevelSwitching",value:function(){this.enabled="NONE"!==this.hls.currentLevel.closedCaptions}},{key:"onFragLoaded",value:function(e){var t=e.frag,n=e.payload;if("main"===t.type){var r=t.sn;if(r!==this.lastSn+1){var i=this.cea608Parser;i&&i.reset()}this.lastSn=r}else if("subtitle"===t.type)if(n.byteLength){if(void 0===this.initPTS)return void this.unparsedVttFrags.push(e);var o=this.vttCCs;o[t.cc]||(o[t.cc]={start:t.start,prevCC:this.prevCC,new:!0},this.prevCC=t.cc);var a=this.textTracks,s=this.hls;b.default.parse(n,this.initPTS,o,t.cc,function(e){var n=a[t.trackId];e.forEach(function(e){if(!n.cues.getCueById(e.id))try{n.addCue(e)}catch(r){var t=new window.TextTrackCue(e.startTime,e.endTime,e.text);t.id=e.id,n.addCue(t)}}),s.trigger(p.default.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:t})},function(e){E.logger.log("Failed to parse VTT cue: "+e),s.trigger(p.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t})})}else this.hls.trigger(p.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t})}},{key:"onFragParsingUserdata",value:function(e){if(this.enabled&&this.config.enableCEA708Captions)for(var t=0;t<e.samples.length;t++){var n=this.extractCea608Data(e.samples[t].bytes);this.cea608Parser.addData(e.samples[t].pts,n)}}},{key:"extractCea608Data",value:function(e){for(var t,n,r,i,o,a=31&e[0],s=2,l=[],u=0;u<a;u++)t=e[s++],n=127&e[s++],r=127&e[s++],i=0!=(4&t),o=3&t,0===n&&0===r||i&&0===o&&(l.push(n),l.push(r));return l}}]),t}(g.default);t.default=T},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(t,n){r(this,e),this.subtle=t,this.aesIV=n}return i(e,[{key:"decrypt",value:function(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)}}]),e}();t.default=o},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(){r(this,e),this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.initTable()}return i(e,[{key:"uint8ArrayToUint32Array_",value:function(e){for(var t=new DataView(e),n=new Uint32Array(4),r=0;r<4;r++)n[r]=t.getUint32(4*r);return n}},{key:"initTable",value:function(){var e=this.sBox,t=this.invSBox,n=this.subMix,r=n[0],i=n[1],o=n[2],a=n[3],s=this.invSubMix,l=s[0],u=s[1],d=s[2],c=s[3],f=new Uint32Array(256),h=0,p=0,m=0;for(m=0;m<256;m++)f[m]=m<128?m<<1:m<<1^283;for(m=0;m<256;m++){var g=p^p<<1^p<<2^p<<3^p<<4;g=g>>>8^255&g^99,e[h]=g,t[g]=h;var y=f[h],v=f[y],_=f[v],b=257*f[g]^16843008*g;r[h]=b<<24|b>>>8,i[h]=b<<16|b>>>16,o[h]=b<<8|b>>>24,a[h]=b,b=16843009*_^65537*v^257*y^16843008*h,l[g]=b<<24|b>>>8,u[g]=b<<16|b>>>16,d[g]=b<<8|b>>>24,c[g]=b,h?(h=y^f[f[f[_^y]]],p^=f[f[p]]):h=p=1}}},{key:"expandKey",value:function(e){for(var t=this.uint8ArrayToUint32Array_(e),n=!0,r=0;r<t.length&&n;)n=t[r]===this.key[r],r++;if(!n){this.key=t;var i=this.keySize=t.length;if(4!==i&&6!==i&&8!==i)throw new Error("Invalid aes key size="+i);var o=this.ksRows=4*(i+6+1),a=void 0,s=void 0,l=this.keySchedule=new Uint32Array(o),u=this.invKeySchedule=new Uint32Array(o),d=this.sBox,c=this.rcon,f=this.invSubMix,h=f[0],p=f[1],m=f[2],g=f[3],y=void 0,v=void 0;for(a=0;a<o;a++)a<i?y=l[a]=t[a]:(v=y,a%i==0?(v=v<<8|v>>>24,v=d[v>>>24]<<24|d[v>>>16&255]<<16|d[v>>>8&255]<<8|d[255&v],v^=c[a/i|0]<<24):i>6&&a%i==4&&(v=d[v>>>24]<<24|d[v>>>16&255]<<16|d[v>>>8&255]<<8|d[255&v]),l[a]=y=(l[a-i]^v)>>>0);for(s=0;s<o;s++)a=o-s,v=3&s?l[a]:l[a-4],u[s]=s<4||a<=4?v:h[d[v>>>24]]^p[d[v>>>16&255]]^m[d[v>>>8&255]]^g[d[255&v]],u[s]=u[s]>>>0}}},{key:"networkToHostOrderSwap",value:function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24}},{key:"decrypt",value:function(e,t,n){for(var r,i,o=this.keySize+6,a=this.invKeySchedule,s=this.invSBox,l=this.invSubMix,u=l[0],d=l[1],c=l[2],f=l[3],h=this.uint8ArrayToUint32Array_(n),p=h[0],m=h[1],g=h[2],y=h[3],v=new Int32Array(e),_=new Int32Array(v.length),b=void 0,E=void 0,T=void 0,S=void 0,x=void 0,w=void 0,I=void 0,D=void 0,R=void 0,A=void 0,P=void 0,M=void 0,L=this.networkToHostOrderSwap;t<v.length;){for(R=L(v[t]),A=L(v[t+1]),P=L(v[t+2]),M=L(v[t+3]),x=R^a[0],w=M^a[1],I=P^a[2],D=A^a[3],r=4,i=1;i<o;i++)b=u[x>>>24]^d[w>>16&255]^c[I>>8&255]^f[255&D]^a[r],E=u[w>>>24]^d[I>>16&255]^c[D>>8&255]^f[255&x]^a[r+1],T=u[I>>>24]^d[D>>16&255]^c[x>>8&255]^f[255&w]^a[r+2],S=u[D>>>24]^d[x>>16&255]^c[w>>8&255]^f[255&I]^a[r+3],x=b,w=E,I=T,D=S,r+=4;b=s[x>>>24]<<24^s[w>>16&255]<<16^s[I>>8&255]<<8^s[255&D]^a[r],E=s[w>>>24]<<24^s[I>>16&255]<<16^s[D>>8&255]<<8^s[255&x]^a[r+1],T=s[I>>>24]<<24^s[D>>16&255]<<16^s[x>>8&255]<<8^s[255&w]^a[r+2],S=s[D>>>24]<<24^s[x>>16&255]<<16^s[w>>8&255]<<8^s[255&I]^a[r+3],r+=3,_[t]=L(b^p),_[t+1]=L(S^m),_[t+2]=L(T^g),_[t+3]=L(E^y),p=R,m=A,g=P,y=M,t+=4}return _.buffer}},{key:"destroy",value:function(){this.key=void 0,this.keySize=void 0,this.ksRows=void 0,this.sBox=void 0,this.invSBox=void 0,this.subMix=void 0,this.invSubMix=void 0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.rcon=void 0}}]),e}();t.default=o},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(t,n){r(this,e),this.subtle=t,this.key=n}return i(e,[{key:"expandKey",value:function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])}}]),e}();t.default=o},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(9),s=r(a),l=n(0),u=n(6),d=r(u),c=function(){function e(t,n,r){i(this,e),this.observer=t,this.config=r,this.remuxer=n}return o(e,[{key:"resetInitSegment",value:function(e,t,n,r){this._audioTrack={container:"audio/adts",type:"audio",id:-1,sequenceNumber:0,isAAC:!0,samples:[],len:0,manifestCodec:t,duration:r,inputTimeScale:9e4}}},{key:"resetTimeStamp",value:function(){}},{key:"append",value:function(e,t,n,r){for(var i=this._audioTrack,o=d.default.getID3Data(e,0),a=90*d.default.getTimeStamp(o),u=0,c=a,f=e.length,h=o.length,p=[{pts:c,dts:c,data:o}];h<f-1;)if(s.default.isHeader(e,h)&&h+5<f){s.default.initTrackConfig(i,this.observer,e,h,i.manifestCodec);var m=s.default.appendFrame(i,e,h,a,u);if(!m){l.logger.log("Unable to parse AAC frame");break}h+=m.length,c=m.sample.pts,u++}else d.default.isHeader(e,h)?(o=d.default.getID3Data(e,h),p.push({pts:c,dts:c,data:o}),h+=o.length):h++;this.remuxer.remux(i,{samples:[]},{samples:p,inputTimeScale:9e4},{samples:[]},t,n,r)}},{key:"destroy",value:function(){}}],[{key:"probe",value:function(e){var t,n,r=d.default.getID3Data(e,0);if(r&&void 0!==d.default.getTimeStamp(r))for(t=r.length,n=Math.min(e.length-1,t+100);t<n;t++)if(s.default.probe(e,t))return l.logger.log("ADTS sync word found !"),!0;return!1}}]),e}();t.default=c},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(10),o=r(i),a=n(1),s=r(a),l=n(0),u=n(5),d=r(u),c=function(e){var t=new d.default;t.trigger=function(e){for(var n=arguments.length,r=Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];t.emit.apply(t,[e,e].concat(r))},t.off=function(e){for(var n=arguments.length,r=Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];t.removeListener.apply(t,[e].concat(r))};var n=function(t,n){e.postMessage({event:t,data:n})};e.addEventListener("message",function(r){var i=r.data;switch(i.cmd){case"init":var a=JSON.parse(i.config);e.demuxer=new o.default(t,i.typeSupported,a,i.vendor);try{(0,l.enableLogs)(!0===a.debug)}catch(e){console.warn("demuxerWorker: unable to enable logs")}n("init",null);break;case"demux":e.demuxer.push(i.data,i.decryptdata,i.initSegment,i.audioCodec,i.videoCodec,i.timeOffset,i.discontinuity,i.trackSwitch,i.contiguous,i.duration,i.accurateTimeOffset,i.defaultInitPTS)}}),t.on(s.default.FRAG_DECRYPTED,n),t.on(s.default.FRAG_PARSING_INIT_SEGMENT,n),t.on(s.default.FRAG_PARSED,n),t.on(s.default.ERROR,n),t.on(s.default.FRAG_PARSING_METADATA,n),t.on(s.default.FRAG_PARSING_USERDATA,n),t.on(s.default.INIT_PTS_FOUND,n),t.on(s.default.FRAG_PARSING_DATA,function(t,n){var r=[],i={event:t,data:n};n.data1&&(i.data1=n.data1.buffer,r.push(n.data1.buffer),delete n.data1),n.data2&&(i.data2=n.data2.buffer,r.push(n.data2.buffer),delete n.data2),e.postMessage(i,r)})};t.default=c},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(0),a=function(){function e(t){r(this,e),this.data=t,this.bytesAvailable=t.byteLength,this.word=0,this.bitsAvailable=0}return i(e,[{key:"loadWord",value:function(){var e=this.data,t=this.bytesAvailable,n=e.byteLength-t,r=new Uint8Array(4),i=Math.min(4,t);if(0===i)throw new Error("no bytes available");r.set(e.subarray(n,n+i)),this.word=new DataView(r.buffer).getUint32(0),this.bitsAvailable=8*i,this.bytesAvailable-=i}},{key:"skipBits",value:function(e){var t;this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,t=e>>3,e-=t>>3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}},{key:"readBits",value:function(e){var t=Math.min(this.bitsAvailable,e),n=this.word>>>32-t;return e>32&&o.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0?this.word<<=t:this.bytesAvailable>0&&this.loadWord(),t=e-t,t>0&&this.bitsAvailable?n<<t|this.readBits(t):n}},{key:"skipLZ",value:function(){var e;for(e=0;e<this.bitsAvailable;++e)if(0!=(this.word&2147483648>>>e))return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}},{key:"skipUEG",value:function(){this.skipBits(1+this.skipLZ())}},{key:"skipEG",value:function(){this.skipBits(1+this.skipLZ())}},{key:"readUEG",value:function(){var e=this.skipLZ();return this.readBits(e+1)-1}},{key:"readEG",value:function(){var e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}},{key:"readBoolean",value:function(){return 1===this.readBits(1)}},{key:"readUByte",value:function(){return this.readBits(8)}},{key:"readUShort",value:function(){return this.readBits(16)}},{key:"readUInt",value:function(){return this.readBits(32)}},{key:"skipScalingList",value:function(e){var t,n,r=8,i=8;for(t=0;t<e;t++)0!==i&&(n=this.readEG(),i=(r+n+256)%256),r=0===i?r:i}},{key:"readSPS",value:function(){var e,t,n,r,i,o,a,s=0,l=0,u=0,d=0,c=this.readUByte.bind(this),f=this.readBits.bind(this),h=this.readUEG.bind(this),p=this.readBoolean.bind(this),m=this.skipBits.bind(this),g=this.skipEG.bind(this),y=this.skipUEG.bind(this),v=this.skipScalingList.bind(this);if(c(),e=c(),f(5),m(3),c(),y(),100===e||110===e||122===e||244===e||44===e||83===e||86===e||118===e||128===e){var _=h();if(3===_&&m(1),y(),y(),m(1),p())for(o=3!==_?8:12,a=0;a<o;a++)p()&&v(a<6?16:64)}y();var b=h();if(0===b)h();else if(1===b)for(m(1),g(),g(),t=h(),a=0;a<t;a++)g();y(),m(1),n=h(),r=h(),i=f(1),0===i&&m(1),m(1),p()&&(s=h(),l=h(),u=h(),d=h());var E=[1,1];if(p()&&p())switch(c()){case 1:E=[1,1];break;case 2:E=[12,11];break;case 3:E=[10,11];break;case 4:E=[16,11];break;case 5:E=[40,33];break;case 6:E=[24,11];break;case 7:E=[20,11];break;case 8:E=[32,11];break;case 9:E=[80,33];break;case 10:E=[18,11];break;case 11:E=[15,11];break;case 12:E=[64,33];break;case 13:E=[160,99];break;case 14:E=[4,3];break;case 15:E=[3,2];break;case 16:E=[2,1];break;case 255:E=[c()<<8|c(),c()<<8|c()]}return{width:Math.ceil(16*(n+1)-2*s-2*l),height:(2-i)*(r+1)*16-(i?2:4)*(u+d),pixelRatio:E}}},{key:"readSliceType",value:function(){return this.readUByte(),this.readUEG(),this.readUEG()}}]),e}();t.default=a},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(6),s=r(a),l=n(0),u=n(12),d=r(u),c=function(){function e(t,n,r){i(this,e),this.observer=t,this.config=r,this.remuxer=n}return o(e,[{key:"resetInitSegment",value:function(e,t,n,r){this._audioTrack={container:"audio/mpeg",type:"audio",id:-1,sequenceNumber:0,isAAC:!1,samples:[],len:0,manifestCodec:t,duration:r,inputTimeScale:9e4}}},{key:"resetTimeStamp",value:function(){}},{key:"append",value:function(e,t,n,r){for(var i=s.default.getID3Data(e,0),o=90*s.default.getTimeStamp(i),a=i.length,l=e.length,u=0,c=0,f=this._audioTrack,h=[{pts:o,dts:o,data:i}];a<l;)if(d.default.isHeader(e,a)){var p=d.default.appendFrame(f,e,a,o,u);if(!p)break;a+=p.length,c=p.sample.pts,u++}else s.default.isHeader(e,a)?(i=s.default.getID3Data(e,a),h.push({pts:c,dts:c,data:i}),a+=i.length):a++;this.remuxer.remux(f,{samples:[]},{samples:h,inputTimeScale:9e4},{samples:[]},t,n,r)}},{key:"destroy",value:function(){}}],[{key:"probe",value:function(e){var t,n,r=s.default.getID3Data(e,0);if(r&&void 0!==s.default.getTimeStamp(r))for(t=r.length,n=Math.min(e.length-1,t+100);t<n;t++)if(d.default.probe(e,t))return l.logger.log("MPEG Audio sync word found !"),!0;return!1}}]),e}();t.default=c},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(1),a=function(e){return e&&e.__esModule?e:{default:e}}(o),s=Math.pow(2,32)-1,l=function(){function e(t,n){r(this,e),this.observer=t,this.remuxer=n}return i(e,[{key:"resetTimeStamp",value:function(e){this.initPTS=e}},{key:"resetInitSegment",value:function(t,n,r,i){if(t&&t.byteLength){var o=this.initData=e.parseInitSegment(t),s={};o.audio&&(s.audio={container:"audio/mp4",codec:n,initSegment:i?t:null}),o.video&&(s.video={container:"video/mp4",codec:r,initSegment:i?t:null}),this.observer.trigger(a.default.FRAG_PARSING_INIT_SEGMENT,{tracks:s})}else n&&(this.audioCodec=n),r&&(this.videoCodec=r)}},{key:"append",value:function(t,n,r,i){var o=this.initData;o||(this.resetInitSegment(t,this.audioCodec,this.videoCodec),o=this.initData);var s=void 0,l=this.initPTS;if(void 0===l){var u=e.getStartDTS(o,t);this.initPTS=l=u-n,this.observer.trigger(a.default.INIT_PTS_FOUND,{initPTS:l})}e.offsetStartDTS(o,t,l),s=e.getStartDTS(o,t),this.remuxer.remux(o.audio,o.video,null,null,s,r,i,t)}},{key:"destroy",value:function(){}}],[{key:"probe",value:function(t){return t.length>=8&&["moof","ftyp","styp"].indexOf(e.bin2str(t.subarray(4,8)))>=0}},{key:"bin2str",value:function(e){return String.fromCharCode.apply(null,e)}},{key:"readUint32",value:function(e,t){e.data&&(t+=e.start,e=e.data);var n=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3];return n<0?4294967296+n:n}},{key:"writeUint32",value:function(e,t,n){e.data&&(t+=e.start,e=e.data),e[t]=n>>24,e[t+1]=n>>16&255,e[t+2]=n>>8&255,e[t+3]=255&n}},{key:"findBox",value:function(t,n){var r,i,o,a,s,l,u,d=[];if(t.data?(l=t.start,a=t.end,t=t.data):(l=0,a=t.byteLength),!n.length)return null;for(r=l;r<a;)i=e.readUint32(t,r),o=e.bin2str(t.subarray(r+4,r+8)),u=i>1?r+i:a,o===n[0]&&(1===n.length?d.push({data:t,start:r+8,end:u}):(s=e.findBox({data:t,start:r+8,end:u},n.slice(1)),s.length&&(d=d.concat(s)))),r=u;return d}},{key:"parseInitSegment",value:function(t){var n=[];return e.findBox(t,["moov","trak"]).forEach(function(t){var r=e.findBox(t,["tkhd"])[0];if(r){var i=r.data[r.start],o=0===i?12:20,a=e.readUint32(r,o),s=e.findBox(t,["mdia","mdhd"])[0];if(s){i=s.data[s.start],o=0===i?12:20;var l=e.readUint32(s,o),u=e.findBox(t,["mdia","hdlr"])[0];if(u){var d=e.bin2str(u.data.subarray(u.start+8,u.start+12)),c={soun:"audio",vide:"video"}[d];c&&(n[a]={timescale:l,type:c},n[c]={timescale:l,id:a})}}}}),n}},{key:"getStartDTS",value:function(t,n){var r,i,o;return r=e.findBox(n,["moof","traf"]),i=[].concat.apply([],r.map(function(n){return e.findBox(n,["tfhd"]).map(function(r){var i,o,a;return i=e.readUint32(r,4),o=t[i].timescale||9e4,a=e.findBox(n,["tfdt"]).map(function(t){var n,r;return n=t.data[t.start],r=e.readUint32(t,4),1===n&&(r*=Math.pow(2,32),r+=e.readUint32(t,8)),r})[0],(a=a||1/0)/o})})),o=Math.min.apply(null,i),isFinite(o)?o:0}},{key:"offsetStartDTS",value:function(t,n,r){e.findBox(n,["moof","traf"]).map(function(n){return e.findBox(n,["tfhd"]).map(function(i){var o=e.readUint32(i,4),a=t[o].timescale||9e4;e.findBox(n,["tfdt"]).map(function(t){var n=t.data[t.start],i=e.readUint32(t,4);if(0===n)e.writeUint32(t,4,i-r*a);else{i*=Math.pow(2,32),i+=e.readUint32(t,8),i-=r*a;var o=Math.floor(i/(s+1)),l=Math.floor(i%(s+1));e.writeUint32(t,4,o),e.writeUint32(t,8,l)}})})})}}]),e}();t.default=l},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(8),a=function(e){return e&&e.__esModule?e:{default:e}}(o),s=function(){function e(t,n,i,o){r(this,e),this.decryptdata=i,this.discardEPB=o,this.decrypter=new a.default(t,n)}return i(e,[{key:"decryptBuffer",value:function(e,t){this.decrypter.decrypt(e,this.decryptdata.key.buffer,this.decryptdata.iv.buffer,t)}},{key:"decryptAacSample",value:function(e,t,n,r){var i=e[t].unit,o=i.subarray(16,i.length-i.length%16),a=o.buffer.slice(o.byteOffset,o.byteOffset+o.length),s=this;this.decryptBuffer(a,function(o){o=new Uint8Array(o),i.set(o,16),r||s.decryptAacSamples(e,t+1,n)})}},{key:"decryptAacSamples",value:function(e,t,n){for(;;t++){if(t>=e.length)return void n();if(!(e[t].unit.length<32)){var r=this.decrypter.isSync();if(this.decryptAacSample(e,t,n,r),!r)return}}}},{key:"getAvcEncryptedData",value:function(e){for(var t=16*Math.floor((e.length-48)/160)+16,n=new Int8Array(t),r=0,i=32;i<=e.length-16;i+=160,r+=16)n.set(e.subarray(i,i+16),r);return n}},{key:"getAvcDecryptedUnit",value:function(e,t){t=new Uint8Array(t);for(var n=0,r=32;r<=e.length-16;r+=160,n+=16)e.set(t.subarray(n,n+16),r);return e}},{key:"decryptAvcSample",value:function(e,t,n,r,i,o){var a=this.discardEPB(i.data),s=this.getAvcEncryptedData(a),l=this;this.decryptBuffer(s.buffer,function(s){i.data=l.getAvcDecryptedUnit(a,s),o||l.decryptAvcSamples(e,t,n+1,r)})}},{key:"decryptAvcSamples",value:function(e,t,n,r){for(;;t++,n=0){if(t>=e.length)return void r();for(var i=e[t].units;!(n>=i.length);n++){var o=i[n];if(!(o.length<=48||1!==o.type&&5!==o.type)){var a=this.decrypter.isSync();if(this.decryptAvcSample(e,t,n,r,o,a),!a)return}}}}}]),e}();t.default=s},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(9),s=r(a),l=n(12),u=r(l),d=n(1),c=r(d),f=n(36),h=r(f),p=n(39),m=r(p),g=n(0),y=n(2),v=function(){function e(t,n,r,o){i(this,e),this.observer=t,this.config=r,this.typeSupported=o,this.remuxer=n,this.sampleAes=null}return o(e,[{key:"setDecryptData",value:function(e){null!=e&&null!=e.key&&"SAMPLE-AES"===e.method?this.sampleAes=new m.default(this.observer,this.config,e,this.discardEPB):this.sampleAes=null}},{key:"resetInitSegment",value:function(e,t,n,r){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack={container:"video/mp2t",type:"video",id:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],len:0,dropped:0},this._audioTrack={container:"video/mp2t",type:"audio",id:-1,inputTimeScale:9e4,duration:r,sequenceNumber:0,samples:[],len:0,isAAC:!0},this._id3Track={type:"id3",id:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],len:0},this._txtTrack={type:"text",id:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],len:0},this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.audioCodec=t,this.videoCodec=n,this._duration=r}},{key:"resetTimeStamp",value:function(){}},{key:"append",value:function(e,t,n,r){var i,o,a,s,l,u=e.length,d=!1;this.contiguous=n;var f=this.pmtParsed,h=this._avcTrack,p=this._audioTrack,m=this._id3Track,v=h.id,_=p.id,b=m.id,E=this._pmtId,T=h.pesData,S=p.pesData,x=m.pesData,w=this._parsePAT,I=this._parsePMT,D=this._parsePES,R=this._parseAVCPES.bind(this),A=this._parseAACPES.bind(this),P=this._parseMPEGPES.bind(this),M=this._parseID3PES.bind(this);for(u-=u%188,i=0;i<u;i+=188)if(71===e[i]){if(o=!!(64&e[i+1]),a=((31&e[i+1])<<8)+e[i+2],(48&e[i+3])>>4>1){if((s=i+5+e[i+4])===i+188)continue}else s=i+4;switch(a){case v:o&&(T&&(l=D(T))&&R(l,!1),T={data:[],size:0}),T&&(T.data.push(e.subarray(s,i+188)),T.size+=i+188-s);break;case _:o&&(S&&(l=D(S))&&(p.isAAC?A(l):P(l)),S={data:[],size:0}),S&&(S.data.push(e.subarray(s,i+188)),S.size+=i+188-s);break;case b:o&&(x&&(l=D(x))&&M(l),x={data:[],size:0}),x&&(x.data.push(e.subarray(s,i+188)),x.size+=i+188-s);break;case 0:o&&(s+=e[s]+1),E=this._pmtId=w(e,s);break;case E:o&&(s+=e[s]+1);var L=I(e,s,!0===this.typeSupported.mpeg||!0===this.typeSupported.mp3,null!=this.sampleAes);v=L.avc,v>0&&(h.id=v),_=L.audio,_>0&&(p.id=_,p.isAAC=L.isAAC),b=L.id3,b>0&&(m.id=b),d&&!f&&(g.logger.log("reparse from beginning"),d=!1,i=-188),f=this.pmtParsed=!0;break;case 17:case 8191:break;default:d=!0}}else this.observer.trigger(c.default.ERROR,{type:y.ErrorTypes.MEDIA_ERROR,details:y.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"TS packet did not start with 0x47"});T&&(l=D(T))?(R(l,!0),h.pesData=null):h.pesData=T,S&&(l=D(S))?(p.isAAC?A(l):P(l),p.pesData=null):(S&&S.size&&g.logger.log("last AAC PES packet truncated,might overlap between fragments"),p.pesData=S),x&&(l=D(x))?(M(l),m.pesData=null):m.pesData=x,null==this.sampleAes?this.remuxer.remux(p,h,m,this._txtTrack,t,n,r):this.decryptAndRemux(p,h,m,this._txtTrack,t,n,r)}},{key:"decryptAndRemux",value:function(e,t,n,r,i,o,a){if(e.samples&&e.isAAC){var s=this;this.sampleAes.decryptAacSamples(e.samples,0,function(){s.decryptAndRemuxAvc(e,t,n,r,i,o,a)})}else this.decryptAndRemuxAvc(e,t,n,r,i,o,a)}},{key:"decryptAndRemuxAvc",value:function(e,t,n,r,i,o,a){if(t.samples){var s=this;this.sampleAes.decryptAvcSamples(t.samples,0,0,function(){s.remuxer.remux(e,t,n,r,i,o,a)})}else this.remuxer.remux(e,t,n,r,i,o,a)}},{key:"destroy",value:function(){this._initPTS=this._initDTS=void 0,this._duration=0}},{key:"_parsePAT",value:function(e,t){return(31&e[t+10])<<8|e[t+11]}},{key:"_parsePMT",value:function(e,t,n,r){var i,o,a,s,l={audio:-1,avc:-1,id3:-1,isAAC:!0};for(i=(15&e[t+1])<<8|e[t+2],o=t+3+i-4,a=(15&e[t+10])<<8|e[t+11],t+=12+a;t<o;){switch(s=(31&e[t+1])<<8|e[t+2],e[t]){case 207:if(!r){g.logger.log("unkown stream type:"+e[t]);break}case 15:-1===l.audio&&(l.audio=s);break;case 21:-1===l.id3&&(l.id3=s);break;case 219:if(!r){g.logger.log("unkown stream type:"+e[t]);break}case 27:-1===l.avc&&(l.avc=s);break;case 3:case 4:n?-1===l.audio&&(l.audio=s,l.isAAC=!1):g.logger.log("MPEG audio found, not supported in this browser for now");break;case 36:g.logger.warn("HEVC stream type found, not supported for now");break;default:g.logger.log("unkown stream type:"+e[t])}t+=5+((15&e[t+3])<<8|e[t+4])}return l}},{key:"_parsePES",value:function(e){var t,n,r,i,o,a,s,l,u=0,d=e.data;if(!e||0===e.size)return null;for(;d[0].length<19&&d.length>1;){var c=new Uint8Array(d[0].length+d[1].length);c.set(d[0]),c.set(d[1],d[0].length),d[0]=c,d.splice(1,1)}if(t=d[0],1===(t[0]<<16)+(t[1]<<8)+t[2]){if((r=(t[4]<<8)+t[5])&&r>e.size-6)return null;n=t[7],192&n&&(a=536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2,a>4294967295&&(a-=8589934592),64&n?(s=536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2,s>4294967295&&(s-=8589934592),a-s>54e5&&(g.logger.warn(Math.round((a-s)/9e4)+"s delta between PTS and DTS, align them"),a=s)):s=a),i=t[8],l=i+9,e.size-=l,o=new Uint8Array(e.size);for(var f=0,h=d.length;f<h;f++){t=d[f];var p=t.byteLength;if(l){if(l>p){l-=p;continue}t=t.subarray(l),p-=l,l=0}o.set(t,u),u+=p}return r&&(r-=i+3),{data:o,pts:a,dts:s,len:r}}return null}},{key:"pushAccesUnit",value:function(e,t){if(e.units.length&&e.frame){var n=t.samples,r=n.length;!this.config.forceKeyFrameOnDiscontinuity||!0===e.key||t.sps&&(r||this.contiguous)?(e.id=r,n.push(e)):t.dropped++}e.debug.length&&g.logger.log(e.pts+"/"+e.dts+":"+e.debug)}},{key:"_parseAVCPES",value:function(e,t){var n,r,i,o=this,a=this._avcTrack,s=this._parseAVCNALu(e.data),l=this.avcSample,u=!1,d=this.pushAccesUnit.bind(this),c=function(e,t,n,r){return{key:e,pts:t,dts:n,units:[],debug:r}};e.data=null,l&&s.length&&(d(l,a),l=this.avcSample=c(!1,e.pts,e.dts,"")),s.forEach(function(t){switch(t.type){case 1:r=!0,l.frame=!0;var s=t.data;if(u&&s.length>4){var f=new h.default(s).readSliceType();2!==f&&4!==f&&7!==f&&9!==f||(l.key=!0)}break;case 5:r=!0,l||(l=o.avcSample=c(!0,e.pts,e.dts,"")),l.key=!0,l.frame=!0;break;case 6:r=!0,n=new h.default(o.discardEPB(t.data)),n.readUByte();for(var p=0,m=0,g=!1,y=0;!g&&n.bytesAvailable>1;){p=0;do{y=n.readUByte(),p+=y}while(255===y);m=0;do{y=n.readUByte(),m+=y}while(255===y);if(4===p&&0!==n.bytesAvailable){if(g=!0,181===n.readUByte()&&49===n.readUShort()&&1195456820===n.readUInt()&&3===n.readUByte()){var v=n.readUByte(),_=n.readUByte(),b=31&v,E=[v,_];for(i=0;i<b;i++)E.push(n.readUByte()),E.push(n.readUByte()),E.push(n.readUByte());o._insertSampleInOrder(o._txtTrack.samples,{type:3,pts:e.pts,bytes:E})}}else if(m<n.bytesAvailable)for(i=0;i<m;i++)n.readUByte()}break;case 7:if(r=!0,u=!0,!a.sps){n=new h.default(t.data);var T=n.readSPS();a.width=T.width,a.height=T.height,a.pixelRatio=T.pixelRatio,a.sps=[t.data],a.duration=o._duration;var S=t.data.subarray(1,4),x="avc1.";for(i=0;i<3;i++){var w=S[i].toString(16);w.length<2&&(w="0"+w),x+=w}a.codec=x}break;case 8:r=!0,a.pps||(a.pps=[t.data]);break;case 9:r=!1,l&&d(l,a),l=o.avcSample=c(!1,e.pts,e.dts,"");break;case 12:r=!1;break;default:r=!1,l&&(l.debug+="unknown NAL "+t.type+" ")}l&&r&&l.units.push(t)}),t&&l&&(d(l,a),this.avcSample=null)}},{key:"_insertSampleInOrder",value:function(e,t){var n=e.length;if(n>0){if(t.pts>=e[n-1].pts)e.push(t);else for(var r=n-1;r>=0;r--)if(t.pts<e[r].pts){e.splice(r,0,t);break}}else e.push(t)}},{key:"_getLastNalUnit",value:function(){var e=this.avcSample,t=void 0;if(!e||0===e.units.length){var n=this._avcTrack,r=n.samples;e=r[r.length-1]}if(e){var i=e.units;t=i[i.length-1]}return t}},{key:"_parseAVCNALu",value:function(e){var t,n,r,i,o,a=0,s=e.byteLength,l=this._avcTrack,u=l.naluState||0,d=u,c=[],f=-1;for(-1===u&&(f=0,o=31&e[0],u=0,a=1);a<s;)if(t=e[a++],u)if(1!==u)if(t)if(1===t){if(f>=0)r={data:e.subarray(f,a-u-1),type:o},c.push(r);else{var h=this._getLastNalUnit();if(h&&(d&&a<=4-d&&h.state&&(h.data=h.data.subarray(0,h.data.byteLength-d)),(n=a-u-1)>0)){var p=new Uint8Array(h.data.byteLength+n);p.set(h.data,0),p.set(e.subarray(0,n),h.data.byteLength),h.data=p}}a<s?(i=31&e[a],f=a,o=i,u=0):u=-1}else u=0;else u=3;else u=t?0:2;else u=t?0:1;if(f>=0&&u>=0&&(r={data:e.subarray(f,s),type:o,state:u},c.push(r)),0===c.length){var m=this._getLastNalUnit();if(m){var g=new Uint8Array(m.data.byteLength+e.byteLength);g.set(m.data,0),g.set(e,m.data.byteLength),m.data=g}}return l.naluState=u,c}},{key:"discardEPB",value:function(e){for(var t,n,r=e.byteLength,i=[],o=1;o<r-2;)0===e[o]&&0===e[o+1]&&3===e[o+2]?(i.push(o+2),o+=2):o++;if(0===i.length)return e;t=r-i.length,n=new Uint8Array(t);var a=0;for(o=0;o<t;a++,o++)a===i[0]&&(a++,i.shift()),n[o]=e[a];return n}},{key:"_parseAACPES",value:function(e){var t,n,r,i,o,a=this._audioTrack,l=e.data,u=e.pts,d=this.aacOverFlow,f=this.aacLastPTS;if(d){var h=new Uint8Array(d.byteLength+l.byteLength);h.set(d,0),h.set(l,d.byteLength),l=h}for(r=0,o=l.length;r<o-1&&!s.default.isHeader(l,r);r++);if(r){var p,m;if(r<o-1?(p="AAC PES did not start with ADTS header,offset:"+r,m=!1):(p="no ADTS header found in AAC PES",m=!0),g.logger.warn("parsing error:"+p),this.observer.trigger(c.default.ERROR,{type:y.ErrorTypes.MEDIA_ERROR,details:y.ErrorDetails.FRAG_PARSING_ERROR,fatal:m,reason:p}),m)return}if(s.default.initTrackConfig(a,this.observer,l,r,this.audioCodec),n=0,t=s.default.getFrameDuration(a.samplerate),d&&f){var v=f+t;Math.abs(v-u)>1&&(g.logger.log("AAC: align PTS for overlapping frames by "+Math.round((v-u)/90)),u=v)}for(;r<o;)if(s.default.isHeader(l,r)&&r+5<o){var _=s.default.appendFrame(a,l,r,u,n);if(!_)break;r+=_.length,i=_.sample.pts,n++}else r++;d=r<o?l.subarray(r,o):null,this.aacOverFlow=d,this.aacLastPTS=i}},{key:"_parseMPEGPES",value:function(e){for(var t=e.data,n=t.length,r=0,i=0,o=e.pts;i<n;)if(u.default.isHeader(t,i)){var a=u.default.appendFrame(this._audioTrack,t,i,o,r);if(!a)break;i+=a.length,r++}else i++}},{key:"_parseID3PES",value:function(e){this._id3Track.samples.push(e)}}],[{key:"probe",value:function(e){return e.length>=564&&71===e[0]&&71===e[188]&&71===e[376]}}]),e}();t.default=v},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(){r(this,e)}return i(e,null,[{key:"getSilentFrame",value:function(e,t){switch(e){case"mp4a.40.2":if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null}}]),e}();t.default=o},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(16),s=r(a),l=n(1),u=r(l),d=n(2),c=n(45),f=r(c),h=n(43),p=r(h),m=n(44),g=r(m),y=n(27),v=r(y),_=n(26),b=r(_),E=n(25),T=r(E),S=n(0),x=n(5),w=r(x),I=n(18),D=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e);var r=e.DefaultConfig;if((n.liveSyncDurationCount||n.liveMaxLatencyDurationCount)&&(n.liveSyncDuration||n.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");for(var o in r)o in n||(n[o]=r[o]);if(void 0!==n.liveMaxLatencyDurationCount&&n.liveMaxLatencyDurationCount<=n.liveSyncDurationCount)throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be gt "liveSyncDurationCount"');if(void 0!==n.liveMaxLatencyDuration&&(n.liveMaxLatencyDuration<=n.liveSyncDuration||void 0===n.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be gt "liveSyncDuration"');(0,S.enableLogs)(n.debug),this.config=n,this._autoLevelCapping=-1;var a=this.observer=new w.default;a.trigger=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];a.emit.apply(a,[e,e].concat(n))},a.off=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];a.removeListener.apply(a,[e].concat(n))},this.on=a.on.bind(a),this.off=a.off.bind(a),this.trigger=a.trigger.bind(a);var s=this.abrController=new n.abrController(this),l=new n.bufferController(this),u=new n.capLevelController(this),d=new n.fpsController(this),c=new f.default(this),h=new p.default(this),m=new g.default(this),y=new T.default(this),_=this.levelController=new b.default(this),E=this.streamController=new v.default(this),x=[_,E],I=n.audioStreamController;I&&x.push(new I(this)),this.networkControllers=x;var D=[c,h,m,s,l,u,d,y];if(I=n.audioTrackController){var R=new I(this);this.audioTrackController=R,D.push(R)}if(I=n.subtitleTrackController){var A=new I(this);this.subtitleTrackController=A,D.push(A)}[n.subtitleStreamController,n.timelineController].forEach(function(e){e&&D.push(new e(t))}),this.coreComponents=D}return o(e,null,[{key:"isSupported",value:function(){var e=window.MediaSource=window.MediaSource||window.WebKitMediaSource,t=window.SourceBuffer=window.SourceBuffer||window.WebKitSourceBuffer,n=e&&"function"==typeof e.isTypeSupported&&e.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),r=!t||t.prototype&&"function"==typeof t.prototype.appendBuffer&&"function"==typeof t.prototype.remove;return n&&r}},{key:"version",get:function(){return"__VERSION__"}},{key:"Events",get:function(){return u.default}},{key:"ErrorTypes",get:function(){return d.ErrorTypes}},{key:"ErrorDetails",get:function(){return d.ErrorDetails}},{key:"DefaultConfig",get:function(){return e.defaultConfig?e.defaultConfig:I.hlsDefaultConfig},set:function(t){e.defaultConfig=t}}]),o(e,[{key:"destroy",value:function(){S.logger.log("destroy"),this.trigger(u.default.DESTROYING),this.detachMedia(),this.coreComponents.concat(this.networkControllers).forEach(function(e){e.destroy()}),this.url=null,this.observer.removeAllListeners(),this._autoLevelCapping=-1}},{key:"attachMedia",value:function(e){S.logger.log("attachMedia"),this.media=e,this.trigger(u.default.MEDIA_ATTACHING,{media:e})}},{key:"detachMedia",value:function(){S.logger.log("detachMedia"),this.trigger(u.default.MEDIA_DETACHING),this.media=null}},{key:"loadSource",value:function(e){e=s.default.buildAbsoluteURL(window.location.href,e,{alwaysNormalize:!0}),S.logger.log("loadSource:"+e),this.url=e,this.trigger(u.default.MANIFEST_LOADING,{url:e})}},{key:"startLoad",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;S.logger.log("startLoad("+e+")"),this.networkControllers.forEach(function(t){t.startLoad(e)})}},{key:"stopLoad",value:function(){S.logger.log("stopLoad"),this.networkControllers.forEach(function(e){e.stopLoad()})}},{key:"swapAudioCodec",value:function(){S.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}},{key:"recoverMediaError",value:function(){S.logger.log("recoverMediaError");var e=this.media;this.detachMedia(),this.attachMedia(e)}},{key:"levels",get:function(){return this.levelController.levels}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(e){S.logger.log("set currentLevel:"+e),this.loadLevel=e,this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(e){S.logger.log("set nextLevel:"+e),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(e){S.logger.log("set loadLevel:"+e),this.levelController.manualLevel=e}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(e){this.levelController.nextLoadLevel=e}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(e){S.logger.log("set firstLevel:"+e),this.levelController.firstLevel=e}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(e){S.logger.log("set startLevel:"+e);var t=this;-1!==e&&(e=Math.max(e,t.minAutoLevel)),t.levelController.startLevel=e}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(e){S.logger.log("set autoLevelCapping:"+e),this._autoLevelCapping=e}},{key:"autoLevelEnabled",get:function(){return-1===this.levelController.manualLevel}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){for(var e=this,t=e.levels,n=e.config.minAutoBitrate,r=t?t.length:0,i=0;i<r;i++)if((t[i].realBitrate?Math.max(t[i].realBitrate,t[i].bitrate):t[i].bitrate)>n)return i;return 0}},{key:"maxAutoLevel",get:function(){var e=this,t=e.levels,n=e.autoLevelCapping;return-1===n&&t&&t.length?t.length-1:n}},{key:"nextAutoLevel",get:function(){var e=this;return Math.min(Math.max(e.abrController.nextAutoLevel,e.minAutoLevel),e.maxAutoLevel)},set:function(e){var t=this;t.abrController.nextAutoLevel=Math.max(t.minAutoLevel,e)}},{key:"audioTracks",get:function(){var e=this.audioTrackController;return e?e.audioTracks:[]}},{key:"audioTrack",get:function(){var e=this.audioTrackController;return e?e.audioTrack:-1},set:function(e){var t=this.audioTrackController;t&&(t.audioTrack=e)}},{key:"liveSyncPosition",get:function(){return this.streamController.liveSyncPosition}},{key:"subtitleTracks",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTrack:-1},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}}]),e}();t.default=D},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":l(t))&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":l(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l="function"==typeof Symbol&&"symbol"==r(Symbol.iterator)?function(e){return void 0===e?"undefined":r(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":r(e)};Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),d=n(1),c=i(d),f=n(3),h=i(f),p=n(2),m=n(0),g=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,c.default.FRAG_LOADING));return n.loaders={},n}return s(t,e),u(t,[{key:"destroy",value:function(){var e=this.loaders;for(var t in e){var n=e[t];n&&n.destroy()}this.loaders={},h.default.prototype.destroy.call(this)}},{key:"onFragLoading",value:function(e){var t=e.frag,n=t.type,r=this.loaders[n],i=this.hls.config;t.loaded=0,r&&(m.logger.warn("abort previous fragment loader for type:"+n),r.abort()),r=this.loaders[n]=t.loader=void 0!==i.fLoader?new i.fLoader(i):new i.loader(i);var o=void 0,a=void 0,s=void 0;o={url:t.url,frag:t,responseType:"arraybuffer",progressData:!1};var l=t.byteRangeStartOffset,u=t.byteRangeEndOffset;isNaN(l)||isNaN(u)||(o.rangeStart=l,o.rangeEnd=u),a={timeout:i.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:i.fragLoadingMaxRetryTimeout},s={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this),onProgress:this.loadprogress.bind(this)},r.load(o,a,s)}},{key:"loadsuccess",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=e.data,o=n.frag;o.loader=void 0,this.loaders[o.type]=void 0,this.hls.trigger(c.default.FRAG_LOADED,{payload:i,frag:o,stats:t,networkDetails:r})}},{key:"loaderror",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=t.loader;r&&r.abort(),this.loaders[t.type]=void 0,this.hls.trigger(c.default.ERROR,{type:p.ErrorTypes.NETWORK_ERROR,details:p.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:t.frag,response:e,networkDetails:n})}},{key:"loadtimeout",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=t.loader;r&&r.abort(),this.loaders[t.type]=void 0,this.hls.trigger(c.default.ERROR,{type:p.ErrorTypes.NETWORK_ERROR,details:p.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t.frag,networkDetails:n})}},{key:"loadprogress",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=t.frag;i.loaded=e.loaded,this.hls.trigger(c.default.FRAG_LOAD_PROGRESS,{frag:i,stats:e,networkDetails:r})}}]),t}(h.default);t.default=g},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":l(t))&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":l(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l="function"==typeof Symbol&&"symbol"==r(Symbol.iterator)?function(e){return void 0===e?"undefined":r(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":r(e)};Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),d=n(1),c=i(d),f=n(3),h=i(f),p=n(2),m=n(0),g=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,c.default.KEY_LOADING));return n.loaders={},n.decryptkey=null,n.decrypturl=null,n}return s(t,e),u(t,[{key:"destroy",value:function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy()}this.loaders={},h.default.prototype.destroy.call(this)}},{key:"onKeyLoading",value:function(e){var t=e.frag,n=t.type,r=this.loaders[n],i=t.decryptdata,o=i.uri;if(o!==this.decrypturl||null===this.decryptkey){var a=this.hls.config;r&&(m.logger.warn("abort previous key loader for type:"+n),r.abort()),t.loader=this.loaders[n]=new a.loader(a),this.decrypturl=o,this.decryptkey=null;var s=void 0,l=void 0,u=void 0;s={url:o,frag:t,responseType:"arraybuffer"},l={timeout:a.fragLoadingTimeOut,maxRetry:a.fragLoadingMaxRetry,retryDelay:a.fragLoadingRetryDelay,maxRetryDelay:a.fragLoadingMaxRetryTimeout},u={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)},t.loader.load(s,l,u)}else this.decryptkey&&(i.key=this.decryptkey,this.hls.trigger(c.default.KEY_LOADED,{frag:t}))}},{key:"loadsuccess",value:function(e,t,n){var r=n.frag;this.decryptkey=r.decryptdata.key=new Uint8Array(e.data),r.loader=void 0,this.loaders[r.type]=void 0,this.hls.trigger(c.default.KEY_LOADED,{frag:r})}},{key:"loaderror",value:function(e,t){var n=t.frag,r=n.loader;r&&r.abort(),this.loaders[t.type]=void 0,this.hls.trigger(c.default.ERROR,{type:p.ErrorTypes.NETWORK_ERROR,details:p.ErrorDetails.KEY_LOAD_ERROR,fatal:!1,frag:n,response:e})}},{key:"loadtimeout",value:function(e,t){var n=t.frag,r=n.loader;r&&r.abort(),this.loaders[t.type]=void 0,this.hls.trigger(c.default.ERROR,{type:p.ErrorTypes.NETWORK_ERROR,details:p.ErrorDetails.KEY_LOAD_TIMEOUT,fatal:!1,frag:n})}}]),t}(h.default);t.default=g},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":l(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":l(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var l="function"==typeof Symbol&&"symbol"==r(Symbol.iterator)?function(e){return void 0===e?"undefined":r(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":r(e)};Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),d=n(16),c=i(d),f=n(1),h=i(f),p=n(3),m=i(p),g=n(2),y=n(49),v=i(y),_=n(0),b=/#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)/g,E=/#EXT-X-MEDIA:(.*)/g,T=new RegExp([/#EXTINF:(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/|(?!#)(\S+)/.source,/|#EXT-X-BYTERANGE:*(.+)/.source,/|#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/|#.*/.source].join(""),"g"),S=/(?:(?:#(EXTM3U))|(?:#EXT-X-(PLAYLIST-TYPE):(.+))|(?:#EXT-X-(MEDIA-SEQUENCE): *(\d+))|(?:#EXT-X-(TARGETDURATION): *(\d+))|(?:#EXT-X-(KEY):(.+))|(?:#EXT-X-(START):(.+))|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DISCONTINUITY-SEQ)UENCE:(\d+))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(VERSION):(\d+))|(?:#EXT-X-(MAP):(.+))|(?:(#)(.*):(.*))|(?:(#)(.*))(?:.*)\r?\n?/,x=function(){function e(){s(this,e),this.method=null,this.key=null,this.iv=null,this._uri=null}return u(e,[{key:"uri",get:function(){return!this._uri&&this.reluri&&(this._uri=c.default.buildAbsoluteURL(this.baseuri,this.reluri,{alwaysNormalize:!0})),this._uri}}]),e}(),w=function(){function e(){s(this,e),this._url=null,this._byteRange=null,this._decryptdata=null,this.tagList=[]}return u(e,[{key:"createInitializationVector",value:function(e){for(var t=new Uint8Array(16),n=12;n<16;n++)t[n]=e>>8*(15-n)&255;return t}},{key:"fragmentDecryptdataFromLevelkey",value:function(e,t){var n=e;return e&&e.method&&e.uri&&!e.iv&&(n=new x,n.method=e.method,n.baseuri=e.baseuri,n.reluri=e.reluri,n.iv=this.createInitializationVector(t)),n}},{key:"cloneObj",value:function(e){return JSON.parse(JSON.stringify(e))}},{key:"url",get:function(){return!this._url&&this.relurl&&(this._url=c.default.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url},set:function(e){this._url=e}},{key:"programDateTime",get:function(){return!this._programDateTime&&this.rawProgramDateTime&&(this._programDateTime=new Date(Date.parse(this.rawProgramDateTime))),this._programDateTime}},{key:"byteRange",get:function(){if(!this._byteRange){var e=this._byteRange=[];if(this.rawByteRange){var t=this.rawByteRange.split("@",2);if(1===t.length){var n=this.lastByteRangeEndOffset;e[0]=n||0}else e[0]=parseInt(t[1]);e[1]=parseInt(t[0])+e[0]}}return this._byteRange}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"decryptdata",get:function(){return this._decryptdata||(this._decryptdata=this.fragmentDecryptdataFromLevelkey(this.levelkey,this.sn)),this._decryptdata}}]),e}(),I=function(e){function t(e){s(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,h.default.MANIFEST_LOADING,h.default.LEVEL_LOADING,h.default.AUDIO_TRACK_LOADING,h.default.SUBTITLE_TRACK_LOADING));return n.loaders={},n}return a(t,e),u(t,[{key:"destroy",value:function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy()}this.loaders={},m.default.prototype.destroy.call(this)}},{key:"onManifestLoading",value:function(e){this.load(e.url,{type:"manifest"})}},{key:"onLevelLoading",value:function(e){this.load(e.url,{type:"level",level:e.level,id:e.id})}},{key:"onAudioTrackLoading",value:function(e){this.load(e.url,{type:"audioTrack",id:e.id})}},{key:"onSubtitleTrackLoading",value:function(e){this.load(e.url,{type:"subtitleTrack",id:e.id})}},{key:"load",value:function(e,t){var n=this.loaders[t.type];if(n){var r=n.context;if(r&&r.url===e)return void _.logger.trace("playlist request ongoing");_.logger.warn("abort previous loader for type:"+t.type),n.abort()}var i=this.hls.config,o=void 0,a=void 0,s=void 0,l=void 0;"manifest"===t.type?(o=i.manifestLoadingMaxRetry,a=i.manifestLoadingTimeOut,s=i.manifestLoadingRetryDelay,l=i.manifestLoadingMaxRetryTimeout):(o=i.levelLoadingMaxRetry,a=i.levelLoadingTimeOut,s=i.levelLoadingRetryDelay,l=i.levelLoadingMaxRetryTimeout,_.logger.log("loading playlist for "+t.type+" "+(t.level||t.id))),n=this.loaders[t.type]=t.loader=void 0!==i.pLoader?new i.pLoader(i):new i.loader(i),t.url=e,t.responseType="";var u=void 0,d=void 0;u={timeout:a,maxRetry:o,retryDelay:s,maxRetryDelay:l},d={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)},n.load(t,u,d)}},{key:"resolve",value:function(e,t){return c.default.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}},{key:"parseMasterPlaylist",value:function(e,t){var n=[],r=void 0;for(b.lastIndex=0;null!=(r=b.exec(e));){var i={},o=i.attrs=new v.default(r[1]);i.url=this.resolve(r[2],t);var a=o.decimalResolution("RESOLUTION");a&&(i.width=a.width,i.height=a.height),i.bitrate=o.decimalInteger("AVERAGE-BANDWIDTH")||o.decimalInteger("BANDWIDTH"),i.name=o.NAME;var s=o.CODECS;if(s){s=s.split(/[ ,]+/);for(var l=0;l<s.length;l++){var u=s[l];-1!==u.indexOf("avc1")?i.videoCodec=this.avc1toavcoti(u):-1!==u.indexOf("hvc1")?i.videoCodec=u:i.audioCodec=u}}n.push(i)}return n}},{key:"parseMasterPlaylistMedia",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=void 0,o=[],a=0;for(E.lastIndex=0;null!=(i=E.exec(e));){var s={},l=new v.default(i[1]);l.TYPE===n&&(s.groupId=l["GROUP-ID"],s.name=l.NAME,s.type=n,s.default="YES"===l.DEFAULT,s.autoselect="YES"===l.AUTOSELECT,s.forced="YES"===l.FORCED,l.URI&&(s.url=this.resolve(l.URI,t)),s.lang=l.LANGUAGE,s.name||(s.name=s.lang),r&&(s.audioCodec=r),s.id=a++,o.push(s))}return o}},{key:"avc1toavcoti",value:function(e){var t,n=e.split(".");return n.length>2?(t=n.shift()+".",t+=parseInt(n.shift()).toString(16),t+=("000"+parseInt(n.shift()).toString(16)).substr(-4)):t=e,t}},{key:"parseLevelPlaylist",value:function(e,t,n,r){var i,o,a=0,s=0,l={type:null,version:null,url:t,fragments:[],live:!0,startSN:0},u=new x,d=0,c=null,f=new w;for(T.lastIndex=0;null!==(i=T.exec(e));){var h=i[1];if(h){f.duration=parseFloat(h);var p=(" "+i[2]).slice(1);f.title=p||null,f.tagList.push(p?["INF",h,p]:["INF",h])}else if(i[3]){if(!isNaN(f.duration)){var m=a++;f.type=r,f.start=s,f.levelkey=u,f.sn=m,f.level=n,f.cc=d,f.baseurl=t,f.relurl=(" "+i[3]).slice(1),l.fragments.push(f),c=f,s+=f.duration,f=new w}}else if(i[4]){if(f.rawByteRange=(" "+i[4]).slice(1),c){var g=c.byteRangeEndOffset;g&&(f.lastByteRangeEndOffset=g)}}else if(i[5])f.rawProgramDateTime=(" "+i[5]).slice(1),f.tagList.push(["PROGRAM-DATE-TIME",f.rawProgramDateTime]);else{for(i=i[0].match(S),o=1;o<i.length&&void 0===i[o];o++);var y=(" "+i[o+1]).slice(1),b=(" "+i[o+2]).slice(1);switch(i[o]){case"#":f.tagList.push(b?[y,b]:[y]);break;case"PLAYLIST-TYPE":l.type=y.toUpperCase();break;case"MEDIA-SEQUENCE":a=l.startSN=parseInt(y);break;case"TARGETDURATION":l.targetduration=parseFloat(y);break;case"VERSION":l.version=parseInt(y);break;case"EXTM3U":break;case"ENDLIST":l.live=!1;break;case"DIS":d++,f.tagList.push(["DIS"]);break;case"DISCONTINUITY-SEQ":d=parseInt(y);break;case"KEY":var E=y,I=new v.default(E),D=I.enumeratedString("METHOD"),R=I.URI,A=I.hexadecimalInteger("IV");D&&(u=new x,R&&["AES-128","SAMPLE-AES"].indexOf(D)>=0&&(u.method=D,u.baseuri=t,u.reluri=R,u.key=null,u.iv=A));break;case"START":var P=y,M=new v.default(P),L=M.decimalFloatingPoint("TIME-OFFSET");isNaN(L)||(l.startTimeOffset=L);break;case"MAP":var C=new v.default(y);f.relurl=C.URI,f.rawByteRange=C.BYTERANGE,f.baseurl=t,f.level=n,f.type=r,f.sn="initSegment",l.initSegment=f,f=new w;break;default:_.logger.warn("line parsed but not handled: "+i)}}}return f=c,f&&!f.relurl&&(l.fragments.pop(),s-=f.duration),l.totalduration=s,l.averagetargetduration=s/l.fragments.length,l.endSN=a-1,l}},{key:"loadsuccess",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=e.data,o=e.url,a=n.type,s=n.id,l=n.level,u=this.hls;if(this.loaders[a]=void 0,void 0!==o&&0!==o.indexOf("data:")||(o=n.url),t.tload=performance.now(),0===i.indexOf("#EXTM3U"))if(i.indexOf("#EXTINF:")>0){var d="audioTrack"!==a&&"subtitleTrack"!==a,c=isNaN(l)?isNaN(s)?0:s:l,f=this.parseLevelPlaylist(i,o,c,"audioTrack"===a?"audio":"subtitleTrack"===a?"subtitle":"main");f.tload=t.tload,"manifest"===a&&u.trigger(h.default.MANIFEST_LOADED,{levels:[{url:o,details:f}],audioTracks:[],url:o,stats:t,networkDetails:r}),t.tparsed=performance.now(),f.targetduration?d?u.trigger(h.default.LEVEL_LOADED,{details:f,level:l||0,id:s||0,stats:t,networkDetails:r}):"audioTrack"===a?u.trigger(h.default.AUDIO_TRACK_LOADED,{details:f,id:s,stats:t,networkDetails:r}):"subtitleTrack"===a&&u.trigger(h.default.SUBTITLE_TRACK_LOADED,{details:f,id:s,stats:t,networkDetails:r}):u.trigger(h.default.ERROR,{type:g.ErrorTypes.NETWORK_ERROR,details:g.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:o,reason:"invalid targetduration",networkDetails:r})}else{var p=this.parseMasterPlaylist(i,o);if(p.length){var m=this.parseMasterPlaylistMedia(i,o,"AUDIO",p[0].audioCodec),y=this.parseMasterPlaylistMedia(i,o,"SUBTITLES");if(m.length){var v=!1;m.forEach(function(e){e.url||(v=!0)}),!1===v&&p[0].audioCodec&&!p[0].attrs.AUDIO&&(_.logger.log("audio codec signaled in quality level, but no embedded audio track signaled, create one"),m.unshift({type:"main",name:"main"}))}u.trigger(h.default.MANIFEST_LOADED,{levels:p,audioTracks:m,subtitles:y,url:o,stats:t,networkDetails:r})}else u.trigger(h.default.ERROR,{type:g.ErrorTypes.NETWORK_ERROR,details:g.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:o,reason:"no level found in manifest",networkDetails:r})}else u.trigger(h.default.ERROR,{type:g.ErrorTypes.NETWORK_ERROR,details:g.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:o,reason:"no EXTM3U delimiter",networkDetails:r})}},{key:"loaderror",value:function(e,t){var n,r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=t.loader;switch(t.type){case"manifest":n=g.ErrorDetails.MANIFEST_LOAD_ERROR,r=!0;break;case"level":n=g.ErrorDetails.LEVEL_LOAD_ERROR,r=!1;break;case"audioTrack":n=g.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,r=!1}o&&(o.abort(),this.loaders[t.type]=void 0),this.hls.trigger(h.default.ERROR,{type:g.ErrorTypes.NETWORK_ERROR,details:n,fatal:r,url:o.url,loader:o,response:e,context:t,networkDetails:i})}},{key:"loadtimeout",value:function(e,t){var n,r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=t.loader;switch(t.type){case"manifest":n=g.ErrorDetails.MANIFEST_LOAD_TIMEOUT,r=!0;break;case"level":n=g.ErrorDetails.LEVEL_LOAD_TIMEOUT,r=!1;break;case"audioTrack":n=g.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT,r=!1}o&&(o.abort(),this.loaders[t.type]=void 0),this.hls.trigger(h.default.ERROR,{type:g.ErrorTypes.NETWORK_ERROR,details:n,fatal:r,url:o.url,loader:o,context:t,networkDetails:i})}}]),t}(m.default);t.default=I},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=Math.pow(2,32)-1,a=function(){function e(){r(this,e)}return i(e,null,[{key:"init",value:function(){e.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};var t;for(t in e.types)e.types.hasOwnProperty(t)&&(e.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);var n=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),r=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);e.HDLR_TYPES={video:n,audio:r};var i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),o=new Uint8Array([0,0,0,0,0,0,0,0]);e.STTS=e.STSC=e.STCO=o,e.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),e.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),e.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),e.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var a=new Uint8Array([105,115,111,109]),s=new Uint8Array([97,118,99,49]),l=new Uint8Array([0,0,0,1]);e.FTYP=e.box(e.types.ftyp,a,l,a,s),e.DINF=e.box(e.types.dinf,e.box(e.types.dref,i))}},{key:"box",value:function(e){for(var t,n=Array.prototype.slice.call(arguments,1),r=8,i=n.length,o=i;i--;)r+=n[i].byteLength;for(t=new Uint8Array(r),t[0]=r>>24&255,t[1]=r>>16&255,t[2]=r>>8&255,t[3]=255&r,t.set(e,4),i=0,r=8;i<o;i++)t.set(n[i],r),r+=n[i].byteLength;return t}},{key:"hdlr",value:function(t){return e.box(e.types.hdlr,e.HDLR_TYPES[t])}},{key:"mdat",value:function(t){return e.box(e.types.mdat,t)}},{key:"mdhd",value:function(t,n){n*=t;var r=Math.floor(n/(o+1)),i=Math.floor(n%(o+1));return e.box(e.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,r>>24,r>>16&255,r>>8&255,255&r,i>>24,i>>16&255,i>>8&255,255&i,85,196,0,0]))}},{key:"mdia",value:function(t){return e.box(e.types.mdia,e.mdhd(t.timescale,t.duration),e.hdlr(t.type),e.minf(t))}},{key:"mfhd",value:function(t){return e.box(e.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))}},{key:"minf",value:function(t){return"audio"===t.type?e.box(e.types.minf,e.box(e.types.smhd,e.SMHD),e.DINF,e.stbl(t)):e.box(e.types.minf,e.box(e.types.vmhd,e.VMHD),e.DINF,e.stbl(t))}},{key:"moof",value:function(t,n,r){return e.box(e.types.moof,e.mfhd(t),e.traf(r,n))}},{key:"moov",value:function(t){for(var n=t.length,r=[];n--;)r[n]=e.trak(t[n]);return e.box.apply(null,[e.types.moov,e.mvhd(t[0].timescale,t[0].duration)].concat(r).concat(e.mvex(t)))}},{key:"mvex",value:function(t){for(var n=t.length,r=[];n--;)r[n]=e.trex(t[n]);return e.box.apply(null,[e.types.mvex].concat(r))}},{key:"mvhd",value:function(t,n){n*=t;var r=Math.floor(n/(o+1)),i=Math.floor(n%(o+1)),a=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,r>>24,r>>16&255,r>>8&255,255&r,i>>24,i>>16&255,i>>8&255,255&i,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return e.box(e.types.mvhd,a)}},{key:"sdtp",value:function(t){var n,r,i=t.samples||[],o=new Uint8Array(4+i.length);for(r=0;r<i.length;r++)n=i[r].flags,o[r+4]=n.dependsOn<<4|n.isDependedOn<<2|n.hasRedundancy;return e.box(e.types.sdtp,o)}},{key:"stbl",value:function(t){return e.box(e.types.stbl,e.stsd(t),e.box(e.types.stts,e.STTS),e.box(e.types.stsc,e.STSC),e.box(e.types.stsz,e.STSZ),e.box(e.types.stco,e.STCO))}},{key:"avc1",value:function(t){var n,r,i,o=[],a=[];for(n=0;n<t.sps.length;n++)r=t.sps[n],i=r.byteLength,o.push(i>>>8&255),o.push(255&i),o=o.concat(Array.prototype.slice.call(r));for(n=0;n<t.pps.length;n++)r=t.pps[n],i=r.byteLength,a.push(i>>>8&255),a.push(255&i),a=a.concat(Array.prototype.slice.call(r));var s=e.box(e.types.avcC,new Uint8Array([1,o[3],o[4],o[5],255,224|t.sps.length].concat(o).concat([t.pps.length]).concat(a))),l=t.width,u=t.height,d=t.pixelRatio[0],c=t.pixelRatio[1];return e.box(e.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,255&l,u>>8&255,255&u,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),s,e.box(e.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),e.box(e.types.pasp,new Uint8Array([d>>24,d>>16&255,d>>8&255,255&d,c>>24,c>>16&255,c>>8&255,255&c])))}},{key:"esds",value:function(e){var t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))}},{key:"mp4a",value:function(t){var n=t.samplerate;return e.box(e.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,n>>8&255,255&n,0,0]),e.box(e.types.esds,e.esds(t)))}},{key:"mp3",value:function(t){var n=t.samplerate;return e.box(e.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,n>>8&255,255&n,0,0]))}},{key:"stsd",value:function(t){return"audio"===t.type?t.isAAC||"mp3"!==t.codec?e.box(e.types.stsd,e.STSD,e.mp4a(t)):e.box(e.types.stsd,e.STSD,e.mp3(t)):e.box(e.types.stsd,e.STSD,e.avc1(t))}},{key:"tkhd",value:function(t){var n=t.id,r=t.duration*t.timescale,i=t.width,a=t.height,s=Math.floor(r/(o+1)),l=Math.floor(r%(o+1));return e.box(e.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,n>>24&255,n>>16&255,n>>8&255,255&n,0,0,0,0,s>>24,s>>16&255,s>>8&255,255&s,l>>24,l>>16&255,l>>8&255,255&l,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,i>>8&255,255&i,0,0,a>>8&255,255&a,0,0]))}},{key:"traf",value:function(t,n){var r=e.sdtp(t),i=t.id,a=Math.floor(n/(o+1)),s=Math.floor(n%(o+1));return e.box(e.types.traf,e.box(e.types.tfhd,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,255&i])),e.box(e.types.tfdt,new Uint8Array([1,0,0,0,a>>24,a>>16&255,a>>8&255,255&a,s>>24,s>>16&255,s>>8&255,255&s])),e.trun(t,r.length+16+20+8+16+8+8),r)}},{key:"trak",value:function(t){return t.duration=t.duration||4294967295,e.box(e.types.trak,e.tkhd(t),e.mdia(t))}},{key:"trex",value:function(t){var n=t.id;return e.box(e.types.trex,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,255&n,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}},{key:"trun",value:function(t,n){var r,i,o,a,s,l,u=t.samples||[],d=u.length,c=12+16*d,f=new Uint8Array(c);for(n+=8+c,f.set([0,0,15,1,d>>>24&255,d>>>16&255,d>>>8&255,255&d,n>>>24&255,n>>>16&255,n>>>8&255,255&n],0),r=0;r<d;r++)i=u[r],o=i.duration,a=i.size,s=i.flags,l=i.cts,f.set([o>>>24&255,o>>>16&255,o>>>8&255,255&o,a>>>24&255,a>>>16&255,a>>>8&255,255&a,s.isLeading<<2|s.dependsOn,s.isDependedOn<<6|s.hasRedundancy<<4|s.paddingValue<<1|s.isNonSync,61440&s.degradPrio,15&s.degradPrio,l>>>24&255,l>>>16&255,l>>>8&255,255&l],12+16*r);return e.box(e.types.trun,f)}},{key:"initSegment",value:function(t){e.types||e.init();var n,r=e.moov(t);return n=new Uint8Array(e.FTYP.byteLength+r.byteLength),n.set(e.FTYP),n.set(r,e.FTYP.byteLength),n}}]),e}();t.default=a},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(41),s=r(a),l=n(1),u=r(l),d=n(0),c=n(46),f=r(c),h=n(2),p=function(){function e(t,n,r,o){i(this,e),this.observer=t,this.config=n,this.typeSupported=r;var a=navigator.userAgent;this.isSafari=o&&o.indexOf("Apple")>-1&&a&&!a.match("CriOS"),this.ISGenerated=!1}return o(e,[{key:"destroy",value:function(){}},{key:"resetTimeStamp",value:function(e){this._initPTS=this._initDTS=e}},{key:"resetInitSegment",value:function(){this.ISGenerated=!1}},{key:"remux",value:function(e,t,n,r,i,o,a){if(this.ISGenerated){if(a){var s=this._initPTS,l=this._PTSNormalize,c=e.inputTimeScale||t.inputTimeScale,f=1/0,h=1/0,p=e.samples;if(p.length&&(f=h=l(p[0].pts-c*i,s)),p=t.samples,p.length){var m=p[0];f=Math.min(f,l(m.pts-c*i,s)),h=Math.min(h,l(m.dts-c*i,s))}if(f!==1/0){var g=s-f;Math.abs(g)>10*c&&(d.logger.warn("timestamp inconsistency, "+(g/c).toFixed(3)+"s delta against expected value: missing discontinuity ? reset initPTS/initDTS"),this._initPTS=f,this._initDTS=h,this.observer.trigger(u.default.INIT_PTS_FOUND,{initPTS:f}))}}}else this.generateIS(e,t,i);if(this.ISGenerated)if(e.samples.length){e.timescale||(d.logger.warn("regenerate InitSegment as audio detected"),this.generateIS(e,t,i));var y=this.remuxAudio(e,i,o,a);if(t.samples.length){var v=void 0;y&&(v=y.endPTS-y.startPTS),t.timescale||(d.logger.warn("regenerate InitSegment as video detected"),this.generateIS(e,t,i)),this.remuxVideo(t,i,o,v,a)}}else{var _=void 0;t.samples.length&&(_=this.remuxVideo(t,i,o,a)),_&&e.codec&&this.remuxEmptyAudio(e,i,o,_)}n.samples.length&&this.remuxID3(n,i),r.samples.length&&this.remuxText(r,i),this.observer.trigger(u.default.FRAG_PARSED)}},{key:"generateIS",value:function(e,t,n){var r,i,o=this.observer,a=e.samples,s=t.samples,l=this.typeSupported,c="audio/mp4",p={},m={tracks:p},g=void 0===this._initPTS;if(g&&(r=i=1/0),e.config&&a.length&&(e.timescale=e.samplerate,d.logger.log("audio sampling rate : "+e.samplerate),e.isAAC||(l.mpeg?(c="audio/mpeg",e.codec=""):l.mp3&&(e.codec="mp3")),p.audio={container:c,codec:e.codec,initSegment:!e.isAAC&&l.mpeg?new Uint8Array:f.default.initSegment([e]),metadata:{channelCount:e.channelCount}},g&&(r=i=a[0].pts-e.inputTimeScale*n)),t.sps&&t.pps&&s.length){var y=t.inputTimeScale;t.timescale=y,p.video={container:"video/mp4",codec:t.codec,initSegment:f.default.initSegment([t]),metadata:{width:t.width,height:t.height}},g&&(r=Math.min(r,s[0].pts-y*n),i=Math.min(i,s[0].dts-y*n),this.observer.trigger(u.default.INIT_PTS_FOUND,{initPTS:r}))}Object.keys(p).length?(o.trigger(u.default.FRAG_PARSING_INIT_SEGMENT,m),this.ISGenerated=!0,g&&(this._initPTS=r,this._initDTS=i)):o.trigger(u.default.ERROR,{type:h.ErrorTypes.MEDIA_ERROR,details:h.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"no audio/video samples found"})}},{key:"remuxVideo",value:function(e,t,n,r,i){var o,a,s,l,c,p,m,g=8,y=e.timescale,v=e.samples,_=[],b=v.length,E=this._PTSNormalize,T=this._initDTS,S=this.nextAvcDts,x=this.isSafari;x&&(n|=v.length&&S&&(i&&Math.abs(t-S/y)<.1||Math.abs(v[0].pts-S-T)<y/5)),n||(S=t*y),v.forEach(function(e){e.pts=E(e.pts-T,S),e.dts=E(e.dts-T,S)}),v.sort(function(e,t){var n=e.dts-t.dts,r=e.pts-t.pts;return n||r||e.id-t.id});var w=v.reduce(function(e,t){return Math.max(Math.min(e,t.pts-t.dts),-18e3)},0);if(w<0){d.logger.warn("PTS < DTS detected in video samples, shifting DTS by "+Math.round(w/90)+" ms to overcome this issue");for(var I=0;I<v.length;I++)v[I].dts+=w}var D=v[0];c=Math.max(D.dts,0),l=Math.max(D.pts,0);var R=Math.round((c-S)/90);n&&R&&(R>1?d.logger.log("AVC:"+R+" ms hole between fragments detected,filling it"):R<-1&&d.logger.log("AVC:"+-R+" ms overlapping between fragments detected"),c=S,v[0].dts=c,l=Math.max(l-R,S),v[0].pts=l,d.logger.log("Video/PTS/DTS adjusted: "+Math.round(l/90)+"/"+Math.round(c/90)+",delta:"+R+" ms")),D=v[v.length-1],m=Math.max(D.dts,0),p=Math.max(D.pts,0,m),x&&(o=Math.round((m-c)/(v.length-1)));for(var A=0,P=0,M=0;M<b;M++){for(var L=v[M],C=L.units,O=C.length,k=0,N=0;N<O;N++)k+=C[N].data.length;P+=k,A+=O,L.length=k,L.dts=x?c+M*o:Math.max(L.dts,c),L.pts=Math.max(L.pts,L.dts)}var F=P+4*A+8;try{a=new Uint8Array(F)}catch(e){return void this.observer.trigger(u.default.ERROR,{type:h.ErrorTypes.MUX_ERROR,details:h.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:F,reason:"fail allocating video mdat "+F})}var B=new DataView(a.buffer);B.setUint32(0,F),a.set(f.default.types.mdat,4);for(var U=0;U<b;U++){for(var j=v[U],H=j.units,q=0,V=void 0,G=0,K=H.length;G<K;G++){var z=H[G],Y=z.data,W=z.data.byteLength;B.setUint32(g,W),g+=4,a.set(Y,g),g+=W,q+=4+W}if(x)V=Math.max(0,o*Math.round((j.pts-j.dts)/o));else{if(U<b-1)o=v[U+1].dts-j.dts;else{var X=this.config,Q=j.dts-v[U>0?U-1:U].dts;if(X.stretchShortVideoTrack){var Z=X.maxBufferHole,J=X.maxSeekHole,$=Math.floor(Math.min(Z,J)*y),ee=(r?l+r*y:this.nextAudioPts)-j.pts;ee>$?(o=ee-Q,o<0&&(o=Q),d.logger.log("It is approximately "+ee/90+" ms to the next segment; using duration "+o/90+" ms for the last video frame.")):o=Q}else o=Q}V=Math.round(j.pts-j.dts)}_.push({size:q,duration:o,cts:V,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:j.key?2:1,isNonSync:j.key?0:1}})}this.nextAvcDts=m+o;var te=e.dropped;if(e.len=0,e.nbNalu=0,e.dropped=0,_.length&&navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var ne=_[0].flags;ne.dependsOn=2,ne.isNonSync=0}e.samples=_,s=f.default.moof(e.sequenceNumber++,c,e),e.samples=[];var re={data1:s,data2:a,startPTS:l/y,endPTS:(p+o)/y,startDTS:c/y,endDTS:this.nextAvcDts/y,type:"video",nb:_.length,dropped:te};return this.observer.trigger(u.default.FRAG_PARSING_DATA,re),re}},{key:"remuxAudio",value:function(e,t,n,r){var i,o,a,l,c,p,m,g=e.inputTimeScale,y=e.timescale,v=g/y,_=e.isAAC?1024:1152,b=_*v,E=this._PTSNormalize,T=this._initDTS,S=!e.isAAC&&this.typeSupported.mpeg,x=e.samples,w=[],I=this.nextAudioPts;if(n|=x.length&&I&&(r&&Math.abs(t-I/g)<.1||Math.abs(x[0].pts-I-T)<20*b),n||(I=t*g),x.forEach(function(e){e.pts=e.dts=E(e.pts-T,I)}),x.sort(function(e,t){return e.pts-t.pts}),r&&e.isAAC)for(var D=0,R=I;D<x.length;){var A,P=x[D],M=P.pts;A=M-R;var L=Math.abs(1e3*A/g);if(A<=-b)d.logger.warn("Dropping 1 audio frame @ "+(R/g).toFixed(3)+"s due to "+L+" ms overlap."),x.splice(D,1),e.len-=P.unit.length;else if(A>=b&&L<1e4&&R){var C=Math.round(A/b);d.logger.warn("Injecting "+C+" audio frame @ "+(R/g).toFixed(3)+"s due to "+Math.round(1e3*A/g)+" ms gap.");for(var O=0;O<C;O++){var k=Math.max(R,0);a=s.default.getSilentFrame(e.manifestCodec||e.codec,e.channelCount),a||(d.logger.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),a=P.unit.subarray()),x.splice(D,0,{unit:a,pts:k,dts:k}),e.len+=a.length,R+=b,D++}P.pts=P.dts=R,R+=b,D++}else Math.abs(A),P.pts=P.dts=R,R+=b,D++}for(var N=0,F=x.length;N<F;N++){var B=x[N],U=B.unit,j=B.pts;if(void 0!==m)o.duration=Math.round((j-m)/v);else{var H=Math.round(1e3*(j-I)/g),q=0;if(n&&e.isAAC&&H){if(H>0&&H<1e4)q=Math.round((j-I)/b),d.logger.log(H+" ms hole between AAC samples detected,filling it"),q>0&&(a=s.default.getSilentFrame(e.manifestCodec||e.codec,e.channelCount),a||(a=U.subarray()),e.len+=q*a.length);else if(H<-12){d.logger.log("drop overlapping AAC sample, expected/parsed/delta:"+(I/g).toFixed(3)+"s/"+(j/g).toFixed(3)+"s/"+-H+"ms"),e.len-=U.byteLength;continue}j=I}if(p=Math.max(0,j),!(e.len>0))return;var V=S?e.len:e.len+8;i=S?0:8;try{l=new Uint8Array(V)}catch(e){return void this.observer.trigger(u.default.ERROR,{type:h.ErrorTypes.MUX_ERROR,details:h.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:V,reason:"fail allocating audio mdat "+V})}S||(new DataView(l.buffer).setUint32(0,V),l.set(f.default.types.mdat,4));for(var G=0;G<q;G++)a=s.default.getSilentFrame(e.manifestCodec||e.codec,e.channelCount),a||(d.logger.log("Unable to get silent frame for given audio codec; duplicating this frame instead."),a=U.subarray()),l.set(a,i),i+=a.byteLength,o={size:a.byteLength,cts:0,duration:1024,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},w.push(o)}l.set(U,i);var K=U.byteLength;i+=K,o={size:K,cts:0,duration:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},w.push(o),m=j}var z=0,Y=w.length;if(Y>=2&&(z=w[Y-2].duration,o.duration=z),Y){this.nextAudioPts=I=m+v*z,e.len=0,e.samples=w,c=S?new Uint8Array:f.default.moof(e.sequenceNumber++,p/v,e),e.samples=[];var W=p/g,X=I/g,Q={data1:c,data2:l,startPTS:W,endPTS:X,startDTS:W,endDTS:X,type:"audio",nb:Y};return this.observer.trigger(u.default.FRAG_PARSING_DATA,Q),Q}return null}},{key:"remuxEmptyAudio",value:function(e,t,n,r){var i=e.inputTimeScale,o=e.samplerate?e.samplerate:i,a=i/o,l=this.nextAudioPts,u=(void 0!==l?l:r.startDTS*i)+this._initDTS,c=r.endDTS*i+this._initDTS,f=1024*a,h=Math.ceil((c-u)/f),p=s.default.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(d.logger.warn("remux empty Audio"),!p)return void d.logger.trace("Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!");for(var m=[],g=0;g<h;g++){var y=u+g*f;m.push({unit:p,pts:y,dts:y}),e.len+=p.length}e.samples=m,this.remuxAudio(e,t,n)}},{key:"remuxID3",value:function(e,t){var n,r=e.samples.length,i=e.inputTimeScale,o=this._initPTS,a=this._initDTS;if(r){for(var s=0;s<r;s++)n=e.samples[s],n.pts=(n.pts-o)/i,n.dts=(n.dts-a)/i;this.observer.trigger(u.default.FRAG_PARSING_METADATA,{samples:e.samples})}e.samples=[],t=t}},{key:"remuxText",value:function(e,t){e.samples.sort(function(e,t){return e.pts-t.pts});var n,r=e.samples.length,i=e.inputTimeScale,o=this._initPTS;if(r){for(var a=0;a<r;a++)n=e.samples[a],n.pts=(n.pts-o)/i;this.observer.trigger(u.default.FRAG_PARSING_USERDATA,{samples:e.samples})}e.samples=[],t=t}},{key:"_PTSNormalize",value:function(e,t){var n;if(void 0===t)return e;for(n=t<e?-8589934592:8589934592;Math.abs(e-t)>4294967296;)e+=n;return e}}]),e}();t.default=p},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(1),a=function(e){return e&&e.__esModule?e:{default:e}}(o),s=function(){function e(t){r(this,e),this.observer=t}return i(e,[{key:"destroy",value:function(){}},{key:"resetTimeStamp",value:function(){}},{key:"resetInitSegment",value:function(){}},{key:"remux",value:function(e,t,n,r,i,o,s,l){var u=this.observer,d="";e&&(d+="audio"),t&&(d+="video"),u.trigger(a.default.FRAG_PARSING_DATA,{data1:l,startPTS:i,startDTS:i,type:d,nb:1,dropped:0}),u.trigger(a.default.FRAG_PARSED)}}]),e}();t.default=s},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=/^(\d+)x(\d+)$/,a=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,s=function(){function e(t){r(this,e),"string"==typeof t&&(t=e.parseAttrList(t));for(var n in t)t.hasOwnProperty(n)&&(this[n]=t[n])}return i(e,[{key:"decimalInteger",value:function(e){var t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}},{key:"hexadecimalInteger",value:function(e){if(this[e]){var t=(this[e]||"0x").slice(2);t=(1&t.length?"0":"")+t;for(var n=new Uint8Array(t.length/2),r=0;r<t.length/2;r++)n[r]=parseInt(t.slice(2*r,2*r+2),16);return n}return null}},{key:"hexadecimalIntegerAsNumber",value:function(e){var t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}},{key:"decimalFloatingPoint",value:function(e){return parseFloat(this[e])}},{key:"enumeratedString",value:function(e){return this[e]}},{key:"decimalResolution",value:function(e){var t=o.exec(this[e]);if(null!==t)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}}],[{key:"parseAttrList",value:function(e){var t,n={};for(a.lastIndex=0;null!==(t=a.exec(e));){var r=t[2];0===r.indexOf('"')&&r.lastIndexOf('"')===r.length-1&&(r=r.slice(1,-1)),n[t[1]]=r}return n}}]),e}();t.default=s},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},a=function(e){var t=e;return o.hasOwnProperty(e)&&(t=o[e]),String.fromCharCode(t)},s=15,l=100,u={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},d={17:2,18:4,21:6,22:8,23:10,19:13,20:15},c={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},f={25:2,26:4,29:6,30:8,31:10,27:13,28:15},h=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],p={verboseFilter:{DATA:3,DEBUG:3,INFO:2,WARNING:2,TEXT:1,ERROR:0},time:null,verboseLevel:0,setTime:function(e){this.time=e},log:function(e,t){var n=this.verboseFilter[e];this.verboseLevel>=n&&console.log(this.time+" ["+e+"] "+t)}},m=function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n].toString(16));return t},g=function(){function e(t,n,i,o,a){r(this,e),this.foreground=t||"white",this.underline=n||!1,this.italics=i||!1,this.background=o||"black",this.flash=a||!1}return i(e,[{key:"reset",value:function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}},{key:"setStyles",value:function(e){for(var t=["foreground","underline","italics","background","flash"],n=0;n<t.length;n++){var r=t[n];e.hasOwnProperty(r)&&(this[r]=e[r])}}},{key:"isDefault",value:function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash}},{key:"equals",value:function(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}},{key:"copy",value:function(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}},{key:"toString",value:function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}]),e}(),y=function(){function e(t,n,i,o,a,s){r(this,e),this.uchar=t||" ",this.penState=new g(n,i,o,a,s)}return i(e,[{key:"reset",value:function(){this.uchar=" ",this.penState.reset()}},{key:"setChar",value:function(e,t){this.uchar=e,this.penState.copy(t)}},{key:"setPenState",value:function(e){this.penState.copy(e)}},{key:"equals",value:function(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}},{key:"copy",value:function(e){this.uchar=e.uchar,this.penState.copy(e.penState)}},{key:"isEmpty",value:function(){return" "===this.uchar&&this.penState.isDefault()}}]),e}(),v=function(){function e(){r(this,e),this.chars=[];for(var t=0;t<l;t++)this.chars.push(new y);this.pos=0,this.currPenState=new g}return i(e,[{key:"equals",value:function(e){for(var t=!0,n=0;n<l;n++)if(!this.chars[n].equals(e.chars[n])){t=!1;break}return t}},{key:"copy",value:function(e){for(var t=0;t<l;t++)this.chars[t].copy(e.chars[t])}},{key:"isEmpty",value:function(){for(var e=!0,t=0;t<l;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}},{key:"setCursor",value:function(e){this.pos!==e&&(this.pos=e),this.pos<0?(p.log("ERROR","Negative cursor position "+this.pos),this.pos=0):this.pos>l&&(p.log("ERROR","Too large cursor position "+this.pos),this.pos=l)}},{key:"moveCursor",value:function(e){var t=this.pos+e;if(e>1)for(var n=this.pos+1;n<t+1;n++)this.chars[n].setPenState(this.currPenState);this.setCursor(t)}},{key:"backSpace",value:function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}},{key:"insertChar",value:function(e){e>=144&&this.backSpace();var t=a(e);if(this.pos>=l)return void p.log("ERROR","Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!");this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1)}},{key:"clearFromPos",value:function(e){var t;for(t=e;t<l;t++)this.chars[t].reset()}},{key:"clear",value:function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}},{key:"clearToEndOfRow",value:function(){this.clearFromPos(this.pos)}},{key:"getTextString",value:function(){for(var e=[],t=!0,n=0;n<l;n++){var r=this.chars[n].uchar;" "!==r&&(t=!1),e.push(r)}return t?"":e.join("")}},{key:"setPenStyles",value:function(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}}]),e}(),_=function(){function e(){r(this,e),this.rows=[];for(var t=0;t<s;t++)this.rows.push(new v);this.currRow=s-1,this.nrRollUpRows=null,this.reset()}return i(e,[{key:"reset",value:function(){for(var e=0;e<s;e++)this.rows[e].clear();this.currRow=s-1}},{key:"equals",value:function(e){for(var t=!0,n=0;n<s;n++)if(!this.rows[n].equals(e.rows[n])){t=!1;break}return t}},{key:"copy",value:function(e){for(var t=0;t<s;t++)this.rows[t].copy(e.rows[t])}},{key:"isEmpty",value:function(){for(var e=!0,t=0;t<s;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}},{key:"backSpace",value:function(){this.rows[this.currRow].backSpace()}},{key:"clearToEndOfRow",value:function(){this.rows[this.currRow].clearToEndOfRow()}},{key:"insertChar",value:function(e){this.rows[this.currRow].insertChar(e)}},{key:"setPen",value:function(e){this.rows[this.currRow].setPenStyles(e)}},{key:"moveCursor",value:function(e){this.rows[this.currRow].moveCursor(e)}},{key:"setCursor",value:function(e){p.log("INFO","setCursor: "+e),this.rows[this.currRow].setCursor(e)}},{key:"setPAC",value:function(e){p.log("INFO","pacData = "+JSON.stringify(e));var t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(var n=0;n<s;n++)this.rows[n].clear();var r=this.currRow+1-this.nrRollUpRows,i=this.lastOutputScreen;if(i){var o=i.rows[r].cueStartTime;if(o&&o<p.time)for(var a=0;a<this.nrRollUpRows;a++)this.rows[t-this.nrRollUpRows+a+1].copy(i.rows[r+a])}}this.currRow=t;var l=this.rows[this.currRow];if(null!==e.indent){var u=e.indent,d=Math.max(u-1,0);l.setCursor(e.indent),e.color=l.chars[d].penState.foreground}var c={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(c)}},{key:"setBkgData",value:function(e){p.log("INFO","bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}},{key:"setRollUpRows",value:function(e){this.nrRollUpRows=e}},{key:"rollUp",value:function(){if(null===this.nrRollUpRows)return void p.log("DEBUG","roll_up but nrRollUpRows not set yet");p.log("TEXT",this.getDisplayText());var e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),p.log("INFO","Rolling up")}},{key:"getDisplayText",value:function(e){e=e||!1;for(var t=[],n="",r=-1,i=0;i<s;i++){var o=this.rows[i].getTextString();o&&(r=i+1,e?t.push("Row "+r+": '"+o+"'"):t.push(o.trim()))}return t.length>0&&(n=e?"["+t.join(" | ")+"]":t.join("\n")),n}},{key:"getTextAndFormat",value:function(){return this.rows}}]),e}(),b=function(){function e(t,n){r(this,e),this.chNr=t,this.outputFilter=n,this.mode=null,this.verbose=0,this.displayedMemory=new _,this.nonDisplayedMemory=new _,this.lastOutputScreen=new _,this.currRollUpRow=this.displayedMemory.rows[s-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}return i(e,[{key:"reset",value:function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.currRollUpRow=this.displayedMemory.rows[s-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.lastCueEndTime=null}},{key:"getHandler",value:function(){return this.outputFilter}},{key:"setHandler",value:function(e){this.outputFilter=e}},{key:"setPAC",value:function(e){this.writeScreen.setPAC(e)}},{key:"setBkgData",value:function(e){this.writeScreen.setBkgData(e)}},{key:"setMode",value:function(e){e!==this.mode&&(this.mode=e,p.log("INFO","MODE="+e),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}},{key:"insertChars",value:function(e){for(var t=0;t<e.length;t++)this.writeScreen.insertChar(e[t]);var n=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";p.log("INFO",n+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(p.log("TEXT","DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}},{key:"ccRCL",value:function(){p.log("INFO","RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}},{key:"ccBS",value:function(){p.log("INFO","BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}},{key:"ccAOF",value:function(){}},{key:"ccAON",value:function(){}},{key:"ccDER",value:function(){p.log("INFO","DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}},{key:"ccRU",value:function(e){p.log("INFO","RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}},{key:"ccFON",value:function(){p.log("INFO","FON - Flash On"),this.writeScreen.setPen({flash:!0})}},{key:"ccRDC",value:function(){p.log("INFO","RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}},{key:"ccTR",value:function(){p.log("INFO","TR"),this.setMode("MODE_TEXT")}},{key:"ccRTD",value:function(){p.log("INFO","RTD"),this.setMode("MODE_TEXT")}},{key:"ccEDM",value:function(){p.log("INFO","EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate()}},{key:"ccCR",value:function(){p.log("CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate()}},{key:"ccENM",value:function(){p.log("INFO","ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}},{key:"ccEOC",value:function(){if(p.log("INFO","EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,p.log("TEXT","DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate()}},{key:"ccTO",value:function(e){p.log("INFO","TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}},{key:"ccMIDROW",value:function(e){var t={flash:!1};if(t.underline=e%2==1,t.italics=e>=46,t.italics)t.foreground="white";else{var n=Math.floor(e/2)-16,r=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=r[n]}p.log("INFO","MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)}},{key:"outputDataUpdate",value:function(){var e=p.time;null!==e&&this.outputFilter&&(this.outputFilter.updateData&&this.outputFilter.updateData(e,this.displayedMemory),null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.lastOutputScreen),this.cueStartTime=this.displayedMemory.isEmpty()?null:e):this.cueStartTime=e,this.lastOutputScreen.copy(this.displayedMemory))}},{key:"cueSplitAtTime",value:function(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}]),e}(),E=function(){function e(t,n,i){r(this,e),this.field=t||1,this.outputs=[n,i],this.channels=[new b(1,n),new b(2,i)],this.currChNr=-1,this.lastCmdA=null,this.lastCmdB=null,this.bufferedData=[],this.startTime=null,this.lastTime=null,this.dataCounters={padding:0,char:0,cmd:0,other:0}}return i(e,[{key:"getHandler",value:function(e){return this.channels[e].getHandler()}},{key:"setHandler",value:function(e,t){this.channels[e].setHandler(t)}},{key:"addData",value:function(e,t){var n,r,i,o=!1;this.lastTime=e,p.setTime(e);for(var a=0;a<t.length;a+=2)if(r=127&t[a],i=127&t[a+1],0!==r||0!==i){if(p.log("DATA","["+m([t[a],t[a+1]])+"] -> ("+m([r,i])+")"),n=this.parseCmd(r,i),n||(n=this.parseMidrow(r,i)),n||(n=this.parsePAC(r,i)),n||(n=this.parseBackgroundAttributes(r,i)),!n&&(o=this.parseChars(r,i)))if(this.currChNr&&this.currChNr>=0){var s=this.channels[this.currChNr-1];s.insertChars(o)}else p.log("WARNING","No channel found yet. TEXT-MODE?");n?this.dataCounters.cmd+=2:o?this.dataCounters.char+=2:(this.dataCounters.other+=2,p.log("WARNING","Couldn't parse cleaned data "+m([r,i])+" orig: "+m([t[a],t[a+1]])))}else this.dataCounters.padding+=2}},{key:"parseCmd",value:function(e,t){var n=null,r=(20===e||28===e)&&32<=t&&t<=47,i=(23===e||31===e)&&33<=t&&t<=35;if(!r&&!i)return!1;if(e===this.lastCmdA&&t===this.lastCmdB)return this.lastCmdA=null,this.lastCmdB=null,p.log("DEBUG","Repeated command ("+m([e,t])+") is dropped"),!0;n=20===e||23===e?1:2;var o=this.channels[n-1];return 20===e||28===e?32===t?o.ccRCL():33===t?o.ccBS():34===t?o.ccAOF():35===t?o.ccAON():36===t?o.ccDER():37===t?o.ccRU(2):38===t?o.ccRU(3):39===t?o.ccRU(4):40===t?o.ccFON():41===t?o.ccRDC():42===t?o.ccTR():43===t?o.ccRTD():44===t?o.ccEDM():45===t?o.ccCR():46===t?o.ccENM():47===t&&o.ccEOC():o.ccTO(t-32),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=n,!0}},{key:"parseMidrow",value:function(e,t){var n=null;return(17===e||25===e)&&32<=t&&t<=47&&((n=17===e?1:2)!==this.currChNr?(p.log("ERROR","Mismatch channel in midrow parsing"),!1):(this.channels[n-1].ccMIDROW(t),p.log("DEBUG","MIDROW ("+m([e,t])+")"),!0))}},{key:"parsePAC",value:function(e,t){var n=null,r=null,i=(17<=e&&e<=23||25<=e&&e<=31)&&64<=t&&t<=127,o=(16===e||24===e)&&64<=t&&t<=95;if(!i&&!o)return!1;if(e===this.lastCmdA&&t===this.lastCmdB)return this.lastCmdA=null,this.lastCmdB=null,!0;n=e<=23?1:2,r=64<=t&&t<=95?1===n?u[e]:c[e]:1===n?d[e]:f[e];var a=this.interpretPAC(r,t);return this.channels[n-1].setPAC(a),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=n,!0}},{key:"interpretPAC",value:function(e,t){var n=t,r={color:null,italics:!1,indent:null,underline:!1,row:e};return n=t>95?t-96:t-64,r.underline=1==(1&n),n<=13?r.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(n/2)]:n<=15?(r.italics=!0,r.color="white"):r.indent=4*Math.floor((n-16)/2),r}},{key:"parseChars",value:function(e,t){var n=null,r=null,i=null;if(e>=25?(n=2,i=e-8):(n=1,i=e),17<=i&&i<=19){var o=t;o=17===i?t+80:18===i?t+112:t+144,p.log("INFO","Special char '"+a(o)+"' in channel "+n),r=[o]}else 32<=e&&e<=127&&(r=0===t?[e]:[e,t]);if(r){var s=m(r);p.log("DEBUG","Char codes =  "+s.join(",")),this.lastCmdA=null,this.lastCmdB=null}return r}},{key:"parseBackgroundAttributes",value:function(e,t){var n,r,i,o,a=(16===e||24===e)&&32<=t&&t<=47,s=(23===e||31===e)&&45<=t&&t<=47;return!(!a&&!s||(n={},16===e||24===e?(r=Math.floor((t-32)/2),n.background=h[r],t%2==1&&(n.background=n.background+"_semi")):45===t?n.background="transparent":(n.foreground="black",47===t&&(n.underline=!0)),i=e<24?1:2,o=this.channels[i-1],o.setBkgData(n),this.lastCmdA=null,this.lastCmdB=null,0))}},{key:"reset",value:function(){for(var e=0;e<this.channels.length;e++)this.channels[e]&&this.channels[e].reset();this.lastCmdA=null,this.lastCmdB=null}},{key:"cueSplitAtTime",value:function(e){for(var t=0;t<this.channels.length;t++)this.channels[t]&&this.channels[t].cueSplitAtTime(e)}}]),e}();t.default=E},function(e,t,n){var r=n(15),i={newCue:function(e,t,n,i){for(var o,a,s,l,u,d=window.VTTCue||window.TextTrackCue,c=0;c<i.rows.length;c++)if(o=i.rows[c],s=!0,l=0,u="",!o.isEmpty()){for(var f=0;f<o.chars.length;f++)o.chars[f].uchar.match(/\s/)&&s?l++:(u+=o.chars[f].uchar,s=!1);o.cueStartTime=t,t===n&&(n+=1e-4),a=new d(t,n,(0,r.fixLineBreaks)(u.trim())),l>=16?l--:l++,navigator.userAgent.match(/Firefox\//)?a.line=c+1:a.line=c>7?c-2:c+1,a.align="left",a.position=Math.max(0,Math.min(100,l/32*100+(navigator.userAgent.match(/Firefox\//)?50:0))),e.addCue(a)}}};e.exports=i},function(e,t,n){function r(e,t){return o.default.search(e,function(e){return e.cc<t?1:e.cc>t?-1:0})}Object.defineProperty(t,"__esModule",{value:!0}),t.findFragWithCC=r;var i=n(7),o=function(e){return e&&e.__esModule?e:{default:e}}(i)},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(54),a=function(e){return e&&e.__esModule?e:{default:e}}(o),s=function(){function e(t,n,i,o){r(this,e),this.hls=t,this.defaultEstimate_=o,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new a.default(n),this.fast_=new a.default(i)}return i(e,[{key:"sample",value:function(e,t){e=Math.max(e,this.minDelayMs_);var n=8e3*t/e,r=e/1e3;this.fast_.sample(r,n),this.slow_.sample(r,n)}},{key:"canEstimate",value:function(){var e=this.fast_;return e&&e.getTotalWeight()>=this.minWeight_}},{key:"getEstimate",value:function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}},{key:"destroy",value:function(){}}]),e}();t.default=s},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(t){r(this,e),this.alpha_=t?Math.exp(Math.log(.5)/t):0,this.estimate_=0,this.totalWeight_=0}return i(e,[{key:"sample",value:function(e,t){var n=Math.pow(this.alpha_,e);this.estimate_=t*(1-n)+n*this.estimate_,this.totalWeight_+=e}},{key:"getTotalWeight",value:function(){return this.totalWeight_}},{key:"getEstimate",value:function(){if(this.alpha_){var e=1-Math.pow(this.alpha_,this.totalWeight_);return this.estimate_/e}return this.estimate_}}]),e}();t.default=o},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){function e(e){return"string"==typeof e&&!!o[e.toLowerCase()]&&e.toLowerCase()}function t(e){return"string"==typeof e&&!!a[e.toLowerCase()]&&e.toLowerCase()}function n(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)e[r]=n[r]}return e}function r(r,o,a){var s=this,l=function(){if("undefined"!=typeof navigator)return/MSIE\s8\.0/.test(navigator.userAgent)}(),u={};l?s=document.createElement("custom"):u.enumerable=!0,s.hasBeenReset=!1;var d="",c=!1,f=r,h=o,p=a,m=null,g="",y=!0,v="auto",_="start",b=50,E="middle",T=50,S="middle";if(Object.defineProperty(s,"id",n({},u,{get:function(){return d},set:function(e){d=""+e}})),Object.defineProperty(s,"pauseOnExit",n({},u,{get:function(){return c},set:function(e){c=!!e}})),Object.defineProperty(s,"startTime",n({},u,{get:function(){return f},set:function(e){if("number"!=typeof e)throw new TypeError("Start time must be set to a number.");f=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"endTime",n({},u,{get:function(){return h},set:function(e){if("number"!=typeof e)throw new TypeError("End time must be set to a number.");h=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"text",n({},u,{get:function(){return p},set:function(e){p=""+e,this.hasBeenReset=!0}})),Object.defineProperty(s,"region",n({},u,{get:function(){return m},set:function(e){m=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"vertical",n({},u,{get:function(){return g},set:function(t){var n=e(t);if(!1===n)throw new SyntaxError("An invalid or illegal string was specified.");g=n,this.hasBeenReset=!0}})),Object.defineProperty(s,"snapToLines",n({},u,{get:function(){return y},set:function(e){y=!!e,this.hasBeenReset=!0}})),Object.defineProperty(s,"line",n({},u,{get:function(){return v},set:function(e){if("number"!=typeof e&&e!==i)throw new SyntaxError("An invalid number or illegal string was specified.");v=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"lineAlign",n({},u,{get:function(){return _},set:function(e){var n=t(e);if(!n)throw new SyntaxError("An invalid or illegal string was specified.");_=n,this.hasBeenReset=!0}})),Object.defineProperty(s,"position",n({},u,{get:function(){return b},set:function(e){if(e<0||e>100)throw new Error("Position must be between 0 and 100.");b=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"positionAlign",n({},u,{get:function(){return E},set:function(e){var n=t(e);if(!n)throw new SyntaxError("An invalid or illegal string was specified.");E=n,this.hasBeenReset=!0}})),Object.defineProperty(s,"size",n({},u,{get:function(){return T},set:function(e){if(e<0||e>100)throw new Error("Size must be between 0 and 100.");T=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"align",n({},u,{get:function(){return S},set:function(e){var n=t(e);if(!n)throw new SyntaxError("An invalid or illegal string was specified.");S=n,this.hasBeenReset=!0}})),s.displayState=void 0,l)return s}if("undefined"!=typeof window&&window.VTTCue)return window.VTTCue;var i="auto",o={"":!0,lr:!0,rl:!0},a={start:!0,middle:!0,end:!0,left:!0,right:!0};return r.prototype.getCueAsHTML=function(){return window.WebVTT.convertCueToDOMTree(window,this.text)},r}()},function(e,t,n){var r=n(15),i=function(e){return e&&e.__esModule?e:{default:e}}(r),o=function(e,t,n){return e.substr(n||0,t.length)===t},a=function(e){var t=parseInt(e.substr(-3)),n=parseInt(e.substr(-6,2)),r=parseInt(e.substr(-9,2)),i=e.length>9?parseInt(e.substr(0,e.indexOf(":"))):0;return isNaN(t)||isNaN(n)||isNaN(r)||isNaN(i)?-1:(t+=1e3*n,t+=6e4*r,t+=36e5*i)},s=function(e){for(var t=5381,n=e.length;n;)t=33*t^e.charCodeAt(--n);return(t>>>0).toString()},l=function(e,t,n){var r=e[t],i=e[r.prevCC];if(!i||!i.new&&r.new)return e.ccOffset=e.presentationOffset=r.start,void(r.new=!1);for(;i&&i.new;)e.ccOffset+=r.start-i.start,r.new=!1,r=i,i=e[r.prevCC];e.presentationOffset=n},u={parse:function(e,t,n,r,u,d){var c=/\r\n|\n\r|\n|\r/g,f=String.fromCharCode.apply(null,new Uint8Array(e)).trim().replace(c,"\n").split("\n"),h="00:00.000",p=0,m=0,g=0,y=[],v=void 0,_=!0,b=new i.default;b.oncue=function(e){var t=n[r],i=n.ccOffset;t&&t.new&&(void 0!==m?i=n.ccOffset=t.start:l(n,r,g)),g&&(i=g+n.ccOffset-n.presentationOffset),e.startTime+=i-m,e.endTime+=i-m,e.id=s(e.startTime)+s(e.endTime)+s(e.text),e.text=decodeURIComponent(escape(e.text)),e.endTime>0&&y.push(e)},b.onparsingerror=function(e){v=e},b.onflush=function(){if(v&&d)return void d(v);u(y)},f.forEach(function(e){if(_){if(o(e,"X-TIMESTAMP-MAP=")){_=!1,e.substr(16).split(",").forEach(function(e){o(e,"LOCAL:")?h=e.substr(6):o(e,"MPEGTS:")&&(p=parseInt(e.substr(7)))});try{t=t<0?t+8589934592:t,p-=t,m=a(h)/1e3,g=p/9e4,-1===m&&(v=new Error("Malformed X-TIMESTAMP-MAP: "+e))}catch(t){v=new Error("Malformed X-TIMESTAMP-MAP: "+e)}return}""===e&&(_=!1)}b.parse(e+"\n")}),b.flush()}};e.exports=u},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(0),a=function(){function e(t){r(this,e),t&&t.xhrSetup&&(this.xhrSetup=t.xhrSetup)}return i(e,[{key:"destroy",value:function(){this.abort(),this.loader=null}},{key:"abort",value:function(){var e=this.loader;e&&4!==e.readyState&&(this.stats.aborted=!0,e.abort()),window.clearTimeout(this.requestTimeout),this.requestTimeout=null,window.clearTimeout(this.retryTimeout),this.retryTimeout=null}},{key:"load",value:function(e,t,n){this.context=e,this.config=t,this.callbacks=n,this.stats={trequest:performance.now(),retry:0},this.retryDelay=t.retryDelay,this.loadInternal()}},{key:"loadInternal",value:function(){var e,t=this.context;e="undefined"!=typeof XDomainRequest?this.loader=new XDomainRequest:this.loader=new XMLHttpRequest;var n=this.stats;n.tfirst=0,n.loaded=0;var r=this.xhrSetup;try{if(r)try{r(e,t.url)}catch(n){e.open("GET",t.url,!0),r(e,t.url)}e.readyState||e.open("GET",t.url,!0)}catch(n){return void this.callbacks.onError({code:e.status,text:n.message},t,e)}t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout),e.send()}},{key:"readystatechange",value:function(e){var t=e.currentTarget,n=t.readyState,r=this.stats,i=this.context,a=this.config;if(!r.aborted&&n>=2)if(window.clearTimeout(this.requestTimeout),0===r.tfirst&&(r.tfirst=Math.max(performance.now(),r.trequest)),4===n){var s=t.status;if(s>=200&&s<300){r.tload=Math.max(r.tfirst,performance.now());var l=void 0,u=void 0;"arraybuffer"===i.responseType?(l=t.response,u=l.byteLength):(l=t.responseText,u=l.length),r.loaded=r.total=u;var d={url:t.responseURL,data:l};this.callbacks.onSuccess(d,r,i,t)}else r.retry>=a.maxRetry||s>=400&&s<499?(o.logger.error(s+" while loading "+i.url),this.callbacks.onError({code:s,text:t.statusText},i,t)):(o.logger.warn(s+" while loading "+i.url+", retrying in "+this.retryDelay+"..."),this.destroy(),this.retryTimeout=window.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,a.maxRetryDelay),r.retry++)}else this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),a.timeout)}},{key:"loadtimeout",value:function(){o.logger.warn("timeout while loading "+this.context.url),this.callbacks.onTimeout(this.stats,this.context,null)}},{key:"loadprogress",value:function(e){var t=e.currentTarget,n=this.stats;n.loaded=e.loaded,e.lengthComputable&&(n.total=e.total);var r=this.callbacks.onProgress;r&&r(n,this.context,null,t)}}]),e}();t.default=a},function(e,t,n){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){var r=arguments[3],i=arguments[4],o=arguments[5],a=JSON.stringify;e.exports=function(e,t){function n(e){g[e]=!0;for(var t in i[e][1]){var r=i[e][1][t];g[r]||n(r)}}for(var s,l=Object.keys(o),u=0,d=l.length;u<d;u++){var c=l[u],f=o[c].exports;if(f===e||f&&f.default===e){s=c;break}}if(!s){s=Math.floor(Math.pow(16,8)*Math.random()).toString(16);for(var h={},u=0,d=l.length;u<d;u++){var c=l[u];h[c]=c}i[s]=["function(require,module,exports){"+e+"(self); }",h]}var p=Math.floor(Math.pow(16,8)*Math.random()).toString(16),m={};m[s]=s,i[p]=["function(require,module,exports){var f = require("+a(s)+");(f.default ? f.default : f)(self);}",m];var g={};n(p);var y="("+r+")({"+Object.keys(g).map(function(e){return a(e)+":["+i[e][0]+","+a(i[e][1])+"]"}).join(",")+"},{},["+a(p)+"])",v=window.URL||window.webkitURL||window.mozURL||window.msURL,_=new Blob([y],{type:"text/javascript"});if(t&&t.bare)return _;var b=v.createObjectURL(_),E=new Worker(b);return E.objectURL=b,E}},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":r(t))&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":r(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0},d=n(42),c=i(d),f=n(61),h=i(f),p=n(67),m=i(p),g=n(66),y=i(g),v=n(65),_=i(v),b=function(e){function t(e,n,r){o(this,t);var i=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i.maxErrors=i.config.maxErrors||5,i.dvrThreshold=i.config.dvrThreshold||300,i.hls=null,i.hlsVersion=c.default.version,i.manifestParsed=!1,i.audioMode=!1,i.metadata=[],i.previousMetadata=null,i.next=r,i.previousLevel=-1,i.lowestLevel=0,i.amountOfErrors=0,i.recoverDecodingErrorDate=null,i.recoverSwapAudioCodecDate=null,i}return s(t,e),l(t,[{key:"isItemSupported",value:function(e){var t=this;return new Promise(function(n){return n("m3u8"!==e.type&&"m3u"!==e.type?{supported:!1,errorCode:Meister.ErrorCodes.WRONG_TYPE}:t.config.disabled||!c.default.isSupported()||t.meister.browser.isSamsung&&!window.MediaSource||t.meister.browser.isiOS&&t.config.iosMobileDisabled?{supported:!1,errorCode:Meister.ErrorCodes.NOT_SUPPORTED}:e.drm||e.drmConfig?{supported:!1,errorCode:Meister.ErrorCodes.NO_DRM}:{supported:!0})})}},{key:"resetPrivates",value:function(){this.metadata=[],this.previousMetadata=null,this.manifestParsed=!1,this.previousLevel=-1,this.lowestLevel=0,this.mediaDuration=0,this.item=null}},{key:"process",value:function(e){var t=this;return this.next(e).then(function(e){return t.player=t.meister.getPlayerByType("html5",e),t.meister.config.audioOnly||"audio"===e.mediaType?t.audioMode=!0:t.audioMode=!1,e}).catch(function(e){console.error("Something went wrong while processing middlewares. "+e)})}},{key:"load",value:function(e){var n=this;u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"load",this).call(this,e),this.item=e;var r=Number.isFinite(e.startPosition)&&e.startPosition>0?e.startPosition:-1;return new Promise(function(t){var i=n.player.mediaElement,o={autoStartLoad:!1,debug:!1};e.Hls&&e.Hls.fineTuning&&(o=Object.assign(o,e.Hls.fineTuning)),n.hls=new c.default(o),n.on("playerError",n.onPlayerError.bind(n)),n.on("requestBitrate",n.onRequestBitrate.bind(n)),n.on("requestGoLive",function(){return n.onRequestGoLive()}),n.hls.on(c.default.Events.MANIFEST_LOADED,function(e,i){if(n.audioMode){for(var o=!0,a=0;a<i.levels.length;a++)if(i.levels[a].videoCodec){o=!1;break}if(o)n.meister.config.autoplay?n.hls.startLoad(r):n.one("requestPlay",function(){if(n.manifestParsed)n.hls.startLoad(r);else{var e=function e(){n.hls.startLoad(r),n.hls.off(c.default.Events.MANIFEST_PARSED,e)};n.hls.on(c.default.Events.MANIFEST_PARSED,e)}}),t();else for(var s=0;s<i.levels.length;s++){var l=i.levels[s];if(!l.videoCodec)return void n.hls.loadSource(l.url[0])}}!n.audioMode&&n.meister.config.autoplay&&n.hls.startLoad(r),n.config.splashTitle&&n.meister.trigger("uiEvent",{type:"splash",info:{title:n.config.splashTitle,description:n.config.splashDescription,thumbnailURL:n.config.splashThumbnail}})}),n.hls.on(c.default.Events.MANIFEST_PARSED,function(e,t){n.onManifestParsed(t.levels,t.firstLevel)}),n.hls.on(c.default.Events.LEVEL_LOADED,function(e,t){var r=t.details.live,i=!1;n.mediaDuration=t.details.totalduration,r&&n.mediaDuration>n.dvrThreshold&&(i=!0),n.config.dvrEnabled||(i=!1),n.meister.trigger("itemTimeInfo",{hasDVR:i,isLive:r,duration:n.mediaDuration})}),n.hls.on(c.default.Events.FRAG_PARSING_METADATA,function(e,t){n.processMetadata(t)}),n.hls.on(c.default.Events.LEVEL_SWITCH,n.onQualityChanged.bind(n)),n.hls.attachMedia(i);var a=n.meister.playlist.list[n.meister.playlist.index];(0,_.default)(a)&&(n.meister.browser.isMobile||n.meister.browser.isNonAutoPlay)?n.one("GoogleIma:initialUserActionCompleted",function(){n.hls.loadSource(e.src)}):n.hls.loadSource(e.src),n.hls.on(c.default.Events.ERROR,function(e,t){return n.onError(e,t)}),n.meister.config.autoplay?(n.config.disableVisibilitySwitch||n.on("windowVisibilityChange",n.visibilityChange.bind(n)),t()):n.audioMode||(n.one("requestPlay",function(){if(n.manifestParsed)n.hls.startLoad(r);else{var e=function e(){n.hls.startLoad(r),n.hls.off(c.default.Events.MANIFEST_PARSED,e)};n.hls.on(c.default.Events.MANIFEST_PARSED,e)}n.config.disableVisibilitySwitch||n.on("windowVisibilityChange",function(e){return n.visibilityChange(e)})}),t())})}},{key:"playerLoadedMetadata",value:function(){}},{key:"onQualityChanged",value:function(e,t){if(this.hls.autoLevelEnabled){var n=this.hls.levels[t.level].bitrate;this.meister.trigger("playerAutoSwitchBitrate",{newBitrate:n,newBitrateIndex:t.level})}}},{key:"_onPlayerTimeUpdate",value:function(){var e=this.player.duration-this.mediaDuration;this.meister.trigger("playerTimeUpdate",{currentTime:this.player.currentTime-e,duration:this.mediaDuration}),0!==this.amountOfErrors&&(this.amountOfErrors-=1),this.broadcastTitle()}},{key:"_onPlayerSeek",value:function(){var e=this.player.duration-this.mediaDuration,t=this.player.currentTime-e,n=this.mediaDuration,r=t/n;this.meister.trigger("playerSeek",{relativePosition:r,currentTime:t,duration:n})}},{key:"onRequestSeek",value:function(e){var t=void 0;if(Number.isFinite(e.relativePosition)){var n=this.player.duration-this.mediaDuration;t=this.mediaDuration*e.relativePosition+n}else if(Number.isFinite(e.timeOffset))t=this.player.currentTime+e.timeOffset;else if(Number.isFinite(e.targetTime)){var r=this.player.duration-this.mediaDuration;t=e.targetTime+r}!e.forcedStart&&this.blockSeekForward&&t>this.player.currentTime||Number.isFinite(t)&&(this.player.currentTime=t)}},{key:"onRequestGoLive",value:function(){var e=this.player.duration,t=this.hls.levels[this.hls.currentLevel].details.targetduration,n=this.hls.config.liveSyncDurationCount,r=t*n,i=e-r;this.player.currentTime=i}},{key:"processMetadata",value:function(e){try{var t=(0,y.default)(e.samples[0].data);this.meister.trigger("id3Tags",t)}catch(e){console.error(e)}var n=h.default.parse(e);if(n){for(var r=this.metadata.length-1;r>=0;r--){var i=this.metadata[r];if(n.title===i.title)return void(i.end=n.end)}this.metadata.push(n)}}},{key:"broadcastTitle",value:function(){var e=this.player.currentTime;if(!(this.previousMetadata&&this.previousMetadata.start<e&&e<this.previousMetadata.end)){var t=this.currentlyPlaying;this.previousMetadata&&t.title===this.previousMetadata.title||(this.previousMetadata=t,this.meister.trigger("itemMetadata",{title:t.title}))}}},{key:"onManifestParsed",value:function(e){if(this.manifestParsed=!0,0!==e.length&&!this.audioMode){for(var t=e[0].bitrate,n=0;n<e.length;n++){var r=e[n];r.bitrate<t&&(t=r.bitrate,this.lowestLevel=n)}var i=[];i.push({bitrate:0,index:-1});for(var o=0;o<e.length;o++){var a=e[o];i.push({bitrate:a.bitrate,index:o})}this.meister.trigger("itemBitrates",{bitrates:i,currentIndex:-1})}}},{key:"onRequestBitrate",value:function(e){if(this.hls.nextLevel=e.bitrateIndex,-1!==e.bitrateIndex){var t=this.hls.levels[e.bitrateIndex].bitrate;this.meister.trigger("playerSwitchBitrate",{newBitrate:t,newBitrateIndex:e.bitrateIndex})}}},{key:"visibilityChange",value:function(e){"visible"===e.visibility?this.hls.nextLevel=this.previousLevel:"hidden"===e.visibility&&(this.hls.autoLevelEnabled?this.previousLevel=-1:this.previousLevel=this.hls.currentLevel,this.hls.nextLevel=this.lowestLevel)}},{key:"recoverFromMediaError",value:function(){var e=performance.now();!this.recoverDecodingErrorDate||e-this.recoverDecodingErrorDate>3e3?(this.recoverDecodingErrorDate=performance.now(),console.warn("Fatal error in Hls. Will attempt to recover."),this.hls.recoverMediaError(),this.hls.startLoad(),this.meister.trigger("requestPlay")):(!this.recoverSwapAudioCodecDate||e-this.recoverSwapAudioCodecDate>3e3)&&(this.recoverSwapAudioCodecDate=performance.now(),console.warn("Fatal error in Hls. Will attempt to swap audio codecs."),this.hls.swapAudioCodec(),this.hls.recoverMediaError(),this.hls.startLoad(),this.meister.trigger("requestPlay"))}},{key:"onError",value:function(e,t){this.amountOfErrors+=1,console.warn("Error in "+this.name+", type: "+t.details+", will attempt to recover. Errors thrown: "+this.amountOfErrors),t.fatal&&(console.error("Can not recover from "+t.type+": "+t.details+"."),t.type===c.default.ErrorTypes.NETWORK_ERROR&&this.meister.error("Network error","HLS-0001",t.details),t.type===c.default.ErrorTypes.MEDIA_ERROR&&this.config.autoRecoverMode&&this.recoverFromMediaError()),this.amountOfErrors===this.maxErrors&&(this.meister.pause(),this.meister.error("Too many errors, exceeded maximum","HLS-0002",t.details))}},{key:"onPlayerError",value:function(e){e.code===e.MEDIA_ERR_DECODE&&this.config.autoRecoverMode&&this.recoverFromMediaError()}},{key:"unload",value:function(){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"unload",this).call(this),this.resetPrivates(),this.hls&&this.hls.media&&this.hls.detachMedia(),this.hls&&this.hls.destroy()}},{key:"destroy",value:function(){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this),this.hls&&this.hls.destroy()}},{key:"duration",get:function(){return this.hls?this.mediaDuration:NaN}},{key:"currentTime",get:function(){if(!this.hls||!this.player)return NaN;var e=this.player.duration-this.mediaDuration;return this.player.currentTime-e},set:function(e){if(this.hls&&this.player){var t=this.player.duration-this.mediaDuration;this.player.currentTime=e+t}}},{key:"currentItem",get:function(){var e=this.currentlyPlaying;return{src:this.item.src,type:this.item.type,title:e.title,bitrate:e.bitrate}}},{key:"currentlyPlaying",get:function(){if(!this.hls||!this.hls.levels)return{bitrate:0,title:""};for(var e=this.hls.currentLevel,t={bitrate:this.hls.levels[e]?this.hls.levels[e].bitrate:0,title:""},n=null,r=this.player.currentTime,i=this.metadata.length-1;i>=0;i--)if(this.metadata[i].start<r&&r<this.metadata[i].end){n=this.metadata[i];break}return n&&(t.title=n.title,t.start=n.start,t.end=n.end,t.duration=n.end-n.start),t}}],[{key:"pluginName",get:function(){return"Hls"}},{key:"pluginVersion",get:function(){return m.default.version}}]),t}(Meister.MediaPlugin);Meister.registerPlugin("hls",b),Meister.registerPlugin(b.pluginName,b),t.default=b},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(62),a=function(e){return e&&e.__esModule?e:{default:e}}(o),s=function(){function e(){r(this,e)}return i(e,null,[{key:"parse",value:function(t){for(var n=[],r=0;r<t.samples.length;r++){var i=t.samples[r];n.push({data:e.toChar(i.data),pts:t.samples[r].pts})}if(n.length){if(-1===n[0].data.indexOf("<?xml"))return null;n[0].data=n[0].data.substring(n[0].data.indexOf("<?xml")),n[0].data=n[0].data.replace(" & "," &amp; ");var o={};o.data=a.default.parse(n[0].data),o.title=o.data.artistName+" - "+o.data.titleName,o.start=n[0].pts;var s=parseInt(o.data.duration)/1e3;return o.end=o.start+s,o}return n}},{key:"toChar",value:function(e){for(var t="",n=0;n<e.length;n++){var r=e[n];t+=String.fromCharCode(r)}return t}}]),e}();t.default=s},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(63),a=function(e){return e&&e.__esModule?e:{default:e}}(o),s=function(){function e(){r(this,e)}return i(e,null,[{key:"parse",value:function(e){for(var t=a.default.parse(e),n=t.getElementsByTagName("dict")[0],r=a.default.getChildren(n),i="",o={},s=0;s<r.length;s++){var l=r[s];"key"===l.tagName?i=l.textContent:o[i]=l.textContent}return o}}]),e}();t.default=s},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(){r(this,e)}return i(e,null,[{key:"parse",value:function(e){var t=function(){};if(void 0!==window.DOMParser)t=function(e){return(new window.DOMParser).parseFromString(e,"text/xml")};else{if(void 0===window.ActiveXObject||!new window.ActiveXObject("Microsoft.XMLDOM"))throw new Error("No XML parser found");t=function(e){var t=new window.ActiveXObject("Microsoft.XMLDOM");return t.async="false",t.loadXML(e),t}}return t(e)}},{key:"getChildren",value:function(e){if(void 0===e.children){for(var t=e.childNodes,n=[],r=1;r<t.length;r+=2)n.push(t[r]);return n}return e.children}}]),e}();t.default=o},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;r(this,e),this.data=n,this.key=t,this.type="org.id3",this.startTime=i,this.endTime=o};t.default=i},function(e,t,n){function r(e){return!("media"!==e.type||!e.parallel||!e.parallel.find(function(e){return"vmap"===e.type}))}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r},function(e,t,n){function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function i(e){var t=!0;return u.forEach(function(n,r){n!==e[r]&&(t=!1)}),t}function o(e){return!!e.find(function(e){return e===p})}function a(e){if(!i(e.slice(0,3)))throw new Error("Invalid ID3 tag");var t=Array.from(e),n=(t.splice(0,d),[]);do{var a=t.splice(0,c),s=t.splice(0,f).reduce(function(e,t){return e+t}),u=t.splice(0,h),p=t.splice(0,s);o(a)||n.push({key:String.fromCharCode.apply(String,r(a)),value:new Uint8Array(p).buffer,flags:u})}while(t.length>0);return n.map(function(e){return new l.default(e.key,e.value)})}Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var s=n(64),l=function(e){return e&&e.__esModule?e:{default:e}}(s),u=new Uint8Array([73,68,51]),d=10,c=4,f=4,h=2,p=255},function(e,t){e.exports={name:"@meisterplayer/plugin-hls",version:"5.4.1",description:"Meister plugin wrapping the hls.js player.",main:"dist/Hls.js",keywords:["meister","video","plugin"],repository:{type:"git",url:"https://github.com/meisterplayer/media-hls.git"},scripts:{lint:"eslint ./src/js",test:"jest","test:coverage":"jest --coverage",build:"gulp build",dist:"gulp build:min && gulp build:dist"},author:"Triple",license:"Apache-2.0",dependencies:{"hls.js":"0.7.11","url-toolkit":"^2.0.1",webworkify:"^1.4.0"},devDependencies:{"@meisterplayer/meister-mock":"^1.0.0","babel-preset-es2015":"^6.24.0","babel-preset-es2017":"^6.22.0",gulp:"^3.9.1",jest:"^20.0.4","meister-gulp-webpack-tasks":"^1.0.6","meister-js-dev":"^3.1.0"},peerDependencies:{"@meisterplayer/meisterplayer":">= 5.1.0"}}},function(e,t,n){e.exports=n(17)}])},function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports=function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/",t(t.s=5)}([function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=function(e){return e&&e.__esModule?e:{default:e}}(r);t.default=i.default},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":r(t))&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":r(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},d=n(2),c=i(d),f=n(3),h=i(f),p=n(4),m=i(p),g=200,y=function(e){function t(e,n){o(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.config.enableKeyBoardShortcuts=void 0===r.config.enableKeyBoardShortcuts||r.config.enableKeyBoardShortcuts,r.isLoaded=!1,r.seekToWhenLoaded=null,r.bufferingMonitor=null,r.CHECK_INTERVAL=r.config.checkInterval||g,r.lastPlayPos=0,r.buffering=!1,r.playerPlayEvent=null,r.playerPauseEvent=null,r}return s(t,e),l(t,[{key:"isTypeSupported",value:function(e){return"html5"===e}},{key:"preloadContent",value:function(){return Promise.resolve()}},{key:"load",value:function(e){var n=this;if(u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"load",this).call(this,e),this.mediaElement=document.createElement("video"),(this.meister.config.audioOnly||"audio"===e.mediaType)&&(this.backgroundImage=document.createElement("img"),this.defaultImageUrl=this.meister.config.defaultAudioImage||"",this.backgroundImage.src=this.defaultImageUrl,this.backgroundImage.setAttribute("class","pf-audio-image"),this.wrapper.appendChild(this.backgroundImage),this.mediaElement=document.createElement("audio")),this.mediaElement.width=this.config.width,this.mediaElement.height=this.config.height,this.mediaElement.setAttribute("class",this.meister.config.playerClass),this.config.posterImage&&this.mediaElement.setAttribute("poster",this.config.posterImage),this.meister.config.iosPlaysInline&&this.mediaElement.setAttribute("playsinline",!0),this.mediaElement.muted=this.meister.config.startMuted,this.wrapper.appendChild(this.mediaElement),this.meister.on("playerPlay",function(){if(n.shouldTriggerReplay)return n.meister.trigger("playerReplay",{}),void(n.shouldTriggerReplay=!1);n.firstPlayTriggered||(n.firstPlayTriggered=!0,n.meister.trigger("playerFirstPlay",{}))}),this.mediaElement.addEventListener("play",function(){n.meister.trigger("playerPlay",n.playerPlayEvent),n.playerPlayEvent=null}),this.mediaElement.addEventListener("pause",function(){n.meister.trigger("playerPause",n.playerPauseEvent),n.playerPauseEvent=null}),this.mediaElement.addEventListener("playing",function(){return n.meister.trigger("playerPlaying")}),this.mediaElement.addEventListener("ended",function(){n.meister.trigger("playerEnd")}),this.mediaElement.addEventListener("error",function(){n.mediaElement.networkState===HTMLMediaElement.NETWORK_NO_SOURCE&&n.meister.error("Media not found",Meister.ErrorCodes.NO_MEDIA_FOUND),n.meister.trigger("playerError",{mediaError:n.mediaElement.error})}),this.mediaElement.addEventListener("seeked",function(){return n.meister.trigger("_playerSeek")}),this.mediaElement.addEventListener("seeking",function(){return n.meister.trigger("playerSeeking")}),this.mediaElement.addEventListener("timeupdate",function(){return n.meister.trigger("_playerTimeUpdate")}),this.mediaElement.addEventListener("progress",function(){return n.meister.trigger("playerProgress",n.mediaElement)}),this.mediaElement.addEventListener("loadedmetadata",function(){return n.meister.trigger("playerLoadedMetadata")}),this.mediaElement.addEventListener("durationchange",function(){return n.meister.trigger("playerDurationChange")}),this.mediaElement.addEventListener("volumechange",function(){return n.meister.trigger("playerVolumeChange")}),this.mediaElement.addEventListener("canplay",function(){return n.meister.trigger("playerCanPlay")}),this.mediaElement.addEventListener("loadedmetadata",function(){n.isLoaded=!0,n.seekToWhenLoaded&&(n.currentTime=n.seekToWhenLoaded,n.seekToWhenLoaded=null)}),this.config.enableKeyBoardShortcuts){var r=new h.default(this.meister.container,this.meister.eventHandler);r.onKey([c.default.Space,c.default.Pause,c.default.PlayPause,c.default.Stop],this.onSpace.bind(this)),r.onKey(c.default.NextTrack,this.nextTrack.bind(this)),r.onKey(c.default.PreviousTrack,this.previousTrack.bind(this)),r.onKey(c.default.ArrowLeft,this.seekBack.bind(this)),r.onKey(c.default.ArrowRight,this.seekForward.bind(this)),r.onKey(c.default.KeyF,this.onKeyF.bind(this))}this.bufferingMonitor=setInterval(this.monitorBuffering.bind(this),this.CHECK_INTERVAL),this.on("itemLoaded",this.onItemLoaded.bind(this)),this.on("itemUnloaded",this.onItemUnloaded.bind(this)),this.meister.on("itemTimeInfo",function(e){n.isLive=e.isLive}),this.on("playerEnd",function(){n.shouldTriggerReplay=!0}),this.meister.trigger("playerCreated")}},{key:"onItemLoaded",value:function(e){e.item.crossorigin?this.mediaElement.setAttribute("crossorigin",e.item.crossorigin):this.mediaElement.removeAttribute("crossorigin"),(this.meister.config.audioOnly||"audio"===e.item.mediaType)&&(e.item.backgroundImage?this.backgroundImage.style["background-image"]="url("+e.item.backgroundImage+")":this.backgroundImage.style["background-image"]="url("+this.defaultImageUrl+")")}},{key:"onItemUnloaded",value:function(){this.canNudge=0,this.firstPlayTriggered=!1}},{key:"monitorBuffering",value:function(){var e=this.mediaElement.currentTime,t=1/this.CHECK_INTERVAL;this.mediaElement.paused||(this.meister.browser.isSamsung&&this.mediaElement.readyState===this.mediaElement.HAVE_ENOUGH_DATA&&0===e?this.meister.trigger("playerBufferedEnough"):!this.buffering&&e<this.lastPlayPos+t?(this.buffering=!0,this.meister.trigger("playerBuffering"),this.meister.trigger("showLoading",{code:"VIDEO_BUFFERING"})):this.buffering&&e>this.lastPlayPos+t&&(this.buffering=!1,this.meister.trigger("playerBufferedEnough"))),this.lastPlayPos=e}},{key:"unload",value:function(){clearInterval(this.bufferingMonitor),this.mediaElement&&this.mediaElement.remove(),this.meister.trigger("playerDestroyed"),u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"unload",this).call(this)}},{key:"play",value:function(e){var t=this;if(this.playerPlayEvent=e,this.mediaElement){var n=this.mediaElement.play();n&&n.catch(function(e){-1===e.message.indexOf("call to pause")&&setTimeout(function(){t.play()},100)})}}},{key:"pause",value:function(e){this.playerPauseEvent=e,this.mediaElement&&this.mediaElement.pause()}},{key:"isPauseDisabled",value:function(){return!!this.isLive&&!!this.meister.config.disablePauseWithLive}},{key:"onSpace",value:function(e){e.preventDefault(),this.isPauseDisabled()||(!0===this.meister.playing?this.meister.pause():this.meister.play())}},{key:"nextTrack",value:function(e){e.preventDefault(),this.meister.trigger("playlistNext")}},{key:"previousTrack",value:function(e){e.preventDefault(),this.meister.trigger("playlistPrevious")}},{key:"seekBack",value:function(e){e.preventDefault(),this.isPauseDisabled()||this.meister.trigger("requestSeek",{timeOffset:-5})}},{key:"seekForward",value:function(e){e.preventDefault(),this.isPauseDisabled()||this.meister.trigger("requestSeek",{timeOffset:5})}},{key:"onKeyF",value:function(e){e.preventDefault(),this.meister.isFullscreen?this.meister.cancelFullscreen():this.meister.requestFullscreen()}},{key:"currentSrc",set:function(e){this.mediaElement&&(this.isLoaded=!1,this.mediaElement.src=e)},get:function(){return this.mediaElement?this.mediaElement.src:null}},{key:"volume",get:function(){return this.mediaElement?this.mediaElement.volume:null},set:function(e){this.mediaElement&&(this.mediaElement.volume=e)}},{key:"muted",get:function(){return this.mediaElement?this.mediaElement.muted:null},set:function(e){this.mediaElement&&(this.mediaElement.muted=e)}},{key:"duration",get:function(){return this.mediaElement?this.mediaElement.duration:null}},{key:"playing",get:function(){return this.mediaElement?!this.mediaElement.paused:null}},{key:"currentTime",get:function(){return this.mediaElement?this.mediaElement.currentTime:null},set:function(e){this.mediaElement&&(this.isLoaded?this.mediaElement.currentTime=e:this.seekToWhenLoaded=e)}}],[{key:"pluginName",get:function(){return"Html5Player"}},{key:"pluginVersion",get:function(){return m.default.version}}]),t}(Meister.PlayerPlugin);Meister.registerPlugin(y.pluginName,y),t.default=y},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(){r(this,e)}return i(e,null,[{key:"F1",get:function(){return 112}},{key:"F2",get:function(){return 113}},{key:"F3",get:function(){return 114}},{key:"F4",get:function(){return 115}},{key:"F5",get:function(){return 116}},{key:"F6",get:function(){return 117}},{key:"F7",get:function(){return 118}},{key:"F8",get:function(){return 118}},{key:"F9",get:function(){return 119}},{key:"F10",get:function(){return 120}},{key:"F11",get:function(){return 121}},{key:"F12",get:function(){return 122}},{key:"Digit1",get:function(){return 49}},{key:"Digit2",get:function(){return 50}},{key:"Digit3",get:function(){return 51}},{key:"Digit4",get:function(){return 52}},{key:"Digit5",get:function(){return 53}},{key:"Digit6",get:function(){return 54}},{key:"Digit7",get:function(){return 55}},{key:"Digit8",get:function(){return 56}},{key:"Digit9",get:function(){return 57}},{key:"Digit0",get:function(){return 48}},{key:"Minus",get:function(){return 189}},{key:"Equal",get:function(){return 187}},{key:"Comma",get:function(){return 188}},{key:"Period",get:function(){return 190}},{key:"Slash",get:function(){return 191}},{key:"Dash",get:function(){return 189}},{key:"Semicolon",get:function(){return 186}},{key:"Quote",get:function(){return 222}},{key:"BracketLeft",get:function(){return 219}},{key:"BracketRight",get:function(){return 221}},{key:"Backquote",get:function(){return 192}},{key:"Accent",get:function(){return 192}},{key:"BackSlash",get:function(){return 220}},{key:"Home",get:function(){return 36}},{key:"End",get:function(){return 35}},{key:"PageUp",get:function(){return 33}},{key:"PageDown",get:function(){return 34}},{key:"ArrowRight",get:function(){return 39}},{key:"ArrowDown",get:function(){return 40}},{key:"ArrowLeft",get:function(){return 37}},{key:"ArrowUp",get:function(){return 38}},{key:"Shift",get:function(){return 16}},{key:"Control",get:function(){return 17}},{key:"Alt",get:function(){return 18}},{key:"Meta",get:function(){return 91}},{key:"Space",get:function(){return 32}},{key:"Escape",get:function(){return 27}},{key:"CapsLock",get:function(){return 20}},{key:"Tab",get:function(){return 9}},{key:"Fn",get:function(){return 119}},{key:"NumLock",get:function(){return 144}},{key:"ScrollLock",get:function(){return 145}},{key:"Enter",get:function(){return 66}},{key:"NumpadEnter",get:function(){return 160}},{key:"Backspace",get:function(){return 67}},{key:"Clear",get:function(){return 28}},{key:"Delete",get:function(){return 112}},{key:"Insert",get:function(){return 124}},{key:"Help",get:function(){return 259}},{key:"Pause",get:function(){return 121}},{key:"BrightnessDown",get:function(){return 220}},{key:"BrightnessUp",get:function(){return 221}},{key:"Eject",get:function(){return 129}},{key:"Power",get:function(){return 26}},{key:"PrintScreen",get:function(){return 120}},{key:"WakeUp",get:function(){return 223}},{key:"Standby",get:function(){return 224}},{key:"KeyQ",get:function(){return 81}},{key:"KeyW",get:function(){return 87}},{key:"KeyE",get:function(){return 69}},{key:"KeyR",get:function(){return 82}},{key:"KeyT",get:function(){return 84}},{key:"KeyY",get:function(){return 89}},{key:"KeyU",get:function(){return 85}},{key:"KeyI",get:function(){return 73}},{key:"KeyO",get:function(){return 79}},{key:"KeyP",get:function(){return 80}},{key:"KeyA",get:function(){return 65}},{key:"KeyS",get:function(){return 83}},{key:"KeyD",get:function(){return 68}},{key:"KeyF",get:function(){return 70}},{key:"KeyG",get:function(){return 71}},{key:"KeyH",get:function(){return 72}},{key:"KeyJ",get:function(){return 74}},{key:"KeyK",get:function(){return 75}},{key:"KeyL",get:function(){return 76}},{key:"KeyZ",get:function(){return 90}},{key:"KeyX",get:function(){return 88}},{key:"KeyC",get:function(){return 67}},{key:"KeyV",get:function(){return 86}},{key:"KeyB",get:function(){return 66}},{key:"KeyN",get:function(){return 78}},{key:"KeyM",get:function(){return 77}},{key:"Mute",get:function(){return 173}},{key:"VolumeDown",get:function(){return 174}},{key:"VolumeUp",get:function(){return 175}},{key:"NextTrack",get:function(){return 176}},{key:"PreviousTrack",get:function(){return 177}},{key:"Stop",get:function(){return 182}},{key:"PlayPause",get:function(){return 179}}]),e}();t.default=o},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(t,n){var i=this;r(this,e),this.container=t,this.eventHandler=n,this.container.addEventListener("keyup",this.handleUp.bind(this)),this.container.addEventListener("keydown",this.handleDown.bind(this)),this.container.setAttribute("tabindex","0"),this.eventHandler.on("playerFullscreen",function(){i.container.focus()})}return i(e,[{key:"onKey",value:function(e,t){var n=this;(Array.isArray(e)?e:[e]).forEach(function(e){n.onKeyUp(e,t),n.onKeyDown(e,function(e){e.preventDefault()})})}},{key:"onKeyUp",value:function(e,t){this.eventHandler.on("up"+e,t)}},{key:"onKeyDown",value:function(e,t){this.eventHandler.on("down"+e,t)}},{key:"handleUp",value:function(e){this.eventHandler.trigger("up"+e.keyCode,e)}},{key:"handleDown",value:function(e){this.eventHandler.trigger("down"+e.keyCode,e)}}]),e}();t.default=o},function(e,t){e.exports={name:"@meisterplayer/plugin-html5player",version:"5.6.1",description:"Meister plugin for playing video with the html5player",main:"dist/Html5player.js",repository:{type:"git",url:"https://github.com/meisterplayer/player-html5player.git"},scripts:{lint:"eslint ./src/js",test:"jest","test:coverage":"jest --coverage",build:"gulp build",dist:"gulp build:min && gulp build:dist"},keywords:["meister","video","plugin"],author:"Triple",license:"Apache-2.0",devDependencies:{"@meisterplayer/meister-mock":"^1.0.0","babel-preset-es2015":"^6.24.0","babel-preset-es2017":"^6.22.0",gulp:"^3.9.1",jest:"^20.0.4","meister-gulp-webpack-tasks":"^1.0.6","meister-js-dev":"^3.1.0"}}},function(e,t,n){e.exports=n(0)}])},function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports=function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/",t(t.s=63)}([function(e,t,n){var r=n(52);"string"==typeof r&&(r=[[e.i,r,""]]),n(3)(r,{sourceMap:!0}),r.locals&&(e.exports=r.locals)},function(e,t,n){function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(){function e(t){i(this,e),this.meister=t,this.isMobile=this.meister.browser.isMobile,this.element=null,this.eventStore=[],this.onItemLoaded&&this.on("itemLoaded",this.onItemLoaded.bind(this)),this.onItemUnloaded&&this.on("itemUnloaded",this.onItemUnloaded.bind(this))}return o(e,[{key:"on",value:function(e,t){var n;(n=this.eventStore).push.apply(n,r(this.meister.on(e,t,this.constructor.name)))}},{key:"one",value:function(e,t,n){this.eventStore.push(this.meister.one(e,t,n,this.constructor.name))}},{key:"classListAdd",value:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];n.forEach(function(t){t&&e.classList.add(t)}),this.isMobile&&e.classList.add("pf-mobile")}},{key:"classListRemove",value:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];n.forEach(function(t){e.classList.remove(t)})}},{key:"getNode",value:function(){return this.element}}]),e}();t.default=a},function(e,t,n){e.exports=function(){var e=[];return e.toString=function(){for(var e=[],t=0;t<this.length;t++){var n=this[t];n[2]?e.push("@media "+n[2]+"{"+n[1]+"}"):e.push(n[1])}return e.join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var r={},i=0;i<this.length;i++){var o=this[i][0];"number"==typeof o&&(r[o]=!0)}for(i=0;i<t.length;i++){var a=t[i];"number"==typeof a[0]&&r[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),e.push(a))}},e}},function(e,t){function n(e,t){for(var n=0;n<e.length;n++){var r=e[n],i=h[r.id];if(i){i.refs++;for(var o=0;o<i.parts.length;o++)i.parts[o](r.parts[o]);for(;o<r.parts.length;o++)i.parts.push(u(r.parts[o],t))}else{for(var a=[],o=0;o<r.parts.length;o++)a.push(u(r.parts[o],t));h[r.id]={id:r.id,refs:1,parts:a}}}}function i(e){for(var t=[],n={},r=0;r<e.length;r++){var i=e[r],o=i[0],a=i[1],s=i[2],l=i[3],u={css:a,media:s,sourceMap:l};n[o]?n[o].parts.push(u):t.push(n[o]={id:o,parts:[u]})}return t}function o(e,t){var n=g(),r=_[_.length-1];if("top"===e.insertAt)r?r.nextSibling?n.insertBefore(t,r.nextSibling):n.appendChild(t):n.insertBefore(t,n.firstChild),_.push(t);else{if("bottom"!==e.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");n.appendChild(t)}}function a(e){e.parentNode.removeChild(e);var t=_.indexOf(e);t>=0&&_.splice(t,1)}function s(e){var t=document.createElement("style");return t.type="text/css",o(e,t),t}function l(e){var t=document.createElement("link");return t.rel="stylesheet",o(e,t),t}function u(e,t){var n,r,i;if(t.singleton){var o=v++;n=y||(y=s(t)),r=d.bind(null,n,o,!1),i=d.bind(null,n,o,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=l(t),r=f.bind(null,n),i=function(){a(n),n.href&&URL.revokeObjectURL(n.href)}):(n=s(t),r=c.bind(null,n),i=function(){a(n)});return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else i()}}function d(e,t,n,r){var i=n?"":r.css;if(e.styleSheet)e.styleSheet.cssText=b(t,i);else{var o=document.createTextNode(i),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(o,a[t]):e.appendChild(o)}}function c(e,t){var n=t.css,r=t.media;if(r&&e.setAttribute("media",r),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}function f(e,t){var n=t.css,r=t.sourceMap;r&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */");var i=new Blob([n],{type:"text/css"}),o=e.href;e.href=URL.createObjectURL(i),o&&URL.revokeObjectURL(o)}var h={},p=function(e){var t;return function(){return void 0===t&&(t=e.apply(this,arguments)),t}},m=p(function(){return/msie [6-9]\b/.test(self.navigator.userAgent.toLowerCase())}),g=p(function(){return document.head||document.getElementsByTagName("head")[0]}),y=null,v=0,_=[];e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=("undefined"==typeof document?"undefined":r(document)))throw new Error("The style-loader cannot be used in a non-browser environment");t=t||{},void 0===t.singleton&&(t.singleton=m()),void 0===t.insertAt&&(t.insertAt="bottom");var o=i(e);return n(o,t),function(e){for(var r=[],a=0;a<o.length;a++){var s=o[a],l=h[s.id];l.refs--,r.push(l)}e&&n(i(e),t);for(var a=0;a<r.length;a++){var l=r[a];if(0===l.refs){for(var u=0;u<l.parts.length;u++)l.parts[u]();delete h[l.id]}}}};var b=function(){var e=[];return function(t,n){return e[t]=n,e.filter(Boolean).join("\n")}}()},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(function(e,t){return t?e.concat(t):e},[]).join(" ")};t.default=r},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.CUSTOM_UI_EVENT_PREFIX="ui",t.MEISTER_DATA_ID_ATTR="data-mstr-id",t.MEISTER_DATA_EVENTS_ATTR="data-mstr-events",t.MEISTER_DATA_STANDARD_ATTR="data-mstr-standard",t.MEISTER_DATA_DIRECTIVE_ATTR="data-mstr-directive"},function(e,t,n){function r(e,t){return Array.prototype.slice.call(e.querySelectorAll(t))}function i(e,t){return e.parentNode?e.parentNode.replaceChild(t,e):null}function o(e){return e.trim().toLowerCase()}Object.defineProperty(t,"__esModule",{value:!0}),t.extractNodesWithSelector=r,t.replaceNodeWith=i,t.formatValue=o},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(t,n){r(this,e),this.config=n,this.meister=t}return i(e,[{key:"unload",value:function(){}}]),e}();t.default=o},function(e,t,n){var r=n(46);"string"==typeof r&&(r=[[e.i,r,""]]),n(3)(r,{sourceMap:!0}),r.locals&&(e.exports=r.locals)},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(10),i=function(e){return e&&e.__esModule?e:{default:e}}(r);t.default=i.default},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":r(t))&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":r(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),d=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0},c=n(17),f=n(18),h=n(15),p=n(62),m=i(p),g=n(11),y=i(g),v=function(e){function t(e,n){var r;a(this,t);var i=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));if(i.hiddenClassName=i.config.hiddenClassName||"mstr-hide-controls",i.directives=[],i.config.ui)if(i.meister.utils.isDOMNode(i.config.ui))i.element=i.config.ui,i.processTemplate();else{if("string"!=typeof i.config.ui){var o;return console.warn("Unable to render a UI template"),o=[],s(i,o)}i.insertStringTemplate(i.config.ui)}else i.insertStringTemplate((0,y.default)());return r=i,s(i,r)}return l(t,e),u(t,[{key:"getTemplateWrapper",value:function(){var e=document.createElement("div");e.style.display="none",e.style.visibility="hidden";var t=document.createElement("div");return e.appendChild(t),document.body.appendChild(e),t}},{key:"insertStringTemplate",value:function(e){var t=this.getTemplateWrapper();t.innerHTML=e,this.element=t.firstChild,this.processTemplate(),this.draw()}},{key:"processTemplate",value:function(){var e=this;(0,f.extractStandardNodes)(this.element).forEach((0,f.createLoadStandardElement)(this.meister,this.config.standard)),(0,c.extractEventNodes)(this.element).forEach((0,c.createRegisterDataEvents)(this.meister,this.config.registeredCallback)),(0,h.extractDirectiveNodes)(this.element).forEach(function(t){var n,r=(0,h.createAttachDirective)(e.meister,e.config);(n=e.directives).push.apply(n,o(r(t)))}),this.meister.on("uiEvent:hideControls",this.hideControls.bind(this)),this.meister.on("uiEvent:showControls",this.showControls.bind(this)),this.meister.on("uiEvent:hideCursor",this.hideCursor.bind(this)),this.meister.on("uiEvent:showCursor",this.showCursor.bind(this))}},{key:"draw",value:function(){this.element&&this.controlsWrapper.appendChild(this.element)}},{key:"hideControls",value:function(){this.element&&this.element.classList.add(this.hiddenClassName)}},{key:"showControls",value:function(){this.element&&this.element.classList.remove(this.hiddenClassName)}},{key:"hideCursor",value:function(){this.meister.container.style.cursor="none"}},{key:"showCursor",value:function(){this.meister.container.style.cursor="auto"}},{key:"unload",value:function(){d(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"unload",this).call(this),this.directives.forEach(function(e){e.unload()})}}],[{key:"pluginName",get:function(){return"HtmlUi"}},{key:"pluginVersion",get:function(){return m.default.version}}]),t}(Meister.Ui);Meister.registerPlugin(v.pluginName,v),t.default=v},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(53),i=(function(e){e&&e.__esModule}(r),function(){return'<div class="mstr-container" data-mstr-directive="autoHideShow,togglePlayPauseClick">\n                <div class="mstr-centerbar">\n                    <span data-mstr-standard="spinner"></span>\n                </div>\n                <div class="mstr-bottombar">\n                    <div class="mstr-items">\n                        <div class="mstr-item">\n                            <span data-mstr-standard="playbutton"></span>\n                        </div>\n                        <div class="mstr-item">\n                            <span data-mstr-standard="playlistpreviousbutton"></span>\n                        </div>\n                        <div class="mstr-item mstr-item--fill">\n                            <span data-mstr-standard="seekbar"></span>\n                        </div>\n                        <div class="mstr-item">\n                            <span data-mstr-standard="timedisplay"></span>\n                        </div>\n                        <div class="mstr-item">\n                            <span data-mstr-standard="playlistnextbutton"></span>\n                        </div>\n                        <div class="mstr-item">\n                            <span data-mstr-standard="fullscreenbutton"></span>\n                        </div>\n                        <div class="mstr-item">\n                            <span data-mstr-standard="volumeslider"></span>\n                        </div>\n                        <div class="mstr-item">\n                            <span data-mstr-standard="qualitybutton"></span>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        '});t.default=i},function(e,t,n){function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":r(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":r(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(7),u=function(e){return e&&e.__esModule?e:{default:e}}(l),d=3e3,c=function(e){function t(e,n){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return Number.isFinite(r.config.timeToFade)&&(d=1e3*r.config.timeToFade),r.onMouseDown=r.onMouseDown.bind(r),r.onMouseUp=r.onMouseUp.bind(r),r.onMouseMove=r.onMouseMove.bind(r),r.onMouseLeave=r.onMouseLeave.bind(r),r.mouseTimeout=null,r.controlsTimeout=null,r.isControlsShown=!1,r.fixedControls=!!r.config.fixedControls,r.toggleFixedControls(r.fixedControls),r}return a(t,e),s(t,[{key:"toggleFixedControls",value:function(e){e?(this.removeEventListeners(),this.showControls(),this.showCursor()):(this.addEventListeners(),this.mouseTimeout=setTimeout(this.hideCursor.bind(this),d),this.controlsTimeout=setTimeout(this.hideControls.bind(this),d))}},{key:"removeEventListeners",value:function(){this.meister.container.removeEventListener("mousedown",this.onMouseDown),this.meister.container.removeEventListener("touchstart",this.onMouseDown),this.meister.container.removeEventListener("mousemove",this.onMouseMove),this.meister.container.removeEventListener("touchmove",this.onMouseMove),this.meister.container.removeEventListener("mouseleave",this.onMouseLeave)}},{key:"addEventListeners",value:function(){this.meister.container.addEventListener("mousedown",this.onMouseDown),this.meister.container.addEventListener("touchstart",this.onMouseDown),this.meister.container.addEventListener("mousemove",this.onMouseMove),this.meister.container.addEventListener("touchmove",this.onMouseMove),this.meister.container.addEventListener("mouseleave",this.onMouseLeave)}},{key:"hideCursor",value:function(){this.dragging||this.meister.trigger("uiEvent:hideCursor",{})}},{key:"showCursor",value:function(){this.meister.trigger("uiEvent:showCursor",{})}},{key:"hideControls",value:function(){!this.dragging&&this.meister.playing&&this.meister.trigger("uiEvent:hideControls",{})}},{key:"showControls",value:function(){this.meister.trigger("uiEvent:showControls",{})}},{key:"onMouseDown",value:function(){this.dragging=!0,window.addEventListener("mouseup",this.onMouseUp),window.addEventListener("touchend",this.onMouseUp)}},{key:"onMouseUp",value:function(){this.dragging=!1,this.onMouseMove(),window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("touchend",this.onMouseUp)}},{key:"onMouseMove",value:function(){clearTimeout(this.mouseTimeout),clearTimeout(this.controlsTimeout),this.showControls(),this.showCursor(),this.mouseTimeout=setTimeout(this.hideCursor.bind(this),d),this.controlsTimeout=setTimeout(this.hideControls.bind(this),d)}},{key:"onMouseLeave",value:function(){clearTimeout(this.mouseTimeout),clearTimeout(this.controlsTimeout),this.hideControls(),this.showCursor()}},{key:"unload",value:function(){this.removeEventListeners(),this.mouseTimeout&&clearTimeout(this.mouseTimeout),this.controlsTimeout&&clearTimeout(this.controlsTimeout),window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("touchend",this.onMouseUp)}}]),t}(u.default),f=function(e,t){return new c(e,t)};t.default=f},function(e,t,n){function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":r(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":r(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(7),u=function(e){return e&&e.__esModule?e:{default:e}}(l),d=function(e){function t(e,n,r){i(this,t);var a=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,r));return a.isLive=!1,a.meister.config.playPauseOnScreenClick=void 0===a.meister.config.playPauseOnScreenClick||a.meister.config.playPauseOnScreenClick,r.addEventListener("click",a.onElementClick.bind(a)),a.meister.on("itemTimeInfo",function(e){a.isLive=e.isLive}),a}return a(t,e),s(t,[{key:"onElementClick",value:function(){this.meister.browser.isMobile||this.meister.config.playPauseOnScreenClick&&(this.meister.playing?this.meister.pause(!0):this.meister.play(!0))}}]),t}(u.default);t.default=d},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t,n,r){switch(n){case"autohideshow":return(0,a.default)(e,t,r);case"toggleplaypauseclick":return new l.default(e,t,r);default:return null}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;var o=n(12),a=r(o),s=n(13),l=r(s)},function(e,t,n){function r(e){var t=(0,a.extractNodesWithSelector)(e,"["+o.MEISTER_DATA_DIRECTIVE_ATTR+"]");return e.getAttribute(o.MEISTER_DATA_DIRECTIVE_ATTR)?t.concat(e):t}function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(n){return(0,a.formatValue)(n.getAttribute(o.MEISTER_DATA_DIRECTIVE_ATTR)).split(",").map(function(r){return(0,l.default)(e,t,r,n)})}}Object.defineProperty(t,"__esModule",{value:!0}),t.extractDirectiveNodes=r,t.createAttachDirective=i;var o=n(5),a=n(6),s=n(14),l=function(e){return e&&e.__esModule?e:{default:e}}(s)},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.CustomUiElementRegisteredEvent=t.CustomUiEvent=void 0;var i=n(5);t.CustomUiEvent=function e(t,n,i,o,a){r(this,e),this.eventName=i,this.eventType=o,this.event=a,this.meister=t,this.element=n},t.CustomUiElementRegisteredEvent=function e(t,n,o){r(this,e),this.meister=t,this.element=n,this.events=o,this.id=n.getAttribute(i.MEISTER_DATA_ID_ATTR)}},function(e,t,n){function r(e){var t=(0,s.extractNodesWithSelector)(e,"["+a.MEISTER_DATA_EVENTS_ATTR+"]");return e.getAttribute(a.MEISTER_DATA_EVENTS_ATTR)?t.concat(e):t}function i(e){return e.split(",").filter(function(e){return!!e}).map(function(e){return e.trim()}).filter(function(e){return!!e})}function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};return function(n){var r=n.getAttribute(a.MEISTER_DATA_EVENTS_ATTR);if(r){var o=i(r);if(!(o.length<1)){var s=n.getAttribute(a.MEISTER_DATA_ID_ATTR),u=s?s+":":"",d=a.CUSTOM_UI_EVENT_PREFIX+":"+u;o.forEach(function(t){var r=""+d+t;n.addEventListener(t,function(i){e.trigger(r,new l.CustomUiEvent(e,n,r,t,i))})}),t(new l.CustomUiElementRegisteredEvent(e,n,o))}}}}Object.defineProperty(t,"__esModule",{value:!0}),t.extractEventNodes=r,t.createRegisterDataEvents=o;var a=n(5),s=n(6),l=n(16)},function(e,t,n){function r(e){return(0,a.extractNodesWithSelector)(e,"["+o.MEISTER_DATA_STANDARD_ATTR+"]")}function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(n){var r=(0,a.formatValue)(n.getAttribute(o.MEISTER_DATA_STANDARD_ATTR));if(r){var i=(0,l.default)(e,t,r);i||console.error("No standard element with name '"+r+"'"),(0,a.replaceNodeWith)(n,i.getNode())}}}Object.defineProperty(t,"__esModule",{value:!0}),t.extractStandardNodes=r,t.createLoadStandardElement=i;var o=n(5),a=n(6),s=n(33),l=function(e){return e&&e.__esModule?e:{default:e}}(s)},function(e,t,n){function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":r(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":r(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(1),u=function(e){return e&&e.__esModule?e:{default:e}}(l),d=function(e){function t(e){i(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.element=document.createElement("div"),n.classListAdd(n.element,"pf-ui-element","pf-ui-element-right","pf-ui-element-active"),n.classListAdd(n.element,"pf-icon","pf-icon_icCc"),n.classListAdd(n.element,"pf-ui-element-hidden"),n.captionSelector=document.createElement("div"),n.classListAdd(n.captionSelector,"pf-quality-selector","hidden"),n.meister.controlsWrapper.appendChild(n.captionSelector),n.element.addEventListener("click",n.onClick.bind(n)),n.captions=null,n.on("itemLoaded",n.onItemLoaded.bind(n)),n.hide=function(){n.classListAdd(n.captionSelector,"hidden"),document.body.removeEventListener("click",n.hide)},n}return a(t,e),s(t,[{key:"onItemUnloaded",value:function(){this.captionSelector.innerHTML="",this.captions=null,this.classListAdd(this.element,"pf-ui-element-hidden")}},{key:"onClick",value:function(e){if(e.stopPropagation(),!e.target.hasAttribute("lang"))return void(this.captionSelector.classList.contains("hidden")?this.show():this.hide());var t=e.target.getAttribute("lang");this.selectLang(t),this.hide()}},{key:"show",value:function(){this.classListRemove(this.captionSelector,"hidden"),document.body.addEventListener("click",this.hide)}},{key:"onItemLoaded",value:function(e){var t=this;e.item&&e.item.captions&&(Array.isArray(e.item.captions)?this.captions=e.item.captions.slice(0).sort(function(e,t){var n=e.title.toUpperCase(),r=t.title.toUpperCase();return n<r?-1:n>r?1:0}):this.captions=[e.item.captions],this.captions.push({title:this.meister.Localization.get("NONE"),lang:"none"}),this.classListRemove(this.element,"pf-ui-element-hidden"),this.captions.forEach(function(e){var n=e.title,r=e.lang;e.option=t.createOption(n,r)}),this.classListRemove(this.element,"pf-ui-element-hidden"))}},{key:"createOption",value:function(e,t){var n=this,r=document.createElement("div");return r.classList.add("pf-quality-option"),r.classList.add("pf-ui-element-active"),r.textContent=e.charAt(0).toUpperCase()+e.toLowerCase().slice(1),r.setAttribute("lang",t),r.selected=document.createElement("div"),r.selected.classList.add("pf-quality-option-select"),r.selected.classList.add("pf-icon"),this.isMobile&&r.selected.classList.add("pf-mobile"),r.appendChild(r.selected),this.captionSelector.appendChild(r),r.addEventListener("click",function(e){return n.onClick(e)}),r}},{key:"selectLang",value:function(e){if(this.captions.forEach(function(e){e.option.selected.classList.remove("pf-icon_icCheck")}),"none"===e)return void this.meister.trigger("requestCaptions",{newLanguage:"none"});var t=this.captions.find(function(t){return t.lang===e});t.option.selected.classList.add("pf-icon_icCheck"),this.meister.trigger("requestCaptions",t)}}]),t}(u.default);t.default=d},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":r(t))&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":r(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(1),d=i(u),c=n(54),f=i(c),h=n(34),p=i(h),m=n(35),g=i(m),y=n(0),v=i(y),_=(0,p.default)(),b=(0,g.default)(),E=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.element=document.createElement("div"),n.classListAdd(n.element,v.default.uiElement),n.meister.config.audioOnly?n.classListAdd(n.element,v.default.uiElementHidden):n.classListAdd(n.element,v.default.uiElementActive),n.classListAdd(n.element,v.default.icon,f.default.fullscreenIcon),n.element.innerHTML=_,n.element.addEventListener("click",function(){return n.toggleFullscreen()}),n.on("playerFullscreen",function(){return n.toggleIcon()}),n.on("playlistMetadata",n.onPlaylistMetadata.bind(n)),n}return s(t,e),l(t,[{key:"onPlaylistMetadata",value:function(e){"audio"===e.mediaType&&this.classListAdd(this.element,v.default.uiElementHidden)}},{key:"toggleIcon",value:function(){document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement?(this.classListAdd(this.element,f.default.fullscreenExitIcon),this.classListRemove(this.element,f.default.fullscreenIcon),this.element.innerHTML=b):(this.classListAdd(this.element,f.default.fullscreenIcon),this.classListRemove(this.element,f.default.fullscreenExitIcon),this.element.innerHTML=_)}},{key:"toggleFullscreen",value:function(){this.meister.isFullscreen?this.meister.cancelFullscreen():this.meister.requestFullscreen()}}]),t}(d.default);t.default=E},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":r(t))&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":r(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(1),d=i(u),c=n(55),f=i(c),h=n(38),p=i(h),m=n(37),g=i(m),y=n(0),v=i(y),_=(0,p.default)(),b=(0,g.default)(),E=function(e){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"normal";o(this,t);var i=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.config=n,i.type=r,i.element=document.createElement("div"),i.classListAdd(i.element,v.default.uiElement,v.default.uiElementActive),i.isLive=!1,i.classListAdd(i.element,f.default.button),i.classListAdd(i.element,f.default.playButton),i.element.innerHTML=_,i.element.addEventListener("click",function(){return i.onClick()}),i.on("itemTimeInfo",function(e){return i.onItemTimeInfo(e)}),i.on("playerPlay",function(){return i.toggleIcon()}),i.on("playerPause",function(){return i.toggleIcon()}),i.on("itemLoaded",function(){return i.toggleIcon()}),i}return s(t,e),l(t,[{key:"onItemTimeInfo",value:function(e){this.isLive=e.isLive,this.isLive&&this.config.disablePauseWithLive&&this.meister.playing&&"normal"===this.type&&this.toggleIcon()}},{key:"onClick",value:function(){this.meister.playing?this.meister.pause(!0):this.meister.play(!0)}},{key:"toggleIcon",value:function(){if(this.isLive&&this.config.disablePauseWithLive&&this.meister.playing&&"normal"===this.type)return this.classListRemove(this.element,f.default.playButton),void this.classListRemove(this.element,f.default.pauseButton);this.meister.playing?(this.classListAdd(this.element,f.default.pauseButton),this.classListRemove(this.element,f.default.playButton),this.element.innerHTML=b):(this.classListRemove(this.element,f.default.pauseButton),this.classListAdd(this.element,f.default.playButton),this.element.innerHTML=_)}}]),t}(d.default);t.default=E},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":r(t))&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":r(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.PlaylistNextButton=t.PlaylistPreviousButton=void 0;var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(1),d=i(u),c=n(56),f=i(c),h=n(39),p=i(h),m=n(36),g=i(m),y=n(0),v=i(y),_=(0,p.default)(),b=(0,g.default)(),E=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.element=document.createElement("div"),n.classListAdd(n.element,v.default.uiElement,v.default.uiElementHidden,v.default.icon,f.default.previousIcon),n.element.innerHTML=_,n.element.addEventListener("click",function(){return n.meister.trigger("playlistPrevious")}),n.on("playlistInfo",function(e){return n.onPlaylistInfo(e)}),n}return s(t,e),l(t,[{key:"onPlaylistInfo",value:function(e){if(this.classListRemove(this.element,v.default.uiElementInactive),e.length<=1)return void this.classListAdd(this.element,v.default.uiElementHidden);0===e.currentIndex&&this.classListAdd(this.element,v.default.uiElementInactive),e.currentIndex>=e.length-1&&this.classListAdd(this.element,v.default.uiElementActive),this.classListRemove(this.element,v.default.uiElementHidden)}}]),t}(d.default),T=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.element=document.createElement("div"),n.classListAdd(n.element,v.default.uiElement,v.default.uiElementHidden,v.default.icon,f.default.nextIcon),n.element.innerHTML=b,n.element.addEventListener("click",function(){return n.meister.trigger("playlistNext")}),n.on("playlistInfo",function(e){return n.onPlaylistInfo(e)}),n}return s(t,e),l(t,[{key:"onPlaylistInfo",value:function(e){0===e.currentIndex&&this.classListAdd(this.element,v.default.uiElementActive),e.currentIndex>=e.length-1&&this.classListAdd(this.element,v.default.uiElementInactive),this.classListRemove(this.element,v.default.uiElementHidden)}}]),t}(d.default);t.PlaylistPreviousButton=E,t.PlaylistNextButton=T},function(e,t,n){function r(e,t,n,r){var i=e;i.textContent="auto"===t?t:r(t),i.setAttribute("index",n)}function i(e,t,n){return e.forEach(function(e){e.index===t?e.option.classList.add(s.default.isActive):e.option.classList.remove(s.default.isActive)}),n?null:t}function o(e,t){return!!e.find(function(e){return e.index===t})}Object.defineProperty(t,"__esModule",{value:!0}),t.prepareBitrateOption=r,t.selectBitrate=i,t.doesBitrateIndexExist=o;var a=n(8),s=function(e){return e&&e.__esModule?e:{default:e}}(a)},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":r(t))&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":r(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(1),d=i(u),c=n(0),f=i(c),h=n(40),p=i(h),m=n(8),g=i(m),y=n(23),v=n(25),_=(0,p.default)(),b=function(e){function t(e,n){o(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.config=n,r.isOpen=!1,r.element=document.createElement("div"),r.classListAdd(r.element,f.default.uiElement,f.default.uiElementActive,f.default.uiElementHidden,g.default.element),r.iconElement=document.createElement("div"),r.iconElement.innerHTML=_,r.classListAdd(r.iconElement,f.default.icon,g.default.iconElement),r.element.appendChild(r.iconElement),r.qualitySelector=document.createElement("div"),r.classListAdd(r.qualitySelector,g.default.qualitySelector,g.default.isClosed),r.element.appendChild(r.qualitySelector),r.qualitySelectorOptions=document.createElement("div"),r.classListAdd(r.qualitySelectorOptions,g.default.qualitySelectorOptions),r.qualitySelector.appendChild(r.qualitySelectorOptions),r.bitrates=null,r.on("itemBitrates",function(e){return r.onItemBitrates(e)}),Array.isArray(r.config.qualityMapping)&&(r.qualityMappingMode=!0,r.qualityMapping=r.config.qualityMapping.map(v.expandQualityMapping)),r.iconElement.addEventListener("click",function(){return r.toggleOpen()}),r.qualitySelectorOptions.addEventListener("click",function(e){return r.onOptionClick(e)}),r}return s(t,e),l(t,[{key:"onItemUnloaded",value:function(){this.qualitySelectorOptions.innerHTML="",this.bitrates=null,this.classListAdd(this.element,f.default.uiElementHidden)}},{key:"setOpen",value:function(){this.classListAdd(this.qualitySelector,g.default.isOpen),this.classListRemove(this.qualitySelector,g.default.isClosed),this.isOpen=!0}},{key:"setClose",value:function(){this.classListAdd(this.qualitySelector,g.default.isClosed),this.classListRemove(this.qualitySelector,g.default.isOpen),this.isOpen=!1}},{key:"toggleOpen",value:function(){this.isOpen?this.setClose():this.setOpen()}},{key:"onOptionClick",value:function(e){if(e.stopPropagation(),!e.target.hasAttribute("index")&&!e.target.mapping)return void(this.qualitySelector.classList.contains("hidden")?this.setOpen():this.setClose());if(e.target.hasAttribute("index")){var t=parseInt(e.target.getAttribute("index"),10);this.selectOption(t)}if(e.target.mapping){var n=parseInt(e.target.mapping.bitrates[0].bitrateIndex,10);this.selectOption(n)}this.setClose()}},{key:"onItemBitrates",value:function(e){var t=this;e.bitrates.sort(function(e,t){return t.bitrate-e.bitrate}),this.bitrates=e.bitrates,this.classListRemove(this.element,f.default.uiElementHidden),this.qualityMappingMode?(this.bitrates=(0,v.prepareResolutionMapping)(this.bitrates,this.qualityMapping),this.qualityMapping.forEach(function(e){e.bitrates.length<1?t.meister.config.debug&&console.error("No bitrates available for this mapping",e):e.option=t.createOption({type:0,mapping:e})})):this.bitrates.forEach(function(e){var n=0===e.bitrate?"auto":e.bitrate;e.option=t.createOption({type:1,bitrate:n,index:e.index})});var n=parseInt(localStorage.getItem("meister_bitrateIndex"),10),r=(0,y.doesBitrateIndexExist)(this.bitrates,n);!Number.isNaN(n)&&r?this.selectOption(n,!1):this.selectOption(e.currentIndex,!0)}},{key:"createOption",value:function(e){var t=document.createElement("div");if(this.classListAdd(t,g.default.qualitySelectorOption),1===e.type){var n=this.config.bitrateToResolution?this.config.bitrateToResolution:this.meister.utils.bitrateToResolution;(0,y.prepareBitrateOption)(t,e.bitrate,e.index,n)}else 0===e.type&&(0,v.prepareResolutionOption)(t,e.mapping);return this.qualitySelectorOptions.appendChild(t),t}},{key:"selectOption",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=null;n=this.qualityMappingMode?(0,v.selectResolution)(this.qualityMapping,e,t):(0,y.selectBitrate)(this.bitrates,e,t),Number.isFinite(n)&&(this.meister.trigger("requestBitrate",{bitrateIndex:n}),localStorage.setItem("meister_bitrateIndex",n.toString()))}}]),t}(d.default);t.default=b},function(e,t,n){function r(e,t){return{index:t,bitrates:[],from:e.from,to:e.to,resolution:e.resolution}}function i(e,t,n){var r=n.find(function(t){return e>t.from&&e<=t.to});if(!r)return void console.warn("No resolution found for bitrate: "+e);r.bitrates.push({bitrate:e,bitrateIndex:t})}function o(e,t){return e.forEach(function(e){return i(e.bitrate,e.index,t)}),e}function a(e,t){var n=e;t.resolution||console.error("Qualitymapping is missing a resolution-value",t),n.textContent=t.resolution,n.mapping=t}function s(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e.forEach(function(e){e.option&&(e.bitrates.find(function(e){return e.bitrateIndex===t})?e.option.selected.classList.add("pf-icon_icCheck"):e.option.selected.classList.remove("pf-icon_icCheck"))}),n?null:t}Object.defineProperty(t,"__esModule",{value:!0}),t.expandQualityMapping=r,t.prepareResolutionMapping=o,t.prepareResolutionOption=a,t.selectResolution=s},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":r(t))&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":r(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function l(e,t){e.style.webkitTransform="scaleX("+t+")",e.style.transform="scaleX("+t+")"}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),d=n(1),c=i(d),f=n(27),h=i(f),p=n(57),m=i(p),g=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.isDragging=!1,n.loadedMetadata=!1,n.mousedownX=0,n.pagedownX=0,n.element=document.createElement("div"),n.classListAdd(n.element,m.default.wrapper),n.innerElement=document.createElement("div"),n.classListAdd(n.innerElement,m.default.inner),n.element.appendChild(n.innerElement),n.seekbarPadding=document.createElement("div"),n.classListAdd(n.seekbarPadding,m.default.padding),n.innerElement.appendChild(n.seekbarPadding),n.seekbarDuration=document.createElement("div"),n.classListAdd(n.seekbarDuration,m.default.seekbar,m.default.duration),n.innerElement.appendChild(n.seekbarDuration),n.seekbarBuffered=document.createElement("div"),n.classListAdd(n.seekbarBuffered,m.default.seekbar,m.default.buffered),n.innerElement.appendChild(n.seekbarBuffered),n.seekbarBuffered.style.transform="scaleX(0)",n.seekbarFill=document.createElement("div"),n.classListAdd(n.seekbarFill,m.default.seekbar,m.default.fill),n.innerElement.appendChild(n.seekbarFill),n.seekbarFill.style.transform="scaleX(0)",n.seekbarHighlight=document.createElement("div"),n.classListAdd(n.seekbarHighlight,m.default.seekbar,m.default.highlight),n.innerElement.appendChild(n.seekbarHighlight),n.seekbarHighlight.style.transform="scaleX(0)",n.seekbarFigure=document.createElement("div"),n.classListAdd(n.seekbarFigure,m.default.seekDot),n.seekbarDuration.appendChild(n.seekbarFigure),n.seekbarFigure.style.left="0%",n.preview=new h.default(e),n.seekbarDuration.appendChild(n.preview.getNode()),n.on("itemTimeInfo",function(e){return n.onItemTimeInfo(e)}),n.on("playerTimeUpdate",function(e){return n.onTimeUpdate(e)}),n.on("playerSeek",function(e){return n.onPlayerSeek(e)}),n.on("playerProgress",function(e){return n.onPlayerProgress(e)}),n.on("playerLoadedMetadata",function(){n.loadedMetadata=!0}),n.points={},n.on("adCuePoints",function(e){return n.onAdCuePoints(e)}),n.on("adEnded",function(e){return n.onAdEnded(e)}),n.element.addEventListener("mouseover",function(e){return n.onMouseOver(e)}),n.element.addEventListener("mousemove",function(e){return n.onMouseMove(e)}),n.element.addEventListener("mouseout",function(){return n.onMouseOut()}),n.element.addEventListener("mousedown",function(e){return n.onSeekDown(e)}),n.element.addEventListener("touchstart",function(e){return n.onSeekDown(e)}),n.onSeekMove=function(e){e.preventDefault();var t=n.normalizeEventPosition(e);n.isDragging&&(l(n.seekbarFill,t),l(n.seekbarHighlight,t),n.updateFigure(t),n.preview.update(t),n.updateCurrentTime(t))},n.onSeekUp=function(e){window.TouchEvent&&e instanceof window.TouchEvent&&e.touches.length>0||n.isDragging&&(n.wasPlaying&&n.meister.play(),n.isDragging=!1,window.TouchEvent&&e instanceof window.TouchEvent?n.preview.hide():e.target!==n.seekbarPadding&&n.preview.hide(),document.removeEventListener("mousemove",n.onSeekMove),document.removeEventListener("mouseup",n.onSeekUp),document.removeEventListener("touchmove",n.onSeekMove),document.removeEventListener("touchend",n.onSeekUp))},n}return s(t,e),u(t,[{key:"onItemUnloaded",value:function(){var e=this;this.loadedMetadata=!1,this.seekbarBuffered.style.transform="scaleX(0)",this.seekbarHighlight.style.transform="scaleX(0)",this.seekbarFill.style.transform="scaleX(0)",this.seekbarFigure.style.left="0%",Object.keys(this.points).forEach(function(t){null!==e.points[t]&&e.points[t].remove()}),this.points={},this.classListAdd(this.element,"pf-ui-element-hidden")}},{key:"onItemTimeInfo",value:function(e){e.isLive&&!e.hasDVR?this.classListAdd(this.element,"pf-ui-element-hidden"):this.classListRemove(this.element,"pf-ui-element-hidden")}},{key:"onTimeUpdate",value:function(e){var t=e.currentTime/e.duration;l(this.seekbarFill,t),this.updateFigure(t)}},{key:"onPlayerProgress",value:function(e){if(e){var t=e.buffered,n=this.findTimerange(t);if(-1!==n){var r=this.meister.duration,i=t.end(n);this.playOffset&&(i-=this.playOffset,r-=this.playOffset);var o=i/r;l(this.seekbarBuffered,o)}}}},{key:"onMouseOver",value:function(e){if(window.TouchEvent&&e instanceof window.TouchEvent){this.pagedownX=e.touches[0].pageX;var t=this.seekbarPadding.getBoundingClientRect();this.mousedownX=this.pagedownX-t.left}else this.mousedownX=e.offsetX,this.pagedownX=e.pageX;this.preview.show()}},{key:"onMouseMove",value:function(e){var t=this.normalizeEventPosition(e);l(this.seekbarHighlight,t),this.preview.update(t)}},{key:"onMouseOut",value:function(){l(this.seekbarHighlight,0),this.isDragging||this.preview.hide()}},{key:"onSeekDown",value:function(e){e.preventDefault(),this.onMouseOver(e),this.onMouseMove(e),this.wasPlaying=this.meister.playing,this.meister.pause(),this.isDragging=!0;var t=this.normalizeEventPosition(e);l(this.seekbarFill,t),this.updateFigure(t),this.updateCurrentTime(t),document.addEventListener("mousemove",this.onSeekMove),document.addEventListener("mouseup",this.onSeekUp),document.addEventListener("touchmove",this.onSeekMove),document.addEventListener("touchend",this.onSeekUp)}},{key:"onPlayerSeek",value:function(e){var t=e.relativePosition;l(this.seekbarFill,t),l(this.seekbarHighlight,t),this.updateFigure(t)}},{key:"onAdCuePoints",value:function(e){for(var t=0;t<e.points.length;t++)this.setPoint(e.points[t])}},{key:"setPoint",value:function(e){function t(e){var t=document.createElement("div"),r=e/n.meister.duration;n.meister.elementUtils.classListAdd(t,"pf-seek-bar-point","pf-ad-point"),t.id="adpoint-"+e,e<0&&(r=1);var i=100*r;t.style.left=i+"%",n.seekbarDuration.appendChild(t),n.points["adpoint-"+e]=t}var n=this;this.loadedMetadata?t(e):this.one("playerLoadedMetadata",function(){t(e)})}},{key:"onAdEnded",value:function(e){var t=e.ad.getAdPodInfo(),n=document.getElementById("adpoint-"+t.getTimeOffset());delete this.points["adpoint-"+t.getTimeOffset()],null!==n&&n.remove()}},{key:"normalizeEventPosition",value:function(e){var t=0;t=window.TouchEvent&&e instanceof window.TouchEvent?e.touches[e.touches.length-1].pageX:e.pageX;var n=t;n=this.mousedownX+(t-this.pagedownX);var r=n/this.seekbarPadding.offsetWidth;return r>1?r=1:r<0&&(r=0),r}},{key:"updateFigure",value:function(e){var t=100*e;this.seekbarFigure.style.left=t+"%"}},{key:"updateCurrentTime",value:function(e){this.meister.trigger("requestSeek",{relativePosition:e})}},{key:"findTimerange",value:function(e){for(var t=0;t<e.length;t++)if(this.meister.currentTime>=e.start(t)&&this.meister.currentTime<=e.end(t))return t;return-1}}]),t}(c.default);t.default=g},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":r(t))&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":r(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(1),d=i(u),c=n(58),f=i(c),h=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.element=document.createElement("div"),n.classListAdd(n.element,f.default.container,f.default.isHidden),n.seekbarPreviewImage=document.createElement("img"),n.classListAdd(n.seekbarPreviewImage,"pf-seek-bar-preview-image"),n.element.appendChild(n.seekbarPreviewImage),n.seekbarPreviewTime=document.createElement("span"),n.seekbarPreviewTime.textContent="0:00",n.classListAdd(n.seekbarPreviewTime,f.default.previewTime),n.element.appendChild(n.seekbarPreviewTime),n.images=[],n.on("itemTimeInfo",function(e){return n.onItemTimeInfo(e)}),n.on("itemImagestream",function(e){n.images=e.images,n.classListRemove(n.element,"no-preview")}),n}return s(t,e),l(t,[{key:"onItemUnloaded",value:function(){this.isLive=!1,this.modifiedDuration=null,this.images=[],this.classListAdd(this.element,"no-preview")}},{key:"onItemTimeInfo",value:function(e){e.isLive&&(this.isLive=!0,this.modifiedDuration=e.duration)}},{key:"show",value:function(){this.classListRemove(this.element,f.default.isHidden)}},{key:"hide",value:function(){this.classListAdd(this.element,f.default.isHidden)}},{key:"update",value:function(e){var t=this.element.offsetWidth,n=this.element.offsetParent.offsetWidth,r=n-t,i=n*e-t/2;i<0?i=0:i>r&&(i=r),this.element.style.transform="translate("+i+"px)";var o=(this.modifiedDuration||this.meister.duration)*e,a=this.getImageByTime(o);if(a&&(this.seekbarPreviewImage.src=a),this.modifiedDuration){o=this.modifiedDuration-o;var s=this.meister.utils.timeToHMS(Math.round(o));this.seekbarPreviewTime.textContent="-"+s}else this.seekbarPreviewTime.textContent=this.meister.utils.timeToHMS(Math.round(o))}},{key:"getImageByTime",value:function(e){if(0===this.images.length)return"";for(var t=0;t<this.images.length;t++){var n=this.images[t];if(n.start<=e&&n.end>=e)return n.src}return this.images[this.images.length-1].src}}]),t}(d.default);t.default=h},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":r(t))&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":r(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(1),d=i(u),c=n(59),f=i(c),h=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.meister=e,n.element=document.createElement("div"),n.classListAdd(n.element,f.default.container),n.spinner=document.createElement("div"),n.classListAdd(n.spinner,f.default.spinner),n.element.appendChild(n.spinner),n.spinnerMessage=document.createElement("div"),n.classListAdd(n.spinnerMessage,f.default.message),n.element.appendChild(n.spinnerMessage),n.on("playerBufferedEnough",function(){return n.hideSpinner(!0)}),n.on("playerPause",function(){return n.hideSpinner()}),n.on("itemUnloaded",function(){return n.hideSpinner()}),n.on("playerPlay",function(){return n.hideSpinner()}),n.on("showLoading",function(e){return n.showSpinner(e)}),n.on("hideLoading",function(){return n.hideSpinner()}),n}return s(t,e),l(t,[{key:"showSpinner",value:function(e){this.classListRemove(this.element,f.default.hidden),this.classListRemove(this.spinner,f.default.hidden),e&&e.message?(this.spinnerMessage.innerHTML=e.message,this.classListRemove(this.spinnerMessage,f.default.hidden)):e&&e.code&&(this.spinnerMessage.innerHTML=this.meister.Localization.get(e.code),this.classListRemove(this.spinnerMessage,f.default.hidden))}},{key:"hideSpinner",value:function(e){("Buffering..."!==this.spinnerMessage.innerHTML||e)&&(this.classListAdd(this.element,f.default.hidden),this.classListAdd(this.spinner,f.default.hidden),this.classListAdd(this.spinnerMessage,f.default.hidden))}}]),t}(d.default);t.default=h},function(e,t,n){function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":r(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":r(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(1),u=function(e){return e&&e.__esModule?e:{default:e}}(l),d=function(e){function t(e,n){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.config=n,r.element=document.createElement("div"),r.classListAdd(r.element,"pf-ui-element","pf-ui-element-left","pf-ui-element-active"),r.classListAdd(r.element,"pf-icon"),r.classListAdd(r.element,"pf-icon_icStepBackward"),r.element.addEventListener("click",function(){return r.onClick()}),r}return a(t,e),s(t,[{key:"onClick",value:function(){this.meister.trigger("requestSeek",{timeOffset:-1*this.config.stepBack})}}]),t}(u.default);t.default=d},function(e,t,n){function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":r(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":r(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(1),u=function(e){return e&&e.__esModule?e:{default:e}}(l),d=function(e){function t(e,n){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.config=n,r.element=document.createElement("div"),r.classListAdd(r.element,"pf-ui-element","pf-ui-element-left","pf-ui-element-active"),r.classListAdd(r.element,"pf-icon"),r.classListAdd(r.element,"pf-icon_icStepForward"),r.element.addEventListener("click",function(){return r.onClick()}),r}return a(t,e),s(t,[{key:"onClick",value:function(){this.meister.trigger("requestSeek",{timeOffset:this.config.stepForward})}}]),t}(u.default);t.default=d},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":r(t))&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":r(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(1),d=i(u),c=n(60),f=i(c),h=n(0),p=i(h),m=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.element=document.createElement("div"),n.classListAdd(n.element,p.default.uiElement,f.default.container),(n.meister.browser.isIE||n.meister.browser.isEdge)&&n.classListAdd(n.element,"microsoft-hack"),n.currentTime=document.createElement("span"),n.currentTime.innerHTML="0:00",n.classListAdd(n.currentTime,f.default.currentTime),n.seperator=document.createElement("span"),n.seperator.innerHTML="/",n.classListAdd(n.seperator,f.default.seperator),n.duration=document.createElement("span"),n.duration.innerHTML="0:00",n.classListAdd(n.duration,f.default.duration),n.duration.addEventListener("click",function(){return n.meister.trigger("requestGoLive")}),n.element.appendChild(n.currentTime),n.element.appendChild(n.seperator),n.element.appendChild(n.duration),n.isLive=!1,n.on("itemTimeInfo",function(e){return n.onItemTimeInfo(e)}),n.on("playerTimeUpdate",function(e){return n.onTimeUpdate(e)}),n.on("playerSeek",function(e){return n.onPlayerSeek(e)}),n.adTimer=null,n.adDuration=0,n}return s(t,e),l(t,[{key:"onItemUnloaded",value:function(){this.isLive=!1,this.classListRemove(this.duration,"go-live",p.default.uiElementActive),this.currentTime.innerHTML="-",this.duration.innerHTML="-"}},{key:"onItemTimeInfo",value:function(e){e.isLive?(this.isLive=!0,this.duration.innerHTML="LIVE",e.hasDVR||(this.currentTime.innerHTML="-")):this.duration.innerHTML=this.createTimeString(e.duration)}},{key:"onTimeUpdate",value:function(e){if(!this.isLive)return this.currentTime.innerHTML=this.createTimeString(e.currentTime),void(this.duration.innerHTML=this.createTimeString(e.duration));e.duration-e.currentTime<35&&(this.currentTime.innerHTML="-",this.classListRemove(this.duration,"go-live",p.default.uiElementActive))}},{key:"onPlayerSeek",value:function(e){if(!this.isLive)return this.currentTime.innerHTML=this.createTimeString(e.currentTime),void(this.duration.innerHTML=this.createTimeString(e.duration));var t=e.duration-e.currentTime;if(t<35)return this.currentTime.innerHTML="-",void this.classListRemove(this.duration,"go-live",p.default.uiElementActive);var n=this.createTimeString(t);this.currentTime.innerHTML="-"+n,this.classListAdd(this.duration,"go-live",p.default.uiElementActive)}},{key:"createTimeString",value:function(e){var t=Math.round(e);return t<0&&(t=0),this.meister.utils.timeToHMS(t)}}]),t}(d.default);t.default=m},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":r(t))&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":r(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(1),d=i(u),c=n(61),f=i(c),h=n(41),p=n(0),m=i(p),g=(0,h.volumeMuteIcon)(),y=(0,h.volumeLowIcon)(),v=(0,h.volumeMediumIcon)(),_=(0,h.volumeHighIcon)(),b=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.isDragging=!1,n.mousedownY=0,n.pagedownY=0,n.element=document.createElement("div"),n.classListAdd(n.element,m.default.uiElement,f.default.volume),n.meister.browser.isiOS&&!n.meister.config.iosPlaysInline?n.classListAdd(n.element,m.default.uiElementInactive):n.classListAdd(n.element,m.default.uiElementActive),n.volumeButton=document.createElement("div"),n.classListAdd(n.volumeButton,f.default.volumeButton),n.classListAdd(n.volumeButton,m.default.svg,f.default.volumeMute),n.volumeButton.innerHTML=g,n.element.appendChild(n.volumeButton),n.sliderContainer=document.createElement("div"),n.meister.browser.isiOS?n.classListAdd(n.sliderContainer,f.default.container,f.default.isClosed,m.default.uiElementHidden):n.classListAdd(n.sliderContainer,f.default.container,f.default.isClosed),n.element.appendChild(n.sliderContainer),n.sliderInner=document.createElement("div"),n.classListAdd(n.sliderInner,f.default.inner),n.sliderContainer.appendChild(n.sliderInner),n.volumeBar=document.createElement("div"),n.classListAdd(n.volumeBar,f.default.volumeBar),n.sliderInner.appendChild(n.volumeBar),n.volumeBarFill=document.createElement("div"),n.classListAdd(n.volumeBarFill,f.default.volumeBarFill),n.volumeBar.appendChild(n.volumeBarFill),n.volumeBarFigure=document.createElement("div"),n.classListAdd(n.volumeBarFigure,f.default.volumeBarFigure),n.volumeBar.appendChild(n.volumeBarFigure),n.on("playerVolumeChange",function(){return n.onVolumeChange()}),n.on("playerLoadedMetadata",function(){return n.onVolumeChange()}),n.volumeButton.addEventListener("click",function(){return n.onClick()}),n.element.addEventListener("mouseover",function(){return n.showSlider(!0)}),n.element.addEventListener("mouseleave",function(){return n.showSlider(!1)}),n.sliderInner.addEventListener("mousedown",function(e){return n.onDown(e)}),n.sliderInner.addEventListener("touchstart",function(e){return n.onDown(e)}),n.onMove=function(e){n.isDragging&&n.updateBar(e)},n.onUp=function(e){n.isDragging&&(n.isDragging=!1,e.target!==n.sliderInner&&n.showSlider(!1),document.removeEventListener("mousemove",n.onMove),document.removeEventListener("mouseup",n.onUp),document.addEventListener("touchmove",n.onMove),document.addEventListener("touchend",n.onUp))},n}return s(t,e),l(t,[{key:"onDown",value:function(e){if(e.preventDefault(),this.isDragging=!0,window.TouchEvent&&e instanceof window.TouchEvent){this.pagedownY=e.touches[0].pageY;var t=e.target.getBoundingClientRect();this.mousedownY=this.pagedownY-t.top}else this.mousedownY=e.offsetY,this.pagedownY=e.pageY;this.updateBar(e),document.addEventListener("mousemove",this.onMove),document.addEventListener("mouseup",this.onUp),document.addEventListener("touchmove",this.onMove),document.addEventListener("touchend",this.onUp)}},{key:"showSlider",value:function(e){this.isDragging||(e?(this.classListAdd(this.sliderContainer,f.default.isOpen),this.classListRemove(this.sliderContainer,f.default.isClosed)):(this.classListRemove(this.sliderContainer,f.default.isOpen),this.classListAdd(this.sliderContainer,f.default.isClosed)))}},{key:"onClick",value:function(){this.meister.muted=!this.meister.muted,this.meister.trigger("playerVolumeChange")}},{key:"onVolumeChange",value:function(){var e=this.meister.volume;this.meister.muted&&(e=0),this.volumeBarFill.style.transform="scaleY("+e+")";var t=100*e;this.volumeBarFigure.style.bottom=t+"%",this.updateIcon()}},{key:"updateBar",value:function(e){this.meister.muted=!1;var t=this.normalizeEventPosition(e);t>1?t=1:t<0&&(t=0),this.meister.volume=t}},{key:"updateIcon",value:function(){var e=this.meister.volume,t=f.default.volumeMute,n=g;this.meister.muted?(t=f.default.volumeMute,n=g):e<=.33&&e>=.01?(t=f.default.volumeLow,n=y):e>=.33&&e<=.66?(t=f.default.volumeMedium,n=v):e>=.66&&e<=1&&(t=f.default.volumeHigh,n=_),this.classListRemove(this.volumeButton,f.default.volumeMute,f.default.volumeLow,f.default.volumeMedium,f.default.volumeHigh),this.classListAdd(this.volumeButton,t),this.volumeButton.innerHTML=n}},{key:"normalizeEventPosition",value:function(e){var t=0;t=window.TouchEvent&&e instanceof window.TouchEvent?e.touches[e.touches.length-1].pageY:e.pageY;var n=t;n=this.mousedownY+(t-this.pagedownY);var r=1-n/this.volumeBar.offsetHeight;return Math.max(Math.min(r,1),0)}}]),t}(d.default);t.default=b},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t,n){switch(n){case"captionsbutton":return new a.default(e,t);case"fullscreenbutton":return new l.default(e,t);case"playbutton":return new d.default(e,t);case"playlistpreviousbutton":return new c.PlaylistPreviousButton(e,t);case"playlistnextbutton":return new c.PlaylistNextButton(e,t);case"qualitybutton":return new h.default(e,t);case"seekbar":return new m.default(e,t);case"spinner":return new y.default(e,t);case"stepbackbutton":return new _.default(e,t);case"stepforwardbutton":return new E.default(e,t);case"timedisplay":return new S.default(e,t);case"volumeslider":return new w.default(e,t);default:return null}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;var o=n(19),a=r(o),s=n(20),l=r(s),u=n(21),d=r(u),c=n(22),f=n(24),h=r(f),p=n(26),m=r(p),g=n(28),y=r(g),v=n(29),_=r(v),b=n(30),E=r(b),T=n(31),S=r(T),x=n(32),w=r(x)},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=r(i),a=n(4),s=r(a),l=function(e){return'\n<svg class="'+(0,s.default)(o.default.svg,e)+'" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">\n    <path fill="currentColor" d="M14.990778,4 L19.009222,4 C19.2777897,4 19.5243695,4.11070974 19.7117708,4.2928267 C19.8904143,4.4719102 20,4.71851976 20,4.99077797 L20,9.00922203 C20,9.54902482 19.5527519,10 19.0010434,10 L17.9989566,10 C17.4426603,10 17,9.55641359 17,9.00922203 L17,7 L14.990778,7 C14.4509752,7 14,6.55275191 14,6.00104344 L14,4.99895656 C14,4.44266033 14.4435864,4 14.990778,4 Z M14.990778,20 C14.4435864,20 14,19.5573397 14,19.0010434 L14,17.9989566 C14,17.4472481 14.4509752,17 14.990778,17 L17,17 L17,14.990778 C17,14.4435864 17.4426603,14 17.9989566,14 L19.0010434,14 C19.5527519,14 20,14.4509752 20,14.990778 L20,19.009222 C20,19.2814802 19.8904143,19.5280898 19.7117708,19.7071733 C19.5243695,19.8892903 19.2777897,20 19.009222,20 L14.990778,20 Z M9.00922203,4 C9.55641359,4 10,4.44266033 10,4.99895656 L10,6.00104344 C10,6.55275191 9.54902482,7 9.00922203,7 L7,7 L7,9.00922203 C7,9.55641359 6.55733967,10 6.00104344,10 L4.99895656,10 C4.44724809,10 4,9.54902482 4,9.00922203 L4,4.99077797 C4,4.71851976 4.10958568,4.4719102 4.28822924,4.2928267 C4.47563053,4.11070974 4.72221026,4 4.99077797,4 L9.00922203,4 Z M9.00922203,20 L4.99077797,20 C4.72221026,20 4.47563053,19.8892903 4.28822924,19.7071733 C4.10958568,19.5280898 4,19.2814802 4,19.009222 L4,14.990778 C4,14.4509752 4.44724809,14 4.99895656,14 L6.00104344,14 C6.55733967,14 7,14.4435864 7,14.990778 L7,17 L9.00922203,17 C9.54902482,17 10,17.4472481 10,17.9989566 L10,19.0010434 C10,19.5573397 9.55641359,20 9.00922203,20 Z"></path>\n</svg>'};t.default=l},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=r(i),a=n(4),s=r(a),l=function(e){return'\n<svg class="'+(0,s.default)(o.default.svg,e)+'" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">\n    <path fill="currentColor" d="M19.009222,10 L14.990778,10 C14.7222103,10 14.4756305,9.88929026 14.2882292,9.7071733 C14.1095857,9.5280898 14,9.28148024 14,9.00922203 L14,4.99077797 C14,4.45097518 14.4472481,4 14.9989566,4 L16.0010434,4 C16.5573397,4 17,4.44358641 17,4.99077797 L17,7 L19.009222,7 C19.5490248,7 20,7.44724809 20,7.99895656 L20,9.00104344 C20,9.55733967 19.5564136,10 19.009222,10 Z M19.009222,14 C19.5564136,14 20,14.4426603 20,14.9989566 L20,16.0010434 C20,16.5527519 19.5490248,17 19.009222,17 L17,17 L17,19.009222 C17,19.5564136 16.5573397,20 16.0010434,20 L14.9989566,20 C14.4472481,20 14,19.5490248 14,19.009222 L14,14.990778 C14,14.7185198 14.1095857,14.4719102 14.2882292,14.2928267 C14.4756305,14.1107097 14.7222103,14 14.990778,14 L19.009222,14 Z M4.99077797,10 C4.44358641,10 4,9.55733967 4,9.00104344 L4,7.99895656 C4,7.44724809 4.45097518,7 4.99077797,7 L7,7 L7,4.99077797 C7,4.44358641 7.44266033,4 7.99895656,4 L9.00104344,4 C9.55275191,4 10,4.45097518 10,4.99077797 L10,9.00922203 C10,9.28148024 9.89041432,9.5280898 9.71177076,9.7071733 C9.52436947,9.88929026 9.27778974,10 9.00922203,10 L4.99077797,10 Z M4.99077797,14 L9.00922203,14 C9.27778974,14 9.52436947,14.1107097 9.71177076,14.2928267 C9.89041432,14.4719102 10,14.7185198 10,14.990778 L10,19.009222 C10,19.5490248 9.55275191,20 9.00104344,20 L7.99895656,20 C7.44266033,20 7,19.5564136 7,19.009222 L7,17 L4.99077797,17 C4.45097518,17 4,16.5527519 4,16.0010434 L4,14.9989566 C4,14.4426603 4.44358641,14 4.99077797,14 Z"></path>\n</svg>\n'};t.default=l},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=r(i),a=n(4),s=r(a),l=function(e){return'\n<svg class="'+(0,s.default)(o.default.svg,e)+'" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">\n    <path fill="currentColor" d="M15.5797546,11.3085619 C16.1433363,11.6897833 16.1368179,12.3122745 15.5797546,12.6890866 L5.02045486,19.8316732 C4.4568732,20.2128946 4,19.9252466 4,19.1843471 L4,4.81330147 C4,4.07457175 4.46339158,3.78916316 5.02045486,4.16597534 L15.5797546,11.3085619 Z M17,5.00087166 C17,4.4481055 17.4426603,4 17.9989566,4 L19.0010434,4 C19.5527519,4 20,4.44463086 20,5.00087166 L20,18.9991283 C20,19.5518945 19.5573397,20 19.0010434,20 L17.9989566,20 C17.4472481,20 17,19.5553691 17,18.9991283 L17,5.00087166 Z"></path>\n</svg>\n'};t.default=l},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=r(i),a=n(4),s=r(a),l=function(e){return'\n<svg class="'+(0,s.default)(o.default.svg,e)+'" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">\n    <path fill="currentColor" d="M6,4.66712976 C6,4.29868417 6.44335318,4 7.0093689,4 L8.9906311,4 C9.54809015,4 10,4.29831281 10,4.66712976 L10,19.3328702 C10,19.7013158 9.55664682,20 8.9906311,20 L7.0093689,20 C6.45190985,20 6,19.7016872 6,19.3328702 L6,4.66712976 Z M14,4.66712976 C14,4.29868417 14.4433532,4 15.0093689,4 L16.9906311,4 C17.5480902,4 18,4.29831281 18,4.66712976 L18,19.3328702 C18,19.7013158 17.5566468,20 16.9906311,20 L15.0093689,20 C14.4519098,20 14,19.7016872 14,19.3328702 L14,4.66712976 Z" id="pause"></path>\n</svg>\n'};t.default=l},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=r(i),a=n(4),s=r(a),l=function(e){return'\n<svg class="'+(0,s.default)(o.default.svg,e)+'" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">\n    <path fill="currentColor" d="M17.5797546,11.3085619 C18.1433363,11.6897833 18.1368179,12.3122745 17.5797546,12.6890866 L7.02045486,19.8316732 C6.4568732,20.2128946 6,19.9252466 6,19.1843471 L6,4.81330147 C6,4.07457175 6.46339158,3.78916316 7.02045486,4.16597534 L17.5797546,11.3085619 Z" id="play"></path>\n</svg>\n'};t.default=l},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=r(i),a=n(4),s=r(a),l=function(e){return'\n<svg class="'+(0,s.default)(o.default.svg,e)+'" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">\n    <path fill="currentColor" d="M8.42024541,11.3085619 C7.85666375,11.6897833 7.86318212,12.3122745 8.42024541,12.6890866 L18.9795451,19.8316732 C19.5431268,20.2128946 20,19.9252466 20,19.1843471 L20,4.81330147 C20,4.07457175 19.5366084,3.78916316 18.9795451,4.16597534 L8.42024541,11.3085619 Z M7,5.00087166 C7,4.4481055 6.55733967,4 6.00104344,4 L4.99895656,4 C4.44724809,4 4,4.44463086 4,5.00087166 L4,18.9991283 C4,19.5518945 4.44266033,20 4.99895656,20 L6.00104344,20 C6.55275191,20 7,19.5553691 7,18.9991283 L7,5.00087166 Z"></path>\n</svg>\n'};t.default=l},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=r(i),a=n(4),s=r(a),l=function(e){return'\n<svg class="'+(0,s.default)(o.default.svg,e)+'" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">\n    <path fill="currentColor" d="M0,5.99406028 C0,4.8927712 0.897026226,4 2.00494659,4 L21.9950534,4 C23.1023548,4 24,4.89451376 24,5.99406028 L24,18.0059397 C24,19.1072288 23.1029738,20 21.9950534,20 L2.00494659,20 C0.897645164,20 0,19.1054862 0,18.0059397 L0,5.99406028 Z M9,11 L6,11 L6,8 L4,8 L4,16 L6,16 L6,13 L9,13 L9,16 L11,16 L11,8 L9,8 L9,11 Z M16,16 C18.209139,16 20,14.209139 20,12 C20,9.790861 18.209139,8 16,8 L13,8 L13,16 L16,16 Z M15,14 L15,10 L16,10 C17.1045695,10 18,10.8954305 18,12 C18,13.1045695 17.1045695,14 16,14 L15,14 Z"></path>\n</svg>\n'};t.default=l},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.volumeHighIcon=t.volumeMediumIcon=t.volumeLowIcon=t.volumeMuteIcon=void 0;var i=n(0),o=r(i),a=n(4),s=r(a),l=(t.volumeMuteIcon=function(e){return'\n<svg class="'+(0,s.default)(o.default.svg,e)+'" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">\n    <path fill="currentColor" d="M18,10.7529107 L15.5073637,8.2602744 C15.1664641,7.91937486 14.6031064,7.914358 14.2587322,8.25873219 C13.9119571,8.6055073 13.9150485,9.16213774 14.2602744,9.50736367 L16.7529107,12 L14.2602744,14.4926363 C13.9193749,14.8335359 13.914358,15.3968936 14.2587322,15.7412678 C14.6055073,16.0880429 15.1621377,16.0849515 15.5073637,15.7397256 L18,13.2470893 L20.4926363,15.7397256 C20.8335359,16.0806251 21.3968936,16.085642 21.7412678,15.7412678 C22.0880429,15.3944927 22.0849515,14.8378623 21.7397256,14.4926363 L19.2470893,12 L21.7397256,9.50736367 C22.0806251,9.16646413 22.085642,8.60310639 21.7412678,8.25873219 C21.3944927,7.91195709 20.8378623,7.91504847 20.4926363,8.2602744 L18,10.7529107 Z"></path>\n    <path fill="currentColor" d="M1.0093689,8.0749622 C0.451909848,8.0749622 0,8.51944308 0,9.06903369 L0,14.9298135 C0,15.478824 0.443353176,15.923885 1.0093689,15.923885 L4,15.923885 L9.37646484,19.6916936 C10.2772423,20.3229555 11,19.9530982 11,18.872049 L11,5.1267982 C11,4.0451514 10.2731186,3.67878158 9.37646484,4.30715352 L4,8.0749622 L1.0093689,8.0749622 Z"></path>\n</svg>\n'},t.volumeLowIcon=function(e){return'\n<svg class="'+(0,s.default)(o.default.svg,e)+'" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">\n    <path fill="currentColor" d="M14.8284271,14.8284271 C16.3905243,13.26633 16.3905243,10.73367 14.8284271,9.17157288 C14.4379028,8.78104858 13.8047379,8.78104858 13.4142136,9.17157288 C13.0236893,9.56209717 13.0236893,10.1952621 13.4142136,10.5857864 C14.1952621,11.366835 14.1952621,12.633165 13.4142136,13.4142136 C13.0236893,13.8047379 13.0236893,14.4379028 13.4142136,14.8284271 C13.8047379,15.2189514 14.4379028,15.2189514 14.8284271,14.8284271 Z" fill-rule="nonzero"></path>\n    <path fill="currentColor" d="M1.0093689,8.0749622 C0.451909848,8.0749622 0,8.51944308 0,9.06903369 L0,14.9298135 C0,15.478824 0.443353176,15.923885 1.0093689,15.923885 L4,15.923885 L9.37646484,19.6916936 C10.2772423,20.3229555 11,19.9530982 11,18.872049 L11,5.1267982 C11,4.0451514 10.2731186,3.67878158 9.37646484,4.30715352 L4,8.0749622 L1.0093689,8.0749622 Z"></path>\n</svg>\n'},t.volumeMediumIcon=function(e){return'\n<svg class="'+(0,s.default)(o.default.svg,e)+'" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">\n    <path fill="currentColor" d="M14.8284271,14.8284271 C16.3905243,13.26633 16.3905243,10.73367 14.8284271,9.17157288 C14.4379028,8.78104858 13.8047379,8.78104858 13.4142136,9.17157288 C13.0236893,9.56209717 13.0236893,10.1952621 13.4142136,10.5857864 C14.1952621,11.366835 14.1952621,12.633165 13.4142136,13.4142136 C13.0236893,13.8047379 13.0236893,14.4379028 13.4142136,14.8284271 C13.8047379,15.2189514 14.4379028,15.2189514 14.8284271,14.8284271 Z" fill-rule="nonzero"></path>\n    <path fill="currentColor" d="M17.6568542,17.6568542 C20.7810486,14.5326599 20.7810486,9.46734008 17.6568542,6.34314575 C17.26633,5.95262146 16.633165,5.95262146 16.2426407,6.34314575 C15.8521164,6.73367004 15.8521164,7.36683502 16.2426407,7.75735931 C18.5857864,10.1005051 18.5857864,13.8994949 16.2426407,16.2426407 C15.8521164,16.633165 15.8521164,17.26633 16.2426407,17.6568542 C16.633165,18.0473785 17.26633,18.0473785 17.6568542,17.6568542 Z" fill-rule="nonzero"></path>\n    <path fill="currentColor" d="M1.0093689,8.0749622 C0.451909848,8.0749622 0,8.51944308 0,9.06903369 L0,14.9298135 C0,15.478824 0.443353176,15.923885 1.0093689,15.923885 L4,15.923885 L9.37646484,19.6916936 C10.2772423,20.3229555 11,19.9530982 11,18.872049 L11,5.1267982 C11,4.0451514 10.2731186,3.67878158 9.37646484,4.30715352 L4,8.0749622 L1.0093689,8.0749622 Z"></path>\n</svg>\n'},t.volumeHighIcon=function(e){return'\n<svg class="'+(0,s.default)(o.default.svg,e)+'" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">\n    <path fill="currentColor" d="M14.8284271,14.8284271 C16.3905243,13.26633 16.3905243,10.73367 14.8284271,9.17157288 C14.4379028,8.78104858 13.8047379,8.78104858 13.4142136,9.17157288 C13.0236893,9.56209717 13.0236893,10.1952621 13.4142136,10.5857864 C14.1952621,11.366835 14.1952621,12.633165 13.4142136,13.4142136 C13.0236893,13.8047379 13.0236893,14.4379028 13.4142136,14.8284271 C13.8047379,15.2189514 14.4379028,15.2189514 14.8284271,14.8284271 Z" fill-rule="nonzero"></path>\n    <path fill="currentColor" d="M17.6568542,17.6568542 C20.7810486,14.5326599 20.7810486,9.46734008 17.6568542,6.34314575 C17.26633,5.95262146 16.633165,5.95262146 16.2426407,6.34314575 C15.8521164,6.73367004 15.8521164,7.36683502 16.2426407,7.75735931 C18.5857864,10.1005051 18.5857864,13.8994949 16.2426407,16.2426407 C15.8521164,16.633165 15.8521164,17.26633 16.2426407,17.6568542 C16.633165,18.0473785 17.26633,18.0473785 17.6568542,17.6568542 Z" fill-rule="nonzero"></path>\n    <path fill="currentColor" d="M20.4852814,20.4852814 C25.1715729,15.7989899 25.1715729,8.20101013 20.4852814,3.51471863 C20.0947571,3.12419433 19.4615921,3.12419433 19.0710678,3.51471863 C18.6805435,3.90524292 18.6805435,4.5384079 19.0710678,4.92893219 C22.9763107,8.83417511 22.9763107,15.1658249 19.0710678,19.0710678 C18.6805435,19.4615921 18.6805435,20.0947571 19.0710678,20.4852814 C19.4615921,20.8758057 20.0947571,20.8758057 20.4852814,20.4852814 Z" fill-rule="nonzero"></path>\n    <path fill="currentColor" d="M1.0093689,8.0749622 C0.451909848,8.0749622 0,8.51944308 0,9.06903369 L0,14.9298135 C0,15.478824 0.443353176,15.923885 1.0093689,15.923885 L4,15.923885 L9.37646484,19.6916936 C10.2772423,20.3229555 11,19.9530982 11,18.872049 L11,5.1267982 C11,4.0451514 10.2731186,3.67878158 9.37646484,4.30715352 L4,8.0749622 L1.0093689,8.0749622 Z"></path>\n</svg>\n'});t.default=l},function(e,t,n){t=e.exports=n(2)(),t.push([e.i,'.pf-player-container {\n  width: 100%;\n  height: 100%;\n  user-select: none;\n  display: inherit;\n  -ms-user-select: none;\n  -moz-user-select: none;\n  -webkit-user-select: none;\n  font-family: "Arial";\n  overflow: hidden; }\n  .pf-player-container:focus {\n    border: none;\n    outline-width: 0; }\n  .pf-player-container .pf-default-wrapper {\n    background-color: black;\n    position: relative;\n    width: 100%;\n    height: 100%; }\n  .pf-player-container .pf-player, .pf-player-container .pf-player video, .pf-player-container .pf-player audio {\n    width: 100%;\n    height: 100%;\n    display: inherit; }\n  .pf-player-container .pf-player .pf-audio-image {\n    height: 100%;\n    margin: 0 auto;\n    text-align: center;\n    display: block; }\n  .pf-player-container .pf-ads {\n    width: 100%;\n    height: 100%;\n    display: block;\n    position: absolute;\n    top: 0;\n    left: 0; }\n  .pf-player-container .pf-controls {\n    width: 100%;\n    height: 100%;\n    position: absolute;\n    top: 0px; }\n\n.mstr-hide-controls {\n  animation: hide-bars-animation 0.4s forwards; }\n\n.pf-ui-element-hidden {\n  visibility: hidden !important;\n  width: 0px !important; }\n\n.mstr-container,\n.mstr-container * {\n  box-sizing: border-box; }\n\n.mstr-container {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%; }\n\n.mstr-bottombar {\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  padding: 15px;\n  width: 100%;\n  background-image: linear-gradient(to top, black 0%, rgba(0, 0, 0, 0.738) 19%, rgba(0, 0, 0, 0.541) 34%, rgba(0, 0, 0, 0.382) 47%, rgba(0, 0, 0, 0.278) 56.5%, rgba(0, 0, 0, 0.194) 65%, rgba(0, 0, 0, 0.126) 73%, rgba(0, 0, 0, 0.075) 80.2%, rgba(0, 0, 0, 0.042) 86.1%, rgba(0, 0, 0, 0.021) 91%, rgba(0, 0, 0, 0.008) 95.2%, rgba(0, 0, 0, 0.002) 98.2%, transparent 100%); }\n\n.mstr-centerbar {\n  position: absolute;\n  top: 50%;\n  left: 0;\n  width: 100%;\n  transform: translateY(-50%);\n  text-align: center; }\n\n.mstr-items {\n  display: table;\n  position: relative; }\n\n.mstr-item {\n  color: white;\n  display: table-cell;\n  width: auto;\n  vertical-align: middle;\n  padding: 0 10px; }\n\n.mstr-item--fill {\n  width: 100%; }\n\n@keyframes show-bars-animation {\n  0% {\n    width: 0;\n    opacity: 0; }\n  1% {\n    width: 100%;\n    opacity: 0.01; }\n  100% {\n    width: 100%;\n    opacity: 1; } }\n\n@keyframes hide-bars-animation {\n  0% {\n    width: 100%;\n    opacity: 1; }\n  99% {\n    width: 100%;\n    opacity: 0.01; }\n  100% {\n    width: 0;\n    opacity: 0; } }\n',""])},function(e,t,n){t=e.exports=n(2)(),t.push([e.i,"",""])},function(e,t,n){t=e.exports=n(2)(),t.push([e.i,"._3-7jdtXGk4-IHrW24dLF4t {\n  display: block; }\n",""]),t.locals={button:"_3-7jdtXGk4-IHrW24dLF4t"}},function(e,t,n){t=e.exports=n(2)(),t.push([e.i,"._2DjGpA6bpztzCIAHvLvgPU {\n  width: 62px; }\n",""]),t.locals={container:"_2DjGpA6bpztzCIAHvLvgPU"}},function(e,t,n){t=e.exports=n(2)(),t.push([e.i,"._2BkoXnFkGWrot4AcrmAdbW {\n  cursor: pointer;\n  pointer-events: all;\n  color: #FFF; }\n\n._1L-Qm5xHQu3dqpQbSGrwcf {\n  cursor: not-allowed;\n  pointer-events: none;\n  color: #FFF;\n  opacity: .8; }\n\n._1Svz3o9fO5ftw5nQmQvFqL {\n  display: none;\n  visibility: hidden; }\n\n._1nCAdn1flNYjKcqsd3vMgY {\n  display: block;\n  width: 30px;\n  height: 30px;\n  color: #FFF; }\n\n._2GjwLTf0ojMGQEkCzNc9Qz {\n  position: relative; }\n\n._1rkEbgdPOWi_wGc1u2I8d- {\n  position: absolute;\n  right: 0;\n  bottom: 100%;\n  padding-bottom: 15px; }\n  ._1rkEbgdPOWi_wGc1u2I8d-._1RtEWhu3XHXTFoQMs8Bq11 {\n    display: none; }\n\n._3h9pYFHPU_F9zDvpJizvfB {\n  padding: 6px 20px;\n  background-color: rgba(0, 0, 0, 0.8);\n  border-radius: 5px; }\n\n._3rREDsf0Lm5GHZCgo2IN2x {\n  color: rgba(255, 255, 255, 0.8);\n  padding: 10px 10px;\n  border-bottom: 1px solid #FFF; }\n  ._3rREDsf0Lm5GHZCgo2IN2x:last-child {\n    border-bottom: none; }\n  ._3rREDsf0Lm5GHZCgo2IN2x._1casQPYrLP1EAJDS5j5lKU {\n    color: #FFF; }\n",""]),t.locals={uiElementActive:"_2BkoXnFkGWrot4AcrmAdbW",uiElementInactive:"_1L-Qm5xHQu3dqpQbSGrwcf",uiElementHidden:"_1Svz3o9fO5ftw5nQmQvFqL",svg:"_1nCAdn1flNYjKcqsd3vMgY",element:"_2GjwLTf0ojMGQEkCzNc9Qz",qualitySelector:"_1rkEbgdPOWi_wGc1u2I8d-",isClosed:"_1RtEWhu3XHXTFoQMs8Bq11",qualitySelectorOptions:"_3h9pYFHPU_F9zDvpJizvfB",qualitySelectorOption:"_3rREDsf0Lm5GHZCgo2IN2x",isActive:"_1casQPYrLP1EAJDS5j5lKU"}},function(e,t,n){t=e.exports=n(2)(),t.push([e.i,"._3HNF4mRUnlhEUDRmRaL1FM {\n  cursor: pointer;\n  pointer-events: all;\n  color: #FFF; }\n\n._1fkLzlfvHZyF5l8gNKYlco {\n  cursor: not-allowed;\n  pointer-events: none;\n  color: #FFF;\n  opacity: .8; }\n\n._9TlMiMIkS6_5UIbC4_9Z_ {\n  display: none;\n  visibility: hidden; }\n\n.WpxVeEvSo_e6KuqcoxKKr {\n  display: block;\n  width: 30px;\n  height: 30px;\n  color: #FFF; }\n\n._2SLCqo9Zre3N_OuQBP5thQ {\n  padding: 10px 0;\n  position: relative;\n  box-sizing: content-box; }\n\n._1l06Jxfs-cgi6Wcnpf8tmc {\n  height: 3px;\n  position: relative; }\n\n._2FVb2TWUbZctFiLbyVV9wY {\n  width: 100%;\n  height: 100%;\n  position: relative;\n  z-index: 9; }\n\n._3KzTOKXIZbO-JnBB32uw9c {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  transform-origin: left center; }\n  ._3KzTOKXIZbO-JnBB32uw9c.EFV1Lvft1DlZC6-WbFj1r {\n    pointer-events: none;\n    background-color: #FFF; }\n  ._3KzTOKXIZbO-JnBB32uw9c.-ZCQKxdC1HEEx4bPpfAfL {\n    pointer-events: none;\n    background-color: rgba(255, 255, 255, 0.2); }\n  ._3KzTOKXIZbO-JnBB32uw9c._3tvc80_K6TWURvVOO4MMoJ {\n    pointer-events: none;\n    background-color: #19c3dd; }\n  ._3KzTOKXIZbO-JnBB32uw9c._39O-7yA5EIqvAL-b7vTyf {\n    pointer-events: none;\n    background-color: #19c3dd; }\n\n._2iqZwCTAxrfF5VqEChdLit {\n  position: absolute;\n  top: 0;\n  left: 0;\n  z-index: 1;\n  width: 13px;\n  height: 13px;\n  border-radius: 50%;\n  background-color: #FFF;\n  transform: translate(-50%, -25%); }\n",""]),t.locals={uiElementActive:"_3HNF4mRUnlhEUDRmRaL1FM",uiElementInactive:"_1fkLzlfvHZyF5l8gNKYlco",uiElementHidden:"_9TlMiMIkS6_5UIbC4_9Z_",svg:"WpxVeEvSo_e6KuqcoxKKr",wrapper:"_2SLCqo9Zre3N_OuQBP5thQ",inner:"_1l06Jxfs-cgi6Wcnpf8tmc",padding:"_2FVb2TWUbZctFiLbyVV9wY",seekbar:"_3KzTOKXIZbO-JnBB32uw9c",duration:"EFV1Lvft1DlZC6-WbFj1r",buffered:"-ZCQKxdC1HEEx4bPpfAfL",fill:"_3tvc80_K6TWURvVOO4MMoJ",highlight:"_39O-7yA5EIqvAL-b7vTyf",seekDot:"_2iqZwCTAxrfF5VqEChdLit"}},function(e,t,n){t=e.exports=n(2)(),t.push([e.i,"._1NqeSe-8TiiitC92PrK5V6 {\n  cursor: pointer;\n  pointer-events: all;\n  color: #FFF; }\n\n.gSKNiCBwJzI_CuN4a5PXT {\n  cursor: not-allowed;\n  pointer-events: none;\n  color: #FFF;\n  opacity: .8; }\n\n._1NmNo3BcjIiEb9F1ore73P {\n  display: none;\n  visibility: hidden; }\n\n.wIaEO9c3JIYl_RHqMklus {\n  display: block;\n  width: 30px;\n  height: 30px;\n  color: #FFF; }\n\n._2PNu7_mVapP8YTuo16N25l {\n  color: #FFF;\n  position: absolute;\n  left: 0;\n  bottom: 100%;\n  color: white;\n  pointer-events: none; }\n  ._2PNu7_mVapP8YTuo16N25l ._2-pCqztMpeQXeI3qV-zMa6 {\n    position: relative;\n    display: block;\n    padding: 5px;\n    background-color: rgba(0, 0, 0, 0.8);\n    color: #FFF;\n    transform: translateY(-16px);\n    opacity: 1;\n    transition: all 150ms ease-in-out;\n    font-size: .8em; }\n    ._2PNu7_mVapP8YTuo16N25l ._2-pCqztMpeQXeI3qV-zMa6:after {\n      content: '';\n      position: absolute;\n      left: 50%;\n      bottom: -10px;\n      transform: translateX(-50%);\n      display: block;\n      border-top: 5px rgba(0, 0, 0, 0.8) solid;\n      border-bottom: 5px transparent solid;\n      border-left: 6px transparent solid;\n      border-right: 6px transparent solid; }\n  ._2PNu7_mVapP8YTuo16N25l._2pqaVb1dIsg92NjxMjnEDm ._2-pCqztMpeQXeI3qV-zMa6 {\n    transform: translateY(0);\n    opacity: 0; }\n",""]),t.locals={uiElementActive:"_1NqeSe-8TiiitC92PrK5V6",uiElementInactive:"gSKNiCBwJzI_CuN4a5PXT",uiElementHidden:"_1NmNo3BcjIiEb9F1ore73P",svg:"wIaEO9c3JIYl_RHqMklus",container:"_2PNu7_mVapP8YTuo16N25l",previewTime:"_2-pCqztMpeQXeI3qV-zMa6",isHidden:"_2pqaVb1dIsg92NjxMjnEDm"}},function(e,t,n){t=e.exports=n(2)(),t.push([e.i,"._1d0zv-YPmo1Ldno5TIUoEa {\n  cursor: pointer;\n  pointer-events: all;\n  color: #FFF; }\n\n._20AZqi0DFj0l7W2MSMC0K {\n  cursor: not-allowed;\n  pointer-events: none;\n  color: #FFF;\n  opacity: .8; }\n\n.k7AdDQ9UeafLwrS3oMDMB {\n  display: none;\n  visibility: hidden; }\n\n.Zhc3tWX4acnrOslNR6TeC {\n  display: block;\n  width: 30px;\n  height: 30px;\n  color: #FFF; }\n\n._3evMdf81zHb9adbp8ayXKg {\n  text-align: center;\n  display: inline-block; }\n\n._1_0YxXFDEW3QGMIEn1l0UW {\n  display: inline-block;\n  width: 3em;\n  height: 3em;\n  border-radius: 50%;\n  border: 3px solid #FFF;\n  border-bottom-color: transparent;\n  background-color: rgba(0, 0, 0, 0.4);\n  animation: _3dUNERw2qIIYEGsihFBEZq 1s linear forwards infinite;\n  box-shadow: 0 0 0 3px rgba(0, 0, 0, 0.4); }\n\n._34DF9shkBnJYlpUMBOhf84 {\n  font-size: 1em;\n  margin-top: .4em;\n  padding: .4em 1em;\n  color: #FFF;\n  background-color: rgba(0, 0, 0, 0.4);\n  border-radius: 5px; }\n\n._2VIkdLXXt3VfC7JWCLHXfq {\n  display: none; }\n\n@keyframes _3dUNERw2qIIYEGsihFBEZq {\n  from {\n    transform: rotate(0deg); }\n  to {\n    transform: rotate(360deg); } }\n",""]),t.locals={uiElementActive:"_1d0zv-YPmo1Ldno5TIUoEa",uiElementInactive:"_20AZqi0DFj0l7W2MSMC0K",uiElementHidden:"k7AdDQ9UeafLwrS3oMDMB",svg:"Zhc3tWX4acnrOslNR6TeC",container:"_3evMdf81zHb9adbp8ayXKg",spinner:"_1_0YxXFDEW3QGMIEn1l0UW",spinSpinner:"_3dUNERw2qIIYEGsihFBEZq",message:"_34DF9shkBnJYlpUMBOhf84",hidden:"_2VIkdLXXt3VfC7JWCLHXfq"}},function(e,t,n){t=e.exports=n(2)(),t.push([e.i,"._3eQbS0Zn_3j-9Xm9wBsK1P {\n  white-space: nowrap; }\n\n._2B9-HeFA7C4xARoMI9cCKn {\n  display: inline-block;\n  padding: 0 .1em; }\n",""]),t.locals={container:"_3eQbS0Zn_3j-9Xm9wBsK1P",seperator:"_2B9-HeFA7C4xARoMI9cCKn"}},function(e,t,n){t=e.exports=n(2)(),t.push([e.i,".v5t06TRsOeMUDMQnYoyPM {\n  cursor: pointer;\n  pointer-events: all;\n  color: #FFF; }\n\n.Q1Suh1PnogvUjYp5fDcg9 {\n  cursor: not-allowed;\n  pointer-events: none;\n  color: #FFF;\n  opacity: .8; }\n\n._1M8QRzyDMWTYCenJKZ4c5t {\n  display: none;\n  visibility: hidden; }\n\n.uJYQ0qTl7XvHLKoiCSy4e {\n  display: block;\n  width: 30px;\n  height: 30px;\n  color: #FFF; }\n\n._2GflfmqwaYB2qLzX2ey8p8 {\n  position: relative; }\n\n._16fXrOcWTt7zR7RfJV-cDc {\n  position: absolute;\n  bottom: 100%;\n  left: 50%;\n  transform: translateX(-50%);\n  padding-bottom: 15px; }\n  ._16fXrOcWTt7zR7RfJV-cDc._3g6zNZaiv9EzypziOuhuoH {\n    display: none; }\n\n._2de5BsC_TROol822hJDj2c {\n  padding: 16px 18px;\n  background-color: rgba(0, 0, 0, 0.8);\n  border-radius: 5px; }\n\n.urVWpavSqihMZbXG2J7sk {\n  position: relative;\n  height: 100px;\n  width: 3px;\n  background-color: #FFF; }\n\n._2Xy-XF0I43HeNHwPvSg2qI {\n  position: relative;\n  height: 100%;\n  background-color: #19c3dd;\n  transform-origin: bottom center; }\n\n._1JBxjTYI2aPUth7YdIJH7r {\n  position: absolute;\n  bottom: 0;\n  left: 50%;\n  width: 13px;\n  height: 13px;\n  border-radius: 50%;\n  background-color: #FFF;\n  transform: translate(-50%, 50%); }\n",""]),t.locals={uiElementActive:"v5t06TRsOeMUDMQnYoyPM",uiElementInactive:"Q1Suh1PnogvUjYp5fDcg9",uiElementHidden:"_1M8QRzyDMWTYCenJKZ4c5t",svg:"uJYQ0qTl7XvHLKoiCSy4e",volume:"_2GflfmqwaYB2qLzX2ey8p8",container:"_16fXrOcWTt7zR7RfJV-cDc",isClosed:"_3g6zNZaiv9EzypziOuhuoH",inner:"_2de5BsC_TROol822hJDj2c",volumeBar:"urVWpavSqihMZbXG2J7sk",volumeBarFill:"_2Xy-XF0I43HeNHwPvSg2qI",volumeBarFigure:"_1JBxjTYI2aPUth7YdIJH7r"}},function(e,t,n){t=e.exports=n(2)(),t.push([e.i,".OZ4P-74HjncIZPPMIe1FP {\n  cursor: pointer;\n  pointer-events: all;\n  color: #FFF; }\n\n._K2hZrPaL1ViV8PoFwKqV {\n  cursor: not-allowed;\n  pointer-events: none;\n  color: #FFF;\n  opacity: .8; }\n\n._1-mv6TpMQsZ7SVRwjGyts1 {\n  display: none;\n  visibility: hidden; }\n\n._3M5Ou7Yb--qH26Gz3F-Plp {\n  display: block;\n  width: 30px;\n  height: 30px;\n  color: #FFF; }\n",""]),t.locals={uiElementActive:"OZ4P-74HjncIZPPMIe1FP",uiElementInactive:"_K2hZrPaL1ViV8PoFwKqV",uiElementHidden:"_1-mv6TpMQsZ7SVRwjGyts1",svg:"_3M5Ou7Yb--qH26Gz3F-Plp"}},function(e,t,n){var r=n(42);"string"==typeof r&&(r=[[e.i,r,""]]),n(3)(r,{sourceMap:!0}),r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(43);"string"==typeof r&&(r=[[e.i,r,""]]),n(3)(r,{sourceMap:!0}),r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(44);"string"==typeof r&&(r=[[e.i,r,""]]),n(3)(r,{sourceMap:!0}),r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(45);"string"==typeof r&&(r=[[e.i,r,""]]),n(3)(r,{sourceMap:!0}),r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(47);"string"==typeof r&&(r=[[e.i,r,""]]),n(3)(r,{sourceMap:!0}),r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(48);"string"==typeof r&&(r=[[e.i,r,""]]),n(3)(r,{sourceMap:!0}),r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(49);"string"==typeof r&&(r=[[e.i,r,""]]),n(3)(r,{sourceMap:!0}),r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(50);"string"==typeof r&&(r=[[e.i,r,""]]),n(3)(r,{sourceMap:!0}),r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(51);"string"==typeof r&&(r=[[e.i,r,""]]),n(3)(r,{sourceMap:!0}),r.locals&&(e.exports=r.locals)},function(e,t){e.exports={name:"@meisterplayer/plugin-htmlui",version:"5.5.1",description:"HTML based userinterface with preconfigured elements. Can be used to create your own userinterface",main:"dist/HtmlUi.js",keywords:["meister","plugin","ui","custom"],scripts:{lint:"eslint ./src/js",test:"jest","test:coverage":"jest --coverage",build:"gulp build",dist:"gulp build:min && gulp build:dist"},author:"Triple",license:"Apache-2.0",devDependencies:{"@meisterplayer/meister-mock":"^1.0.0","babel-preset-es2015":"^6.24.1","babel-preset-es2017":"^6.24.1",gulp:"^3.9.1",jest:"^20.0.4","meister-gulp-webpack-tasks":"^1.0.11","meister-js-dev":"^3.1.0",yargs:"^8.0.1"},jest:{moduleNameMapper:{"^.+\\.(s?css|less)$":"<rootDir>/__mocks__/styleStub.js"}}}},function(e,t,n){e.exports=n(9)}])},function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports=function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/",t(t.s=3)}([function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=function(e){return e&&e.__esModule?e:{default:e}}(r);t.default=i.default},function(e,t,n){function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":r(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":r(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"===r(Symbol.iterator)?function(e){return void 0===e?"undefined":r(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":r(e)},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},d=n(2),c=function(e){return e&&e.__esModule?e:{default:e}}(d),f=function(e){function t(){return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),l(t,[{key:"isItemSupported",value:function(e){return new Promise(function(t){return t("multi-source"!==e.type?{supported:!1,errorCode:Meister.ErrorCodes.WRONG_TYPE}:{supported:!0})})}},{key:"restructureItems",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[],r=0;r<e.length;r+=1){var i=e[r];Object.prototype.hasOwnProperty.call(i,"drm")||(i.drm=t),n.push(i)}return n}},{key:"getItemToPlay",value:function(e){var t=this,n=e[0];return this.meister.pluginLoader.getPluginByItem(n).then(function(r){return r.errorCode&&e.length>1?(e.shift(),t.getItemToPlay(e)):r.errorCode?(t.meister.error("Could not find plugin to play type: '"+n.type+"'.","MLTSRC-0001",{title:"Unable to play content."}),null):n})}},{key:"process",value:function(e){var t=this;return e.src&&!e.sources&&(e.sources=e.src),this.currentItem=e,void 0===this.currentItem.switchItemOnError&&(this.currentItem.switchItemOnError=!0),new Promise(function(n,r){var i="object"===s(e.drmConfig);e.sources=t.restructureItems(e.sources,i),t.getItemToPlay(e.sources).then(function(i){null==i?r(e):(e.metadata&&(i.metadata=e.metadata),t.currentItem.switchItemOnError&&t.on("playerError",t.onPlayerError.bind(t)),n(i))})})}},{key:"onPlayerError",value:function(){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"unload",this).call(this);var e=this.currentItem.sources.shift();this.currentItem.sources.length&&(console.warn(t.pluginName+": Item '"+e.type+"' ran into an error while playing. Switching items for optimal experience."),this.meister.setItem(this.currentItem),this.meister.load())}}],[{key:"pluginName",get:function(){return"MultiSource"}},{key:"pluginVersion",get:function(){return c.default.version}}]),t}(Meister.ParserPlugin);Meister.registerPlugin(f.pluginName,f),Meister.registerPlugin("multisource",f),t.default=f},function(e,t){e.exports={name:"@meisterplayer/plugin-multisource",version:"5.2.0",description:"Meister plugin for having multiple sources in one item",main:"dist/MultiSource.js",keywords:["meister","video","plugin"],repository:{type:"git",url:"https://github.com/meisterplayer/parser-multisource.git"},author:"Triple",license:"Apache-2.0",devDependencies:{"meister-gulp-webpack-tasks":"^1.0.6","meister-js-dev":"^3.1.0","babel-preset-es2015":"^6.24.0","babel-preset-es2017":"^6.22.0",gulp:"^3.9.1"}}},function(e,t,n){e.exports=n(0)}])},function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports=function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/",t(t.s=5)}([function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=function(e){return e&&e.__esModule?e:{default:e}}(r);t.default=i.default},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(i,o){try{var a=t[i](o),s=a.value}catch(e){return void n(e)}if(!a.done)return Promise.resolve(s).then(function(e){r("next",e)},function(e){r("throw",e)});e(s)}return r("next")})}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":r(t))&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":r(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u="function"==typeof Symbol&&"symbol"===r(Symbol.iterator)?function(e){return void 0===e?"undefined":r(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":r(e)},d=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},f=n(3),h=i(f),p=n(4),m=i(p),g=n(2),y=i(g),v=function(e){function t(e,n,r){a(this,t);var i=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i.manifestParsed=!1,i.audioMode=!1,i.next=r,i.previousLevel=-1,i.lowestLevel=0,i.dvrThreshold=i.config.dvrThreshold,void 0===i.dvrThreshold&&(i.dvrThreshold=300),i.mediaDuration=0,i.endTime=0,i.beginTime=0,i.mediaSequence=0,i.lastMediaSequence=0,i.childManifest=null,i.qualityStreams=[],i.masterPlaylist=null,i.baseEndTime=0,i.manifestTimeoutId=null,i.pollResolutionId=null,i.currentResolution={width:0,height:0},i.name="nativeHLS",i.events=[],i}return l(t,e),d(t,[{key:"isItemSupported",value:function(e){var t=this;return new Promise(function(n){"m3u8"!==e.type&&"m3u"!==e.type&&n({supported:!1,errorCode:Meister.ErrorCodes.WRONG_TYPE}),(!t.meister.browser.isSafari||!t.meister.browser.isiOS&&t.config.safariDesktopDisabled)&&(t.meister.browser.isFacebook||t.meister.browser.isiOS||n({supported:!1,errorCode:Meister.ErrorCodes.NOT_SUPPORTED})),e.drm||e.drmConfig?(t.meister.one("drmKeySystemSupport",function(e){var t=!1;Object.keys(e).forEach(function(n){("com.apple.fps"===n&&e[n]||"com.apple.fps.1_0"===n&&e[n]||"com.apple.fps.2_0"===n&&e[n])&&(t=!0)}),n({supported:t,errorCode:t?null:Meister.ErrorCodes.NO_DRM})}),t.meister.trigger("requestDrmKeySystemSupport",{})):n({supported:!0})})}},{key:"resetPrivates",value:function(){this.previousMetadata=null,this.manifestParsed=!1,this.previousLevel=-1,this.lowestLevel=0,this.mediaDuration=0,this.item=null}},{key:"process",value:function(e){var t=this;return this.next(e).then(function(e){return t.player=t.meister.getPlayerByType("html5",e),t.meister.config.audioOnly||"audio"===e.mediaType?t.audioMode=!0:t.audioMode=!1,e}).catch(function(e){console.error("Something went wrong while processing middlewares. "+e)})}},{key:"load",value:function(){function e(e){return n.apply(this,arguments)}var n=o(regeneratorRuntime.mark(function e(n){var r,i,o,a,s=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"load",this).call(this,n),this.item=n,this.mediaElement=this.player.mediaElement,this.mediaElement.src=n.src,this.masterPlaylist=n.src,this.on("requestBitrate",this.onRequestBitrate.bind(this)),this.on("requestGoLive",function(){return s.onRequestGoLive()}),this.mediaElement.textTracks.addEventListener("addtrack",this.onAddTextTrack.bind(this)),this.pollResolutionId=setInterval(this.pollResolution.bind(this),1e3),e.next=11,this.loadManifest(n.src);case 11:r=e.sent,r.keyInfo&&r.keyInfo.URI&&(i=r.keyInfo.URI.replace("skd:","https:"),this.meister.trigger("drmLicenseInfoAvailable",{fairplay:{drmServerUrl:i}})),this.endTime=r.duration,this.baseEndTime=this.endTime,this.mediaDuration=r.duration,this.mediaSequence=r.mediaSequence,this.beginTime=this.endTime-this.mediaDuration,o=Object.keys(r.segments)[Object.keys(r.segments).length-1],this.lastMediaSequence=o,a=r.duration>this.dvrThreshold&&r.isLive,!1===this.config.dvrEnabled&&(a=!1),this.meister.trigger("itemTimeInfo",{isLive:r.isLive,hasDVR:a,duration:this.mediaDuration,modifiedDuration:this.mediaDuration,endTime:this.endTime}),n.startFromBeginning?"object"===u(n.startFromBeginning)?this.onRequestSeek({relativePosition:n.startFromBeginning.offset/this.duration}):isNaN(this.meister.duration)?this.meister.one("playerCanPlay",function(){s.meister.currentTime=0}):this.meister.currentTime=0:r.isLive&&this.onRequestGoLive(),this.manifestTimeoutId=setTimeout(function(){s.getNewManifest()},5e3);case 25:case"end":return e.stop()}},e,this)}));return e}()},{key:"_onPlayerTimeUpdate",value:function(){var e=this.endTime-this.mediaDuration;this.meister.trigger("playerTimeUpdate",{currentTime:this.player.currentTime-e,duration:this.mediaDuration})}},{key:"_onPlayerSeek",value:function(){var e=this.endTime-this.mediaDuration,t=this.player.currentTime-e,n=this.mediaDuration,r=t/n;this.meister.trigger("playerSeek",{relativePosition:r,currentTime:t,duration:n})}},{key:"onRequestSeek",value:function(e){var t=void 0;if(Number.isFinite(e.relativePosition)){var n=this.endTime-this.mediaDuration;t=this.mediaDuration*e.relativePosition+n}else if(Number.isFinite(e.timeOffset))t=this.player.currentTime+e.timeOffset;else if(Number.isFinite(e.targetTime)){var r=this.endTime-this.mediaDuration;t=e.targetTime+r}!e.forcedStart&&this.blockSeekForward&&t>this.player.currentTime||Number.isFinite(t)&&(this.player.currentTime=t)}},{key:"onAddTextTrack",value:function(e){var t=this,n=e.track;n.mode="hidden",n.addEventListener("cuechange",function(e){var n=e.target,r=Array.from(n.activeCues).filter(function(e){return"org.id3"===e.type}),i=r.map(function(e){return new y.default(e.value.key,e.value.data,e.startTime,e.endTime)});t.meister.trigger("id3Tags",i)})}},{key:"onRequestGoLive",value:function(){var e=this;isNaN(this.player.duration)?this.meister.one("playerLoadedMetadata",function(){e.onRequestGoLive()}):this.player.currentTime=this.endTime-30}},{key:"onRequestBitrate",value:function(e){var t=this,n=this.player.currentTime,r=this.meister.playing;e.drmConfig&&this.meister.trigger("drmConfig",e.drmConfig),this.meister.playerPlugin.mediaElement.src="",-1===e.bitrateIndex?this.meister.playerPlugin.mediaElement.src=this.masterPlaylist:this.meister.playerPlugin.mediaElement.src=this.meister.utils.resolveUrl(this.masterPlaylist,this.qualityStreams[e.bitrateIndex].url),this.playOffset=0,this.endTime=this.baseEndTime,this.meister.one("playerLoadedMetadata",function(){t.player.currentTime=n,r?t.meister.play():t.meister.pause()})}},{key:"onError",value:function(e,t){console.warn("Error in "+this.name+", type: "+t.details+", will attempt to recover."),t.fatal&&console.error("Can not recover from "+t.type+": "+t.details+".")}},{key:"pollResolution",value:function(){var e=this.mediaElement.videoHeight,t=this.mediaElement.videoWidth;if(this.currentResolution.width!==t||this.currentResolution.height!==e){var n=this.qualityStreams.find(function(n){return n.resolution&&n.resolution.width===t&&n.resolution.height===e});if(n){var r=this.qualityStreams.indexOf(n);this.meister.trigger("playerAutoSwitchBitrate",{newBitrate:parseInt(n.bandwith,10),newBitrateIndex:r}),this.currentResolution=n.resolution}}}},{key:"getNewManifest",value:function(){function e(){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark(function e(){var t,n,r,i,o,a=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.loadManifest(this.childManifest);case 3:for(t=e.sent,n=Object.keys(t.segments)[Object.keys(t.segments).length-1],r=n-this.lastMediaSequence,i=0;i<r;i+=1)this.endTime+=t.segments[Object.keys(t.segments)[i]];this.mediaDuration=t.duration,this.beginTime=this.endTime-t.duration,this.lastMediaSequence=n,o=t.duration>this.dvrThreshold&&t.isLive,!1===this.config.dvrEnabled&&(o=!1),this.meister.trigger("itemTimeInfo",{isLive:t.isLive,hasDVR:o,duration:this.mediaDuration,modifiedDuration:this.mediaDuration,endTime:this.endTime}),this.manifestTimeoutId=setTimeout(function(){a.getNewManifest()},5e3),e.next=20;break;case 16:e.prev=16,e.t0=e.catch(0),console.warn("WARNING: Could not load manifest, retrying loading manifest.",e.t0),this.manifestTimeoutId=setTimeout(function(){a.getNewManifest()},5e3);case 20:case"end":return e.stop()}},e,this,[[0,16]])}));return e}()},{key:"loadManifest",value:function(){function e(e){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark(function e(t){var n,r,i,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:return n=e.sent,e.next=5,n.text();case 5:if(r=e.sent,i=new h.default(r),o=i.parse(),!o.streams.length){e.next=13;break}return this.config.filterAudioOnly?this.qualityStreams=o.streams.filter(function(e){return e.resolution}):this.qualityStreams=o.streams,this.onQualitysAvailable(),this.childManifest=this.meister.utils.resolveUrl(t,o.streams[0].url),e.abrupt("return",this.loadManifest(this.meister.utils.resolveUrl(t,o.streams[0].url)));case 13:return e.abrupt("return",o);case 14:case"end":return e.stop()}},e,this)}));return e}()},{key:"onQualitysAvailable",value:function(){var e=this.qualityStreams.map(function(e,t){return{bitrate:parseInt(e.bandwith,10),index:t}});e.unshift({bitrate:0,index:-1}),this.meister.trigger("itemBitrates",{bitrates:e,currentIndex:-1})}},{key:"unload",value:function(){c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"unload",this).call(this),this.manifestTimeoutId&&clearTimeout(this.manifestTimeoutId),this.pollResolutionId&&clearInterval(this.pollResolutionId),this.meister.remove(this.events),this.mediaDuration=0,this.endTime=0,this.baseEndTime=0,this.beginTime=0,this.mediaSequence=0,this.lastMediaSequence=0,this.childManifest=null,this.qualityStreams=[],this.masterPlaylist=null,this.manifestTimeoutId=null,this.pollResolutionId=null,this.currentResolution={width:0,height:0},this.mediaElement=null}},{key:"destroy",value:function(){c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"duration",get:function(){return this.mediaDuration}},{key:"currentTime",get:function(){if(!this.player)return NaN;var e=this.endTime-this.mediaDuration;return this.player.currentTime-e},set:function(e){if(this.player){var t=this.endTime-this.mediaDuration;this.player.currentTime=e+t}}}],[{key:"pluginName",get:function(){return"NativeHls"}},{key:"pluginVersion",get:function(){return m.default.version}}]),t}(Meister.MediaPlugin);Meister.registerPlugin(v.pluginName,v),Meister.registerPlugin("nativehls",v),t.default=v},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;r(this,e),this.data=n,this.key=t,this.type="org.id3",this.startTime=i,this.endTime=o};t.default=i},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e){return e.replace("#EXT-X-KEY:","").split(",").reduce(function(e,t){var n=t.indexOf("="),r=t.substring(0,n),i=t.substring(n+1);return e[r]=i.replace(/"/g,""),e},{})}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(){function e(t){r(this,e),this.text=t}return o(e,[{key:"parse",value:function(){var e=this.text.split("\n"),t={streams:[],segments:{},mediaSequence:0,duration:0,isLive:!0},n=!1,r=t.mediaSequence,o={};return e.forEach(function(e){n&&(o.url=e,t.streams.push(o),o={},n=!1),e.startsWith("#EXT-X-STREAM-INF")&&(n=!0),e.startsWith("#EXT-X-ENDLIST")&&(t.isLive=!1),e.startsWith("#EXT-X-KEY")&&(t.keyInfo=i(e));var a=/^#EXT-X-STREAM-INF:.*BANDWIDTH=(\d*)?/.exec(e);if(a&&a[1]){var s=a[1];o.bandwith=s}var l=/^#EXT-X-STREAM-INF:.*RESOLUTION=(\d*x\d*)?/.exec(e);if(l&&l[1]){var u=l[1].split("x");if(u.length<2)o.resolution={width:0,height:0};else{var d={width:parseInt(u[0],10),height:parseInt(u[1],10)};o.resolution=d}}var c=/^#EXTINF:?([0-9.]*)?,?(.*)?/.exec(e);c&&c[1]&&(t.segments[r]=parseFloat(c[1]),r+=1,t.duration+=parseFloat(c[1]));var f=/^#EXT-X-MEDIA-SEQUENCE:?(-?[0-9.]*)?/.exec(e);f&&f[1]&&(t.mediaSequence=parseInt(f[1],10),r=parseInt(f[1],10))}),t}}]),e}();t.default=a},function(e,t){e.exports={name:"@meisterplayer/plugin-nativehls",version:"5.6.0",description:"Meister plugin for playback of HLS in browsers that support it natively (ex. Safari)",main:"dist/NativeHls.js",keywords:["meister","video","plugin","hls"],repository:{type:"git",url:"https://github.com/meisterplayer/media-nativehls.git"},scripts:{lint:"eslint ./src/js",test:"jest","test:coverage":"jest --coverage",build:"gulp build",dist:"gulp build:min && gulp build:dist"},author:"Triple",license:"Apache-2.0",dependencies:{},devDependencies:{"@meisterplayer/meister-mock":"1.0.0","babel-preset-es2015":"6.24.0","babel-preset-es2017":"6.22.0",gulp:"3.9.1",jest:"20.0.4","meister-gulp-webpack-tasks":"1.0.6","meister-js-dev":"3.1.0"},peerDependencies:{"@meisterplayer/meisterplayer":">= 5.1.0"}}},function(e,t,n){e.exports=n(0)}])},function(e,t,n){"use strict";(function(t,n){var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports=function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/",t(t.s=8)}([function(e,t,n){function r(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function o(e){if(c===setTimeout)return setTimeout(e,0);if((c===r||!c)&&setTimeout)return c=setTimeout,setTimeout(e,0);try{return c(e,0)}catch(t){try{return c.call(null,e,0)}catch(t){return c.call(this,e,0)}}}function a(e){if(f===clearTimeout)return clearTimeout(e);if((f===i||!f)&&clearTimeout)return f=clearTimeout,clearTimeout(e);try{return f(e)}catch(t){try{return f.call(null,e)}catch(t){return f.call(this,e)}}}function s(){g&&p&&(g=!1,p.length?m=p.concat(m):y=-1,m.length&&l())}function l(){if(!g){var e=o(s);g=!0;for(var t=m.length;t;){for(p=m,m=[];++y<t;)p&&p[y].run();y=-1,t=m.length}p=null,g=!1,a(e)}}function u(e,t){this.fun=e,this.array=t}function d(){}var c,f,h=e.exports={};!function(){try{c="function"==typeof setTimeout?setTimeout:r}catch(e){c=r}try{f="function"==typeof clearTimeout?clearTimeout:i}catch(e){f=i}}();var p,m=[],g=!1,y=-1;h.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];m.push(new u(e,t)),1!==m.length||g||o(l)},u.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=d,h.addListener=d,h.once=d,h.off=d,h.removeListener=d,h.removeAllListeners=d,h.emit=d,h.binding=function(e){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(e){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(5),i=function(e){return e&&e.__esModule?e:{default:e}}(r);t.default=i.default},function(e,t,n){(function(e,t){!function(e,n){function r(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var r={callback:e,args:t};return u[l]=r,s(l),l++}function i(e){delete u[e]}function o(e){var t=e.callback,r=e.args;switch(r.length){case 0:t();break;case 1:t(r[0]);break;case 2:t(r[0],r[1]);break;case 3:t(r[0],r[1],r[2]);break;default:t.apply(n,r)}}function a(e){if(d)setTimeout(a,0,e);else{var t=u[e];if(t){d=!0;try{o(t)}finally{i(e),d=!1}}}}if(!e.setImmediate){var s,l=1,u={},d=!1,c=e.document,f=Object.getPrototypeOf&&Object.getPrototypeOf(e);f=f&&f.setTimeout?f:e,"[object process]"==={}.toString.call(e.process)?function(){s=function(e){t.nextTick(function(){a(e)})}}():function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?function(){var t="setImmediate$"+Math.random()+"$",n=function(n){n.source===e&&"string"==typeof n.data&&0===n.data.indexOf(t)&&a(+n.data.slice(t.length))};e.addEventListener?e.addEventListener("message",n,!1):e.attachEvent("onmessage",n),s=function(n){e.postMessage(t+n,"*")}}():e.MessageChannel?function(){var e=new MessageChannel;e.port1.onmessage=function(e){a(e.data)},s=function(t){e.port2.postMessage(t)}}():c&&"onreadystatechange"in c.createElement("script")?function(){var e=c.documentElement;s=function(t){var n=c.createElement("script");n.onreadystatechange=function(){a(t),n.onreadystatechange=null,e.removeChild(n),n=null},e.appendChild(n)}}():function(){s=function(e){setTimeout(a,0,e)}}(),f.setImmediate=r,f.clearImmediate=i}}("undefined"==typeof self?void 0===e?void 0:e:self)}).call(t,n(4),n(0))},function(e,r,i){function o(e,t){this._id=e,this._clearFn=t}var a=Function.prototype.apply;r.setTimeout=function(){return new o(a.call(setTimeout,window,arguments),clearTimeout)},r.setInterval=function(){return new o(a.call(setInterval,window,arguments),clearInterval)},r.clearTimeout=r.clearInterval=function(e){e&&e.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(window,this._id)},r.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},r.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},r._unrefActive=r.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},i(2),r.setImmediate=t,r.clearImmediate=n},function(e,t,n){var i,o="function"==typeof Symbol&&"symbol"===r(Symbol.iterator)?function(e){return void 0===e?"undefined":r(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":r(e)};i=function(){return this}();try{i=i||Function("return this")()||(0,eval)("this")}catch(e){"object"===("undefined"==typeof window?"undefined":o(window))&&(i=window)}e.exports=i},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":r(t))&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":r(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},d=n(6),c=(i(d),n(7)),f=i(c),h=window.MediaPlayer,p=function(e){function t(e,n){o(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.mediaPlayer=null,r.isLive=!1,r.bitrates=[],r}return s(t,e),l(t,[{key:"isItemSupported",value:function(e){var t=this;return new Promise(function(n){return"smooth"!==e.type&&"mss"!==e.type?n({supported:!1,errorCode:Meister.ErrorCodes.WRONG_TYPE}):window.MediaSource?e.drm||e.drmConfig?(t.meister.one("drmKeySystemSupport",function(e){var t=!1;return Object.keys(e).forEach(function(n){"com.microsoft.playready"===n&&e[n]&&(t=!0)}),n({supported:t,errorCode:t?null:Meister.ErrorCodes.NO_DRM})}),void t.meister.trigger("requestDrmKeySystemSupport",{})):n({supported:!0}):n({supported:!1,errorCode:Meister.ErrorCodes.NOT_SUPPORTED})})}},{key:"process",value:function(e){var t=this;return new Promise(function(n,r){t.player=t.meister.getPlayerByType("html5",e),t.player?n(e):r(t.name+": Unable to play item "+e.src+", no player available.")})}},{key:"hasPlayerLoadHack",value:function(e){var t=this;"MSTR-0404"===e.code&&this.meister.playerPlugin.mediaElement.currentSrc===location.protocol+"//"+location.host+"/"&&(this.fake404Triggered=!0),setTimeout(function(){t.meister.playerPlugin.mediaElement.currentSrc===location.protocol+"//"+location.host+"/"?console.info("Ignoring error: strange HAS player behaviour."):t.meister.error("Media not found",Meister.ErrorCodes.NO_MEDIA_FOUND),t.one("error",!0,t.hasPlayerLoadHack.bind(t))},1)}},{key:"load",value:function(e){var n=this;return u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"load",this).call(this,e),this.one("error",!0,this.hasPlayerLoadHack.bind(this)),this.one("playerError",!0,function(e){e.mediaError.code===e.mediaError.MEDIA_ERR_SRC_NOT_SUPPORTED||n.fake404Triggered||n.meister.trigger("playerError",e)}),new Promise(function(t){n.mediaPlayer=new h,n.mediaPlayer.setAutoPlay(!1),n.mediaPlayer.init(n.meister.playerPlugin.mediaElement),n.mediaPlayer.load({url:e.src}),n.attachEvents(),t()})}},{key:"unload",value:function(){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"unload",this).call(this),this.mediaPlayer&&(this.mediaPlayer.stop(),this.mediaPlayer.reset(),this.mediaPlayer=null),this.isLive=!1,this.bitrates=[]}},{key:"attachEvents",value:function(){this.on("requestBitrate",this.onRequestBitrate.bind(this)),this.mediaPlayer.eventBus.addEventListener("manifestLoaded",this.onManifestLoaded.bind(this))}},{key:"onManifestLoaded",value:function(e){e.data.mediaPresentationDuration===1/0&&(this.isLive=!0);var t=e.data.Period.AdaptationSet,n=[];n.push({bitrate:0,index:-1}),t.forEach(function(e){if("video"===e.id){var t=e.Representation;t.reverse(),t.forEach(function(e,t){n.push({bitrate:e.bandwidth,index:t})})}}),this.bitrates=n,this.meister.trigger("itemTimeInfo",{isLive:this.isLive,hasDVR:!1}),this.meister.trigger("itemBitrates",{bitrates:n,currentIndex:-1})}},{key:"_onPlayerTimeUpdate",value:function(){this.meister.trigger("playerTimeUpdate",{currentTime:this.player.currentTime,duration:this.player.duration})}},{key:"_onPlayerSeek",value:function(){var e=this.player.currentTime,t=this.player.duration,n=e/t;this.meister.trigger("playerSeek",{relativePosition:n,currentTime:e,duration:t})}},{key:"onRequestSeek",value:function(e){var t=void 0;Number.isFinite(e.relativePosition)?t=e.relativePosition*this.player.duration:Number.isFinite(e.timeOffset)?t=this.player.currentTime+e.timeOffset:Number.isFinite(e.targetTime)&&(t=e.targetTime),!e.forcedStart&&this.blockSeekForward&&t>this.player.currentTime||Number.isFinite(t)&&(this.player.currentTime=t)}},{key:"onRequestBitrate",value:function(e){if(-1===e.bitrateIndex)return void this.mediaPlayer.setAutoSwitchQuality(!0);var t=0;this.bitrates.forEach(function(n){n.index===e.bitrateIndex&&(t=n.bitrate)}),this.mediaPlayer.setAutoSwitchQuality(!1),this.mediaPlayer.setQualityFor("video",e.bitrateIndex),this.meister.trigger("playerSwitchBitrate",{newBitrate:t,newBitrateIndex:e.bitrateIndex})}},{key:"duration",get:function(){return this.player?this.player.duration:NaN}},{key:"currentTime",get:function(){return this.player?this.player.currentTime:NaN},set:function(e){this.player&&(this.player.currentTime=e)}}],[{key:"pluginName",get:function(){return"Smooth"}},{key:"pluginVersion",get:function(){return f.default.version}}]),t}(Meister.MediaPlugin);Meister.registerPlugin("smooth",p),Meister.registerPlugin(p.pluginName,p),t.default=p},function(e,t,n){(function(n,o){var l,u,d="function"==typeof Symbol&&"symbol"===r(Symbol.iterator)?function(e){return void 0===e?"undefined":r(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":r(e)};!function(n,r){l=[],void 0!==(u=function(){return n.MediaPlayer=r()}.apply(t,l))&&(e.exports=u)}(window,function(){function t(e){var t;for(t=[],i=0,len=e.length;i<len;i+=1)e[i].isRoot?t.push("root"):t.push(e[i].name);var n=function(e,t){var n;if(null!==e&&null!==t)for(n in e)e.hasOwnProperty(n)&&(t.hasOwnProperty(n)||(t[n]=e[n]))},r=function(e,t,r){var i,o,a,s,l;if(null!==e&&0!==e.length)for(i=0,o=e.length;i<o;i+=1)a=e[i],t.hasOwnProperty(a.name)&&(r.hasOwnProperty(a.name)?a.merge&&(s=t[a.name],l=r[a.name],"object"===(void 0===s?"undefined":d(s))&&"object"===(void 0===l?"undefined":d(l))?n(s,l):null!=a.mergeFunction?r[a.name]=a.mergeFunction(s,l):r[a.name]=s+l):r[a.name]=t[a.name])},o=function e(t,n){var i,o,a,s,l,u,d,c=t;if(null!==c.children&&0!==c.children.length)for(i=0,o=c.children.length;i<o;i+=1)if(u=c.children[i],n.hasOwnProperty(u.name))if(u.isArray)for(l=n[u.name+"_asArray"],a=0,s=l.length;a<s;a+=1)d=l[a],r(c.properties,n,d),e(u,d);else d=n[u.name],r(c.properties,n,d),e(u,d)};return{run:function n(r){var i,a,s,l,u,c,f;if(null===r)return r;if("object"!==(void 0===r?"undefined":d(r)))return r;for(i=0,a=t.length;i<a;i+=1)"root"===t[i]&&(u=e[i],c=r,o(u,c));for(l in r)if(r.hasOwnProperty(l)){if(-1!==(s=t.indexOf(l)))if(u=e[s],u.isArray)for(f=r[l+"_asArray"],i=0,a=f.length;i<a;i+=1)c=f[i],o(u,c);else c=r[l],o(u,c);n(r[l])}return r}}}function r(e,t,n){function r(e){var t=e.localName;return null==t&&(t=e.baseName),null!=t&&""!=t||(t=e.nodeName),t}function i(e){return e.prefix}function o(e){return"string"==typeof e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"):e}function a(e){return e.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#x27;/g,"'").replace(/&#x2F;/g,"/")}function s(o){if(o.nodeType==_.DOCUMENT_NODE){var l,u,d,c=o.firstChild;for(u=0,d=o.childNodes.length;u<d;u+=1)if(o.childNodes[u].nodeType!==_.COMMENT_NODE){c=o.childNodes[u];break}if(n)l=s(c);else{l={};var f=r(c);l[f]=s(c)}return l}if(o.nodeType==_.ELEMENT_NODE){var l=new Object;l.__cnt=0;for(var h=o.childNodes,p=0;p<h.length;p++){var c=h.item(p),f=r(c);if(l.__cnt++,null==l[f])l[f]=s(c),l[f+"_asArray"]=new Array(1),l[f+"_asArray"][0]=l[f];else{if(null!=l[f]&&!(l[f]instanceof Array)){var m=l[f];l[f]=new Array,l[f][0]=m,l[f+"_asArray"]=l[f]}for(var g=0;null!=l[f][g];)g++;l[f][g]=s(c)}}for(var y=0;y<o.attributes.length;y++){var b=o.attributes.item(y);l.__cnt++;for(var E=b.value,T=0,S=e.length;T<S;T++){var x=e[T];x.test.call(this,b.value)&&(E=x.converter.call(this,b.value))}l[t+b.name]=E}var w=i(o);return null!=w&&""!=w&&(l.__cnt++,l.__prefix=w),1==l.__cnt&&null!=l["#text"]&&(l=l["#text"]),null!=l["#text"]&&(l.__text=l["#text"],v&&(l.__text=a(l.__text)),delete l["#text"],delete l["#text_asArray"]),null!=l["#cdata-section"]&&(l.__cdata=l["#cdata-section"],delete l["#cdata-section"],delete l["#cdata-section_asArray"]),null==l.__text&&null==l.__cdata||(l.toString=function(){return(null!=this.__text?this.__text:"")+(null!=this.__cdata?this.__cdata:"")}),l}return o.nodeType==_.TEXT_NODE||o.nodeType==_.CDATA_SECTION_NODE?o.nodeValue:o.nodeType==_.COMMENT_NODE?null:void 0}function l(e,t,n,r){var i="<"+(null!=e&&null!=e.__prefix?e.__prefix+":":"")+t;if(null!=n)for(var o=0;o<n.length;o++){var a=n[o],s=e[a];i+=" "+a.substr(1)+"='"+s+"'"}return i+=r?"/>":">"}function u(e,t){return"</"+(null!=e.__prefix?e.__prefix+":":"")+t+">"}function d(e,t){return-1!==e.indexOf(t,e.length-t.length)}function c(e,t){return!!(d(t.toString(),"_asArray")||0==t.toString().indexOf("_")||e[t]instanceof Function)}function f(e){var t=0;if(e instanceof Object)for(var n in e)c(e,n)||t++;return t}function h(e){var t=[];if(e instanceof Object)for(var n in e)-1==n.toString().indexOf("__")&&0==n.toString().indexOf("_")&&t.push(n);return t}function p(e){var t="";return null!=e.__cdata&&(t+="<![CDATA["+e.__cdata+"]]>"),null!=e.__text&&(t+=v?o(e.__text):e.__text),t}function m(e){var t="";return e instanceof Object?t+=p(e):null!=e&&(t+=v?o(e):e),t}function g(e,t,n){var r="";if(0==e.length)r+=l(e,t,n,!0);else for(var i=0;i<e.length;i++)r+=l(e[i],t,h(e[i]),!1),r+=y(e[i]),r+=u(e[i],t);return r}function y(e){var t="";if(f(e)>0)for(var n in e)if(!c(e,n)){var r=e[n],i=h(r);if(null==r||void 0==r)t+=l(r,n,i,!0);else if(r instanceof Object)if(r instanceof Array)t+=g(r,n,i);else{var o=f(r);o>0||null!=r.__text||null!=r.__cdata?(t+=l(r,n,i,!1),t+=y(r),t+=u(r,n)):t+=l(r,n,i,!0)}else t+=l(r,n,i,!1),t+=m(r),t+=u(r,n)}return t+=m(e)}null!==t&&void 0!==t||(t="_"),null!==n&&void 0!==n||(n=!1);var v=!1,_={ELEMENT_NODE:1,TEXT_NODE:3,CDATA_SECTION_NODE:4,COMMENT_NODE:8,DOCUMENT_NODE:9};this.parseXmlString=function(e){var t;if(window.DOMParser)try{if(t=(new window.DOMParser).parseFromString(e,"text/xml"),t.getElementsByTagName("parsererror").length>0)throw new Error("Error parsing XML")}catch(e){return null}return t},this.xml2json=function(e){return s(e)},this.xml_str2json=function(e){var t=this.parseXmlString(e);return null===t?t:this.xml2json(t)},this.json2xml_str=function(e){return y(e)},this.json2xml=function(e){var t=this.json2xml_str(e);return this.parseXmlString(t)},this.getVersion=function(){return"1.0.11"},this.escapeMode=function(e){v=e}}function l(){var e,t,n;try{e=navigator.userAgent.toLowerCase(),/msie (\d+\.\d+);/.test(e)?(n=Number(RegExp.$1),e.indexOf("trident/6")>-1&&(n=10),e.indexOf("trident/5")>-1&&(n=9),e.indexOf("trident/4")>-1&&(n=8),t="Internet Explorer"):e.indexOf("trident/7")>-1?(n=11,t="Internet Explorer"):/edge[\/\s](\d+\.\d+)/.test(e)?(n=Number(RegExp.$1),t="Edge"):/firefox[\/\s](\d+\.\d+)/.test(e)?(n=Number(RegExp.$1),t="Firefox"):/opera[\/\s](\d+\.\d+)/.test(e)?(n=Number(RegExp.$1),t="Opera"):/chrome[\/\s](\d+\.\d+)/.test(e)?(n=Number(RegExp.$1),t="Chrome"):/version[\/\s](\d+\.\d+)/.test(e)?(n=Number(RegExp.$1),t="Safari"):/rv[\/\s](\d+\.\d+)/.test(e)?(n=Number(RegExp.$1),t="Mozilla"):/mozilla[\/\s](\d+\.\d+)/.test(e)?(n=Number(RegExp.$1),t="Mozilla"):/binget[\/\s](\d+\.\d+)/.test(e)?(n=Number(RegExp.$1),t="Library (BinGet)"):/curl[\/\s](\d+\.\d+)/.test(e)?(n=Number(RegExp.$1),t="Library (cURL)"):/java[\/\s](\d+\.\d+)/.test(e)?(n=Number(RegExp.$1),t="Library (Java)"):/libwww-perl[\/\s](\d+\.\d+)/.test(e)?(n=Number(RegExp.$1),t="Library (libwww-perl)"):/microsoft url control -[\s](\d+\.\d+)/.test(e)?(n=Number(RegExp.$1),t="Library (Microsoft URL Control)"):/peach[\/\s](\d+\.\d+)/.test(e)?(n=Number(RegExp.$1),t="Library (Peach)"):/php[\/\s](\d+\.\d+)/.test(e)?(n=Number(RegExp.$1),t="Library (PHP)"):/pxyscand[\/\s](\d+\.\d+)/.test(e)?(n=Number(RegExp.$1),t="Library (pxyscand)"):/pycurl[\/\s](\d+\.\d+)/.test(e)?(n=Number(RegExp.$1),t="Library (PycURL)"):/python-urllib[\/\s](\d+\.\d+)/.test(e)?(n=Number(RegExp.$1),t="Library (Python URLlib)"):/appengine-google/.test(e)?(n=Number(RegExp.$1),t="Cloud (Google AppEngine)"):/trident/.test(e)?(n=Number(RegExp.$1),t="Trident"):/adventurer/.test(e)?(n=Number(RegExp.$1),t="Adventurer"):(n="unknown",t="unknown")}catch(e){t="error",n="error"}return{name:t.replace(/\s+/g,""),version:n}}function u(){var e,t,n,r;try{e=navigator.userAgent.toLowerCase(),n=-1!==e.indexOf("windows nt 10.0")?"Windows 10":-1!==e.indexOf("windows nt 6.3")?"Windows 8.1":-1!==e.indexOf("windows nt 6.2")?"Windows 8":-1!==e.indexOf("windows nt 6.1")?"Windows 7":-1!==e.indexOf("windows nt 6.0")?"Windows Vista/Windows Server 2008":-1!==e.indexOf("windows nt 5.2")?"Windows XP x64/Windows Server 2003":-1!==e.indexOf("windows nt 5.1")?"Windows XP":-1!==e.indexOf("windows nt 5.01")?"Windows 2000, Service Pack 1 (SP1)":-1!==e.indexOf("windows xp")?"Windows XP":-1!==e.indexOf("windows 2000")?"Windows 2000":-1!==e.indexOf("windows nt 5.0")?"Windows 2000":-1!==e.indexOf("windows nt 4.0")?"Windows NT 4.0":-1!==e.indexOf("windows nt")?"Windows NT 4.0":-1!==e.indexOf("winnt4.0")?"Windows NT 4.0":-1!==e.indexOf("winnt")?"Windows NT 4.0":-1!==e.indexOf("windows me")?"Windows ME":-1!==e.indexOf("win 9x 4.90")?"Windows ME":-1!==e.indexOf("windows 98")?"Windows 98":-1!==e.indexOf("win98")?"Windows 98":-1!==e.indexOf("windows 95")?"Windows 95":-1!==e.indexOf("windows_95")?"Windows 95":-1!==e.indexOf("win95")?"Windows 95":-1!==e.indexOf("ce")?"Windows CE":-1!==e.indexOf("win16")?"Windows 3.11":-1!==e.indexOf("iemobile")?"Windows Mobile":-1!==e.indexOf("wm5 pie")?"Windows Mobile":-1!==e.indexOf("windows phone 10.0")?"Windows Phone 10":-1!==e.indexOf("windows")?"Windows (Unknown Version)":-1!==e.indexOf("openbsd")?"Open BSD":-1!==e.indexOf("sunos")?"Sun OS":-1!==e.indexOf("ubuntu")?"Ubuntu":-1!==e.indexOf("ipad")?"iOS (iPad)":-1!==e.indexOf("ipod")?"iOS (iTouch)":-1!==e.indexOf("iphone")?"iOS (iPhone)":-1!==e.indexOf("mac os x beta")?"Mac O SX Beta":-1!==e.indexOf("mac os x 10")?/mac os x 10_(\d+)\_(\d+)/.test(e)?"Mac OS X 10."+RegExp.$1:"Mac OS X 10":-1!==e.indexOf("mac os x")?"Mac OS X":-1!==e.indexOf("mac_68000")?"Mac OS Classic (68000)":-1!==e.indexOf("68K")?"Mac OS Classic (68000)":-1!==e.indexOf("mac_powerpc")?"Mac OS Classic (PowerPC)":-1!==e.indexOf("ppc mac")?"Mac OS Classic (PowerPC)":-1!==e.indexOf("macintosh")?"Mac OS Classic":-1!==e.indexOf("googletv")?"Android (GoogleTV)":-1!==e.indexOf("xoom")?"Android (Xoom)":-1!==e.indexOf("htc_flyer")?"Android (HTC Flyer)":-1!==e.indexOf("android")?"Android":-1!==e.indexOf("symbian")?"Symbian":-1!==e.indexOf("series60")?"Symbian (Series 60)":-1!==e.indexOf("series70")?"Symbian (Series 70)":-1!==e.indexOf("series80")?"Symbian (Series 80)":-1!==e.indexOf("series90")?"Symbian (Series 90)":-1!==e.indexOf("x11")?"UNIX":-1!==e.indexOf("nix")?"UNIX":-1!==e.indexOf("linux")?"Linux":-1!==e.indexOf("qnx")?"QNX":-1!==e.indexOf("os/2")?"IBM OS/2":-1!==e.indexOf("beos")?"BeOS":-1!==e.indexOf("blackberry95")?"Blackberry (Storm 1/2)":-1!==e.indexOf("blackberry97")?"Blackberry (Bold)":-1!==e.indexOf("blackberry96")?"Blackberry (Tour)":-1!==e.indexOf("blackberry89")?"Blackberry (Curve 2)":-1!==e.indexOf("blackberry98")?"Blackberry (Torch)":-1!==e.indexOf("playbook")?"Blackberry (Playbook)":-1!==e.indexOf("wnd.rim")?"Blackberry (IE/FF Emulator)":-1!==e.indexOf("blackberry")?"Blackberry":-1!==e.indexOf("palm")?"Palm OS":-1!==e.indexOf("webos")?"WebOS":-1!==e.indexOf("hpwos")?"WebOS (HP)":-1!==e.indexOf("blazer")?"Palm OS (Blazer)":-1!==e.indexOf("xiino")?"Palm OS (Xiino)":-1!==e.indexOf("kindle")?"Kindle":-1!==e.indexOf("wii")?"Nintendo (Wii)":-1!==e.indexOf("nintendo ds")?"Nintendo (DS)":-1!==e.indexOf("playstation 3")?"Sony (Playstation Console)":-1!==e.indexOf("playstation portable")?"Sony (Playstation Portable)":-1!==e.indexOf("webtv")?"MSN TV (WebTV)":-1!==e.indexOf("inferno")?"Inferno":"Unknown",t=navigator.platform.toLowerCase(),r=-1!==t.indexOf("x64")?"64":-1!==e.indexOf("x86_64")?"64":-1!==e.indexOf("x86-64")?"64":-1!==e.indexOf("win64")?"64":-1!==e.indexOf("x64;")?"64":-1!==e.indexOf("amd64")?"64":-1!==e.indexOf("wow64")?"64":-1!==e.indexOf("x64_64")?"64":-1!==e.indexOf("ia65")?"64":-1!==e.indexOf("sparc64")?"64":-1!==e.indexOf("ppc64")?"64":-1!==e.indexOf("irix64")?"64":-1!==e.indexOf("irix64")?"64":"32"}catch(e){n="error",r="error"}return{name:n.replace(/\s+/g,""),bits:"x"+r}}var c,f,h,p={},m={},g={},y={};y=function(){var e,t="3a8c632",n="2016-11-28_15:28:30",r=new y.di.Context,i=new h.System,o=!1,a=null,s=null,f=null,p=[],m=[],g=null,v=null,_="und",b="und",E=!1,T={video:-1,audio:-1},S=null,x=!1,w=!1,I=!0,D=null,R=!1,A={},P=function(){if(!o)throw new Error("MediaPlayer not initialized !!!")},M=function(){if(!e.getElement())throw new Error("MediaPlayer.play(): Video element not attached to MediaPlayer")},L=function(){if(!D)throw new Error("MediaPlayer.play(): Source not attached to MediaPlayer")},C=function(){if(P(),M(),L(),!y.hasMediaSourceExtension())return void this.errHandler.sendError(y.dependencies.ErrorHandler.prototype.CAPABILITY_ERR_MEDIASOURCE,"MediaSource extension not supported by the browser");w=!0,this.metricsModel.addSession(null,D.url,e.getElement().loop,null,"MediaPlayer.js_"+this.getVersion()),S||(S=i.getObject("streamController"),S.setVideoModel(e),S.setAutoPlay(I)),S.setDefaultAudioLang(_),S.setDefaultSubtitleLang(b),S.enableSubtitles(E),S.load(D),i.mapValue("scheduleWhilePaused",R),i.mapOutlet("scheduleWhilePaused","stream")},O=function(){return o&&e.getElement()&&D&&!x},k=function(){O()&&C.call(this)},N=function(t,n){var r=document.createEvent("CustomEvent");r.initCustomEvent(t,!1,!1,{type:n.streamType,bitrate:n.switchedQuality,representationId:n.representationId,time:e.getCurrentTime(),width:n.width,height:n.height}),e.getElement().dispatchEvent(r)},F=function(t){var n;switch(t.data.metric){case"ManifestReady":P(),this.debug.log("[MediaPlayer] ManifestReady"),s=this.metricsExt.getBitratesForType("video"),this.debug.log("[MediaPlayer] video bitrates: "+JSON.stringify(s)),n=document.createEvent("CustomEvent"),n.initCustomEvent("manifest_loaded",!1,!1,{}),e.getElement().dispatchEvent(n);break;case"RepresentationSwitch":P(),"video"==t.data.stream?(s=this.metricsExt.getBitratesForType(t.data.stream))&&(N("download_bitrate",{streamType:t.data.stream,switchedQuality:s[t.data.value.lto],representationId:t.data.value.to,width:this.metricsExt.getVideoWidthForRepresentation(t.data.value.to),height:this.metricsExt.getVideoHeightForRepresentation(t.data.value.to)}),this.debug.log("[MediaPlayer]["+t.data.stream+"] send download_bitrate - b="+s[t.data.value.lto])):"audio"==t.data.stream&&(f=this.metricsExt.getBitratesForType(t.data.stream))&&(N("download_bitrate",{streamType:t.data.stream,switchedQuality:f[t.data.value.to],representationId:t.data.value.to,width:this.metricsExt.getVideoWidthForRepresentation(t.data.value.to),height:this.metricsExt.getVideoHeightForRepresentation(t.data.value.to)}),this.debug.log("[MediaPlayer]["+t.data.stream+"] send download_bitrate - b="+s[t.data.value.lto]));break;case"BufferedSwitch":P(),"video"==t.data.stream?p.push({streamType:t.data.stream,mediaStartTime:t.data.value.mt,switchedQuality:s[t.data.value.lto],representationId:t.data.value.to,width:this.metricsExt.getVideoWidthForRepresentation(t.data.value.to),height:this.metricsExt.getVideoHeightForRepresentation(t.data.value.to)}):"audio"==t.data.stream&&m.push({streamType:t.data.stream,mediaStartTime:t.data.value.mt,switchedQuality:f[t.data.value.lto],representationId:t.data.value.to,width:this.metricsExt.getVideoWidthForRepresentation(t.data.value.to),height:this.metricsExt.getVideoHeightForRepresentation(t.data.value.to)});break;case"BufferLevel":n=document.createEvent("CustomEvent"),n.initCustomEvent("bufferLevel_updated",!1,!1,{type:t.data.stream,level:t.data.value.level}),e.getElement().dispatchEvent(n);break;case"State":n=document.createEvent("CustomEvent"),n.initCustomEvent("state_changed",!1,!1,{type:t.data.stream,state:t.data.value.current}),e.getElement().dispatchEvent(n)}},B=function(e){g=e.data},U=function(e){v=e.data},j=function(e,t){var n=0;for(n=t.length-1;n>=0;n-=1)e.splice(n,1)},H=function(t){var n=e.getCurrentTime(),r=null,i=[],o=0;for(o=0;o<t.length;o+=1)r=t[o],n>=r.mediaStartTime&&(N("play_bitrate",r),this.debug.log("[MediaPlayer]["+r.streamType+"] send play_bitrate - b="+r.switchedQuality+", t="+r.mediaStartTime+"("+e.getPlaybackRate()+")"),i.push(o));j(t,i)},q=function(){0!==e.getPlaybackRate()&&(H.call(this,p),H.call(this,m))},V=function(){this.addEventListener("metricAdded",F.bind(this)),this.addEventListener("error",B.bind(this)),this.addEventListener("warning",U.bind(this)),this.addEventListener("timeupdate",q.bind(this))},G=function(e){if(w&&S){if(!x){x=!0;var t={};t[y.dependencies.StreamController.eventList.ENAME_TEARDOWN_COMPLETE]=function(){S=null,w=!1,x=!1,this.debug.log("[MediaPlayer] Player is stopped"),O.call(this)&&k.call(this)}.bind(this),S.subscribe(y.dependencies.StreamController.eventList.ENAME_TEARDOWN_COMPLETE,t,void 0,!0),S.reset(e)}}else O.call(this)&&k.call(this)},K=function(e){if(!S)return null;switch(e){case y.TRACKS_TYPE.AUDIO:return S.getAudioTracks();case y.TRACKS_TYPE.TEXT:return S.getSubtitleTracks()}return null},z=function(e){if(!S)return null;switch(e){case y.TRACKS_TYPE.AUDIO:return S.getSelectedAudioTrack();case y.TRACKS_TYPE.TEXT:return S.getSelectedSubtitleTrack()}return null},Y=function(e,t){if(!S)return null;switch(e){case y.TRACKS_TYPE.AUDIO:S.setAudioTrack(t);break;case y.TRACKS_TYPE.TEXT:S.setSubtitleTrack(t)}return null},W=function(e,t){return e.id===t.id&&e.lang===t.lang&&e.subType===t.subType},X=function(){if(arguments&&arguments.length>0){var e={};return"string"==typeof arguments[0]&&(e.url=arguments[0]),arguments[1]&&(e.protData=arguments[1]),e}},Q=function(){var e=this.metricsModel.getReadOnlyMetricsFor("video");return e?this.metricsExt.getCurrentDVRInfo(e):null};return i.mapValue("system",i),i.mapOutlet("system"),i.injectInto(r),{notifier:void 0,debug:void 0,eventBus:void 0,metricsExt:void 0,abrController:void 0,metricsModel:void 0,errHandler:void 0,config:void 0,getVersion:function(){return"1.7.0"},getVersionFull:function(){return-1===t.indexOf("@@")?"1.7.0_"+t:"1.7.0"},getVersionDashJS:function(){return"1.2.0"},getBuildDate:function(){return-1===n.indexOf("@@")?n:"Not a builded version"},init:function(t){if(!t)throw new Error("MediaPlayer.init(): Invalid Argument");o||(i.injectInto(this),o=!0,this.debug.log("[MediaPlayer] Version: "+this.getVersionFull()+" - "+this.getBuildDate()),this.debug.log("[MediaPlayer] user-agent: "+navigator.userAgent)),e=i.getObject("videoModel"),e.setElement(t),V.call(this),a=i.getObject("debugController")},addEventListener:function(t,n,r){P(),"hasplayer"===y.PUBLIC_EVENTS[t]?this.eventBus.addEventListener(t,n,r):e.listen(t,n,r)},removeEventListener:function(t,n){P(),"hasplayer"===y.PUBLIC_EVENTS[t]?this.eventBus.removeEventListener(t,n):e.unlisten(t,n)},getVideoModel:function(){return e},getDebug:function(){return this.debug},getMetricsExt:function(){return this.metricsExt},setConfig:function(e){this.config&&e&&(this.debug.log("[MediaPlayer] set config: "+JSON.stringify(e,null,"\t")),this.config.setParams(e))},setParams:function(e){this.setConfig(e)},setDebug:function(e){if(P(),"boolean"!=typeof e)throw new Error("MediaPlayer.setDebug(): Invalid Arguments");!0===e?this.debug.setLevel(4):this.debug.setLevel(0)},getAutoPlay:function(){return I},setAutoPlay:function(e){I=e},setInitialQualityFor:function(e,t){T[e]=t},getQualityFor:function(e){return P(),this.abrController.getQualityFor(e)},setQualityFor:function(e,t){if(P(),"number"!=typeof t)throw new Error("MediaPlayer.setQualityFor(): Invalid Arguments");this.abrController.setQualityFor(e,t)},getAutoSwitchQuality:function(){return P(),this.abrController.getAutoSwitchBitrate()},setAutoSwitchQuality:function(e){if(P(),"boolean"!=typeof e)throw new Error("MediaPlayer.setAutoSwitchQuality(): Invalid Arguments");this.abrController.setAutoSwitchBitrate(e)},getScheduleWhilePaused:function(){return R},setScheduleWhilePaused:function(e){if("boolean"!=typeof e)throw new Error("MediaPlayer.setScheduleWhilePaused(): Invalid Arguments");R=e},setDefaultAudioLang:function(e){if("string"!=typeof e)throw new Error("MediaPlayer.setDefaultAudioLang(): Invalid Arguments");_=e},getDefaultAudioLang:function(){return _},setDefaultSubtitleLang:function(e){if("string"!=typeof e)throw new Error("MediaPlayer.setDefaultSubtitleLang(): Invalid Arguments");b=e},getDefaultSubtitleLang:function(){return b},load:function(e){var t,n=[],r=[],i={video:{"ABR.keepBandwidthCondition":!0},audio:{"ABR.keepBandwidthCondition":!0}};if(arguments&&arguments.length>0&&"object"!==d(arguments[0])&&(console.warn('You are using "deprecated" call of the method load, please refer to the documentation to change prameters call'),e=X.apply(null,arguments)),!e||!e.url)throw new Error("MediaPlayer.load(): stream has no url.");p=[],m=[],P(),this.reset(0),T.video>=0&&(this.abrController.setQualityFor("video",T.video),i.video["ABR.keepBandwidthCondition"]=!1,T.video=-1),T.audio>=0&&(this.abrController.setQualityFor("audio",T.audio),i.audio["ABR.keepBandwidthCondition"]=!1,T.audio=-1),this.setConfig(i),g=null,v=null;for(var o in A)n.push(A[o].deferInit.promise);c.all(n).then(function(){for(var n in A)t=A[n],t.deferLoad=c.defer(),r.push(t.deferLoad.promise),t.load(e,function(){this.deferLoad.resolve()}.bind(t));c.all(r).then(function(){D=e,G.call(this,0)}.bind(this))}.bind(this))},play:function(){P(),e.play()},seek:function(t){var n=null,r=0;if(P(),"number"!=typeof t)throw new Error("MediaPlayer.seek(): Invalid Arguments");if(this.isLive()){if(n=this.getDVRWindowRange(),r=S.getLiveDelay(),null===n)throw new Error("MediaPlayer.seek(): impossible for live stream");if(t<n.start||t>n.end)throw new Error("MediaPlayer.seek(): seek value outside available time range");t>n.end-r&&(t=n.end-r),S.seek(t,!0)}else{if(t<0||t>e.getDuration())throw new Error("MediaPlayer.seek(): seek value outside available time range");e.setCurrentTime(t)}},pause:function(){P(),e.pause()},stop:function(){P(),e.pause(),this.isLive()||e.setCurrentTime(0);for(var t in A)A[t].stop()},reset:function(e){P(),this.setQualityFor("video",0),this.setQualityFor("audio",0),D=null,G.call(this,e);for(var t in A)A[t].reset()},refreshManifest:function(e){P(),S.refreshManifest(e)},getDuration:function(){return P(),e.getDuration()},isLive:function(){return P(),e.getDuration()===Number.POSITIVE_INFINITY},getPosition:function(){return P(),this.isLive()?void 0:e.getCurrentTime()},getDVRWindowRange:function(){if(P(),!this.isLive())return null;var e=Q.call(this);return e?e.range:null},getDVRWindowSize:function(){return P(),this.isLive(),null},getDVRSeekOffset:function(e){if(P(),!this.isLive())return null;var t=Q.call(this),n=t?t.range.start+e:null;return n&&n>t.range.end&&(n=t.range.end),n},getVideoBitrates:function(){return P(),s},getMetricsFor:function(e){return this.metricsModel.getReadOnlyMetricsFor(e)},getTrickModeSpeed:function(){return S?S.getTrickModeSpeed():0},setTrickModeSpeed:function(t){P(),S&&(S.getTrickModeSpeed()!==t&&1===t?e.play():S.setTrickModeSpeed(t))},getError:function(){return g},getWarning:function(){return v},getTracks:function(e){if(P(),!e||e!==y.TRACKS_TYPE.AUDIO&&e!==y.TRACKS_TYPE.TEXT)throw new Error('MediaPlayer Invalid Argument - "type" should be defined and shoud be kind of MediaPlayer.TRACKS_TYPE');var t=K(e);if(!t)return[];for(var n=[],r=0;r<t.length;r+=1)n.push({id:t[r].id,lang:t[r].lang,subType:t[r].subType});return n},selectTrack:function(e,t){if(P(),!e||e!==y.TRACKS_TYPE.AUDIO&&e!==y.TRACKS_TYPE.TEXT)throw new Error('MediaPlayer Invalid Argument - "type" should be defined and shoud be kind of MediaPlayer.TRACKS_TYPE');if(!t||!(t.id||t.lang||t.subType))throw new Error("MediaPlayer.selectTrack(): track parameter is not in valid");var n=K(e);if(!n)return void this.debug.error("[MediaPlayer] No available track for type "+e);var r=z(e);if(r&&W(r,t))return void this.debug.log("[MediaPlayer] "+e+" track ["+t.id+" - "+t.lang+"] is already selected");for(var i=0;i<n.length;i+=1)if(W(n[i],t))return void Y(e,n[i])},getSelectedTrack:function(e){if(P(),!e||e!==y.TRACKS_TYPE.AUDIO&&e!==y.TRACKS_TYPE.TEXT)throw new Error('MediaPlayer Invalid Argument - "type" should be defined and shoud be kind of MediaPlayer.TRACKS_TYPE');var t=z(e);return t?{id:t.id,lang:t.lang,subType:t.subType}:null},enableSubtitles:function(e){if(P(),"boolean"!=typeof e)throw new Error("MediaPlayer.enableSubtitles(): Invalid Arguments");E=e,S&&S.enableSubtitles(E)},isSubtitlesEnabled:function(){return P(),E},enableSubtitleExternDisplay:function(e){if("boolean"!=typeof e)throw new Error("MediaPlayer.enableSubtitleExternDisplay(): Invalid Arguments");this.config.setParams({"TextTrackExtensions.displayModeExtern":e})},getTTMLRenderingDiv:function(){return e?e.getTTMLRenderingDiv():null},attachTTMLRenderingDiv:function(t){P(),e.setTTMLRenderingDiv(t)},getMute:function(){return P(),e.getMute()},setMute:function(t){if(P(),"boolean"!=typeof t)throw new Error("MediaPlayer.setMute(): Invalid Arguments");e.setMute(t)},getVolume:function(){return P(),e.getVolume()},setVolume:function(t){if(P(),"number"!=typeof t||t<0||t>1)throw new Error("MediaPlayer.setVolume(): Invalid Arguments");e.setVolume(t)},getTerminalId:function(){var e=l(),t=u();return t.name+"-"+t.bits+"-"+e.name},addPlugin:function(e){if(P(),void 0===e)throw new Error("MediaPlayer.addPlugin(): plugin undefined");if("function"!=typeof e.getName||"function"!=typeof e.getVersion||"function"!=typeof e.init||"function"!=typeof e.load||"function"!=typeof e.stop||"function"!=typeof e.reset)throw new Error("MediaPlayer.addPlugin(): plugin API not compliant");A[e.getName()]&&A[e.getName()].destroy(),this.debug.log("[MediaPlayer] Add plugin '"+e.getName()+"' (v"+e.getVersion()+")"),A[e.getName()]=e,e.deferInit=c.defer(),o&&e.init(this,function(){this.deferInit.resolve()}.bind(e))},removePlugin:function(e){var t;if(void 0===e)throw new Error("MediaPlayer.removePlugin(): plugin undefined");if("string"==typeof e)t=e;else{if("function"!=typeof e.getName)throw new Error("MediaPlayer.removePlugin(): plugin API not compliant");t=e.getName()}A[t]&&(this.debug.log("[MediaPlayer] Remove plugin '"+t),A[t].destroy(),A[t]=null,delete A[t])}}},y.prototype={constructor:y},y.dependencies={},y.dependencies.protection={},y.dependencies.protection.servers={},y.utils={},y.models={},y.modules={},y.vo={},y.vo.metrics={},y.vo.protection={},y.rules={},y.rules.o={},y.di={},y.PUBLIC_EVENTS={error:"hasplayer",warning:"hasplayer",cueEnter:"hasplayer",cueExit:"hasplayer",manifestUrlUpdate:"hasplayer",metricAdded:"hasplayer",metricChanged:"hasplayer",play_bitrate:"video",download_bitrate:"video",bufferLevel_updated:"video",state_changed:"video"},y.TRACKS_TYPE={AUDIO:"audio",TEXT:"text"},y.hasMediaSourceExtension=function(){return(new y.utils.Capabilities).supportsMediaSource()},y.hasMediaKeysExtension=function(){return(new y.utils.Capabilities).supportsMediaKeys()},y.dependencies.AbrController=function(){var e=!0,t={},n={},r={},i={},o="",a=function(e){return t.hasOwnProperty(e)||(t[e]=!0),t[e]},s=function(e,n){t[e]=n},l=function(e){return n.hasOwnProperty(e)||(n[e]=0),n[e]},u=function(e,t){n[e]=t},d=function(e){return i.hasOwnProperty(e)||(i[e]=0),i[e]},c=function(e,t){i[e]=t},f=function(t,n){var i,s,u,c,f,h,p=this,m=a(t),g=l(t),v=d(t),_=y.rules.SwitchRequest.prototype.NO_CHANGE,b=y.rules.SwitchRequest.prototype.NO_CHANGE,E=y.rules.SwitchRequest.prototype.NO_CHANGE,T=[],S={};if(!e||!m)return p.debug.log("[AbrController]["+t+"] ABR disabled"),{quality:g,confidence:v};for(p.debug.log("[AbrController]["+t+"] Check rules...."),u=p.getMetricsFor(n),f=p.abrRulesCollection.getRules(y.rules.BaseRulesCollection.prototype.QUALITY_SWITCH_RULES),i=0,s=f.length;i<s;i+=1)T.push(f[i].checkIndex(g,u,n,o));for(S[y.rules.SwitchRequest.prototype.STRONG]=y.rules.SwitchRequest.prototype.NO_CHANGE,S[y.rules.SwitchRequest.prototype.WEAK]=y.rules.SwitchRequest.prototype.NO_CHANGE,S[y.rules.SwitchRequest.prototype.DEFAULT]=y.rules.SwitchRequest.prototype.NO_CHANGE,i=0,s=T.length;i<s;i+=1)c=T[i],c.quality!==y.rules.SwitchRequest.prototype.NO_CHANGE&&(p.debug.log("[AbrController]["+t+"] Request for quality "+c.quality+", priority = "+c.priority+" ("+f[i].name+")"),S[c.priority]=Math.min(S[c.priority],c.quality)),!0===c.max&&(E=Math.min(E,c.quality));return S[y.rules.SwitchRequest.prototype.WEAK]!==y.rules.SwitchRequest.prototype.NO_CHANGE&&(b=y.rules.SwitchRequest.prototype.WEAK,_=S[y.rules.SwitchRequest.prototype.WEAK]),S[y.rules.SwitchRequest.prototype.DEFAULT]!==y.rules.SwitchRequest.prototype.NO_CHANGE&&(b=y.rules.SwitchRequest.prototype.DEFAULT,_=S[y.rules.SwitchRequest.prototype.DEFAULT]),S[y.rules.SwitchRequest.prototype.STRONG]!==y.rules.SwitchRequest.prototype.NO_CHANGE&&(b=y.rules.SwitchRequest.prototype.STRONG,_=S[y.rules.SwitchRequest.prototype.STRONG]),_!==y.rules.SwitchRequest.prototype.NO_CHANGE&&void 0!==_&&(g=_),b!==y.rules.SwitchRequest.prototype.NO_CHANGE&&void 0!==b&&(v=b),E!==y.rules.SwitchRequest.prototype.NO_CHANGE&&(r[t]=E),h=p.manifestExt.getRepresentationCount(n),g<0&&(g=0),g>=h&&(g=h-1),v!==y.rules.SwitchRequest.prototype.STRONG&&v!==y.rules.SwitchRequest.prototype.WEAK&&(v=y.rules.SwitchRequest.prototype.DEFAULT),p.debug.info("[AbrController]["+t+"] Request quality: "+g),{quality:g,confidence:v}},h=function(e,t){var n,r=this.metricsExt.getBitratesForType(e,t),i=this.config.getParamFor(e,"ABR.minQuality","number",-1),o=this.config.getParamFor(e,"ABR.maxQuality","number",-1),a=this.config.getParamFor(e,"ABR.minBandwidth","number",-1),s=this.config.getParamFor(e,"ABR.maxBandwidth","number",-1),l=r.length;if(-1!==a)for(n=0;n<r.length;n++)if(r[n]>=a){i=-1===i?n:Math.max(n,i);break}if(-1!==s)for(n=r.length-1;n>=0;n--)if(r[n]<=s){o=-1===o?n:Math.min(n,o);break}return i=i>=l?l-1:i,i=i<0?0:i,o=o>=l||o<0?l-1:o,{min:i,max:o}};return{debug:void 0,abrRulesCollection:void 0,manifestExt:void 0,metricsModel:void 0,metricsExt:void 0,config:void 0,getAutoSwitchBitrate:function(){return e},setAutoSwitchBitrate:function(t){this.debug.log("[AbrController] Set auto switch: "+t),e=t},getMetricsFor:function(e){var t,n;return t=this.manifestExt.getIsVideo(e),t?this.metricsModel.getMetricsFor("video"):(n=this.manifestExt.getIsAudio(e),n?this.metricsModel.getMetricsFor("audio"):this.metricsModel.getMetricsFor("stream"))},getPlaybackQuality:function(e,t){var n,i,o,a=this,s=this.getQualityFor(e),l=-1,d=-1,p=this.config.getParamFor(e,"ABR.switchUpIncrementally","boolean",!1);if(o=f.call(this,e,t),n=o.quality,i=o.confidence,a.getAutoSwitchBitrate()){p&&n>s&&(a.debug.log("[AbrController]["+e+"] Incremental switch => quality: "+n),n=s+1);var m=h.call(a,e,t);l=m.min,d=m.max,n<l&&(n=l,a.debug.log("[AbrController]["+e+"] New quality < min => "+n)),n>d&&(n=d,a.debug.log("[AbrController]["+e+"] New quality > max => "+n)),n>r[e]&&(n=r[e],a.debug.log("[AbrController]["+e+"] Max allowed quality = "+n))}return u.call(a,e,n),c.call(a,e,i),a.debug.info("[AbrController]["+e+"] Set quality: "+n),{quality:n,confidence:i}},getAutoSwitchFor:function(e){return a(e)},setAutoSwitchFor:function(e,t){t!==a(e)&&(this.debug.log("[AbrController]["+e+"] Set auto switch: "+t),s(e,t))},getQualityFor:function(e){return l(e)},setQualityFor:function(e,t){t!==l(e)&&(this.debug.log("[AbrController]["+e+"] Set playback quality: "+t),u(e,t))},isMinQuality:function(e,t,n){return n<=h.call(this,e,t).min},setPlayerState:function(e){o=e}}},y.dependencies.AbrController.prototype={constructor:y.dependencies.AbrController},y.dependencies.AbrController.BANDWIDTH_SAFETY=.9,y.dependencies.BufferController=function(){var e,t,n,r,i,o,a,s,u,d=!1,f=!1,h=!1,p=!0,m=[],v=!1,_=-1,b=!0,E=!1,T=!1,x=-1,w=-1,I=!1,D=!1,R=!1,A=null,P=null,M=0,L=null,C=0,O=!1,k=null,N=!1,F=null,B=null,U=!1,j=0,H=!0,q=!1,V=null,G=null,K=!0,z=!1,Y=-1,W=-1,X=null,Q=!1,Z=0,J=null,$=null,ee=-1,te=NaN,ne="Safari"===l().name,re="Firefox"===l().name,ie=function(){Te.call(this)&&null!==L&&this.fragmentController.onBufferControllerStateChange()},oe=function(e,t){var n=0,r=null;!1===K&&(r=G.start,n=e.getTime()-r.getTime(),G.duration=n,G.stopreason=t,K=!0)},ae=function(e){var t=this;"text"!==r&&(t.debug.info("[BufferController]["+r+"] stalled = "+e),I=e,t.videoModel.stallStream(r,I),t.abrController.setPlayerState(I?"buffering":"playing"))},se=function(){d&&f&&(this.debug.info("[BufferController]["+r+"] startPlayback"),ae.call(this,!0),Ne.call(this))},le=function(){var e,t=this;if(!0!==f){if(!1===v&&(e=new Date,oe(e,y.vo.metrics.PlayList.Trace.USER_REQUEST_STOP_REASON),V=this.metricsModel.addPlayList(r,e,0,y.vo.metrics.PlayList.INITIAL_PLAY_START_REASON)),R){if("application/ttml+xml"===F.mimeType)return;R=!1}f=!0,t.debug.info("[BufferController]["+r+"] START"),h=!0,Y=-1,W=-1,J=null,se.call(t)}},ue=function(e){var t=this,n=new Date;!0===v&&_===e||(this.debug.info("[BufferController]["+r+"] SEEK: "+e),!0===f&&ce.call(t),this.fragmentController.clearExecutedRequests(L),V=this.metricsModel.addPlayList(r,n,_,y.vo.metrics.PlayList.SEEK_START_REASON),v=!0,_=e,c.when(!X||X.promise).then(function(){le.call(t)}))},de=function(){this.debug.info("[BufferController]["+r+"] SEEKED"),v=!1,_=-1},ce=function(){f&&(this.debug.info("[BufferController]["+r+"] STOP"),clearTimeout(s),clearTimeout(u),f=!1,h=!1,v=!1,_=-1,clearTimeout($),$=null,oe(new Date,y.vo.metrics.PlayList.Trace.USER_REQUEST_STOP_REASON),this.fragmentController.abortRequestsForModel(L))},fe=function(t){return e[t]},he=function(e){this.debug.info("[BufferController]["+r+"] Load request ",null!==e.url?e.url:e.quality)},pe=function(e,t){void 0!==e.sequenceNumber&&(ee=e.sequenceNumber),this.fragmentController.isInitializationRequest(e)?me.call(this,e,t):ge.call(this,e,t)},me=function(e,t){var n,i=this,o=t.data,a=e.quality;i.debug.log("[BufferController]["+r+"] Initialization loaded ",a);try{n=i.fragmentController.process(o),n?(m[a]=n,i.debug.info("[BufferController]["+r+"] Buffer initialization segment ",null!==e.url?e.url:e.quality),ye.call(i,n,e.quality).then(function(){Te()&&Ae.call(i)})):Ae.call(i)}catch(e){Se.call(i),e.name?i.errHandler.sendError(e.name,e.message,e.data):i.errHandler.sendError(y.dependencies.ErrorHandler.prototype.INTERNAL_ERROR,"Internal error while processing media segment",e.message)}},ge=function(n,i){var o,a,s=this,l=this.manifestExt.getEventStreamForAdaptationSet(s.getData()),u=this.manifestExt.getEventStreamForRepresentation(s.getData(),t);if(te=n.duration,Te()){Z=0,s.debug.log("[BufferController]["+r+"] Media loaded ",n.url),!0===s.chunkAborted&&(s.chunkAborted=!1),1===s.chunkMissingCount&&(s.chunkMissingCount=0);try{a=s.fragmentController.process(i.data,n,e),a?((l.length>0||u.length>0)&&(o=be.call(s,a,n,l,u),s.eventController.addInbandEvents(o)),s.debug.info("[BufferController]["+r+"] Buffer segment from url ",n.url),a=Ee.call(s,a),c.when(!T||we.call(s)).then(function(){T=!1,re&&(B.timestampOffset=-_e(a)/n.timescale),ye.call(s,a,n.quality,n.index).then(function(){x!==n.quality&&(s.debug.log("[BufferController]["+r+"] Buffered quality changed: "+n.quality),s.metricsModel.addBufferedSwitch(r,n.startTime,t.id,n.quality),x=n.quality),Se.call(s),Ne.call(s)})})):(s.debug.error("[BufferController]["+r+"] Error with segment data, no bytes to push"),Se.call(s),Ne.call(s))}catch(e){Se.call(s),e.name?s.errHandler.sendError(e.name,e.message,e.data):s.errHandler.sendError(y.dependencies.ErrorHandler.prototype.INTERNAL_ERROR,"Internal error while processing media segment",e.message)}}},ye=function(e,n,i){var o=this,a=c.defer(),s=o.videoModel.getCurrentTime(),l=new Date;if(!0===K&&(K=!1,G=o.metricsModel.appendPlayListTrace(V,t.id,null,l,s,null,1,null)),Me())return xe.call(o).then(function(){Me()&&(o.debug.log("[BufferController]["+r+"] Buffering segment"),o.sourceBufferExt.append(B,e,Q).then(function(){if(o.debug.log("[BufferController]["+r+"] Segment buffered"),O=!1,D&&C>1&&!ne)we.call(o,-1,Ce.call(o)-30).then(function(){ve.call(o),a.resolve()});else if(U){var e=q?-1:Ce.call(o)+te,t=q?Ce.call(o)-te:-1;we.call(o,e,t).then(function(){ve.call(o),a.resolve()})}else ve.call(o),a.resolve();o.system.notify("bufferUpdated")},function(t){o.errHandler.sendError(y.dependencies.ErrorHandler.prototype.MEDIA_ERR_APPEND_SOURCEBUFFER,"Failed to append data into "+r+" source buffer",new y.vo.Error(t.err.code,t.err.name,t.err.message)),t.err.code===y.dependencies.ErrorHandler.prototype.DOM_ERR_QUOTA_EXCEEDED&&(k={data:e,quality:n,index:i},A=a,O=!0,M=0,ce.call(o))}))}),a.promise},ve=function(){var e,t,n=null;if(this.debug.getLevel()>=this.debug.INFO&&B){if(null===(n=this.sourceBufferExt.getAllRanges(B))||0===n.length)return;for(e=0,t=n.length;e<t;e+=1)this.debug.info("[BufferController]["+r+"] Buffered range ["+e+"]: "+n.start(e)+" - "+n.end(e)+" ("+this.getVideoModel().getCurrentTime()+")")}},_e=function(e){var t=S.deserialize(e),n=t.getBoxByType("moof"),r=null===n?null:n.getBoxByType("traf"),i=null===r?null:r.getBoxByType("trun");return null===i||0===i.samples_table.length?0:void 0===i.samples_table[0].sample_composition_time_offset?0:i.samples_table[0].sample_composition_time_offset},be=function(e,t,n,r){var i,o,a,s=[],l=0,u=Math.pow(256,2),d=Math.pow(256,3),c=Math.max(isNaN(t.startTime)?0:t.startTime,0),f=[];z=!1,a=n.concat(r);for(var h=0;h<a.length;h++)f[a[h].schemeIdUri]=a[h];for(;l<e.length&&(i=String.fromCharCode(e[l+4],e[l+5],e[l+6],e[l+7]),o=e[l]*d+e[l+1]*u+256*e[l+2]+1*e[l+3],"moov"!==i&&"moof"!==i);){if("emsg"===i){z=!0;for(var p=["","",0,0,0,0,""],m=0,y=l+12;y<o+l;)0===m||1===m||6===m?(0!==e[y]?p[m]+=String.fromCharCode(e[y]):m+=1,y+=1):(p[m]=e[y]*d+e[y+1]*u+256*e[y+2]+1*e[y+3],y+=4,m+=1);var v=p[0],_=p[1],b=p[2],E=p[3],T=p[4],S=p[5],x=p[6],w=c*b+E;if(f[v]){var I=new g.vo.Event;I.eventStream=f[v],I.eventStream.value=_,I.eventStream.timescale=b,I.duration=T,I.id=S,I.presentationTime=w,I.messageData=x,I.presentationTimeDelta=E,s.push(I)}}l+=o}return s},Ee=function(e){if(!z)return e;for(var t,n,r=e.length,i=0,o=0,a=0,s=Math.pow(256,2),l=Math.pow(256,3),u=new Uint8Array(e.length);i<r;){if(t=String.fromCharCode(e[i+4],e[i+5],e[i+6],e[i+7]),n=e[i]*l+e[i+1]*s+256*e[i+2]+1*e[i+3],"emsg"!==t)for(a=i;a<i+n;a++)u[o]=e[a],o+=1;i+=n}return u.subarray(0,o)},Te=function(){var e=this;return!!f||(Se.call(e),!1)},Se=function(){X&&(X.resolve(),X=null)},xe=function(){var e,t,n=this,r=c.defer(),i=0;return O?(t=function(){var n,o,a=this,s=a.videoModel.getCurrentTime();o=a.fragmentController.getExecutedRequestForTime(L,s),n=o&&!isNaN(o.startTime)?o.startTime:Math.floor(s),e=o&&!isNaN(o.duration)?o.duration:1,we.call(a,0,n).then(function(n){i+=n,i>=e?r.resolve():setTimeout(t,1e3*e)})},t.call(n),r.promise):c.when(!0)},we=function(e,t){var i,o,a=this,s=c.defer();return 0===B.buffered.length?(s.resolve(0),s.promise):(i=void 0!==e&&-1!==e?e:B.buffered.start(0),(o=void 0!==t&&-1!==t?t:B.buffered.end(B.buffered.length-1))<=i?(s.resolve(0),s.promise):(a.debug.info("[BufferController]["+r+"] Remove from "+i+" to "+o+" ("+a.getVideoModel().getCurrentTime()+")"),"text"!==r&&a.sourceBufferExt.abort(n,B),a.sourceBufferExt.remove(B,i,o,P.duration,n,Q).then(function(){a.fragmentController.removeExecutedRequestsBeforeTime(L,o+1),a.fragmentController.cancelPendingRequestsForModel(L),s.resolve(o-i)},function(e){a.errHandler.sendWarning(y.dependencies.ErrorHandler.prototype.MEDIA_ERR_REMOVE_SOURCEBUFFER,"Failed to remove data from "+r+" source buffer",new y.vo.Error(e.code,e.name,e.message)),s.resolve(0)}),s.promise))},Ie=function(e){if(Te.call(this)){if(Se.call(this),e.aborted)return void Be.call(this);if("text"===r)return void this.errHandler.sendWarning(y.dependencies.ErrorHandler.prototype.DOWNLOAD_ERR_CONTENT,"Failed to download media segment",{url:e.url,status:e.status});Z+=1,3===Z?this.errHandler.sendError(y.dependencies.ErrorHandler.prototype.DOWNLOAD_ERR_CONTENT,"Failed to download media segment",{url:e.url,status:e.status}):(this.errHandler.sendWarning(y.dependencies.ErrorHandler.prototype.DOWNLOAD_ERR_CONTENT,"Failed to download media segment",{url:e.url,status:e.status}),J=e,0===Y&&Ve.call(this))}},De=function(){var e=this;e.debug.log("[BufferController]["+r+"] Stream is complete."),R=!0,oe(new Date,y.vo.metrics.PlayList.Trace.END_OF_CONTENT_STOP_REASON),Se.call(e),ce.call(e),e.system.notify("bufferingCompleted")},Re=function(t){var n=this;return Te.call(n)?m[t]?(n.debug.info("[BufferController]["+r+"] Buffer initialization segment, quality = ",t),ye.call(this,m[t],t).then(function(){n.debug.log("[BufferController]["+r+"] Initialization segment buffered"),Te()&&Ae.call(n)}),c.when(null)):this.indexHandler.getInitRequest(e[t]):c.when(null)},Ae=function(){var e,n,i=this,o=Ce.call(i);Te.call(i)&&(T?n=o:(e=i.sourceBufferExt.getBufferRange(B,o),n=e?e.end:o),-1===ee||v?(i.debug.log("[BufferController]["+r+"] loadNextFragment for time: "+n),i.indexHandler.getSegmentRequestForTime(t,n).then(Pe.bind(i),function(){w=-1,De.call(i)})):(i.debug.log("[BufferController]["+r+"] loadNextFragment for sequence number: "+ee),i.indexHandler.getNextSegmentRequestFromSN(t,ee).then(Pe.bind(i))))},Pe=function e(n){var i=this,o=i.manifestModel.getValue();if(null!==n&&n.action===n.ACTION_COMPLETE)return void De.call(i);null!==n?(U&&(n=i.indexHandler.getIFrameRequest(n)),i.fragmentController.isFragmentLoadedOrPending(i,n)?(i.debug.log("[BufferController]["+r+"] new fragment request => already loaded or pending "+n.url),i.indexHandler.getNextSegmentRequest(t).then(e.bind(i))):(i.fragmentController.prepareFragmentForLoading(i,n,he,pe,Ie,null),ie.call(i))):(i.debug.log("[BufferController]["+r+"] loadNextFragment failed"),Se.call(i),D?"M3U"===o.name&&Ue.call(i,w).then(function(){t=fe.call(i,w),Fe.call(i,0)},function(e){e&&i.errHandler.sendError(e.name,e.message,e.data)}):De.call(i))},Me=function(){return!!F&&!!B},Le=function(){var e=this.videoModel.getCurrentTime();return P.start+P.duration-e},Ce=function(){var e=this.videoModel.getCurrentTime();return v?_:e},Oe=function(){var e,n=this,i=c.defer(),o=t.segmentAvailabilityRange.end;return n.debug.log("[BufferController]["+r+"] Manifest live edge = "+o),e=Math.max(o-a,t.segmentAvailabilityRange.start),this.indexHandler.getSegmentRequestForTime(t,e).then(function(e){P.liveEdge=e.startTime,n.debug.log("[BufferController]["+r+"] Live edge = "+P.liveEdge),i.resolve(P.liveEdge)}),i.promise},ke=function(e){if(Me()){var t=this,n=Ce.call(t);C=t.sourceBufferExt.getBufferLength(B,n),t.debug.log("[BufferController]["+r+"] Working time = "+n+", Buffer level = "+C.toFixed(3)),e&&t.metricsModel.addBufferLevel(r,new Date,C),t.updateBufferState()}},Ne=function(){var e,t,n=this;Te.call(n)&&(n.debug.log("[BufferController]["+r+"] Check buffer..."),ke.call(n,!0),I&&C>o&&ae.call(n,!1),e=Le.call(n),n.debug.log("[BufferController]["+r+"] time to end = "+e),U?C<1&&Be.call(n):E||T||C<i&&(i<e||i>=e&&!R)?Be.call(n):(t=C-i+.5,Fe.call(n,t)))},Fe=function(e){var t=this;e=Math.max(e,te/2),this.debug.log("[BufferController]["+r+"] Check buffer in = "+e.toFixed(3)+" ms (bufferLevel = "+C+")"),clearTimeout(s),s=setTimeout(function(){s=null,Ne.call(t)},1e3*e)},Be=function(){var n,i,o=this,a=new Date,s=o.videoModel.getCurrentTime(),l=o.manifestModel.getValue(),u=!1,d=null;null!==X&&o.debug.error("[BufferController]["+r+"] deferredFragmentBuffered has not been resolved, create a new one is not correct."),X=c.defer(),o.debug.log("[BufferController]["+r+"] Start buffering process..."),He.call(o),u=0===m.length,i=o.abrController.getPlaybackQuality(r,F),n=i.quality,t=fe.call(o,n),n!==w&&(o.debug.log("[BufferController]["+r+"] currentDownloadQuality changed : "+n),w=n,u=!0,oe(new Date,y.vo.metrics.PlayList.Trace.REPRESENTATION_SWITCH_STOP_REASON),o.debug.log("[BufferController]["+r+"] Send RepresentationSwitch with quality = "+n),o.metricsModel.addRepresentationSwitch(r,a,s,t.id,n),"M3U"!==l.name||!D&&null!==e[n].initialization||(d=c.defer(),Ue.call(o,n).then(function(){t=fe.call(o,n),d.resolve()},function(e){d.reject(e)}))),c.when(!d||d.promise).then(function(){!0===u?Re.call(o,n).then(function(e){null!==e&&(o.fragmentController.prepareFragmentForLoading(o,e,he,pe,Ie,null),ie.call(o))},function(e){Se.call(o),e.name===y.dependencies.ErrorHandler.prototype.MEDIA_ERR_CODEC_UNSUPPORTED?o.errHandler.sendError(e.name,e.message,e.data):o.errHandler.sendError(y.dependencies.ErrorHandler.prototype.INTERNAL_ERROR,"Internal error while processing initialization segment",e.message)}):Ae.call(o)},function(e){Se(),e&&o.errHandler.sendError(e.name,e.message,e.data)})},Ue=function(t){var n,r,i=this,o=c.defer(),a=i.manifestModel.getValue();return Te.call(i)?(r=this.manifestExt.getDataIndex(F,a,P.index),n=a.Period_asArray[P.index].AdaptationSet_asArray[r].Representation_asArray[t],i.parser.hlsParser.updatePlaylist(n).then(function(){e=je.call(i,F,P),o.resolve()},function(e){o.reject(e)}),o.promise):(o.reject(),o.promise)},je=function(e,t){var n,r,i=this.manifestModel.getValue();return n=this.manifestExt.getDataIndex(e,i,t.index),r=this.manifestExt.getAdaptationsForPeriod(i,t),this.manifestExt.getRepresentationsForAdaptation(i,r[n])},He=function(){if(!1===b)return!1;this.debug.log("[BufferController]["+r+"] Data changed"),e=je.call(this,F,P),t=fe.call(this,this.abrController.getPlaybackQuality(r,F).quality),this.bufferExt.updateData(F,r),E&&(m=[],this.fragmentController.clearExecutedRequests(L),T=!0,"text"===r&&(B.UpdateLang(F.id,F.lang),"application/ttml+xml"===F.mimeType&&we.call(this))),b=!1,E=!1},qe=function(e){var t,n,i=this,o=this.abrController.getQualityFor(r);if(!this.abrController.isMinQuality(r,F,o)){n=i.abrRulesCollection.getRules(y.rules.BaseRulesCollection.prototype.ABANDON_FRAGMENT_RULES);var a=function(e){e.quality<o&&(i.fragmentController.abortRequestsForModel(L),i.debug.info("[BufferController]["+r+"] Abandon current segment download"))};for(t=0;t<n.length;t++)n[t].execute(e.data.request,a)}},Ve=function(){null!==J&&(this.debug.log("[BufferController]["+r+"] Signal segment loading failed"),this.system.notify("segmentLoadingFailed",J),J=null)};return{videoModel:void 0,metricsModel:void 0,manifestExt:void 0,manifestModel:void 0,bufferExt:void 0,sourceBufferExt:void 0,abrController:void 0,parser:void 0,fragmentExt:void 0,indexHandler:void 0,debug:void 0,system:void 0,errHandler:void 0,config:void 0,abrRulesCollection:void 0,initialize:function(e,t,n,r,s,l,u){var c=this.manifestModel.getValue();this.debug.log("[BufferController]["+e+"] Initialize"),-1!==navigator.userAgent.indexOf("Espial")&&(this.debug.log("[BufferController]["+e+"] Espial browser = sync append"),Q=!0),this[y.dependencies.FragmentLoader.eventList.ENAME_LOADING_PROGRESS]=qe,D=this.manifestExt.getIsDynamic(c),this.setMediaSource(l),this.setType(e),this.setBuffer(r),this.setFragmentController(s),this.setEventController(u),i=this.config.getParamFor(e,"BufferController.minBufferTime","number",-1),o=this.config.getParamFor(e,"BufferController.minBufferTimeForPlaying","number",0),a=this.config.getParamFor(e,"BufferController.liveDelay","number",-1),this.updateData(n,t),this.load(),d=!0},load:function(){var e=this,n=e.manifestModel.getValue();He.call(this),t=fe.call(e,e.abrController.getPlaybackQuality(r,F).quality),w=-1,this.fragmentController.reset&&this.fragmentController.reset(),we.call(this).then(function(){t&&(e.indexHandler.setIsDynamic(D),-1===i&&(i=e.bufferExt.decideBufferLength(n.minBufferTime,P.duration,h)),(-1===a||a<i)&&(a=i),n.minBufferTime=i,"video"===r&&(D?e.indexHandler.updateSegmentList(t).then(function(){Oe.call(e).then(function(t){e.system.notify("startTimeFound",t)})}):e.indexHandler.getCurrentTime(t).then(function(n){n<t.segmentAvailabilityRange.start&&(n=t.segmentAvailabilityRange.start),e.system.notify("startTimeFound",n)})))})},getIndexHandler:function(){return this.indexHandler},getType:function(){return r},setType:function(e){r=e,void 0!==this.indexHandler&&this.indexHandler.setType(e)},getPeriodInfo:function(){return P},getVideoModel:function(){return this.videoModel},setVideoModel:function(e){this.videoModel=e},getFragmentController:function(){return this.fragmentController},setFragmentController:function(e){e&&(this.fragmentController=e,L=this.fragmentController.attachBufferController(this),L.fragmentLoader.subscribe(y.dependencies.FragmentLoader.eventList.ENAME_LOADING_PROGRESS,this),L.setType(r))},setEventController:function(e){this.eventController=e},getData:function(){return F},updateData:function(e,t){this.debug.log("[BufferController]["+r+"] Update data"),E=null!==F&&(F.id!==e.id||F.lang!==e.lang||F.subType!==e.subType),F=e,P=t,b=!0,E&&(this.debug.log("[BufferController]["+r+"] Track changed"),clearTimeout(s),s=null,R=!1,le.call(this),null===X&&Ne.call(this))},getHtmlVideoState:function(){return Y},getAvailableRepresentations:function(){return e},getCurrentRepresentation:function(){return t},getBuffer:function(){return B},setBuffer:function(e){B=e},getMinBufferTime:function(){return i},setMinBufferTime:function(e){i=e},getLiveDelay:function(){return a},setMediaSource:function(e){n=e},isReady:function(){return!0},isBufferingCompleted:function(){return R},clearMetrics:function(){null!==r&&""!==r&&this.metricsModel.clearCurrentMetricsForType(r)},updateManifest:function(){this.system.notify("manifestUpdate")},updateBufferState:function(){var e,t=this,n=this.videoModel.getCurrentTime(),i=-1===W?n:W,o=n-i;if(clearTimeout(u),u=null,!1!==f&&"text"!==r&&!U){switch(Y){case-1:Y=0,this.debug.info("[BufferController]["+r+"] BUFFERING - "+n+" - "+C),this.metricsModel.addState(r,"buffering",n);break;case 0:!this.getVideoModel().isPaused()&&o>0&&C>=1?(Y=1,this.debug.info("[BufferController]["+r+"] PLAYING - "+n),this.metricsModel.addState(r,"playing",n),v=!1,_=-1,Z=0):this.getVideoModel().isStalled()||(e=this.sourceBufferExt.getAllRanges(B));break;case 1:if(!this.getVideoModel().isPaused()&&!this.getVideoModel().isSeeking()&&(o<=0&&C<=1||0===C))if(Y=0,this.debug.info("[BufferController]["+r+"] BUFFERING - "+n+" - "+C),this.metricsModel.addState(r,"buffering",n),J)Ve.call(this);else{e=this.sourceBufferExt.getAllRanges(B);var a;for(a=0;a<e.length&&!(n<e.start(a));a++);a<e.length&&this.videoModel.setCurrentTime(e.start(a))}u=setTimeout(function(){u=null,ke.call(t,!1)},1e3)}n>0&&(W=n)}},updateStalledState:function(){I=this.videoModel.isStalled()},reset:function(e){var t=this,i=function(e){e&&(e.reject(),e=null)},o=c.defer();return ce.call(this),this.sourceBufferExt.abort(n,B),c.when(!X||X.promise).then(function(){i(A),i(X),L&&(L.fragmentLoader.unsubscribe(y.dependencies.FragmentLoader.eventList.ENAME_LOADING_PROGRESS,t.abrController),t.fragmentController.abortRequestsForModel(L),t.fragmentController.detachBufferController(L),L=null),t.clearMetrics(),m=[],p=!0,O=!1,k=null,N=!1,U&&(t.abrController.setAutoSwitchFor(r,H),t.abrController.setQualityFor(r,j)),e||t.sourceBufferExt.removeSourceBuffer(n,B),F=null,B=null,o.resolve()},function(){o.reject()}),o.promise},getSegmentDuration:function(){return te},setTrickMode:function(e,t){var n=c.defer();return this.debug.log("[BufferController]["+r+"] setTrickMode - enabled = "+e),U===e?(n.resolve(),n.promise):(U=e,U?(q=t,j=this.abrController.getQualityFor(r),H=this.abrController.getAutoSwitchFor(r),this.abrController.setAutoSwitchFor(r,!1),this.abrController.setQualityFor(r,0),n.resolve()):(this.abrController.setAutoSwitchFor(r,H),this.abrController.setQualityFor(r,j),we.call(this).then(function(){n.resolve()})),n.promise)},start:le,seek:ue,stop:ce,seeked:de,updateBufferLevel:ke}},y.dependencies.BufferController.prototype={constructor:y.dependencies.BufferController},y.dependencies.BufferExtensions=function(){var e,t,n=0,r=0,i=null,o=null,a=function(e){var t=this.metricsExt.getCurrentHttpRequest(e);return null!==t?(t.tresponse.getTime()-t.trequest.getTime())/1e3:0},s=function(){var e,t,a=this;return e=i?a.abrController.getQualityFor("audio"):n,t=o?a.abrController.getQualityFor("video"):r,e===n&&t===r};return{system:void 0,videoModel:void 0,metricsExt:void 0,metricsModel:void 0,abrController:void 0,bufferMax:void 0,updateData:function(e,t){if(e){var a=e.Representation_asArray.length-1;"audio"===t?(n=a,i=e):"video"===t&&(r=a,o=e)}},getTopQualityIndex:function(e){var t=null;return"audio"===e?t=n:"video"===e&&(t=r),t},decideBufferLength:function(t,n){return e=isNaN(n)||y.dependencies.BufferExtensions.DEFAULT_MIN_BUFFER_TIME<n&&t<n?Math.max(y.dependencies.BufferExtensions.DEFAULT_MIN_BUFFER_TIME,t):t>=n?Math.min(n,y.dependencies.BufferExtensions.DEFAULT_MIN_BUFFER_TIME):Math.min(n,t)},getLeastBufferLevel:function(){var e=this.metricsModel.getReadOnlyMetricsFor("video"),t=this.metricsExt.getCurrentBufferLevel(e),n=this.metricsModel.getReadOnlyMetricsFor("audio"),r=this.metricsExt.getCurrentBufferLevel(n);return null===t||null===r?null!==r?r.level:null!==t?t.level:null:Math.min(r.level,t.level)},getRequiredBufferLength:function(n,r,i,o){var l,u=this,d=u.metricsModel.getReadOnlyMetricsFor("video"),f=u.metricsModel.getReadOnlyMetricsFor("audio"),h=o>=y.dependencies.BufferExtensions.LONG_FORM_CONTENT_DURATION_THRESHOLD,p=c.defer(),m=!1;return u.bufferMax===y.dependencies.BufferExtensions.BUFFER_SIZE_MIN?(l=e,p.resolve(l)):u.bufferMax===y.dependencies.BufferExtensions.BUFFER_SIZE_INFINITY?(l=o,p.resolve(l)):u.bufferMax===y.dependencies.BufferExtensions.BUFFER_SIZE_REQUIRED?(t=e,i||n||(m=s.call(u)),m&&(t=h?y.dependencies.BufferExtensions.BUFFER_TIME_AT_TOP_QUALITY_LONG_FORM:y.dependencies.BufferExtensions.BUFFER_TIME_AT_TOP_QUALITY),l=t+r+Math.max(a.call(u,d),a.call(u,f)),p.resolve(l)):p.reject("invalid bufferMax value: "+u.bufferMax),p.promise},getBufferTarget:function(){return void 0===t?e:t}}},y.dependencies.BufferExtensions.BUFFER_SIZE_REQUIRED="required",y.dependencies.BufferExtensions.BUFFER_SIZE_MIN="min",y.dependencies.BufferExtensions.BUFFER_SIZE_INFINITY="infinity",y.dependencies.BufferExtensions.BUFFER_TIME_AT_STARTUP=1,y.dependencies.BufferExtensions.DEFAULT_MIN_BUFFER_TIME=16,y.dependencies.BufferExtensions.DEFAULT_LIVE_DELAY=16,y.dependencies.BufferExtensions.BUFFER_TIME_AT_TOP_QUALITY=30,y.dependencies.BufferExtensions.BUFFER_TIME_AT_TOP_QUALITY_LONG_FORM=300,y.dependencies.BufferExtensions.LONG_FORM_CONTENT_DURATION_THRESHOLD=600,y.dependencies.BufferExtensions.prototype.constructor=y.dependencies.BufferExtensions,y.utils.Capabilities=function(){},y.utils.Capabilities.prototype={constructor:y.utils.Capabilities,system:void 0,supportsMediaSource:function(){var e="WebKitMediaSource"in window,t="MediaSource"in window;return e||t},supportsMediaKeys:function(){var e="WebKitMediaKeys"in window,t="MSMediaKeys"in window,n="MediaKeys"in window;return e||t||n},supportsEncryptedMedia:function(){return this.system.hasMapping("protectionModel")},supportsCodec:function(e,t){if(!(e instanceof HTMLMediaElement))throw"element must be of type HTMLMediaElement.";var n=e.canPlayType(t);return"probably"===n||"maybe"===n}},y.utils.Config=function(){var e=["video","audio"],t={"BufferController.minBufferTimeForPlaying":-1,"BufferController.minBufferTime":-1,"BufferController.liveDelay":-1,"ABR.minBandwidth":-1,"ABR.maxBandwidth":-1,"ABR.minQuality":-1,"ABR.maxQuality":-1,"ABR.switchUpIncrementally":!1,"ABR.switchUpRatioSafetyFactor":-1,"ABR.latencyInBandwidth":!0,"ABR.switchDownBufferTime":-1,"ABR.switchDownBufferRatio":-1,"ABR.switchLowerBufferTime":-1,"ABR.switchLowerBufferRatio":-1,"ABR.switchUpBufferTime":-1,"ABR.switchUpBufferRatio":-1,"ABR.keepBandwidthCondition":!0,"ABR.droppedFramesMinRatio":-1,"ABR.droppedFramesMaxRatio":-1,"ManifestLoader.RetryAttempts":-1,"ManifestLoader.RetryInterval":-1,"FragmentLoader.RetryAttempts":-1,"FragmentLoader.RetryInterval":-1,video:{},audio:{}},n=function(n){var r,i,o;for(r in n)if(n.hasOwnProperty(r)&&-1===r.indexOf("//"))if(e.indexOf(r)>-1){i=n[r];for(o in i)i.hasOwnProperty(o)&&(t[r][o]=n[r][o])}else t[r]=n[r]},r=function(e,t,n,r){var i=e[t];if(void 0===i||-1===i)return r;if(void 0!==n&&(void 0===i?"undefined":d(i))!==n)switch(n){case"number":i=Number(i);break;case"boolean":i="true"===i||"1"===i||1===i}return i},i=function(e,n,i){return r(t,e,n,i)},o=function(e,n,i,o){var a=t[e];return void 0!==a&&void 0!==a[n]?r(a,n,i,o):r(t,n,i,o)};return{debug:void 0,setup:function(){},setParams:function(e){n(e);var t=this.getParam("Debug.level","number",-1);-1!==t&&this.debug.setLevel(t)},getParam:function(e,t,n){return i(e,t,n)},getParamFor:function(e,t,n,r){return o(e,t,n,r)}}},y.utils.Config.prototype={constructor:y.utils.Config},y.di.Context=function(){var e=function(){var e=document.createElement("video"),t=this.system.getObject("debug");y.models.ProtectionModel_21Jan2015.detect(e)?this.system.mapSingleton("protectionModel",y.models.ProtectionModel_21Jan2015):y.models.ProtectionModel_3Feb2014.detect(e)?this.system.mapClass("protectionModel",y.models.ProtectionModel_3Feb2014):y.models.ProtectionModel_01b.detect(e)?this.system.mapClass("protectionModel",y.models.ProtectionModel_01b):(t.log("No supported version of EME detected on this user agent!"),t.log("Attempts to play encrypted content will fail!"))};return{system:void 0,setup:function(){this.system.autoMapOutlets=!0,this.system.mapSingleton("capabilities",y.utils.Capabilities),this.system.mapSingleton("config",y.utils.Config),this.system.mapSingleton("debug",y.utils.Debug),this.system.mapSingleton("debugController",y.utils.DebugController),this.system.mapClass("domParser",y.utils.DOMParser),this.system.mapSingleton("eventBus",y.utils.EventBus),this.system.mapSingleton("textTrackExtensions",y.utils.TextTrackExtensions),this.system.mapSingleton("tokenAuthentication",y.utils.TokenAuthentication),this.system.mapSingleton("vttParser",y.utils.VTTParser),this.system.mapSingleton("ttmlParser",y.utils.TTMLParser),this.system.mapSingleton("ttmlRenderer",y.utils.TTMLRenderer),this.system.mapSingleton("manifestModel",y.models.ManifestModel),this.system.mapClass("metrics",y.models.MetricsList),this.system.mapSingleton("metricsModel",y.models.MetricsModel),this.system.mapSingleton("uriQueryFragModel",y.models.URIQueryAndFragmentModel),this.system.mapSingleton("videoModel",y.models.VideoModel),this.system.mapSingleton("abrController",y.dependencies.AbrController),this.system.mapClass("bufferController",y.dependencies.BufferController),this.system.mapSingleton("bufferExt",y.dependencies.BufferExtensions),this.system.mapSingleton("errHandler",y.dependencies.ErrorHandler),this.system.mapClass("eventController",y.dependencies.EventController),this.system.mapClass("fragmentController",y.dependencies.FragmentController),this.system.mapClass("fragmentInfoController",y.dependencies.FragmentInfoController),this.system.mapClass("fragmentLoader",y.dependencies.FragmentLoader),this.system.mapClass("fragmentModel",y.dependencies.FragmentModel),this.system.mapClass("manifestLoader",y.dependencies.ManifestLoader),this.system.mapSingleton("manifestUpdater",y.dependencies.ManifestUpdater),this.system.mapSingleton("mediaSourceExt",y.dependencies.MediaSourceExtensions),this.system.mapSingleton("notifier",y.dependencies.Notifier),this.system.mapSingleton("sourceBufferExt",y.dependencies.SourceBufferExtensions),this.system.mapClass("stream",y.dependencies.Stream),this.system.mapSingleton("streamController",y.dependencies.StreamController),this.system.mapClass("textController",y.dependencies.TextController),this.system.mapSingleton("textSourceBuffer",y.dependencies.TextSourceBuffer),this.system.mapSingleton("textTTMLXMLMP4SourceBuffer",y.dependencies.TextTTMLXMLMP4SourceBuffer),this.system.mapSingleton("videoExt",y.dependencies.VideoModelExtensions),this.system.mapClass("protectionController",y.dependencies.ProtectionController),this.system.mapSingleton("protectionExt",y.dependencies.ProtectionExtensions),this.system.mapSingleton("ksClearKey",y.dependencies.protection.KeySystem_ClearKey),this.system.mapSingleton("ksPlayReady",y.dependencies.protection.KeySystem_PlayReady),this.system.mapSingleton("ksWidevine",y.dependencies.protection.KeySystem_Widevine),this.system.mapSingleton("serverClearKey",y.dependencies.protection.servers.ClearKey),this.system.mapSingleton("serverDRMToday",y.dependencies.protection.servers.DRMToday),this.system.mapSingleton("serverPlayReady",y.dependencies.protection.servers.PlayReady),this.system.mapSingleton("serverWidevine",y.dependencies.protection.servers.Widevine),e.call(this),this.system.mapClass("abrRulesCollection",y.rules.BaseRulesCollection),this.system.mapClass("abandonRequestRule",y.rules.AbandonRequestsRule),this.system.mapClass("downloadRatioRule",y.rules.DownloadRatioRule),this.system.mapClass("droppedFramesRule",y.rules.DroppedFramesRule),this.system.mapClass("insufficientBufferRule",y.rules.InsufficientBufferRule),this.system.mapClass("limitSwitchesRule",y.rules.LimitSwitchesRule),this.system.mapClass("baseURLExt",g.dependencies.BaseURLExtensions),this.system.mapClass("fragmentExt",g.dependencies.FragmentExtensions),this.system.mapClass("indexHandler",g.dependencies.DashHandler),this.system.mapSingleton("manifestExt",g.dependencies.DashManifestExtensions),this.system.mapSingleton("metricsExt",y.dependencies.MetricsExtensions),this.system.mapSingleton("timelineConverter",g.dependencies.TimelineConverter),this.system.mapSingleton("parser",y.dependencies.Parser),this.system.mapClass("dashParser",g.dependencies.DashParser),this.system.mapClass("mssParser",p.dependencies.MssParser),this.system.mapClass("hlsParser",m.dependencies.HlsParser),this.system.mapSingleton("hlsDemux",m.dependencies.HlsDemux),this.system.mapSingleton("contextManager",y.modules.ContextManager),this.system.mapHandler("setContext","contextManager","setContext")}}},y.modules.ContextManager=function(){return{system:void 0,debug:void 0,setContext:function(e){this.system.autoMapOutlets=!0,"MSS"===e?(this.system.mapClass("mp4Processor",y.dependencies.Mp4Processor),this.system.mapClass("indexHandler",p.dependencies.MssHandler),this.system.mapClass("fragmentController",p.dependencies.MssFragmentController)):"HLS"===e?(this.system.mapClass("mp4Processor",y.dependencies.Mp4Processor),this.system.mapClass("fragmentController",m.dependencies.HlsFragmentController),this.system.mapClass("indexHandler",m.dependencies.HlsHandler)):(this.system.mapClass("fragmentController",y.dependencies.FragmentController),this.system.mapClass("indexHandler",g.dependencies.DashHandler))}}},y.modules.ContextManager.prototype={constructor:y.modules.ContextManager},y.utils.Debug=function(){Date.prototype.HHMMSSmmm=function(){var e=this.getHours().toString(),t=this.getMinutes().toString(),n=this.getSeconds().toString(),r=this.getMilliseconds().toString();return(e[1]?e:"0"+e[0])+":"+(t[1]?t:"0"+t[0])+":"+(n[1]?n:"0"+n[0])+"."+(r[2]?r:"0"+(r[1]?r:"0"+r[0]))},Date.prototype.MMSSmmm=function(){var e=this.getMinutes().toString(),t=this.getSeconds().toString(),n=this.getMilliseconds().toString();return(e[1]?e:"0"+e[0])+":"+(t[1]?t:"0"+t[0])+"."+(n[2]?n:"0"+(n[1]?n:"0"+n[0]))};var e=function(){this.logArray=[],this.showLevel=!0};e.prototype.error=e.prototype.warn=e.prototype.info=e.prototype.debug=function(e){this.logArray.push(e)},e.prototype.getLogs=function(){return this.logArray};var t=0,n=(new Date,console),r=function(e,t){if(e<=a()){var r=i(e,t);switch(e){case 1:n.error(r);break;case 2:n.warn(r);break;case 3:n.info(r);break;case 4:n.debug(r)}}},i=function(e,t){var r="",i=null;return i=new Date,r+="["+i.HHMMSSmmm()+"]",n&&n.showLevel&&(r+="["+o(e)+"]"),Array.apply(null,t).forEach(function(e){r+=e+" "}),r},o=function(e){switch(e){case 1:return"ERROR";case 2:return"WARN";case 3:return"INFO";case 4:return"DEBUG";default:return""}},a=function(){return t};return{NONE:0,ERROR:1,WARN:2,INFO:3,DEBUG:4,ALL:4,getLevel:a,getLogger:function(){return n},setLevel:function(e){t=e},setLogger:function(t){switch(t){case"log4javascript":var r=new log4javascript.PopUpAppender,i=new log4javascript.PatternLayout("%d{HH:mm:ss.SSS} %-5p - %m%n");r.setLayout(i),n.addAppender(r),n.setLevel(log4javascript.Level.ALL),n.initialized=!0;break;case"memory":n=new e;break;case"console":n=console;break;default:n=null}},error:function(){r.call(this,1,arguments)},warn:function(){r.call(this,2,arguments)},info:function(){r.call(this,3,arguments)},log:function(){r.call(this,4,arguments)}}},y.utils.DebugController=function(){var e={isInDebug:!1,level:0,loggerType:"console"},t=function(t){!0!==t.altKey||!0!==t.ctrlKey||!0!==t.shiftKey||68!==t.keyCode&&90!==t.keyCode||(e.isInDebug?(e.isInDebug=!1,console.log("debug mode desactivated"),90===t.keyCode&&n(this.debug.getLogger().getLogs()),this.debug.setLevel(e.level),this.debug.setLogger(e.loggerType)):(e.isInDebug=!0,console.log("debug mode activated"),e.level=this.debug.getLevel(),this.debug.setLevel(68===t.keyCode?4:3),this.debug.setLogger(68===t.keyCode?"console":"memory")))},n=function(e){if(e&&e.length>0){var t=JSON.stringify(e,null,"\r\n"),n=new Blob([t],{type:"text/json"});if(navigator.msSaveBlob)navigator.msSaveBlob(n,"hasplayer_logs.txt");else{var r=document.createEvent("MouseEvents"),i=document.createElement("a");i.download="hasplayer_logs.txt",i.href=window.URL.createObjectURL(n),i.dataset.downloadurl=["text/json",i.download,i.href].join(":"),r.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),i.dispatchEvent(r)}}};return{debug:void 0,setup:function(){window.addEventListener("keydown",t.bind(this))}}},y.utils.DebugController.prototype={constructor:y.utils.DebugController},y.dependencies.ErrorHandler=function(){return{eventBus:void 0,debug:void 0,sendWarning:function(e,t,n){this.eventBus.dispatchEvent({type:"warning",data:{code:e,message:t,data:n}}),this.debug.warn("[Warn] Code: "+e+", Message: "+t+", Data: "+JSON.stringify(n,null,"\t"))},sendError:function(e,t,n){this.eventBus.dispatchEvent({type:"error",data:{code:e,message:t,data:n}}),this.debug.error("[Error] Code: "+e+", Message: "+t+", Data: "+JSON.stringify(n,null,"\t"))}}},y.dependencies.ErrorHandler.prototype={constructor:y.dependencies.ErrorHandler},y.dependencies.ErrorHandler.prototype.INTERNAL_ERROR="INTERNAL_ERROR",y.dependencies.ErrorHandler.prototype.MEDIA_ERR_ABORTED="MEDIA_ERR_ABORTED",y.dependencies.ErrorHandler.prototype.MEDIA_ERR_NETWORK="MEDIA_ERR_NETWORK",y.dependencies.ErrorHandler.prototype.MEDIA_ERR_DECODE="MEDIA_ERR_DECODE",y.dependencies.ErrorHandler.prototype.MEDIA_ERR_SRC_NOT_SUPPORTED="MEDIA_ERR_SRC_NOT_SUPPORTED",y.dependencies.ErrorHandler.prototype.MEDIA_ERR_ENCRYPTED="MEDIA_ERR_ENCRYPTED",y.dependencies.ErrorHandler.prototype.CAPABILITY_ERR_MEDIASOURCE="CAPABILITY_ERR_MEDIASOURCE",y.dependencies.ErrorHandler.prototype.CAPABILITY_ERR_MEDIAKEYS="CAPABILITY_ERR_MEDIAKEYS",y.dependencies.ErrorHandler.prototype.MEDIA_ERR_CREATE_MEDIASOURCE="MEDIA_ERR_CREATE_MEDIASOURCE",y.dependencies.ErrorHandler.prototype.MEDIA_ERR_CODEC_UNSUPPORTED="MEDIA_ERR_CODEC_UNSUPPORTED",y.dependencies.ErrorHandler.prototype.MEDIA_ERR_CREATE_SOURCEBUFFER="MEDIA_ERR_CREATE_SOURCEBUFFER",y.dependencies.ErrorHandler.prototype.MEDIA_ERR_APPEND_SOURCEBUFFER="MEDIA_ERR_APPEND_SOURCEBUFFER",y.dependencies.ErrorHandler.prototype.MEDIA_ERR_REMOVE_SOURCEBUFFER="MEDIA_ERR_REMOVE_SOURCEBUFFER",y.dependencies.ErrorHandler.prototype.MANIFEST_ERR_PARSE="MANIFEST_ERR_PARSE",y.dependencies.ErrorHandler.prototype.MANIFEST_ERR_NO_STREAM="MANIFEST_ERR_NO_STREAM",y.dependencies.ErrorHandler.prototype.MANIFEST_ERR_NO_VIDEO="MANIFEST_ERR_NO_VIDEO",y.dependencies.ErrorHandler.prototype.MANIFEST_ERR_NO_AUDIO="MANIFEST_ERR_NO_AUDIO",y.dependencies.ErrorHandler.prototype.DOWNLOAD_ERR_MANIFEST="DOWNLOAD_ERR_MANIFEST",y.dependencies.ErrorHandler.prototype.DOWNLOAD_ERR_SIDX="DOWNLOAD_ERR_SIDX",y.dependencies.ErrorHandler.prototype.DOWNLOAD_ERR_INIT="DOWNLOAD_ERR_INIT",y.dependencies.ErrorHandler.prototype.DOWNLOAD_ERR_CONTENT="DOWNLOAD_ERR_CONTENT",y.dependencies.ErrorHandler.prototype.CC_ERR_PARSE="CC_ERR_PARSE",y.dependencies.ErrorHandler.prototype.HLS_DEMUX_ERROR="HLS_DEMUX_ERROR",y.dependencies.ErrorHandler.prototype.MEDIA_KEYERR="MEDIA_KEYERR",y.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_UNKNOWN="MEDIA_KEYERR_UNKNOWN",y.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_CLIENT="MEDIA_KEYERR_CLIENT",y.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_SERVICE="MEDIA_KEYERR_SERVICE",y.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_OUTPUT="MEDIA_KEYERR_OUTPUT",y.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_HARDWARECHANGE="MEDIA_KEYERR_HARDWARECHANGE",y.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_DOMAIN="MEDIA_KEYERR_DOMAIN",y.dependencies.ErrorHandler.prototype.MEDIA_KEYSYSERR_ACCESS_DENIED="MEDIA_KEYSYSERR_ACCESS_DENIED",y.dependencies.ErrorHandler.prototype.MEDIA_KEYMESSERR_URL_LICENSER_UNKNOWN="MEDIA_KEYMESSERR_URL_LICENSER_UNKNOWN",y.dependencies.ErrorHandler.prototype.MEDIA_KEYMESSERR_NO_CHALLENGE="MEDIA_KEYMESSERR_NO_CHALLENGE",y.dependencies.ErrorHandler.prototype.MEDIA_KEYMESSERR_LICENSER_ERROR="MEDIA_KEYMESSERR_LICENSER_ERROR",y.dependencies.ErrorHandler.prototype.MEDIA_KEYMESSERR_NO_SESSION="MEDIA_KEYMESSERR_NO_SESSION",y.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_SERVER_CERTIFICATE="MEDIA_KEYERR_SERVER_CERTIFICATE",y.dependencies.ErrorHandler.prototype.DOM_ERR_INDEX_SIZE=1,y.dependencies.ErrorHandler.prototype.DOM_ERR_HIERARCHY_REQUEST=3,y.dependencies.ErrorHandler.prototype.DOM_ERR_WRONG_DOCUMENT=4,y.dependencies.ErrorHandler.prototype.DOM_ERR_INVALID_CHARACTER=5,y.dependencies.ErrorHandler.prototype.DOM_ERR_NO_MODIFICATION_ALLOWED=7,y.dependencies.ErrorHandler.prototype.DOM_ERR_NOT_FOUND=8,y.dependencies.ErrorHandler.prototype.DOM_ERR_NOT_SUPPORTED=9,y.dependencies.ErrorHandler.prototype.DOM_ERR_INVALID_STATE=11,y.dependencies.ErrorHandler.prototype.DOM_ERR_SYNTAX=12,y.dependencies.ErrorHandler.prototype.DOM_ERR_INVALID_MODIFICATION=13,y.dependencies.ErrorHandler.prototype.DOM_ERR_NAMESPACE=14,y.dependencies.ErrorHandler.prototype.DOM_ERR_INVALID_ACCESS=15,y.dependencies.ErrorHandler.prototype.DOM_ERR_SECURITY=18,y.dependencies.ErrorHandler.prototype.DOM_ERR_NETWORK=19,y.dependencies.ErrorHandler.prototype.DOM_ERR_ABORT=20,y.dependencies.ErrorHandler.prototype.DOM_ERR_URL_MISMATCH=21,y.dependencies.ErrorHandler.prototype.DOM_ERR_QUOTA_EXCEEDED=22,y.dependencies.ErrorHandler.prototype.DOM_ERR_TIMEOUT=23,y.dependencies.ErrorHandler.prototype.DOM_ERR_INVALID_NODE_TYPE=24,y.dependencies.ErrorHandler.prototype.DOM_ERR_DATA_CLONE=25,y.utils.EventBus=function(){var e,t=function(t,n){var r=(n?"1":"0")+t;return r in e||(e[r]=[]),e[r]};return function(){e={}}(),{addEventListener:function(e,n,r){var i=t(e,r);-1===i.indexOf(n)&&i.push(n)},removeEventListener:function(e,n,r){var i=t(e,r),o=i.indexOf(n);-1!==o&&i.splice(o,1)},dispatchEvent:function(e){var n=t(e.type,!1).slice(),r=0;for(r=0;r<n.length;r+=1)n[r].call(this,e);return!e.defaultPrevented}}},y.dependencies.EventController=function(){var e=[],t=[],n=[],r=null,i=function(){null!==r&&(clearInterval(r),r=null),e=null,t=null,n=null},o=function(){null!==r&&(clearInterval(r),r=null)},a=function(){this.debug.log("[EventController] Start Event Controller"),isNaN(100)||(r=setInterval(u.bind(this),100))},s=function(t){var n=this;e=[],t&&t.length>0&&(e=t),n.debug.log("[EventController] Added "+t.length+" inline events")},l=function(e){var n,r=this,i=0;for(i=0;i<e.length;i++)n=e[i],t[n.id]=n,r.debug.log("[EventController] Add inband event with id "+n.id)},u=function(){d.call(this,t),d.call(this,e),c.call(this)},d=function(e){var t,r,i=this,o=this.videoModel.getCurrentTime(),a=0;if(e)for(a=0;a<e.length;a++)void 0!==(r=e[a])&&(0===(t=r.presentationTime/r.eventStream.timescale)||t<=o&&t+.1>o)&&(i.debug.log("[EventController] Start Event at "+o),r.duration>0&&n.push(r),"urn:mpeg:dash:event:2012"===r.eventStream.schemeIdUri&&1===r.eventStream.value&&f.call(this),e.splice(a,1))},c=function(){var e,t,r=this,i=0;if(n)for(e=this.videoModel.getCurrentTime(),i=0;i<n.length;i++)null!==(t=n[i])&&(t.duration+t.presentationTime)/t.eventStream.timescale<e&&(r.debug.log("[EventController] Remove Event at time "+e),t=null,n.splice(i,1))},f=function(){var e=this,t=e.manifestModel.getValue(),n=t.mpdUrl;t.hasOwnProperty("Location")&&(n=t.Location),e.debug.log("[EventController] Refresh manifest @ "+n),e.manifestLoader.load(n).then(function(t){e.manifestModel.setValue(t)})};return{manifestModel:void 0,manifestLoader:void 0,debug:void 0,system:void 0,videoModel:void 0,addInlineEvents:s,addInbandEvents:l,reset:i,clear:o,start:a}},y.dependencies.EventController.prototype={constructor:y.dependencies.EventController},y.dependencies.FragmentController=function(){var e=[],t=function(t){var n=e.length,r=0;for(r=0;r<n;r+=1)if(e[r].getContext()===t)return e[r];return null},n=function(){var t=!0,n=e.length,r=0;for(r=0;r<n;r+=1)if(!e[r].isReady()){t=!1;break}return t},r=function(){var t=0;for(t=0;t<e.length;t+=1)e[t].executeCurrentRequest()};return{system:void 0,debug:void 0,process:function(e){var t=null;return null!==e&&void 0!==e&&e.byteLength>0&&(t=new Uint8Array(e)),t},attachBufferController:function(n){var r;return n?(r=t(n),r||(r=this.system.getObject("fragmentModel"),r.setContext(n),e.push(r)),r):null},detachBufferController:function(t){var n=e.indexOf(t);n>-1&&e.splice(n,1)},onBufferControllerStateChange:function(){n()&&r.call(this)},isFragmentLoadedOrPending:function(e,n){var r=t(e);return!!r&&r.isFragmentLoadedOrPending(n)},getPendingRequests:function(e){var n=t(e);return n?n.getPendingRequests():null},getLoadingRequests:function(e){var n=t(e);return n?n.getLoadingRequests():null},isInitializationRequest:function(e){return e&&e.type&&"initialization segment"===e.type.toLowerCase()},getLoadingTime:function(e){var n=t(e);return n?n.getLoadingTime():null},getExecutedRequestForTime:function(e,t){return e?e.getExecutedRequestForTime(t):null},removeExecutedRequest:function(e,t){e&&e.removeExecutedRequest(t)},removeExecutedRequestsBeforeTime:function(e,t){e&&e.removeExecutedRequestsBeforeTime(t)},clearExecutedRequests:function(e){e&&e.clearExecutedRequests()},cancelPendingRequestsForModel:function(e){e&&e.cancelPendingRequests()},abortRequestsForModel:function(e){e&&e.abortRequests()},prepareFragmentForLoading:function(e,n,r,i,o,a){var s=t(e);return s&&n?(s.addRequest(n),s.setCallbacks(r,i,o,a),!0):null}}},y.dependencies.FragmentController.prototype={constructor:y.dependencies.FragmentController},y.dependencies.FragmentLoader=function(){var e,t=2,n=500,r=0,i=[],o=function(e){var t=new XMLHttpRequest,n=!1;t.open("HEAD",e.url,!0),t.onload=function(){t.status<200||t.status>399||(n=!0,e.deferred.resolve(e))},t.onloadend=t.onerror=function(){n||e.deferred.reject(t)},t.send()},a=function(t){var n=c.defer(),r=new XMLHttpRequest,o=null,a=!0,s=!0,l=null,u=this;return i.push(r),t.requestStartDate=new Date,o=u.metricsModel.addHttpRequest(t.streamType,null,t.type,t.url,null,t.range,t.requestStartDate,null,null,null,null,t.duration,t.startTime,t.quality),u.metricsModel.appendHttpTrace(o,t.requestStartDate,t.requestStartDate.getTime()-t.requestStartDate.getTime(),[0]),l=t.requestStartDate,r.open("GET",u.tokenAuthentication.addTokenAsQueryArg(t.url),!0),r.responseType="arraybuffer",r=u.tokenAuthentication.setTokenInRequestHeader(r),t.range&&r.setRequestHeader("Range","bytes="+t.range),r.onprogress=function(e){var n=new Date;a&&(a=!1,(!e.lengthComputable||e.lengthComputable&&e.total!==e.loaded)&&(t.firstByteDate=n,o.tresponse=n)),e.lengthComputable&&(t.bytesLoaded=e.loaded,t.bytesTotal=e.total),u.metricsModel.appendHttpTrace(o,n,n.getTime()-l.getTime(),[t.bytesLoaded?t.bytesLoaded:0]),l=n,u.notify(y.dependencies.FragmentLoader.eventList.ENAME_LOADING_PROGRESS,{request:t,httpRequestMetrics:o,lastTraceTime:l})},r.onload=function(){if(!(r.status<200||r.status>399)){s=!1;var i,a,d=new Date,c=r.response,f=c?c.byteLength:0;t.firstByteDate||(t.firstByteDate=t.requestStartDate),t.requestEndDate=d,i=t.firstByteDate.getTime()-t.requestStartDate.getTime(),a=t.requestEndDate.getTime()-t.firstByteDate.getTime(),u.debug.log("[FragmentLoader]["+e+"] Loaded: "+t.url+" ("+r.status+", "+i+"ms, "+a+"ms)"),o.tresponse=t.firstByteDate,o.tfinish=t.requestEndDate,o.responsecode=r.status,o.bytesLength=f,u.metricsModel.appendHttpTrace(o,d,d.getTime()-l.getTime(),[f]),l=d,n.resolve({data:c,request:t})}},r.onabort=function(){var e,n,i=new Date;r.aborted=!0,0!==o.trace.length&&(e=o.trace[o.trace.length-1],n=e.b[0],t.requestEndDate=i,o.tresponse=t.firstByteDate,o.tfinish=t.requestEndDate,o.responsecode=r.status,o.bytesLength=n)},r.onloadend=r.onerror=function(){-1!==i.indexOf(r)&&(i.splice(i.indexOf(r),1),s&&(s=!1,o.responsecode=r.status,n.reject(r)))},u.debug.log("[FragmentLoader]["+e+"] Load: "+t.url),r.send(),n.promise},s=function e(i,o){var s=this;a.call(s,i).then(function(e){r=0,o.resolve(e)},function(a){a.aborted?(i.status=0,i.aborted=!0,o.reject(i)):r>=t?(r=0,i.status=a.status,o.reject(i)):setTimeout(function(){r++,e.call(s,i,o)},n)})};return{metricsModel:void 0,debug:void 0,tokenAuthentication:void 0,config:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,setup:function(){t=this.config.getParam("FragmentLoader.RetryAttempts","number",2),n=this.config.getParam("FragmentLoader.RetryInterval","number",500)},setType:function(t){e=t},load:function(e){var t=c.defer();return"Initialization Segment"===e.type&&e.data?t.resolve(e,{data:e.data}):s.call(this,e,t),t.promise},abort:function(){var t=0;for(t=0;t<i.length;t+=1)this.debug.log("[FragmentLoader]["+e+"] Abort XHR "+(i[t].responseURL?i[t].responseURL:"")),i[t].abort()},checkForExistence:function(e){return e?(e.deferred=c.defer(),o.call(this,e),e.deferred.promise):c.when(null)}}},y.dependencies.FragmentLoader.prototype={constructor:y.dependencies.FragmentLoader},y.dependencies.FragmentLoader.eventList={ENAME_LOADING_PROGRESS:"loadingProgress"},y.dependencies.FragmentModel=function(){var e,t,n,r,i,o,a=[],s=[],l=[],u=function(i){var o,s,u=this;t.call(e,i),o=function(t,r){l.splice(l.indexOf(t),1),a.push(t),n.call(e,t,r),t.deferred=null},s=function(t){l.splice(l.indexOf(t),1),r.call(e,t),t.deferred=null},u.fragmentLoader.load(i).then(o.bind(e,i),s.bind(e,i))},d=function(e,t){var n=function(e,n){return e[t]<n[t]?-1:e[t]>n[t]?1:0};e.sort(n)},c=function(e){var t=a.indexOf(e);-1!==t&&a.splice(t,1)};return{system:void 0,debug:void 0,fragmentLoader:void 0,setContext:function(t){e=t},getContext:function(){return e},setType:function(e){o=e,this.fragmentLoader&&this.fragmentLoader.setType(e)},addRequest:function(e){if(e){if(this.isFragmentLoadedOrPending(e))return;s.push(e),d.call(this,s,"index")}},setCallbacks:function(e,o,a,s){t=e,i=s,r=a,n=o},isFragmentLoadedOrPending:function(e){var t,n=!1,r=a.length,i=0;for(i=0;i<r;i++)if(t=a[i],e.startTime===t.startTime||"complete"===t.action&&e.action===t.action){if(e.url===t.url){n=!0;break}c(e)}if(!n)for(i=0,r=s.length;i<r;i+=1)t=s[i],e.url===t.url&&e.startTime===t.startTime&&(n=!0);if(!n)for(i=0,r=l.length;i<r;i+=1)t=l[i],e.url===t.url&&e.startTime===t.startTime&&(n=!0);return n},isReady:function(){return e.isReady()},getPendingRequests:function(){return s},getLoadingRequests:function(){return l},getLoadingTime:function(){var e,t,n=0;for(t=a.length-1;t>=0;t-=1)if(e=a[t],e.requestEndDate instanceof Date&&e.firstByteDate instanceof Date){n=e.requestEndDate.getTime()-e.firstByteDate.getTime();break}return n},getExecutedRequestForTime:function(e){var t,n=a.length-1,r=NaN,i=NaN,o=null;for(t=n;t>=0;t-=1)if(o=a[t],r=o.startTime,i=r+o.duration,!isNaN(r)&&!isNaN(i)&&e>r&&e<i)return o;return null},getExecutedRequestForQualityAndIndex:function(e,t){var n,r=a.length-1,i=null;for(n=r;n>=0;n-=1)if(i=a[n],i.quality===e&&i.index===t)return i;return null},removeExecutedRequest:function(e){c.call(this,e)},removeExecutedRequestsBeforeTime:function(e){var t,n=a.length-1,r=NaN,i=null;for(t=n;t>=0;t-=1)i=a[t],r=i.startTime,!isNaN(r)&&r<e&&c.call(this,i)},clearExecutedRequests:function(){a=[]},cancelPendingRequests:function(){s=[]},abortRequests:function(){this.fragmentLoader.abort(),l=[]},executeCurrentRequest:function(){var t,n=this;if(0!==s.length&&!(l.length>=2))switch(t=s.shift(),t.action){case"complete":a.push(t),i.call(e,t);break;case"download":l.push(t),u.call(n,t);break;default:this.debug.log("Unknown request action."),t.deferred?(t.deferred.reject(),t.deferred=null):r.call(e,t)}}}},y.dependencies.FragmentModel.prototype={constructor:y.dependencies.FragmentModel},y.dependencies.FragmentInfoController=function(){var e,t,n,r,i=!1,o=!1,a=null,s=!1,l=0,u=null,d=null,f=null,h=0,p=NaN,m=function(){this.debug.info("[FragmentInfoController]["+e+"] sendRequest"),T.call(this)&&null!==a&&this.fragmentController.onBufferControllerStateChange()},g=function(){i&&o&&(d=(new Date).getTime(),f=n,this.debug.info("[FragmentInfoController]["+e+"] startPlayback"),I.call(this))},v=function(){var t,i=this;!0!==o&&(o=!0,i.debug.info("[FragmentInfoController]["+e+"] START"),t=r.getCurrentRepresentation().segments,t?(n=t[t.length-1].presentationStartTime-t[t.length-1].duration,g.call(i)):i.indexHandler.updateSegmentList(r.getCurrentRepresentation()).then(function(e){t=e,n=t[t.length-1].presentationStartTime-t[t.length-1].duration,g.call(i)}))},_=function(){o&&(this.debug.info("[FragmentInfoController]["+e+"] STOP"),clearTimeout(t),o=!1,d=null,f=null,clearTimeout(u),u=null,this.fragmentController.abortRequestsForModel(a))},b=function(t){this.debug.info("[FragmentInfoController]["+e+"] Load request ",null!==t.url?t.url:t.quality)},E=function(t,i){var o,a;p=t.duration,s=!1,l=0,this.debug.log("[FragmentInfoController]["+e+"] Media loaded ",t.url);try{this.fragmentController.process(i.data,t,r.getAvailableRepresentations()),this.debug.info("[FragmentInfoController]["+e+"] Buffer segment from url ",t.url),o=((new Date).getTime()-d)/1e3,a=n+p-f,h=a-o>0?a-o:0,w.call(this,h)}catch(e){this.errHandler.sendError(y.dependencies.ErrorHandler.prototype.INTERNAL_ERROR,"Internal error while processing fragment info segment",e.message)}},T=function(){return o},S=function(e){if(T.call(this)){if(e.aborted)return void I.call(this);l+=1,this.errHandler.sendWarning(y.dependencies.ErrorHandler.prototype.DOWNLOAD_ERR_CONTENT,"Failed to download fragmentInfo segment",{url:e.url,status:e.status})}},x=function t(i){var o=this;if(null!==i&&i.action===i.ACTION_COMPLETE)return void _.call(o);if(null!==i){if(n=i.startTime+i.duration,i=o.indexHandler.getFragmentInfoRequest(i),o.fragmentController.isFragmentLoadedOrPending(o,i))return void o.indexHandler.getNextSegmentRequest(r.getCurrentRepresentation()).then(t.bind(o));o.debug.log("[FragmentInfoController]["+e+"] onFragmentRequest "+i.url),o.fragmentController.prepareFragmentForLoading(o,i,b,E,S,null),m.call(o)}else o.debug.log("[FragmentInfoController]["+e+"] bufferFragmentInfo failed")},w=function(n){var r=this,i=Math.round(Math.min(1e3*n,2e3));r.debug.log("[FragmentInfoController]["+e+"] Check buffer delta = "+i+" ms"),clearTimeout(t),t=setTimeout(function(){t=null,I.call(r)},i)},I=function(){var t,i=this;T.call(i)&&(i.debug.log("[FragmentInfoController]["+e+"] Start buffering process..."),t=n,i.debug.log("[FragmentInfoController]["+e+"] loadNextFragment for time: "+t),this.indexHandler.getSegmentRequestForTime(r.getCurrentRepresentation(),t).then(x.bind(this)))};return{sourceBufferExt:void 0,abrController:void 0,debug:void 0,system:void 0,errHandler:void 0,abrRulesCollection:void 0,indexHandler:void 0,initialize:function(e,t,n){var o=this;o.debug.log("[FragmentInfoController]["+e+"] Initialize"),r=n,o.setType(e),o.setFragmentController(t),i=!0},setType:function(t){e=t,void 0!==this.indexHandler&&(this.indexHandler.setType(t),this.indexHandler.setIsDynamic(!0))},isReady:function(){return!0},setFragmentController:function(t){t&&(this.fragmentController=t,a=this.fragmentController.attachBufferController(this),a.setType(e))},reset:function(){var e=this;return _.call(e),a&&(e.fragmentController.abortRequestsForModel(a),e.fragmentController.detachBufferController(a),a=null),c.when(null)},start:v,stop:_}},y.dependencies.FragmentInfoController.prototype={constructor:y.dependencies.FragmentInfoController},y.dependencies.ManifestLoader=function(){var e=2,t=500,n=null,r=function(e){var t,n="",r=0;if(e.length<1)return e;if(15360!==e.charCodeAt(0))return e;for(r=0;r<e.length;r+=1)t=e.charCodeAt(r),n+=String.fromCharCode((255&t)<<8|(65280&t)>>8);return n},i=function(e){var t=null;return-1!==e.indexOf("/")&&(-1!==e.indexOf("?")&&(e=e.substring(0,e.indexOf("?"))),t=e.substring(0,e.lastIndexOf("/")+1)),t},o=function(){null!==n&&n.abort(),this.parser.abort()},a=function(o){var a=i(o),s=c.defer(),l=this;return n=new y.dependencies.XHRLoader,n.initialize(null,e,t),n.load(o).then(function(e){e.responseURL&&(l.debug.log("[ManifestLoader] Redirect URL: "+e.responseURL),a=i(e.responseURL)),l.tokenAuthentication.checkRequestHeaderForToken(e),l.metricsModel.addHttpRequest("stream",null,"MPD",o,null,null,e.startDate,e.endDate,e.status,null,null),l.parser.parse(r(e.responseText),a).then(function(t){t?(t.mpdUrl=o,t.mpdLoadedTime=e.endDate,l.metricsModel.addManifestUpdate("stream",t.type,e.startDate,e.endDate,t.availabilityStartTime),s.resolve(t)):s.reject()},function(e){e&&e.name&&e.message?s.reject(e):(l.debug.error("[ManifestLoader] Manifest parsing error"),s.reject({name:y.dependencies.ErrorHandler.prototype.MANIFEST_ERR_PARSE,message:"Failed to parse manifest",data:{url:o}}))})},function(e){!e||e.aborted?s.reject():(l.metricsModel.addHttpRequest("stream",null,"MPD",o,null,null,e.startDate,e.endDate,e.status,null,null),s.reject({name:y.dependencies.ErrorHandler.prototype.DOWNLOAD_ERR_MANIFEST,message:"Failed to download manifest",data:{url:o,status:e.status}}))}),s.promise};return{debug:void 0,parser:void 0,config:void 0,metricsModel:void 0,tokenAuthentication:void 0,setup:function(){e=this.config.getParam("ManifestLoader.RetryAttempts","number",2),t=this.config.getParam("ManifestLoader.RetryInterval","number",500)},load:a,abort:o}},y.dependencies.ManifestLoader.prototype={constructor:y.dependencies.ManifestLoader},y.dependencies.ManifestUpdater=function(){var e,t=NaN,n=null,r=!1,i=function(){null!==n&&(clearInterval(n),n=null)},o=function(){i.call(this),isNaN(t)||(this.debug.log("Refresh manifest in "+t+" seconds."),n=setTimeout(s.bind(this),Math.min(1e3*t,Math.pow(2,31)-1),this))},a=function(){var e,n,r=this,i=r.manifestModel.getValue();void 0!==i&&null!==i&&(n=r.manifestExt.getRefreshDelay(i),e=((new Date).getTime()-i.mpdLoadedTime.getTime())/1e3,t=Math.max(n-e,0),o.call(r))},s=function(){var t,n,i=this;c.when(!e||e.promise).then(function(){e=c.defer(),t=i.manifestModel.getValue(),n=t.mpdUrl,t.hasOwnProperty("Location")&&(n=t.Location),i.manifestLoader.load(n).then(function(e){i.manifestModel.setValue(e),i.debug.log("Manifest has been refreshed."),r||a.call(i)})})},l=function(){e&&e.resolve()};return{debug:void 0,system:void 0,manifestModel:void 0,manifestExt:void 0,manifestLoader:void 0,setup:function(){a.call(this),this.system.mapHandler("streamsComposed",void 0,l.bind(this))},start:function(){r=!1,a.call(this)},stop:function(){r=!0,i.call(this)}}},y.dependencies.ManifestUpdater.prototype={constructor:y.dependencies.ManifestUpdater},y.models.ManifestModel=function(){var e=null;return{system:void 0,eventBus:void 0,getValue:function(){return e},setValue:function(t){e=t,e&&this.system.notify("manifestUpdated"),null!==e&&this.eventBus.dispatchEvent({type:"manifestLoaded",data:t})}}},y.models.ManifestModel.prototype={constructor:y.models.ManifestModel},y.dependencies.MediaSourceExtensions=function(){},y.dependencies.MediaSourceExtensions.prototype={constructor:y.dependencies.MediaSourceExtensions,createMediaSource:function(){var e="WebKitMediaSource"in window;return"MediaSource"in window?new MediaSource:e?new WebKitMediaSource:null},attachMediaSource:function(e,t){return t.setSource(window.URL.createObjectURL(e)),!0},detachMediaSource:function(e){return e.setSource(""),!0},setDuration:function(e,t){var n,r=!1;if("open"!==e.readyState)return e.duration;for(n=0;n<e.sourceBuffers.length;n++)if(e.sourceBuffers[n].updating){r=!0;break}return r||(e.duration=t),e.duration},signalEndOfStream:function(e){var t=e.sourceBuffers,n=t.length,r=0;if("open"===e.readyState){for(r;r<n;r++){if(t[r].updating)return;if(0===t[r].buffered.length)return}return e.endOfStream(),!0}}},y.dependencies.MetricsExtensions=function(){var e={42:"Baseline","4D":"Main",58:"Extended",64:"High"},t=function(e,t){var n,r,i,o,a,s,l,u;for(s=0;s<e.length;s+=1)for(n=e[s],i=n.AdaptationSet_asArray,l=0;l<i.length;l+=1)for(r=i[l],a=r.Representation_asArray,u=0;u<a.length;u+=1)if(o=a[u],t===o.id)return o;return null},n=function(e,t){var n=!1;return"video"===t?(this.manifestExt.getIsVideo(e),"video"===e.type&&(n=!0)):"audio"===t?(this.manifestExt.getIsAudio(e),"audio"===e.type&&(n=!0)):"text"===t?(this.manifestExt.getIsText(e),"text"===e.type&&(n=!0)):n=!1,n},r=y.utils.copyMethods(g.dependencies.DashMetricsExtensions);return r.config=void 0,r.getDuration=function(){var e=this,t=e.manifestModel.getValue(),n=t?t.Period.duration:null;return n!==1/0?n:-1},r.getFormatForType=function(e){var t,n=this,r=n.manifestModel.getValue(),i=0;for(i=0;i<r.Period.AdaptationSet.length;i++)if(t=r.Period.AdaptationSet[i],t.type===e)return t.mimeType;return null},r.getCodecForType=function(e){var t,n=this,r=n.manifestModel.getValue(),i=0;for(i=0;i<r.Period.AdaptationSet.length;i++)if(t=r.Period.AdaptationSet[i],t.type===e||t.contentType===e)return t.Representation[0].codecs;return null},r.getVideoWidthForRepresentation=function(e){var n,r,i=this,o=i.manifestModel.getValue();return o?(r=o.Period_asArray,n=t.call(i,r,e),null===n?null:n.width):null},r.getVideoHeightForRepresentation=function(e){var n,r,i=this,o=i.manifestModel.getValue();return o?(r=o.Period_asArray,n=t.call(i,r,e),null===n?null:n.height):null},r.getCodecsForRepresentation=function(e){var n,r=this,i=r.manifestModel.getValue(),o=i.Period_asArray;return n=t.call(r,o,e),null===n?null:n.codecs},r.getH264ProfileLevel=function(t){return t.indexOf("avc1")<0?"":e[t.substr(5,2)]+"@"+(parseInt(t.substr(9,2),16)/10).toString()},r.getBitratesForType=function(e,t){var r,i,o,a,s,l,u,d,c=this,f=c.manifestModel.getValue(),h=null,p=[];if(!(null!==f&&void 0!==f||null!==t&&void 0!==t))return null;if(t)h=t;else for(r=f.Period_asArray,o=0;o<r.length;o+=1)for(i=r[o],a=i.AdaptationSet_asArray,u=0;u<a.length;u+=1)if(h=a[u],n.call(c,a[u],e)){h=a[u];break}if(null!==h)for(h=c.manifestExt.processAdaptation(h),l=h.Representation_asArray,d=0;d<l.length;d+=1)s=l[d],p.push(s.bandwidth);return p},r.getBitratesWithResolutionForType=function(e){var t,r,i,o,a,s,l,u,d,c=this,f=c.manifestModel.getValue(),h=[];if(null===f||void 0===f)return null;for(t=f.Period_asArray,i=0;i<t.length;i+=1)for(r=t[i],a=r.AdaptationSet_asArray,u=0;u<a.length;u+=1)if(o=a[u],n.call(c,o,e)){for(o=c.manifestExt.processAdaptation(o),l=o.Representation_asArray,d=0;d<l.length;d+=1){s=l[d];var p={bitrate:s.bandwidth,width:s.width,height:s.height};h.push(p)}return h}return h},r},y.dependencies.MetricsExtensions.prototype={constructor:y.dependencies.MetricsExtensions},y.models.MetricsModel=function(){return{system:void 0,eventBus:void 0,config:void 0,streamMetrics:{},metricsChanged:function(){this.eventBus.dispatchEvent({type:"metricsChanged",data:{}})},metricChanged:function(e){this.eventBus.dispatchEvent({type:"metricChanged",data:{stream:e}}),this.metricsChanged()},metricUpdated:function(e,t,n){this.eventBus.dispatchEvent({type:"metricUpdated",data:{stream:e,metric:t,value:n}}),this.metricChanged(e)},metricAdded:function(e,t,n){this.eventBus.dispatchEvent({type:"metricAdded",data:{stream:e,metric:t,value:n}}),this.metricChanged(e)},clearCurrentMetricsForType:function(e){var t=this.config.getParamFor(e,"ABR.keepBandwidthCondition","boolean",!0);for(var n in this.streamMetrics[e])!this.streamMetrics[e].hasOwnProperty(n)||"HttpList"===n&&!1!==t||(this.streamMetrics[e][n]=[]);this.metricChanged(e)},clearAllCurrentMetrics:function(){var e=this;for(var t in this.streamMetrics)this.streamMetrics.hasOwnProperty(t)&&"stream"===t&&delete this.streamMetrics[t];this.metricsChanged.call(e)},getReadOnlyMetricsFor:function(e){return this.streamMetrics.hasOwnProperty(e)?this.streamMetrics[e]:null},getMetricsFor:function(e){var t;return this.streamMetrics.hasOwnProperty(e)?t=this.streamMetrics[e]:(t=this.system.getObject("metrics"),this.streamMetrics[e]=t),t},addTcpConnection:function(e,t,n,r,i,o){var a=new y.vo.metrics.TCPConnection;return a.tcpid=t,a.dest=n,a.topen=r,a.tclose=i,a.tconnect=o,this.getMetricsFor(e).TcpList.push(a),this.metricAdded(e,"TcpConnection",a),a},addHttpRequest:function(e,t,n,r,i,o,a,s,l,u,d,c,f,h){var p=new y.vo.metrics.HTTPRequest,m=this.getMetricsFor(e).HttpList;return p.stream=e,p.tcpid=t,p.type=n,p.url=r,p.actualurl=i,p.range=o,p.trequest=a,p.tresponse=s,p.tfinish=l,p.responsecode=u,p.interval=d,p.mediaduration=c,p.startTime=f,p.quality=h,m.push(p),this.metricAdded(e,"HttpRequest",p),m.length>10&&m.shift(),p},appendHttpTrace:function(e,t,n,r){var i=new y.vo.metrics.HTTPRequest.Trace;return i.s=t,i.d=n,i.b=r,e.trace.push(i),this.metricUpdated(e.stream,"HttpRequestTrace",e),i},addRepresentationSwitch:function(e,t,n,r,i){var o=new y.vo.metrics.RepresentationSwitch;return o.t=t,o.mt=n,o.to=r,o.lto=i,this.getMetricsFor(e).RepSwitchList.push(o),this.metricAdded(e,"RepresentationSwitch",o),o},addBufferedSwitch:function(e,t,n,r){var i=new y.vo.metrics.BufferedSwitch;return i.mt=t,i.to=n,i.lto=r,this.getMetricsFor(e).BufferedSwitchList.push(i),this.metricAdded(e,"BufferedSwitch",i),i},addState:function(e,t,n,r){var i=new y.vo.metrics.State;return i.current=t,i.position=n,i.reason=r,this.metricAdded(e,"State",i),i},addSession:function(e,t,n,r,i){var o=new y.vo.metrics.Session;return o.uri=t,o.loopMode=n?1:0,o.endTime=r,o.playerType=i,this.metricAdded(e,"Session",o),o},addCondition:function(e,t,n,r,i,o){var a=new y.vo.metrics.Condition;return a.isFullScreen=t,a.windowSize=n+"x"+r,a.fps=o,a.droppedFrames=i,this.metricAdded(e,"Condition",a),a},addMetaData:function(){this.metricAdded(null,"ManifestReady",null)},addBufferLevel:function(e,t,n){var r=new y.vo.metrics.BufferLevel,i=this.getMetricsFor(e).BufferLevel;return r.t=t,r.level=Number(n.toFixed(3)),i.push(r),this.metricAdded(e,"BufferLevel",r),i.length>10&&i.shift(),r},addDVRInfo:function(e,t,n){var r=new y.vo.metrics.DVRInfo,i=this.getMetricsFor(e).DVRInfo;return r.t=t,r.range=n,i.push(r),this.metricAdded(e,"DVRInfo",r),i.length>10&&i.shift(),r},addDroppedFrames:function(e,t){var n=new y.vo.metrics.DroppedFrames,r=this.getMetricsFor(e).DroppedFrames;return n.time=t.creationTime,n.droppedFrames=t.droppedVideoFrames,n.decodedFrameCount=t.totalVideoFrames,r.length>0&&r[r.length-1]===n?r[r.length-1]:(r.push(n),this.metricAdded(e,"DroppedFrames",n),n)},addPlaybackQuality:function(e,t,n,r){var i=new y.vo.metrics.PlaybackQuality,o=this.getMetricsFor(e).PlaybackQuality;return i.t=t,i.mt=r,i.droppedFrames=n.droppedVideoFrames,i.totalVideoFrames=n.totalVideoFrames,o.length>0&&i.droppedFrames===o[o.length-1].droppedFrames&&i.totalVideoFrames===o[o.length-1].totalVideoFrames?o[o.length-1]:(o.push(i),this.metricAdded(e,"PlaybackQuality",i),o.length>10&&o.shift(),i)},addVideoResolution:function(e,t,n,r,i){var o=new y.vo.metrics.VideoResolution,a=this.getMetricsFor(e).VideoResolution;return o.t=t,o.mt=i,o.width=n,o.height=r,a.length>0&&o.width===a[a.length-1].width&&o.height===a[a.length-1].height?a[a.length-1]:(a.push(o),this.metricAdded(e,"VideoResolution",o),o)},addManifestUpdate:function(e,t,n,r,i,o,a,s,l,u){var d=new y.vo.metrics.ManifestUpdate,c=this.getMetricsFor("stream");return d.streamType=e,d.type=t,d.requestTime=n,d.fetchTime=r,d.availabilityStartTime=i,d.presentationStartTime=o,d.clientTimeOffset=a,d.currentTime=s,d.buffered=l,d.latency=u,c.ManifestUpdate.push(d),this.metricAdded(e,"ManifestUpdate",d),d},updateManifestUpdateInfo:function(e,t){if(e&&t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);this.metricUpdated(e.streamType,"ManifestUpdate",e)}},addManifestUpdatePeriodInfo:function(e,t,n,r,i){var o=new y.vo.metrics.ManifestUpdate.PeriodInfo;return o.id=t,o.index=n,o.start=r,o.duration=i,e.periodInfo.push(o),this.metricUpdated(e.streamType,"ManifestUpdatePeriodInfo",e),o},addManifestUpdateRepresentationInfo:function(e,t,n,r,i,o,a,s){var l=new y.vo.metrics.ManifestUpdate.RepresentationInfo;return l.id=t,l.index=n,l.periodIndex=r,l.streamType=i,l.startNumber=a,l.segmentInfoType=s,l.presentationTimeOffset=o,e.representationInfo.push(l),this.metricUpdated(e.streamType,"ManifestUpdateRepresentationInfo",e),l},addPlayList:function(e,t,n,r){var i=new y.vo.metrics.PlayList,o=this.getMetricsFor(e).PlayList;return i.stream=e,i.start=t,i.mstart=n,i.starttype=r,o.push(i),this.metricAdded(e,"PlayList",i),o.length>10&&o.shift(),i},appendPlayListTrace:function(e,t,n,r,i,o,a,s){var l=new y.vo.metrics.PlayList.Trace;return l.representationid=t,l.subreplevel=n,l.start=r,l.mstart=i,l.duration=o,l.playbackspeed=a,l.stopreason=s,e.trace.push(l),this.metricUpdated(e.stream,"PlayListTrace",e),e.trace.length>10&&e.trace.shift(),l}}},y.models.MetricsModel.prototype={constructor:y.models.MetricsModel},y.dependencies.Mp4Processor=function(){var e=function(e){var t=new S.boxes.MovieHeaderBox,n=e[e.length-1];return t.version=1,t.creation_time=0,t.modification_time=0,t.timescale=n.timescale,t.duration=Math.round(n.duration*n.timescale),t.rate=65536,t.volume=256,t.reserved=0,t.reserved_2=[0,0],t.matrix=[65536,0,0,0,65536,0,0,0,1073741824],t.pre_defined=[0,0,0,0,0,0],t.next_track_ID=n.trackId+1,t.flags=0,t},t=function(e){var t,n,i;return t=new S.boxes.TrackBox,n=new S.boxes.TrackHeaderBox,n.version=1,n.flags=7,n.creation_time=0,n.modification_time=0,n.track_id=e.trackId,n.reserved=0,n.duration=Math.round(e.duration*e.timescale),n.reserved_2=[0,0],n.layer=0,n.alternate_group=0,n.volume=256,n.reserved_3=0,n.matrix=[65536,0,0,0,65536,0,0,0,1073741824],n.width=e.width<<16,n.height=e.height<<16,t.boxes.push(n),i=new S.boxes.MediaBox,i.boxes.push(r(e)),i.boxes.push(o(e)),i.boxes.push(a(e)),t.boxes.push(i),t},n=function(e){var t,n,r;return t=e.charCodeAt(0)-96<<10,n=e.charCodeAt(1)-96<<5,r=e.charCodeAt(2)-96,t|n|r},r=function(e){var t=new S.boxes.MediaHeaderBox;return t.flags=0,t.version=1,t.creation_time=0,t.modification_time=0,t.timescale=e.timescale,t.duration=Math.round(e.duration*e.timescale),t.pad=0,t.language=n(e.language),t.pre_defined=0,t},i=function(e){var t,n=0;for(t=0;t<e.length;t+=1)n|=e.charCodeAt(t)<<8*(e.length-t-1);return n},o=function(e){var t=new S.boxes.HandlerBox;switch(t.version=0,t.pre_defined=0,e.type){case"video":t.handler_type=i(t.HANDLERTYPEVIDEO),t.name=t.HANDLERVIDEONAME;break;case"audio":t.handler_type=i(t.HANDLERTYPEAUDIO),t.name=t.HANDLERAUDIONAME;break;default:t.handler_type=i(t.HANDLERTYPETEXT),t.name=t.HANDLERTEXTNAME}return t.name+="\0",t.reserved=[0,0,0],t.flags=0,t},a=function(e){var t=new S.boxes.MediaInformationBox;switch(e.type){case"video":t.boxes.push(P(e));break;case"audio":t.boxes.push(M(e))}return t.boxes.push(s(e)),t.boxes.push(A(e)),t},s=function(){var e,t,n;return e=new S.boxes.DataInformationBox,t=new S.boxes.DataReferenceBox,t.version=0,t.entry_count=1,t.flags=0,n=new S.boxes.DataEntryUrlBox,n.location="",n.version=0,n.flags=1,t.boxes.push(n),e.boxes.push(t),e},l=function(){var e=new S.boxes.TimeToSampleBox;return e.version=0,e.entry_count=0,e.flags=0,e.entry=[],e},u=function(){var e=new S.boxes.SampleToChunkBox;return e.flags=0,e.version=0,e.entry_count=0,e.entry=[],e},d=function(){var e=new S.boxes.ChunkOffsetBox;return e.version=0,e.entry_count=0,e.flags=0,e.chunk_offset=[],e},c=function(){var e=new S.boxes.SampleSizeBox;return e.version=0,e.flags=0,e.sample_count=0,e.sample_size=0,e},f=function(e){var t,n=new Uint8Array(e.length/2);for(t=0;t<e.length/2;t+=1)n[t]=parseInt(""+e[2*t]+e[2*t+1],16);return n},h=function(e,t){var n=new Uint8Array(e.length+t.length);return n.set(e,0),n.set(t,e.length),n},p=function(e){var t,n,r,i,o,a,s,l,u,d=new RegExp("^[A-Z0-9]7","gi"),c=new RegExp("^[A-Z0-9]8","gi");for(t=new S.boxes.AVCConfigurationBox,t.configurationVersion=1,t.lengthSizeMinusOne=3,t.reserved=63,t.SPS_NAL=[],t.PPS_NAL=[],n=new Uint8Array(0),r=e.codecPrivateData,i=r.split("00000001"),i.splice(0,1),o=0,a=0,s=0;s<i.length;s+=1)l=f(i[s]),i[s].match(d)&&(t.SPS_NAL[o++]={NAL_length:l.length,NAL:l},t.AVCProfileIndication=parseInt(i[s].substr(2,2),16),t.profile_compatibility=parseInt(i[s].substr(4,2),16),t.AVCLevelIndication=parseInt(i[s].substr(6,2),16)),i[s].match(c)&&(t.PPS_NAL[a++]={NAL_length:l.length,NAL:l}),u=new Uint8Array(l.length+4),u[3]=l.length,u.set(l,4),n=h(n,u);return t.numOfSequenceParameterSets=o,t.numOfPictureParameterSets=a,t},m=function(e){var t=null;return t=void 0!==e.contentProtection?new S.boxes.EncryptedVideoBox:new S.boxes.AVC1VisualSampleEntryBox,t.data_reference_index=1,t.compressorname=[10,65,86,67,32,67,111,100,105,110,103,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],t.depth=24,t.reserved=[0,0,0,0,0,0],t.reserved_2=0,t.reserved_3=0,t.pre_defined=0,t.pre_defined_2=[0,0,0],t.pre_defined_3=65535,t.frame_count=1,t.horizresolution=4718592,t.vertresolution=4718592,t.height=e.height,t.width=e.width,t.boxes.push(p(e)),void 0!==e.contentProtection&&t.boxes.push(E(e)),t},g=function(e){var t=new S.boxes.OriginalFormatBox;return t.data_format=i(e.codecs.substring(0,e.codecs.indexOf("."))),t},v=function(){var e=new S.boxes.SchemeTypeBox;return e.flags=0,e.version=0,e.scheme_type=1667591779,e.scheme_version=65536,e},_=function(e){var t=new S.boxes.SchemeInformationBox;return t.boxes.push(b(e)),t},b=function(e){var t=new S.boxes.TrackEncryptionBox;return t.flags=0,t.version=0,t.default_IsEncrypted=1,t.default_IV_size=8,t.default_KID=e.contentProtection&&e.contentProtection.length>0&&e.contentProtection[0]["cenc:default_KID"]?e.contentProtection[0]["cenc:default_KID"]:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],t},E=function(e){var t=new S.boxes.ProtectionSchemeInformationBox;return t.boxes.push(g(e)),t.boxes.push(v()),t.boxes.push(_(e)),t},T=function(e){var t=e.codecs.substring(0,e.codecs.indexOf("."));switch(t){case"avc1":return m(e);default:throw{name:y.dependencies.ErrorHandler.prototype.MEDIA_ERR_CODEC_UNSUPPORTED,message:"Codec is not supported",data:{codec:t}}}},x=function(e){for(var t=[];e.length>=2;)t.push(parseInt(e.substring(0,2),16)),e=e.substring(2,e.length);return t},w=function(e){var t,n,r,i,o,a,s;return t=x(e.codecPrivateData),n=t.length,r=new Uint8Array(2+n),r[0]=5,r[1]=n,r.set(t,2),i=13+r.length,o=new Uint8Array(2+i),o[0]=4,o[1]=i,o[2]=64,o[3]=20,o[3]|=0,o[3]|=1,o[4]=255,o[5]=255,o[6]=255,o[7]=(4278190080&e.bandwidth)>>24,o[8]=(16711680&e.bandwidth)>>16,o[9]=(65280&e.bandwidth)>>8,o[10]=255&e.bandwidth,o[11]=(4278190080&e.bandwidth)>>24,o[12]|=(16711680&e.bandwidth)>>16,o[13]|=(65280&e.bandwidth)>>8,o[14]|=255&e.bandwidth,o.set(r,15),a=3+o.length,s=new Uint8Array(2+a),s[0]=3,s[1]=a,s[2]=(65280&e.trackId)>>8,s[3]=255&e.trackId,s[4]=0,s.set(o,5),s},I=function(e){var t,n,r=null;return r=void 0!==e.contentProtection?new S.boxes.EncryptedAudioBox:new S.boxes.MP4AudioSampleEntryBox,r.reserved=[0,0,0,0,0,0],r.data_reference_index=1,r.reserved_2=[0,0],r.channelcount=e.channels,r.samplesize=16,r.pre_defined=0,r.reserved_3=0,r.samplerate=e.samplingRate<<16,t=new S.boxes.ESDBox,n=w(e),t.ES_tag=n[0],t.ES_length=n[1],t.ES_data=n.subarray(2,n.length),t.version=0,t.flags=0,r.boxes.push(t),void 0!==e.contentProtection&&r.boxes.push(E(e)),r},D=function(e){var t=e.codecs.substring(0,e.codecs.indexOf("."));switch(t){case"mp4a":return I(e);default:throw{name:y.dependencies.ErrorHandler.prototype.MEDIA_ERR_CODEC_UNSUPPORTED,message:"Codec is not supported",data:{codec:t}}}return null},R=function(e){var t=new S.boxes.SampleDescriptionBox;switch(t.version=0,t.flags=0,e.type){case"video":t.boxes.push(T(e));break;case"audio":t.boxes.push(D(e))}return t},A=function(e){var t=new S.boxes.SampleTableBox;return t.boxes.push(l()),t.boxes.push(u()),t.boxes.push(d()),t.boxes.push(c()),t.boxes.push(R(e)),t},P=function(){var e=new S.boxes.VideoMediaHeaderBox;return e.version=0,e.flags=1,e.graphicsmode=0,e.opcolor=[0,0,0],e},M=function(){var e=new S.boxes.SoundMediaHeaderBox;return e.version=0,e.balance=0,e.reserved=0,e.flags=1,e},L=function(){var e=new S.boxes.FileTypeBox;return e.major_brand=1769172790,e.minor_brand=1,e.compatible_brands=[],e.compatible_brands[0]=1769172845,e.compatible_brands[1]=1769172790,e.compatible_brands[2]=1836278888,e},C=function(e){var t,n,r,i=e[e.length-1];for(t=new S.boxes.MovieExtendsBox,r=0;r<e.length;r+=1)i=e[r],n=new S.boxes.TrackExtendsBox,n.version=0,n.flags=0,n.track_ID=i.trackId,n.default_sample_description_index=1,n.default_sample_duration=0,n.default_sample_flags=0,n.default_sample_size=0,t.boxes.push(n);return t},O=function(e){var t,n,r,i=[];for(r=0;r<e.length;r+=1)t=new Uint8Array(e[r].initData),n=new S.boxes.ProtectionSystemSpecificHeaderBox,n.read(t,8,t.length),i.push(n);return i},k=1,N=function(){var e=new S.boxes.MovieFragmentHeaderBox;return e.version=0,e.flags=0,e.sequence_number=k++,e},F=function(e){var t=new S.boxes.TrackFragmentBox;return t.version=0,t.flags=0,t.boxes.push(B(e)),t.boxes.push(U(e)),t.boxes.push(j(e)),t.boxes.push(H(e)),t},B=function(e){var t=new S.boxes.TrackFragmentHeaderBox;return t.version=0,t.flags=131072,t.track_ID=e.trackId,t},U=function(e){var t=new S.boxes.TrackFragmentBaseMediaDecodeTimeBox;return t.version=1,t.flags=0,t.baseMediaDecodeTime=e.samples.length>0?e.samples[0].dts:0,t},j=function(e){var t,n,r,i=new S.boxes.TrackFragmentRunBox;for(e.samples[0].cts,n=e.samples[0].duration>0?256:0,i.version=0,i.flags=1537|n|("video"===e.type?2048:0),i.data_offset=0,i.samples_table=[],i.sample_count=e.samples.length,t=0;t<e.samples.length;t++)r={sample_duration:e.samples[t].duration,sample_size:e.samples[t].size,sample_composition_time_offset:e.samples[t].cts-e.samples[t].dts,sample_flags:e.samples[t].flags},r.sample_composition_time_offset<0&&(i.version=1),i.samples_table.push(r);return i},H=function(e){var t,n=new S.boxes.SampleDependencyTableBox;for(n.version=0,n.flags=0,n.sample_dependency_table=[],t=0;t<e.samples.length;t++)n.sample_dependency_table.push((267386880&e.samples[t].flags)>>20);return n},q=function(e){var t=new S.boxes.MediaDataBox;return t.data=e.data,t};return{protectionExt:void 0,generateInitSegment:function(n){var r,i,o,a;for(r=new S.boxes.File,i=new S.boxes.MovieBox,i.boxes.push(e(n)),a=0;a<n.length;a+=1)i.boxes.push(t(n[a]));for(i.boxes.push(C(n)),a=0;a<n.length;a++)void 0!==n[a].contentProtection&&(o=this.protectionExt.getSupportedKeySystemsFromContentProtection(n[a].contentProtection),i.boxes.push.apply(i.boxes,O(o)));return r.boxes.push(L()),r.boxes.push(i),S.serialize(r)},generateMediaSegment:function(e){var t,n,r,i,o,a=0,s={},l=[],u=0;if(t=new S.boxes.File,n=new S.boxes.MovieFragmentBox,n.boxes.push(N()),e)for(r=0;r<e.length;r+=1)n.boxes.push(F(e[r]));if(t.boxes.push(n),i=t.getLength(),o=n.getBoxesByType("traf"),i+=8,e&&e.length&&(l=[e.length]),e)for(r=0;r<e.length;r+=1)o[r].getBoxByType("trun").data_offset=i,i+=e[r].data.length,l[r]=e[r].data,a+=l[r].length;for(s.data=new Uint8Array(a),r=0;r<l.length;r++)s.data.set(l[r],u),u+=l[r].length;return t.boxes.push(q(s)),S.serialize(t)}}},y.dependencies.Mp4Processor.prototype={constructor:y.dependencies.Mp4Processor},y.dependencies.Notifier=function(){var e,t=0,n=function(){return this.observableId||(t+=1,this.observableId="_id_"+t),this.observableId};return{system:void 0,setup:function(){e=this.system,e.mapValue("notify",this.notify),e.mapValue("subscribe",this.subscribe),e.mapValue("unsubscribe",this.unsubscribe)},notify:function(){var t=arguments[0]+n.call(this),r=new y.vo.Event;r.sender=this,r.type=arguments[0],r.data=arguments[1],r.error=arguments[2],r.timestamp=(new Date).getTime(),e.notify.call(e,t,r)},subscribe:function(t,r,i,o){if(!i&&r[t]&&(i=r[t]=r[t].bind(r)),!r)throw"observer object cannot be null or undefined";if(!i)throw"event handler cannot be null or undefined";t+=n.call(this),e.mapHandler(t,void 0,i,o)},unsubscribe:function(t,r,i){i=i||r[t],t+=n.call(this),e.unmapHandler(t,void 0,i)}}},y.dependencies.Notifier.prototype={constructor:y.dependencies.Notifier},y.dependencies.Parser=function(){var e=null;return{debug:void 0,system:void 0,dashParser:void 0,mssParser:void 0,hlsParser:void 0,metricsModel:void 0,parse:function(t,n){if(null===e)if(t.indexOf("SmoothStreamingMedia")>-1&&void 0!==this.mssParser)this.system.notify("setContext","MSS"),e=this.mssParser;else if(t.indexOf("#EXTM3U")>-1&&void 0!==this.hlsParser)this.system.notify("setContext","HLS"),e=this.hlsParser;else{if(!(t.indexOf("MPD")>-1&&void 0!==this.dashParser))return c.reject("manifest cannot be parsed, protocol is unsupported!");this.system.notify("setContext","MPD"),e=this.dashParser}return e.parse(t,n)},abort:function(){null!==e&&void 0!==e.abort&&e.abort()},reset:function(){e=null}}},y.dependencies.Parser.prototype={constructor:y.dependencies.Parser},y.dependencies.SourceBufferExtensions=function(){this.system=void 0,this.manifestExt=void 0},y.dependencies.SourceBufferExtensions.prototype={constructor:y.dependencies.SourceBufferExtensions,createSourceBuffer:function(e,t){var n=null;if(!e)return null;try{n=e.addSourceBuffer(t)}catch(e){if(!this.manifestExt.getIsTextTrack(t))throw e;if("text/vtt"===t||"text/ttml"===t)n=this.system.getObject("textSourceBuffer");else{if("application/ttml+xml+mp4"!==t&&"application/mp4"!==t&&"application/ttml+xml"!==t)throw e;n=this.system.getObject("textTTMLXMLMP4SourceBuffer")}}return n},removeSourceBuffer:function(e,t){try{e.removeSourceBuffer(t)}catch(e){}},getBufferRange:function(e,t,n){var r,i,o=null,a=0,s=0,l=null,u=null,d=0,c=n||.03;try{o=e.buffered}catch(e){return null}if(o){for(i=0,r=o.length;i<r;i+=1)if(a=o.start(i),s=o.end(i),null===l){if(d=Math.abs(a-t),t>=a&&t<s){l=a,u=s;continue}if(d<=c){l=a,u=s;continue}}else{if(!((d=a-u)<=c))break;u=s}if(null!==l)return{start:l,end:u}}return null},getAllRanges:function(e){try{return e.buffered}catch(e){return null}},getBufferLength:function(e,t,n){var r,i=this;return r=i.getBufferRange(e,t,n),null===r?0:r.end-t},waitForUpdateEnd:function(e){var t,n=c.defer(),r=function(){e.updating||(clearInterval(t),n.resolve(!0))},i=function t(){e.updating||(e.removeEventListener("updateend",t,!1),n.resolve(!0))};if(!e.updating)return n.resolve(!0),n.promise;if("function"==typeof e.addEventListener)try{e.addEventListener("updateend",i,!1)}catch(e){t=setInterval(r,50)}else t=setInterval(r,50);return n.promise},append:function(e,t,n){var r=c.defer(),i=this;return i.waitForUpdateEnd(e).then(function(){try{"append"in e?e.append(t):"appendBuffer"in e&&e.appendBuffer(t),n?r.resolve():i.waitForUpdateEnd(e).then(function(){r.resolve()})}catch(e){r.reject({err:e,data:t})}}),r.promise},remove:function(e,t,n,r,i,o){var a=c.defer(),s=this;return s.waitForUpdateEnd(e).then(function(){try{t>=0&&t<r&&n>t&&"ended"!==i.readyState&&e.remove(t,n),isNaN(n)&&"ended"!==i.readyState&&e.remove(t),o?a.resolve():s.waitForUpdateEnd(e).then(function(){a.resolve()})}catch(e){a.reject(e)}}),a.promise},abort:function(e,t){try{"open"===e.readyState&&t.abort()}catch(e){}}},Math.sign||(Math.sign=function(e){return e<0?-1:0===e?0:1}),y.dependencies.Stream=function(){var e,t,n,r,i,o,a,s,l,u,d,f,h,p,m,g,v,_,b,E,T,S,x,w,I,D,R,A=null,P=null,M=-1,L=null,C=-1,O=null,k=!1,N=!1,F=null,B=null,U=null,j=-1,H=!0,q=!1,V=!1,G="und",K="und",z=null,Y=-1,W=-1,X="Stopped",Q=1,Z=!1,J=!1,$=null,ee=!0,te=null,ne=!1,re=-1,ie=-1,oe=function(e){this.errHandler.sendError(e.data.code,e.data.message,e.data.data)},ae=function(){q&&(this.debug.info("[Stream] Play."),this.videoModel.play())},se=function(){this.debug.info("[Stream] Pause."),this.videoModel.pause()},le=function(t,n){q&&(this.debug.info("[Stream] Seek: "+t),this.manifestExt.getIsDynamic(e)&&!ne&&0!==this.videoModel.getCurrentTime()&&me.call(this),!0===n?(v=t,this.system.unmapHandler("bufferUpdated"),this.system.mapHandler("bufferUpdated",void 0,He.bind(this)),Ce.call(this,v)):this.videoModel.setCurrentTime(t))},ue=function(e){var t=c.defer(),n=this,r=function n(){e.removeEventListener("sourceopen",n),e.removeEventListener("webkitsourceopen",n),t.resolve(e)};return e.addEventListener("sourceopen",r,!1),e.addEventListener("webkitsourceopen",r,!1),n.mediaSourceExt.attachMediaSource(e,n.videoModel),t.promise},de=function(){var n=this,r=[],i=c.defer(),o=function(){P&&r.push(P.reset(V)),F&&r.push(F.reset(V)),L&&r.push(L.reset(V)),B&&r.push(B.reset(V)),O&&r.push(O.reset(V)),U&&r.push(U.reset(V)),c.all(r).then(function(){$&&($.reset(),$=void 0),t&&n.mediaSourceExt.detachMediaSource(n.videoModel),q=!1,A=null,P=null,L=null,O=null,t=null,e=null,i.resolve()})};return c.when(ee).then(function(){o()}),i.promise},ce=function(e,n){var r=null,i=null;if(("video"===e.type||"audio"===e.type)&&!this.capabilities.supportsCodec(this.videoModel.getElement(),n))return this.errHandler.sendError(y.dependencies.ErrorHandler.prototype.MEDIA_ERR_CODEC_UNSUPPORTED,e.type+" codec is not supported",{codec:n}),null;try{i=this.sourceBufferExt.createSourceBuffer(t,n)}catch(t){return this.errHandler.sendError(y.dependencies.ErrorHandler.prototype.MEDIA_ERR_CREATE_SOURCEBUFFER,"Failed to create "+e.type+" source buffer",new y.vo.Error(t.code,t.name,t.message)),null}return r=this.system.getObject("bufferController"),r.initialize(e.type,z,e,i,this.fragmentController,t,$),"text"===e.type&&i.hasOwnProperty("initialize")&&i.initialize(n,r,e),r},fe=function(e,t){var n=null;return e&&t&&t.type&&(n=this.system.getObject("fragmentInfoController"),n.initialize(t.type,this.fragmentController,e)),n},he=function(){var t,n,r,i;if(ee=!1,$=this.system.getObject("eventController"),t=this.manifestExt.getVideoData(e,z.index),null===t?this.errHandler.sendError(y.dependencies.ErrorHandler.prototype.MANIFEST_ERR_NO_VIDEO,"No Video data in manifest"):(M=this.manifestExt.getDataIndex(t,e,z.index),n=this.manifestExt.getCodec(t),A=this.manifestExt.getContentProtectionData(t),null===n?this.errHandler.sendError(y.dependencies.ErrorHandler.prototype.MANIFEST_ERR_NO_VIDEO,"Video codec information not available"):(P=ce.call(this,t,n),this.manifestExt.getIsDynamic(e)&&(F=fe.call(this,P,t)))),null===P)return void(ee=!0);if(null===(t=this.manifestExt.getSpecificAudioData(e,z.index,G)))this.errHandler.sendWarning(y.dependencies.ErrorHandler.prototype.MANIFEST_ERR_NO_AUDIO,"No audio data in manifest");else if(C=this.manifestExt.getDataIndex(t,e,z.index),null===(r=this.manifestExt.getCodec(t)))this.errHandler.sendWarning(y.dependencies.ErrorHandler.prototype.MANIFEST_ERR_NO_AUDIO,"Audio codec information not available");else{if(null===(L=ce.call(this,t,r)))return void(ee=!0);this.manifestExt.getIsDynamic(e)&&(B=fe.call(this,L,t))}t=this.manifestExt.getSpecificTextData(e,z.index,K),null!==t&&(j=this.manifestExt.getDataIndex(t,e,z.index),i=this.manifestExt.getMimeType(t),null===i?this.errHandler.sendWarning(y.dependencies.ErrorHandler.prototype.MANIFEST_ERR_NO_TEXT,"Text codec information not available"):(O=ce.call(this,t,i),this.manifestExt.getIsDynamic(e)&&(U=fe.call(this,O,t)))),$&&$.addInlineEvents(this.manifestExt.getEventsForPeriod(e,z)),D?D.init(A,r,n):A&&!this.capabilities.supportsEncryptedMedia()&&this.errHandler.sendError(y.dependencies.ErrorHandler.prototype.CAPABILITY_ERR_MEDIAKEYS,"EME is not supported/enabled",null),ee=!0},pe=function(){this.debug.log("[Stream] Setting duration: "+z.duration),this.mediaSourceExt.setDuration(t,z.duration),q=!0},me=function(){F&&!1===N&&(N=!0,F.start()),B&&B.start(),U&&k&&U.start()},ge=function(){F&&(N=!1,F.stop()),B&&B.stop(),U&&U.stop()},ye=function(){this.debug.info("[Stream] <video> loadedmetadata event")},ve=function(){this.debug.info("[Stream] <video> canplay event")},_e=function(){this.debug.info("[Stream] <video> playing event"),re=(new Date).getTime()/1e3,ie=this.getVideoModel().getCurrentTime()},be=function(){this.debug.info("[Stream] <video> loadstart event")},Ee=function(){this.debug.info("[Stream] <video> play event"),1!==Q?this.setTrickModeSpeed(1):W>=0?(Be.call(this,W),W=-1):Ce.call(this),this.metricsModel.addPlayList("video",(new Date).getTime(),this.videoModel.getCurrentTime(),"play")},Te=function(){this.debug.info("[Stream] <video> ended event"),this.metricsModel.addState("video","stopped",this.videoModel.getCurrentTime(),1)},Se=function(){this.debug.info("[Stream] <video> pause event"),re=-1,ie=-1,this.metricsModel.addPlayList("video",(new Date).getTime(),this.videoModel.getCurrentTime(),"pause"),Ne.call(this),"MSS"===e.name&&this.manifestExt.getIsDynamic(e)&&me.call(this)},xe=function(e){var t,n=e.srcElement.error,r="[Stream] <video> error: ";if(-1!==n.code){switch(n.code){case 1:t=y.dependencies.ErrorHandler.prototype.MEDIA_ERR_ABORTED,r+="fetching process aborted";break;case 2:t=y.dependencies.ErrorHandler.prototype.MEDIA_ERR_NETWORK,r+="network error";break;case 3:t=y.dependencies.ErrorHandler.prototype.MEDIA_ERR_DECODE,r+="media decoding error";break;case 4:t=y.dependencies.ErrorHandler.prototype.MEDIA_ERR_SRC_NOT_SUPPORTED,r+="media format not supported";break;case 5:t=y.dependencies.ErrorHandler.prototype.MEDIA_ERR_ENCRYPTED,r+="media is encrypted"}V=!0,this.errHandler.sendError(t,r)}},we=function(){var e=this.videoModel.getCurrentTime();if(this.debug.info("[Stream] <video> seeking event: "+e),1!==Q&&e.toFixed(3)!==I.toFixed(3))return void this.setTrickModeSpeed(1);e=e<this.getStartTime()?this.getStartTime():e,Ce.call(this,e)},Ie=function(){var e,t,n,r,i,o,a,l,u,d=this,c=function(e,t){if(d.videoModel.getCurrentTime()===d.getStartTime()||Z)return d.debug.log("[Stream] Trick mode (x"+Q+"): stop"),void(Z&&(l=document.createEvent("Event"),l.initEvent("ended",!0,!0),d.videoModel.getElement().dispatchEvent(l)));t<d.getStartTime()?t=d.getStartTime():t>=d.videoModel.getDuration()&&(t=d.videoModel.getDuration()-T,Z=!0),e>0&&d.debug.log("[Stream] Trick mode (x"+Q+"): wait "+e.toFixed(3)+" s"),w=setTimeout(function(){x=(new Date).getTime()/1e3,d.debug.log("[Stream] Trick mode (x"+Q+"): seek time = "+t.toFixed(3)),I=t,d.videoModel.setCurrentTime(t)},e>0?1e3*e:0)};if(this.debug.info("[Stream] <video> seeked event"),ke.call(this),1!==Q){if(e=(new Date).getTime()/1e3,t=d.videoModel.getCurrentTime(),n=e-b,r=e-x,i=Math.abs(t-E),o=i/n,d.debug.log("[Stream] Trick mode (x"+Q+"): elapsed time = "+n.toFixed(3)+", elapsed video time = "+i.toFixed(3)+", speed = "+o.toFixed(3)),"Changed"===X)clearTimeout(w),X="Running",b=(new Date).getTime()/1e3,E=t,d.debug.info("[Stream] Trick mode (x"+Q+"): videoTime = "+E),S=Math.abs(_/Q)>1?S/Math.abs(_/Q):S,a=t+S*Math.sign(Q),u=0;else if(o<.9*Math.abs(Q)){var f=Math.abs(Q/o);S*=Math.round(f)+Math.round(f%T),d.debug.info("[Stream] Trick mode (x"+Q+"): seek step = "+S),a=t+S*Math.sign(Q),u=0}else a=t+S*Math.sign(Q),u=Math.abs(a-E)/Math.abs(Q)-n-r;c.call(d,u,a)}this.videoModel.listen("seeking",s),ne=!1,re=-1,ie=-1},De=function(){this.debug.info("[Stream] <video> progress event"),Le.call(this)},Re=function(){this.debug.info("[Stream] <video> timeupdate event: "+this.videoModel.getCurrentTime()),Le.call(this)},Ae=function(){var e=this.videoModel.getDuration(),n=Number(z.duration.toFixed(3));this.debug.info("[Stream] <video> durationchange event: "+e),!isNaN(e)&&e!==1/0&&e>n&&(this.debug.log("[Stream] Setting duration: "+n),this.mediaSourceExt.setDuration(t,n))},Pe=function(){this.debug.info("[Stream] <video> ratechange event: "+this.videoModel.getPlaybackRate()),P&&P.updateStalledState(),L&&L.updateStalledState(),O&&O.updateStalledState()},Me=function(){se.call(this),ne=!0,this.system.notify("manifestUpdate",!0)},Le=function(){P&&P.updateBufferLevel(!0),L&&L.updateBufferLevel(!0),O&&O.updateBufferLevel(!0)},Ce=function(e){this.debug.log("[Stream] startBuffering"+(void 0===e?"":" at time "+e)),P&&(void 0===e?P.start():P.seek(e)),L&&(void 0===e?L.start():L.seek(e)),O&&k&&1===Q&&(void 0===e?O.start():O.seek(e))},Oe=function(){this.debug.log("[Stream] stopBuffering"),P&&P.stop(),L&&L.stop(),O&&O.stop()},ke=function(){P&&P.seeked(),L&&L.seeked(),O&&O.seeked()},Ne=function(){this.scheduleWhilePaused&&!this.manifestExt.getIsDynamic(e)||Oe.call(this),clearInterval(void 0)},Fe=function(n){var r=this;e=n,r.debug.log("[Stream] Create MediaSource");try{t=r.mediaSourceExt.createMediaSource()}catch(e){r.errHandler.sendError(y.dependencies.ErrorHandler.prototype.MEDIA_ERR_CREATE_MEDIASOURCE,"Failed to create MediaSource",{name:e.name,message:e.message})}null!==t&&(r.debug.log("[Stream] Setup MediaSource"),ue.call(r,t).then(function(e){t=e,r.debug.log("[Stream] Initialize MediaSource"),he.call(r),r.debug.log("[Stream] Initialize playback"),pe.call(r),r.debug.log("[Stream] Playback initialized")}))},Be=function(e){this.debug.log("[Stream] Set video model current time: "+e),this.videoModel.unlisten("seeking",s),this.videoModel.setCurrentTime(e)},Ue=function(){P&&!P.isBufferingCompleted()||L&&!L.isBufferingCompleted()||t&&(this.debug.info("[Stream] Signal end of stream"),this.mediaSourceExt.signalEndOfStream(t))},je=function(t){this.debug.info("[Stream] Start time = "+t),-1!==Y&&!this.manifestExt.getIsDynamic(e)&&Y<z.duration&&(this.debug.info("[Stream] Initial start time = "+Y),t=Y),le.call(this,t,0===z.index&&H)},He=function(){var e,t,n;if(this.debug.info("[Stream] Check start time"),null!==(e=this.sourceBufferExt.getBufferRange(P.getBuffer(),v,2))){if(n=Math.max(v,e.start),L){if(null===(t=this.sourceBufferExt.getBufferRange(L.getBuffer(),v,2)))return;if(this.debug.info("[Stream] Check start time: A["+t.start+"-"+t.end+"], V["+e.start+"-"+e.end+"]"),t.end<n)return;n=Math.max(n,t.start)}this.debug.info("[Stream] Check start time: OK => "+n),this.system.unmapHandler("bufferUpdated"),this.videoModel.isPaused()?W=n:Be.call(this,n),ae.call(this)}},qe=function(t,n,r){var i=-1;return t?-1===r?r:(i=this.manifestExt.getDataIndex(n,e,z.index),i!==r&&(this.manifestExt.getIsDynamic(e)?this.system.notify("manifestUpdate"):t.updateData(n,z)),i):r},Ve=function(t){var n,r;if(e=this.manifestModel.getValue(),z=t,this.debug.log("[Stream] Manifest updated ... set new data on buffers."),P&&(n=P.getData(),r=n&&n.hasOwnProperty("id")?this.manifestExt.getDataForId(n.id,e,z.index):this.manifestExt.getDataForIndex(M,e,z.index),P.updateData(r,z)),L&&(r=this.manifestExt.getDataForIndex(C,e,z.index),L.updateData(r,z)),O&&(r=this.manifestExt.getDataForIndex(j,e,z.index),O.updateData(r,z)),$){var i=this.manifestExt.getEventsForPeriod(e,z);$.addInlineEvents(i)}ne&&P&&(this.system.unmapHandler("bufferUpdated"),this.system.mapHandler("bufferUpdated",void 0,He.bind(this)),P.load()),N&&me.call(this)},Ge=function(){var e=this.videoModel.getCurrentTime();O.seek(e),O.seeked()},Ke=function(t){var n=this;if(this.debug.log("[Stream] Segment loading failed: start time = "+t.startTime+", duration = "+t.duration),this.manifestExt.getIsDynamic(e)&&null===te){ne=!0;var r=t.duration;this.debug.info("[Stream] Reload session in "+r+" s."),te=setTimeout(function(){te=null,n.system.notify("manifestUpdate",!0),ge.call(n)},1e3*r)}else le.call(this,t.startTime+t.duration)},ze=function(){if(!0!==document.hidden&&-1!==re){var e=(new Date).getTime()/1e3,t=this.getVideoModel().getCurrentTime(),n=e-re,r=t-ie;this.debug.log("[Stream] VisibilityChange: elapsedClockTime = "+n+", elapsedStreamTime = "+r+" ("+(n-r)+")"),n-r>1&&Me.call(this)}};return{system:void 0,videoModel:void 0,manifestLoader:void 0,manifestModel:void 0,mediaSourceExt:void 0,sourceBufferExt:void 0,manifestExt:void 0,fragmentController:void 0,fragmentExt:void 0,protectionExt:void 0,capabilities:void 0,debug:void 0,metricsExt:void 0,errHandler:void 0,timelineConverter:void 0,scheduleWhilePaused:void 0,textTrackExtensions:void 0,metricsModel:void 0,eventBus:void 0,notify:void 0,setup:function(){this.system.mapHandler("startTimeFound",void 0,je.bind(this)),this.system.mapHandler("segmentLoadingFailed",void 0,Ke.bind(this)),this.system.mapHandler("bufferingCompleted",void 0,Ue.bind(this)),this[y.dependencies.ProtectionController.eventList.ENAME_PROTECTION_ERROR]=oe.bind(this),i=Ee.bind(this),o=Se.bind(this),a=xe.bind(this),s=we.bind(this),l=Ie.bind(this),f=De.bind(this),h=Pe.bind(this),u=Re.bind(this),d=Ae.bind(this),r=ye.bind(this),p=ve.bind(this),m=_e.bind(this),g=be.bind(this),n=Te.bind(this),R=ze.bind(this)},load:function(e,t){z=t,Fe.call(this,e)},setVideoModel:function(e){this.videoModel=e,this.videoModel.listen("play",i),this.videoModel.listen("pause",o),this.videoModel.listen("error",a),this.videoModel.listen("seeking",s),this.videoModel.listen("seeked",l),this.videoModel.listen("timeupdate",u),this.videoModel.listen("durationchange",d),this.videoModel.listen("progress",f),this.videoModel.listen("ratechange",h),this.videoModel.listen("loadedmetadata",r),this.videoModel.listen("ended",n),this.videoModel.listen("canplay",p),this.videoModel.listen("playing",m),this.videoModel.listen("loadstart",g)},setInitialStartTime:function(e){var t=parseFloat(e);isNaN(t)||(Y=t)},setAudioTrack:function(e){B&&B.stop(),C=qe.call(this,L,e,C)},getSelectedAudioTrack:function(){if(L)return this.manifestExt.getDataForIndex(C,e,z.index)},setSubtitleTrack:function(e){U&&U.stop(),j=qe.call(this,O,e,j)},getSelectedSubtitleTrack:function(){if(O&&k)return this.manifestExt.getDataForIndex(j,e,z.index)},initProtection:function(e){(D=e)&&D.subscribe(y.dependencies.ProtectionController.eventList.ENAME_PROTECTION_ERROR,this)},getVideoModel:function(){return this.videoModel},getManifestExt:function(){return this.manifestExt},setAutoPlay:function(e){H=e},setDefaultAudioLang:function(e){G=e},setDefaultSubtitleLang:function(e){K=e},getAutoPlay:function(){return H},reset:function(){var e=c.defer(),t=this;return this.debug.info("[Stream] Reset"),Oe.call(this),ge.call(this),se.call(this),clearTimeout(w),clearTimeout(te),1!==Q&&this.videoModel.setMute(J),this.videoModel.unlisten("play",i),this.videoModel.unlisten("pause",o),this.videoModel.unlisten("error",a),this.videoModel.unlisten("seeking",s),this.videoModel.unlisten("seeked",l),this.videoModel.unlisten("timeupdate",u),this.videoModel.unlisten("durationchange",d),this.videoModel.unlisten("progress",f),this.videoModel.unlisten("ratechange",h),this.videoModel.unlisten("loadedmetadata",r),this.videoModel.unlisten("ended",n),this.videoModel.unlisten("canplay",p),this.videoModel.unlisten("playing",m),this.videoModel.unlisten("loadstart",g),this.system.unmapHandler("streamsComposed",void 0,Ge),this.system.unmapHandler("bufferUpdated"),this.system.unmapHandler("startTimeFound"),this.system.unmapHandler("segmentLoadingFailed"),this.system.unmapHandler("bufferingCompleted"),de.call(this).then(function(){D&&D.unsubscribe(y.dependencies.ProtectionController.eventList.ENAME_PROTECTION_ERROR,t),D=void 0,t.fragmentController=void 0,e.resolve()}),e.promise},getDuration:function(){return z.duration},getStartTime:function(){return z.start},getPeriodIndex:function(){return z.index},getId:function(){return z.id},getPeriodInfo:function(){return z},getMinbufferTime:function(){return P?P.getMinbufferTime():y.dependencies.BufferExtensions.DEFAULT_MIN_BUFFER_TIME},getLiveDelay:function(){return P?P.getLiveDelay():y.dependencies.BufferExtensions.DEFAULT_LIVE_DELAY},startEventController:function(){$.start()},resetEventController:function(){$.reset()},enableSubtitles:function(t){var n;t!==k&&(k=t,n=this.textTrackExtensions.getCurrentTextTrack(this.videoModel.getElement()),this.textTrackExtensions.cleanSubtitles(),O&&(t?(this.manifestExt.getIsDynamic(e)?(this.system.mapHandler("streamsComposed",void 0,Ge.bind(this),!0),this.system.notify("manifestUpdate")):Ge.call(this),n&&"metadata"!==n.kind&&"showing"!==n.mode?n.mode="showing":n&&(n.mode="hidden")):(U&&U.stop(),n&&(n.mode="disabled"),O.stop())))},setTrickModeSpeed:function(e){var t,n,r=[],i=this,o=1!==e,a=function e(){i.videoModel.getCurrentTime()>t+1&&(i.videoModel.unlisten("timeupdate",e),i.debug.info("[Stream] Set mute: "+J+", the mute state before using trick mode."),i.videoModel.setMute(J))};e!==Q&&P&&(i.debug.info("[Stream] Trick mode: speed = "+e),o&&"Stopped"===X?(i.debug.info("[Stream] Set mute: true"),J=i.videoModel.getMute(),J||i.videoModel.setMute(!0),i.videoModel.pause()):o||(Q=1,clearTimeout(w),this.videoModel.pause(),Oe.call(i)),r.push(P.setTrickMode(o,e>1)),L&&r.push(L.setTrickMode(o,e>1)),c.all(r).then(function(){_=Q,Q=e,t=i.videoModel.getCurrentTime(),o?"Running"===X?X="Changed":"Stopped"===X&&(Z=!1,X="Running",S=T=P.getSegmentDuration(),b=x=(new Date).getTime()/1e3,E=t,i.debug.info("[Stream] Trick mode (x"+Q+"): videoTime = "+E),n=t+S*Math.sign(Q),n=Math.round(1e3*(n-n%T))/1e3,i.debug.info("[Stream] Trick mode (x"+Q+"): seek step = "+S),I=n,le.call(i,n)):(i.debug.info("[Stream] Trick mode: Stopped, current time = "+t),X="Stopped",i.videoModel.listen("timeupdate",a),t=Z?i.getStartTime():t,le.call(i,t,!0))}))},getTrickModeSpeed:function(){return Q},updateData:Ve,play:ae,seek:le,pause:se}},y.dependencies.Stream.prototype={constructor:y.dependencies.Stream},y.dependencies.StreamController=function(){var e,t,n,r,i,o,a,s,l,u,d,f=!1,h=[],p=!1,m=!0,g=!1,v="und",_="und",b=!1,E=!1,T=null,S=function(e,t){var n=e.getElement(),r=t.getElement();return r.parentNode||n.parentNode.insertBefore(r,n),n.style.width="0px",r.style.width="100%",I(n,r),w.call(this,e),x.call(this,t),!0},x=function(e){e.listen("seeking",i),e.listen("progress",o),e.listen("timeupdate",r),e.listen("pause",a),e.listen("play",s)},w=function(e){e.unlisten("seeking",i),e.unlisten("progress",o),e.unlisten("timeupdate",r),e.unlisten("pause",a),e.unlisten("play",s)},I=function(e,t){["controls","loop","muted","playbackRate","volume"].forEach(function(n){t[n]=e[n]})},D=function(){var e=t.getVideoModel().getElement().buffered;if(e.length){var n=e.length-1,r=e.end(n);t.getStartTime()+t.getDuration()-r<6&&(t.getVideoModel().unlisten("progress",o),C())}},R=function(e,n,r){!g&&e&&n&&e!==n&&(g=!0,e.pause(),t=n,S.call(this,e.getVideoModel(),n.getVideoModel()),r?this.seek(e.getVideoModel().getCurrentTime()):this.seek(n.getStartTime()),this.play(),e.resetEventController(),t.startEventController(),g=!1)},A=function(){var e=this,n=new Date,r=t.getStartTime()+t.getDuration(),i=t.getVideoModel().getElement(),o=i.currentTime,a=e.videoExt.getPlaybackQuality(i);e.metricsModel.addPlaybackQuality("video",n,a,o),e.metricsModel.addVideoResolution("video",n,i.videoWidth,i.videoHeight,o),O()&&(t.getVideoModel().getElement().seeking||r-o<.2&&R.call(this,t,O()))},P=function(){var e=t.getVideoModel().getCurrentTime(),n=k(e);this.metricsModel.addState("video","seeking",t.getVideoModel().getCurrentTime()),n&&n!==t&&R.call(this,t,n,e)},M=function(){this.manifestUpdater.stop(),this.metricsModel.addState("video","paused",t.getVideoModel().getCurrentTime())},L=function(){this.manifestUpdater.start()},C=function(){var e=O();e&&e.seek(e.getStartTime())},O=function(){var e=t.getPeriodIndex()+1;return e<h.length?h[e]:null},k=function(e){var t=0,n=null,r=h.length,i=0;for(r>0&&(t+=h[0].getStartTime()),i=0;i<r;i+=1)if(n=h[i],t+=n.getDuration(),e<t)return n},N=function(){var e=this.system.getObject("videoModel"),t=document.createElement("video");return e.setElement(t),e},F=function(e){e.parentNode&&e.parentNode.removeChild(e)},B=function(){var r,i,o,a,s,l,u,c,f,g=this,y=g.manifestModel.getValue(),E=g.metricsModel.getMetricsFor("stream"),S=g.metricsExt.getCurrentManifestUpdate(E);if(!y)return!1;if(this.debug.info("[StreamController] composeStreams"),g.capabilities.supportsEncryptedMedia()&&(n||(n=g.system.getObject("protectionController"),p=!0),n.setMediaElement(g.videoModel.getElement()),d&&n.setProtectionData(d)),c=g.manifestExt.getMpd(y),t&&(r=t.getPeriodInfo(),c.isClientServerTimeSyncCompleted=r.mpd.isClientServerTimeSyncCompleted,c.clientServerTimeShift=r.mpd.clientServerTimeShift),i=g.manifestExt.getRegularPeriods(y,c),0===i.length)return!1;for(s=0,o=i.length;s<o;s+=1){for(u=i[s],l=0,a=h.length;l<a;l+=1)h[l].getId()===u.id&&(f=h[l],this.debug.info("[StreamController] update stream data"),f.updateData(u));f||(this.debug.info("[StreamController] Create stream"),f=g.system.getObject("stream"),f.setVideoModel(0===s?g.videoModel:N.call(g)),f.initProtection(n),f.setAutoPlay(m),f.setDefaultAudioLang(v),f.setDefaultSubtitleLang(_),f.enableSubtitles(b),f.setInitialStartTime(e.startTime),f.load(y,u),h.push(f)),g.metricsModel.addManifestUpdatePeriodInfo(S,u.id,u.index,u.start,u.duration),f=null}return t||(t=h[0],x.call(g,t.getVideoModel())),g.metricsModel.updateManifestUpdateInfo(S,{currentTime:g.videoModel.getCurrentTime(),buffered:g.videoModel.getElement().buffered,presentationStartTime:i[0].start,clientTimeOffset:c.clientServerTimeShift}),T&&(T.resolve(),T=null),!0},U=function(){t&&(l=this.manifestExt.getAudioDatas(this.manifestModel.getValue(),t.getPeriodIndex()),this.system.notify("audioTracksUpdated"))},j=function(){t&&(u=this.manifestExt.getTextDatas(this.manifestModel.getValue(),t.getPeriodIndex()),this.system.notify("subtitleTracksUpdated"))},H=function(e){!0===e&&(E=!0),this.refreshManifest()},q=function(){if(!f)return void(T&&(T.resolve(),T=null));this.debug.info("[StreamController] Manifest updated"),B.call(this)?(U.call(this),j.call(this),this.system.notify("streamsComposed")):this.errHandler.sendError(y.dependencies.ErrorHandler.prototype.MANIFEST_ERR_NO_STREAM,"No stream/period is provided in the manifest"),T&&(T.resolve(),T=null)};return{system:void 0,videoModel:void 0,parser:void 0,manifestLoader:void 0,manifestUpdater:void 0,manifestModel:void 0,manifestExt:void 0,fragmentExt:void 0,capabilities:void 0,debug:void 0,metricsModel:void 0,metricsExt:void 0,videoExt:void 0,errHandler:void 0,eventBus:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,setup:function(){this.system.mapHandler("manifestUpdate",void 0,H.bind(this)),this.system.mapHandler("manifestUpdated",void 0,q.bind(this)),r=A.bind(this),o=D.bind(this),i=P.bind(this),a=M.bind(this),s=L.bind(this)},getManifestExt:function(){return t.getManifestExt()},setAutoPlay:function(e){m=e},getAutoPlay:function(){return m},getVideoModel:function(){return this.videoModel},setVideoModel:function(e){this.videoModel=e},getAudioTracks:function(){return l},getSelectedAudioTrack:function(){if(t)return t.getSelectedAudioTrack()},setAudioTrack:function(e){t&&t.setAudioTrack(e)},getSubtitleTracks:function(){return u},setSubtitleTrack:function(e){t&&t.setSubtitleTrack(e)},getSelectedSubtitleTrack:function(){if(t)return t.getSelectedSubtitleTrack()},getMinbufferTime:function(){return t?t.getMinbufferTime():y.dependencies.BufferExtensions.DEFAULT_MIN_BUFFER_TIME},getLiveDelay:function(){return t?t.getLiveDelay():y.dependencies.BufferExtensions.DEFAULT_LIVE_DELAY},load:function(t){var n=this;f=!0,e=t,e.protData&&(d=e.protData),E=!1,T=c.defer(),n.debug.info("[StreamController] load url: "+e.url),n.manifestLoader.load(e.url).then(function(e){n.manifestModel.setValue(e),n.metricsModel.addMetaData(),n.debug.info("[StreamController] Manifest has loaded."),n.manifestUpdater.start()},function(e){T.resolve(),T=null,e&&n.errHandler.sendError(e.name,e.message,e.data)})},refreshManifest:function(e){var t=this.manifestModel.getValue(),n=e||(t.hasOwnProperty("Location")?t.Location:t.mpdUrl);this.debug.log("[StreamController] Refresh manifest: "+n);var r=this;this.manifestLoader.abort(),this.manifestLoader.load(n,!0).then(function(e){r.manifestModel.setValue(e),r.debug.log("[StreamController] Manifest has been refreshed"),E=!1},function(t){void 0!==t&&(e?E&&r.errHandler.sendError(t.name,t.message,t.data):(r.errHandler.sendWarning(t.name,t.message,t.data),r.eventBus.dispatchEvent({type:"manifestUrlUpdate",data:{url:n}})))})},reset:function(e){var r={},i=[],o=this;this.debug.info("[StreamController] Reset"),t&&w.call(this,t.getVideoModel()),f=!1,o.manifestLoader.abort(),o.manifestUpdater.stop(),o.parser.reset(),c.when(!T||T.promise).then(function(){o.pause(),o.metricsModel.clearAllCurrentMetrics(),g=!1,r[y.models.ProtectionModel.eventList.ENAME_TEARDOWN_COMPLETE]=function(){var r,a,s=0;for(p=!1,n=null,d=null,s=0,r=h.length;s<r;s+=1)a=h[s],i.push(a.reset()),a!==t&&F(a.getVideoModel().getElement());o.videoModel.reset(),c.all(i).then(function(){h=[],t=null,o.metricsModel.addState("video","stopped",o.videoModel.getCurrentTime(),e),o.notify(y.dependencies.StreamController.eventList.ENAME_TEARDOWN_COMPLETE)}),o.manifestModel.setValue(null)},n?p?(n.protectionModel.subscribe(y.models.ProtectionModel.eventList.ENAME_TEARDOWN_COMPLETE,r,void 0,!0),n.teardown()):(n.setMediaElement(null),r[y.models.ProtectionModel.eventList.ENAME_TEARDOWN_COMPLETE]()):r[y.models.ProtectionModel.eventList.ENAME_TEARDOWN_COMPLETE]()})},setDefaultAudioLang:function(e){v=e},setDefaultSubtitleLang:function(e){_=e},enableSubtitles:function(e){b=e,t&&t.enableSubtitles(e)},setTrickModeSpeed:function(e){t&&t.setTrickModeSpeed(e)},getTrickModeSpeed:function(){return t?t.getTrickModeSpeed():0},play:function(){t.play()},pause:function(){t&&t.pause()},seek:function(e,n){t&&t.seek(e,n)}}},y.dependencies.StreamController.prototype={constructor:y.dependencies.StreamController},y.dependencies.StreamController.eventList={ENAME_STREAMS_COMPOSED:"streamsComposed",ENAME_TEARDOWN_COMPLETE:"streamTeardownComplete"},y.utils.TokenAuthentication=function(){var e={type:y.utils.TokenAuthentication.TYPE_QUERY};return{debug:void 0,getTokenAuthentication:function(){return e},setTokenAuthentication:function(t){e=t},checkRequestHeaderForToken:function(t){void 0!==e.name&&null!==t.getResponseHeader(e.name)&&(e.token=t.getResponseHeader(e.name),this.debug.log(e.name+" received: "+e.token))},addTokenAsQueryArg:function(t){if(void 0!==e.name&&void 0!==e.token&&e.type===y.utils.TokenAuthentication.TYPE_QUERY){t+=(-1===t.indexOf("?")?"?":"&")+e.name+"="+e.token,this.debug.log(e.name+" is being appended on the request url with a value of : "+e.token)}return t},setTokenInRequestHeader:function(t){return e.type===y.utils.TokenAuthentication.TYPE_HEADER&&(t.setRequestHeader(e.name,e.token),this.debug.log(e.name+" is being set in the request header with a value of : "+e.token)),t}}},y.utils.TokenAuthentication.TYPE_QUERY="query",y.utils.TokenAuthentication.TYPE_HEADER="header",y.models.URIQueryAndFragmentModel=function(){var e=new y.vo.URIFragmentData,t=[],n=function(){e=new y.vo.URIFragmentData,t=[]};return{parseURI:function(n){function r(e,t,n,r){var i=r[0].split(/[=]/);return r.push({key:i[0],value:i[1]}),r.shift(),r}function i(e,n,r){return n>0&&(l&&0===t.length?t=r[n].split(/[&]/):u&&(o=r[n].split(/[&]/))),r}var o=[],a=new RegExp(/[?]/),s=new RegExp(/[#]/),l=a.test(n),u=s.test(n);return n.split(/[?#]/).map(i),t.length>0&&(t=t.reduce(r,null)),o.length>0&&(o=o.reduce(r,null),o.forEach(function(t){e[t.key]=t.value})),n},reset:n,getURIFragmentData:function(){return e},getURIQueryData:t}},y.models.URIQueryAndFragmentModel.prototype={constructor:y.models.URIQueryAndFragmentModel},y.models.VideoModel=function(){var e,t={},n=null,r=function(){for(var e in t)if(!0===t[e])return!0;return!1},i=function(n,i){t[n]=i,r()?(this.debug.info("<video> setPlaybackRate(0)"),e.playbackRate=0):(this.debug.info("<video> setPlaybackRate(1)"),e.playbackRate=1)};return{system:void 0,debug:void 0,setup:function(){},reset:function(){t=[]},play:function(){this.debug.info("<video> play()"),e.play()},pause:function(){this.debug.info("<video> pause()"),e.pause()},isPaused:function(){return e.paused},isSeeking:function(){return e.seeking},getDuration:function(){return e.duration},getPlaybackRate:function(){return e.playbackRate},setPlaybackRate:function(t){this.debug.info("<video> setPlaybackRate("+t+")"),e.playbackRate=t},getMute:function(){return e.muted},setMute:function(t){e.muted=t},getVolume:function(){return e.volume},setVolume:function(t){e.volume=t},getCurrentTime:function(){return e.currentTime},setCurrentTime:function(t){this.debug.info("<video> setCurrentTime ("+t+")"),e.currentTime=t},listen:function(t,n){e.addEventListener(t,n,!1)},unlisten:function(t,n){e.removeEventListener(t,n,!1)},listenOnParent:function(t,n){e.parentElement.addEventListener(t,n,!1)},unlistenOnParent:function(t,n){e.parentElement.removeEventListener(t,n,!1)},getElement:function(){return e},setElement:function(t){e=t},setSource:function(t){e.src=t},isStalled:function(){return 0===e.playbackRate},getTTMLRenderingDiv:function(){return n},setTTMLRenderingDiv:function(e){n=e,n.style.position="absolute",n.style.display="flex",n.style.overflow="hidden",n.style.pointerEvents="none",n.style.top=0,n.style.left=0},stallStream:i}},y.models.VideoModel.prototype={constructor:y.models.VideoModel},y.dependencies.VideoModelExtensions=function(){return{getPlaybackQuality:function(e){var t="webkitDroppedFrameCount"in e,n="getVideoPlaybackQuality"in e,r=null;return n?r=e.getVideoPlaybackQuality():t&&(r={droppedVideoFrames:e.webkitDroppedFrameCount,creationTime:new Date,totalVideoFrames:e.webkitDecodedFrameCount}),r}}},y.dependencies.VideoModelExtensions.prototype={constructor:y.dependencies.VideoModelExtensions},y.dependencies.XHRLoader=function(){var e=null,t=null,n=null,r=null,i=null,o=0,a=0,s=0,l=null,u=null,d=function(){null!==e&&e.readyState>0&&e.readyState<4?e.abort():l&&(clearTimeout(l),l=null,u.reject())},f=function d(){var c=!0,f=function(t){i&&i(e,t)},h=function(){e.aborted=!0},p=function(){e.status<200||e.status>299||200===e.status&&4===e.readyState&&(c=!1,e.endDate=new Date,u.resolve(e))},m=function(){c&&(c=!1,e.endDate=new Date,s++,!e.aborted&&o>0&&s<=o?l=setTimeout(function(){d()},a):u.reject(e))};try{e=new XMLHttpRequest,n&&(e.responseType=n),r&&e.setRequestHeader("Range","bytes="+r),e.onprogress=f,e.onabort=h,e.onload=p,e.onloadend=m,e.onerror=m,e.startDate=new Date,e.open("GET",t,!0),e.send()}catch(t){e.onerror()}};return{initialize:function(e,t,r,s){n=e,o=t,a=r,i=s},load:function(e,n){return t=e,r=n,s=0,u=c.defer(),f(),u.promise},abort:d}},y.dependencies.XHRLoader.prototype={constructor:y.dependencies.XHRLoader},y.utils.TTMLParser=function(){var e=["http://www.w3.org/ns/ttml","http://www.w3.org/2006/10/ttaf1"],t=["http://www.w3.org/ns/ttml#styling","http://www.w3.org/2006/10/ttaf1#styling"],n=["http://www.w3.org/ns/ttml#parameter","http://www.w3.org/2006/10/ttaf1#parameter"],r=["http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt"],i=/^(0[0-9]|1[0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9])((\.[0-9][0-9][0-9])|(:[0-9][0-9]))$/,o=/^\d+(\.\d+|)(h|m|s|ms|f)$/,a=null,s=null,l=null,u=null,d=null,f=null,h=null,p=[],m=[],g=[],y=function(e){var t,n,r;if(i.test(e))return t=e.split(":"),n=3600*parseFloat(t[0])+60*parseFloat(t[1])+parseFloat(t[2]),t[3]&&h&&!isNaN(h)&&(n+=parseFloat(t[3])/h),n;if(o.test(e)){switch("ms"==e.substr(e.length-2)?(n=parseFloat(e.substr(0,e.length-3)),r=e.substr(e.length-2)):(n=parseFloat(e.substr(0,e.length-2)),r=e.substr(e.length-1)),r){case"h":n=60*n*60;break;case"m":n*=60;break;case"s":break;case"ms":n*=.01;break;case"f":if(!h||isNaN(h))return NaN;n/=h}return n}return NaN},v=function(){var e=!1;return s=a?this.domParser.getChildNode(a,"tt"):null,l=s?this.domParser.getChildNode(s,"head"):null,u=l?this.domParser.getChildNode(l,"layout"):null,d=l?this.domParser.getChildNode(l,"styling"):null,f=s?this.domParser.getChildNode(s,"body"):null,s&&l&&f&&(e=!0),e},_=function(n,r,i){var o,a,s=null,l=0;for(l=0;l<n.length;l+=1){if(s=E.call(this,[n[l]],t,r))return s;if(o=E.call(this,[n[l]],e,"style")){if(s=b.call(this,p,o,r))return s;for(o=b.call(this,p,o,"style");o;){if(s=b.call(this,p,o,r))return s;o=b.call(this,p,o,"style")}}if(a=E.call(this,[n[l]],e,"region")){if(s=b.call(this,m,a,r))return s;if(o=b.call(this,m,a,"style")){if(s=b.call(this,p,o,r))return s;for(o=b.call(this,p,o,"style");o;){if(s=b.call(this,p,o,r))return s;o=b.call(this,p,o,"style")}}}}return void 0!==i?i:null},b=function(n,r,i){var o=0,a=null,s=0;for(o=0;o<n[r].length;o+=1){for(s=0;s<t.length;s+=1)if(a=n[r].getNamedItem(i),a||(a=n[r].getNamedItemNS(t[s],i)),a)return a.nodeValue;for(s=0;s<e.length;s+=1)if(a=n[r].getNamedItem(i),a||(a=n[r].getNamedItemNS(e[s],i)),a)return a.nodeValue}return null},E=function(e,t,n){var r=null,i=0,o=0;for(i=0;i<e.length;i+=1)for(o=0;o<t.length;o+=1)if(r=this.domParser.getAttributeValue(e[i],n,t[o]))return r;return r},T=function(e){e||(e="32 15");var t=e,n=0;for(t=t.split(" "),n=0;n<t.length;n+=1)t[n]=parseFloat(t[n]);return t},S=function(e,t){var r={backgroundColor:null,color:null,fontSize:null,fontFamily:null,fontStyle:null,textOutline:{color:null,with:null},textAlign:null,displayAlign:null,origin:null,extent:null,cellResolution:null,rootExtent:t,showBackground:null};return r.backgroundColor=_.call(this,e,"backgroundColor","transparent"),r.color=_.call(this,e,"color"),r.fontSize=_.call(this,e,"fontSize"),r.fontFamily=_.call(this,e,"fontFamily"),r.fontStyle=_.call(this,e,"fontStyle","normal"),r.textOutline=_.call(this,e,"textOutline"),r.extent=_.call(this,e,"extent"),r.origin=_.call(this,e,"origin"),r.textAlign=_.call(this,e,"textAlign","start"),r.displayAlign=_.call(this,e,"displayAlign","before"),r.showBackground=_.call(this,e,"showBackground"),r.cellResolution=E.call(this,e,n,"cellResolution"),r.cellResolution=T(r.cellResolution),r};return{domParser:void 0,videoModel:void 0,parse:function(t){var i,o,l,u,d,b,T,x,w,I,D,R,A,P,M,L=[],C=null,O=null,k=null,N="",F="";try{if(null!==this.videoModel.getTTMLRenderingDiv()&&(F="html"),a=this.domParser.createXmlTree(t),!v.call(this))return i="TTML document has incorrect structure",c.reject(i);for(x=0;x<n.length;x+=1)h=this.domParser.getAttributeValue(s,"frameRate",n[x])?parseInt(h,10):null;if(!(T=this.domParser.getChildNodes(f,"div"))||0===T.length)return i="TTML body document does not contain any div",c.reject(i);for(p=this.domParser.getAllSpecificNodes(s,"style"),m=this.domParser.getAllSpecificNodes(s,"region"),g=this.domParser.getAllSpecificNodes(s,"image"),R=_.call(this,[s],"extent"),D=0;D<T.length;D+=1)if(P=E.call(this,[T[D]],r,"backgroundImage"),P&&void 0!==g[P.substring(1)]&&(u=y(E.call(this,[T[D]],e,"begin")),d=y(E.call(this,[T[D]],e,"end")),k=S.call(this,[T[D],s],R),b={start:u,end:d,data:"data:image/"+g[P.substring(1)].imagetype.nodeValue+";base64, "+this.domParser.getChildNode(g[P.substring(1)],"#text").nodeValue,type:"image",line:80,style:k},L.push(b)),(o=this.domParser.getChildNodes(T[D],"p"))&&0!==o.length)for(x=0;x<o.length;x+=1)if(b=null,k=null,l=o[x],u=y(E.call(this,[l],e,"begin")),d=y(E.call(this,[l],e,"end")),isNaN(u)||isNaN(d)||d<u)i="TTML document has incorrect timing value";else if(P=E.call(this,[l],r,"backgroundImage"),P&&void 0!==g[P.substring(1)]&&(k=S.call(this,[l,T[D],s],R),b={start:u,end:d,data:"data:image/"+g[P.substring(1)].imagetype.nodeValue+";base64, "+this.domParser.getChildNode(g[P.substring(1)],"#text").nodeValue,type:"image",line:80,style:k}),w=this.domParser.getChildNodes(l,"span"),w.length>0){for(I=0;I<w.length;I++){I>0&&(N+="\n"),0===I&&(k=S.call(this,[w[I],l,f,s,T[D]],R)),A=this.domParser.getTextNodesIn(w[I]);for(var B=0;B<A.length;B+=1)B>0&&(N+="\n"),N+=A[B].textContent}b={start:u,end:d,data:N,type:"text",line:80,style:k},N="",L.push(b)}else{if(k=S.call(this,[l,f,s],R),x>0&&(C=y(E.call(this,[o[x-1]],e,"begin")),O=y(E.call(this,[o[x-1]],e,"end"))),u===C&&d===O||u>=C&&d<=O)""!==l.textContent&&("html"===F?b={start:u,end:d,data:l.textContent,type:"text",line:80,style:k}:(u>=C&&d<=O?(M=L[L.length-1],M.end=u):M=L.pop(),b={start:u,end:d,data:M.data+"\n"+l.textContent,type:"text",line:80,style:k}));else{for(A=this.domParser.getTextNodesIn(l),I=0;I<A.length;I+=1)I>0&&(N+="\n"),N+=A[I].textContent;""!==N&&(b={start:u,end:d,data:N,type:"text",line:80,style:k},N="")}null!==b&&L.push(b)}else i="TTML document does not contain any cues";return L.length>0?c.when(L):c.reject(i)}catch(e){return i=e.message,c.reject(i)}}}},y.utils.TTMLRenderer=function(){var e,t=[],n=function(){var n=0;for(n=0;n<t.length;n++)d(t[n],t[n].ttmlStyle,e)},r=function(){this.cleanSubtitles()},i=function(){var t=document.createElement("div");return t.style.position="absolute",t.style.display="flex",t.style.flexDirection="row",t.style.overflow="initial",t.style.pointerEvents="none",e.appendChild(t),t},o=function(t){e.hasChildNodes()&&e.removeChild(t)},a=function(e,t){var n,r;if(e&&"%"===e[e.length-1])n=parseFloat(e.substr(0,e.length-1))/100*t[1]+"px";else if(e&&"x"===e[e.length-1])n=e;else if(e&&"c"===e[e.length-1]){var i=e.replace(/\s/g,"").split("c");for(r=0;r<i.length;r+=1)i[r]=parseFloat(i[r]);n=isNaN(i[1])?i[0]*t[1]+"px":i[1]*t[1]+"px"}else n=t[1]+"px";return n},s=function(e,t,n){var r={color:n,width:null},i=0;if(e&&(e=e.split(" "),e[0]&&isNaN(e[0][0])?(r.color=e[0],i=1):r.color=n,r.color&&"#"===r.color[0]&&(r.color=l(r.color)),e[i]))switch(e[i][e[i].length-1]){case"c":e[i]=e[i].split("c"),e[i][0]&&(r.width=e[i][0]*t[1]+"px");break;case"x":r.width=e[i]}return r},l=function(e){return e=e.replace("#",""),"rgba("+parseInt(e.substring(0,2),16)+","+parseInt(e.substring(2,4),16)+","+parseInt(e.substring(4,6),16)+","+(e.length>6?parseInt(e.substring(6,8),16):255)+")"},u=function(e){var t,n,r=e;return t=e.replace(/^(rgb|rgba)\(/,"").replace(/\)$/,"").replace(/\s/g,"").split(","),t[t.length-1]>1&&(n=parseInt(t[t.length-1],10)/255,r="rgba("+t[0]+","+t[1]+","+t[2]+","+n+")"),r},d=function(e,t,n){var r,i,o,d,c=[n.clientWidth/t.cellResolution[0],n.clientHeight/t.cellResolution[1]];if(e){if(t.backgroundColor&&"#"===t.backgroundColor[0]?t.backgroundColor=l(t.backgroundColor):t.backgroundColor&&"a"===t.backgroundColor[3]&&(t.backgroundColor=u(t.backgroundColor)),t.color&&"#"===t.color[0]?t.color=l(t.color):t.color&&"a"===t.color[3]&&(t.color=u(t.color)),t.origin&&"%"===t.origin[t.origin.length-1])r=t.origin.split("%"),e.style.left=parseInt(r[0],10)+"%",e.style.top=parseInt(r[1],10)+"%",t.extent&&"%"===t.extent[t.extent.length-1]&&(i=t.extent.split("%"),e.style.width=parseInt(i[0],10)+"%",e.style.height=parseInt(i[1],10)+"%");else if(t.origin&&"x"===t.origin[t.origin.length-1])if(r=t.origin.split("px"),t.rootExtent&&"x"===t.rootExtent[t.rootExtent.length-1]){d=t.rootExtent.split("px");var f=r[0]/d[0]*n.clientWidth;e.style.left=f/n.clientWidth*100+"%",f=r[1]/d[1]*n.clientHeight,e.style.top=f/n.clientHeight*100+"%",t.extent&&"x"===t.extent[t.extent.length-1]&&(i=t.extent.split("px"),f=i[0]/d[0]*n.clientWidth,e.style.width=f/n.clientWidth*100+"%",f=i[1]/d[1]*n.clientHeight,e.style.height=f/n.clientHeight*100+"%")}else e.style.left=r[0]+"px",e.style.top=r[1]+"px";else t.origin&&"c"===t.origin[t.origin.length-1]&&(r=t.origin.split("c"),e.style.left=r[0]*c[0]+"px",e.style.top=r[1]*c[1]+"px",t.extent&&"c"===t.extent[t.extent.length-1]&&(i=t.extent.split("c"),e.style.width=i[0]*c[0]+"px",e.style.height=i[1]*c[1]+"px"));switch(o=s(t.textOutline,c,t.color),e.style.webkitTextStrokeWidth=o.width,e.style.webkitTextStroke=o.color,t.textAlign){case"start":e.style.justifyContent="flex-start";break;case"end":e.style.justifyContent="flex-end";break;case"center":e.style.justifyContent="center";break;case"right":e.style.justifyContent="flex-end";break;case"left":e.style.justifyContent="flex-start";break;default:e.style.justifyContent="flex-start"}switch(t.displayAlign){case"before":e.style.alignItems="flex-start";break;case"center":e.style.alignItems=t.displayAlign;break;case"after":e.style.alignItems="flex-end";break;default:e.style.alignItems="flex-start"}e.style.fontStyle=t.fontStyle,t.showBackground&&"whenActive"===t.showBackground?e.style.backgroundColor="transparent":e.style.backgroundColor=t.backgroundColor,e.style.color=t.color,e.style.fontSize=a(t.fontSize,c),e.style.fontFamily=t.fontFamily}};return{videoModel:void 0,initialize:function(t){e=t,document.addEventListener("webkitfullscreenchange",n.bind(this)),document.addEventListener("mozfullscreenchange",n.bind(this)),document.addEventListener("fullscreenchange",n.bind(this)),this.videoModel.listen("seeking",r.bind(this))},cleanSubtitles:function(){var e=0;for(e=0;e<t.length;e++)o(t[e]);t=[]},onCueEnter:function(n){var r=i();if(d(r,n.currentTarget.style,e),r.ttmlStyle=n.currentTarget.style,"image"!==n.currentTarget.type){var o=document.createElement("p");r.appendChild(o),o.innerText=n.currentTarget.text,o.style.marginTop="auto",r.ttmlStyle.showBackground&&"whenActive"===r.ttmlStyle.showBackground&&(o.style.backgroundColor=n.currentTarget.style.backgroundColor)}else{var a=new Image;a.style.height="auto",a.style.width="auto",a.src=n.currentTarget.text,r.appendChild(a)}r.data=n.currentTarget.text,t.push(r)},onCueExit:function(e){var n=0;for(n=0;n<t.length&&(e.currentTarget.text!==t[n].data||t[n].ttmlStyle!==e.currentTarget.style);n++);o(t[n]),t.splice(n,1)}}},y.dependencies.TextController=function(){var e,t,n,r,i=!1,o=null,a="READY",s=function(e){this.debug.log("TextController setState to:"+e),a=e},l=function(){if(i&&"READY"===a){var e=this;e.indexHandler.getInitRequest(r[0]).then(function(t){e.fragmentLoader.load(t).then(c.bind(e,t),f.bind(e,t)),s.call(e,"LOADING")})}},u=function(){l.call(this)},d=function(e,t){var n,r,i=this.manifestModel.getValue();return r=this.manifestExt.getDataIndex(e,i,t.index),n=this.manifestExt.getAdaptationsForPeriod(i,t),this.manifestExt.getRepresentationsForAdaptation(i,n[r])},c=function(e,t){var r=this;r.fragmentController.process(t.data,e).then(function(e){null!==e&&r.sourceBufferExt.append(n,e,r.videoModel)})},f=function(){};return{videoModel:void 0,fragmentLoader:void 0,fragmentController:void 0,indexHandler:void 0,sourceBufferExt:void 0,manifestModel:void 0,manifestExt:void 0,debug:void 0,initialize:function(e,t,n,r,o){var a=this;a.setVideoModel(r),a.setBuffer(n),a.setMediaSource(o),a.updateData(t,e),i=!0,l.call(a)},setPeriodInfo:function(e){o=e},getPeriodIndex:function(){return o.index},getVideoModel:function(){return this.videoModel},setVideoModel:function(e){this.videoModel=e},getData:function(){return t},setData:function(e){t=e},getBuffer:function(){return n},setBuffer:function(e){n=e},setMediaSource:function(t){e=t},updateData:function(e,n){t=e,o=n,r=d.call(this,t,o),s.call(this,"READY"),l.call(this)},reset:function(t){t||(this.sourceBufferExt.abort(e,n),this.sourceBufferExt.removeSourceBuffer(e,n))},start:u}},y.dependencies.TextController.prototype={constructor:y.dependencies.TextController},y.dependencies.TextSourceBuffer=function(){var e,t,n;return{system:void 0,eventBus:void 0,errHandler:void 0,initialize:function(r,i){n=r,e=i.getVideoModel().getElement(),t=i.getData()},append:function(n){var r=this,i=String.fromCharCode.apply(null,new Uint16Array(n));r.getParser().parse(i).then(function(n){var i=t.Representation_asArray[0].id,o=t.lang;r.getTextTrackExtensions().addTextTrack(e,n,i,o,!0).then(function(){r.eventBus.dispatchEvent({type:"updateend"})})},function(e){r.errHandler.sendError(y.dependencies.ErrorHandler.prototype.CC_ERR_PARSE,e,i)})},abort:function(){this.getTextTrackExtensions().deleteCues(e)},getParser:function(){var e;return"text/vtt"===n?e=this.system.getObject("vttParser"):"application/ttml+xml"===n&&(e=this.system.getObject("ttmlParser")),e},getTextTrackExtensions:function(){return this.system.getObject("textTrackExtensions")},addEventListener:function(e,t,n){this.eventBus.addEventListener(e,t,n)},removeEventListener:function(e,t,n){this.eventBus.removeEventListener(e,t,n)}}},y.dependencies.TextSourceBuffer.prototype={constructor:y.dependencies.TextSourceBuffer},y.dependencies.TextTTMLXMLMP4SourceBuffer=function(){var e,t,n,r,i={length:0,ranges:[],start:function(e){return this.ranges[e].start},end:function(e){return this.ranges[e].end},addRange:function(e,t){var n=0,r=!1;for(n=0;n<this.ranges.length;n++)this.ranges[n].end<=e+.01&&this.ranges[n].end>=e-.01&&(r=!0,this.ranges[n].end=t),this.ranges[n].start<=t+.01&&this.ranges[n].start>=t-.01&&(r=!0,this.ranges[n].start=e);r||(this.ranges.push({start:e,end:t}),this.length=this.length+1,this.ranges.sort(function(e,t){return e.start-t.start}))},removeRange:function(e,t){var n=0;for(n=this.ranges.length-1;n>=0;n-=1)(void 0===t||-1===t||this.ranges[n].end<=t)&&(void 0===e||-1===e||this.ranges[n].start>=e)&&this.ranges.splice(n,1);this.length=this.ranges.length},reset:function(){this.length=0,this.ranges=[]}};return{updating:!1,system:void 0,eventBus:void 0,buffered:i,textTrackExtensions:void 0,ttmlParser:void 0,debug:void 0,manifestModel:void 0,initialize:function(o,a,s){t=o,e=a.getVideoModel().getElement(),i.reset(),n=s.lang,r=s.id},remove:function(t,n){if(t<0||t>=n)throw"INVALID_ACCESS_ERR";this.getTextTrackExtensions().deleteCues(e,!1,t,n),this.buffered.removeRange(t,n)},append:function(i){var o,a,s,l,u,d,c,f,h=this,p=S.deserialize(i),m=p.getBoxByType("moov"),g=0,y="utf-8";return"application/ttml+xml"===t?(this.track=this.textTrackExtensions.addTextTrack(e,[],r,n,!0),h.isUTF16(i)&&(y="utf-16"),void this.convertUTFToString(i,y).then(function(t){h.ttmlParser.parse(t).then(function(t){t&&(h.textTrackExtensions.addCues(h.track,t),h.buffered.addRange(0,e.duration),h.eventBus.dispatchEvent({type:"updateend"}))},function(){})})):m?(o=m.getBoxByType("mvhd"),h.timescale=o.timescale,this.track=this.textTrackExtensions.addTextTrack(e,[],r,n,!0),void this.eventBus.dispatchEvent({type:"updateend"})):void((a=p.getBoxByType("moof"))&&(s=p.getBoxByType("mdat"),l=a.getBoxByType("traf"),u=l.getBoxByType("tfhd"),d=l.getBoxByType("tfdt"),c=l.getBoxByType("trun"),f=d.baseMediaDecodeTime/h.timescale,g=0,g=256&c.flags?c.samples_table[0].sample_duration/h.timescale:u.default_sample_duration/h.timescale,h.buffered.addRange(f,f+g),h.isUTF16(s.data)&&(y="utf-16"),h.convertUTFToString(s.data,y).then(function(e){h.ttmlParser.parse(e).then(function(e){var t,n=h.manifestModel.getValue();if(e){if("MSS"===n.name)for(t=0;t<e.length;t+=1)e[t].start=e[t].start+f,e[t].end=e[t].end+f;h.textTrackExtensions.addCues(h.track,e),h.eventBus.dispatchEvent({type:"updateend"})}},function(){})})))},convertUTFToString:function(e,t){var n=c.defer(),r=new Blob([e],{type:"text/xml"}),i=new FileReader;return i.onload=function(e){n.resolve(e.target.result)},i.readAsText(r,t),n.promise},isUTF16:function(e){var t,n,r,i,o=0,a=e&&e.length,s=null;if(a<2){if(e[0]>255)return!1}else{if(t=e[0],n=e[1],255===t&&254===n)return!0;if(254===t&&255===n)return!0;for(;o<a;o++){if(0===e[o]){s=o;break}if(e[o]>255)return!1}if(null===s)return!1;if(void 0!==(r=e[s+1])&&r>0&&r<128)return!0;if(void 0!==(i=e[s-1])&&i>0&&i<128)return!0}return!1},UpdateLang:function(e,t){r=e,n=t},abort:function(){this.getTextTrackExtensions().deleteCues(e,!0)},getTextTrackExtensions:function(){return this.textTrackExtensions},addEventListener:function(e,t,n){this.eventBus.addEventListener(e,t,n),this.updating||this.eventBus.dispatchEvent({type:"updateend"})},removeEventListener:function(e,t,n){this.eventBus.removeEventListener(e,t,n)}}},y.dependencies.TextTTMLXMLMP4SourceBuffer.prototype={constructor:y.dependencies.TextTTMLXMLMP4SourceBuffer},y.utils.TextTrackExtensions=function(){var e,t="",n=null;return{system:void 0,eventBus:void 0,videoModel:void 0,debug:void 0,config:void 0,setup:function(){e=window.VTTCue||window.TextTrackCue},cueEnter:function(e,t,n){this.eventBus.dispatchEvent({type:"cueEnter",data:{text:t,style:e,type:n}})},cueExit:function(e,t,n){this.eventBus.dispatchEvent({type:"cueExit",data:{text:t,style:e,type:n}})},getCurrentTextTrack:function(e){for(var t=0;t<e.textTracks.length;t++)if("hascaption"===e.textTracks[t].label)return e.textTracks[t];return null},addTextTrack:function(r,i,o,a,s){var l,u=null,d=null,c="subtitles",f=this.videoModel.getTTMLRenderingDiv();for(u=this.getCurrentTextTrack(r),u?(this.cleanSubtitles(),u.default=s,"showing"!==u.mode&&"metadata"!==u.kind&&(u.mode="showing"),t=a):(f&&(n=this.system.getObject("ttmlRenderer"),n.initialize(f)),c=null!==f?"metadata":"subtitles","subtitles"===c&&(c=!0===this.config.getParam("TextTrackExtensions.displayModeExtern","boolean")?"metadata":"subtitles"),u=r.addTextTrack(c,"hascaption",a),t=a,u.default=s,u.mode="metadata"!==c?"showing":"hidden"),l=0;l<i.length;l+=1)d=i[l],u.addCue(new e(d.start,d.end,d.data));return u},onCueEnter:function(e){var t=this.videoModel.getTTMLRenderingDiv();"image"===e.currentTarget.type&&null===t&&this.debug.warn("[TextTrackExtensions] Rendering image subtitles without div is impossible"),t&&n.onCueEnter(e),this.cueEnter(e.currentTarget.style,e.currentTarget.text,e.currentTarget.type)},onCueExit:function(e){this.videoModel.getTTMLRenderingDiv()&&n.onCueExit(e),this.cueExit(e.currentTarget.style,e.currentTarget.text)},addCues:function(n,r){var i=0,o=null,a=null;for(i=0;i<r.length;i+=1)o=r[i],o.start<o.end&&(a=new e(o.start,o.end,o.data),a.id=t,a.type=o.type,a.onenter=this.onCueEnter.bind(this),a.onexit=this.onCueExit.bind(this),a.snapToLines=!1,a.line=o.line,o.style&&(a.style=o.style),n.addCue(a))},deleteCues:function(e,t,n,r){var i,o=null,a=null,s=null,l=0;if(e&&(o=e.textTracks[0])){if(i=o.mode,"disabled"===i&&(o.mode="hidden"),a=o.cues)for(s=a.length-1,l=s;l>=0;l-=1)(void 0===r||-1===r||a[l].endTime<=r)&&(void 0===n||-1===n||a[l].startTime>=n)&&o.removeCue(a[l]);o.mode=i}},cleanSubtitles:function(){this.videoModel.getTTMLRenderingDiv()&&n&&n.cleanSubtitles()}}},y.utils.VTTParser=function(){var e=function(e){var t=e.split(":"),n=t.length-1;return e=60*parseInt(t[n-1],10)+parseFloat(t[n],10),2===n&&(e+=3600*parseInt(t[0],10)),e};return{parse:function(t){var n,r=/(?:\r\n|\r|\n)/gm,i=/-->/,o=/(^[\s]+|[\s]+$)/g,a=[];t=t.split(r),n=t.length;for(var s=0;s<n;s++){var l=t[s];if(l.length>0&&"WEBVTT"!==l&&l.match(i)){var u=l.split(i),d=t[s+1];a.push({start:e(u[0].replace(o,"")),end:e(u[1].replace(o,"")),data:d})}}return c.when(a)}}},y.rules.AbandonRequestsRule=function(){return{debug:void 0,metricsExt:void 0,name:"AbandonRequestRule",execute:function(e,t){var n,r,i=(new Date).getTime(),o=e.streamType,a=new y.rules.SwitchRequest(y.rules.SwitchRequest.prototype.NO_CHANGE,y.rules.SwitchRequest.prototype.WEAK);if(null===e.firstByteDate||e.aborted)return this.debug.log("[AbandonRequestsRule]["+o+"] Request has already been aborted."),void t(a);n=(i-e.firstByteDate.getTime())/1e3,e.bytesLoaded<e.bytesTotal&&n>=.5*e.duration&&(r=e.bytesLoaded/n,e.bytesTotal/r>2*e.duration&&(a=new y.rules.SwitchRequest(0,y.rules.SwitchRequest.prototype.STRONG),this.debug.info("[AbandonRequestsRule]["+o+"] BW = "+r.toFixed(3)+" kb/s => switch to lowest quality"))),t(a)}}},y.rules.AbandonRequestsRule.prototype={constructor:y.rules.AbandonRequestsRule},y.rules.BaseRulesCollection=function(){var e=[],t=[];return{downloadRatioRule:void 0,insufficientBufferRule:void 0,droppedFramesRule:void 0,abandonRequestRule:void 0,getRules:function(n){switch(n){case y.rules.BaseRulesCollection.prototype.QUALITY_SWITCH_RULES:return e;case y.rules.BaseRulesCollection.prototype.ABANDON_FRAGMENT_RULES:return t;default:return null}},setup:function(){e.push(this.downloadRatioRule),e.push(this.insufficientBufferRule),e.push(this.droppedFramesRule),t.push(this.abandonRequestRule)}}},y.rules.BaseRulesCollection.prototype={constructor:y.rules.BaseRulesCollection,QUALITY_SWITCH_RULES:"qualitySwitchRules",ABANDON_FRAGMENT_RULES:"abandonFragmentRules"},y.rules.DownloadRatioRule=function(){return{debug:void 0,manifestExt:void 0,metricsExt:void 0,manifestModel:void 0,config:void 0,name:"DownloadRatioRule",checkIndex:function(e,t,n){var r,i,o,a,s,l,u,d,c,f=this,h=f.metricsExt.getHttpRequests(t),p=null,m=[],g=y.rules.SwitchRequest.prototype.NO_CHANGE,v=0,_=y.rules.SwitchRequest.prototype.DEFAULT;if(n&&n.hasOwnProperty("type")){if(s=f.config.getParamFor(n.type,"ABR.latencyInBandwidth","boolean",!0),l=f.config.getParamFor(n.type,"ABR.switchUpRatioSafetyFactor","number",1.5),f.debug.log("[DownloadRatioRule]["+n.type+"] Checking download ratio rule... (current = "+e+")"),!t)return f.debug.log("[DownloadRatioRule]["+n.type+"] No metrics, bailing."),new y.rules.SwitchRequest;for(c=h.length-1;c>=0&&null===p;)h[c].tfinish&&h[c].trequest&&h[c].tresponse&&h[c].bytesLength>0&&(p=h[c]),c--;if(null===p)return f.debug.log("[DownloadRatioRule]["+n.type+"] No valid requests made for this stream yet, bailing."),new y.rules.SwitchRequest;if(i=(p.tfinish.getTime()-p.trequest.getTime())/1e3,r=(p.tfinish.getTime()-p.tresponse.getTime())/1e3,i<=0)return f.debug.log("[DownloadRatioRule]["+n.type+"] Don't know how long the download of the last fragment took, bailing."),new y.rules.SwitchRequest;if(null===p.mediaduration||void 0===p.mediaduration||p.mediaduration<=0||isNaN(p.mediaduration))return f.debug.log("[DownloadRatioRule]["+n.type+"] Don't know the duration of the last media fragment, bailing."),new y.rules.SwitchRequest;for(f.debug.log("[DownloadRatioRule]["+n.type+"] DL: "+Number(r.toFixed(3))+"s, Total: "+Number(i.toFixed(3))+"s"),v=p.bytesLength,d=1,c=h.length-2;c>=0&&d<3;)h[c].tfinish&&h[c].trequest&&h[c].tresponse&&h[c].bytesLength>0&&(f.debug.log("[DownloadRatioRule]["+n.type+"] length: "+h[c].bytesLength+", time: "+(h[c].tfinish.getTime()-h[c].trequest.getTime())/1e3),v+=h[c].bytesLength,i+=(h[c].tfinish.getTime()-h[c].trequest.getTime())/1e3,r+=(h[c].tfinish.getTime()-h[c].tresponse.getTime())/1e3,d+=1),c--;if(v*=8,o=s?v/i:v/r,f.debug.log("[DownloadRatioRule]["+n.type+"] BW = "+Math.round(o/1e3)+" kb/s"),isNaN(o))return new y.rules.SwitchRequest;for(d=f.manifestExt.getRepresentationCount(n),u=f.manifestExt.getRepresentationFor(e,n),a=f.manifestExt.getBandwidth(u),c=0;c<d;c+=1)m.push(f.manifestExt.getRepresentationBandwidth(n,c));if(o<=a){for(c=e-1;c>0&&!(m[c]<=o);c-=1);return g=c,_=y.rules.SwitchRequest.prototype.WEAK,f.debug.info("[DownloadRatioRule]["+n.type+"] SwitchRequest: q="+g+"/"+(d-1)+" ("+m[g]+"), p="+_),new y.rules.SwitchRequest(g,_)}for(c=d-1;c>e&&!(o>m[c]*l);c-=1);return g=c,_=y.rules.SwitchRequest.prototype.STRONG,f.debug.info("[DownloadRatioRule]["+n.type+"] SwitchRequest: q="+g+"/"+(d-1)+" ("+m[g]+"), p="+_),new y.rules.SwitchRequest(g,_)}return new y.rules.SwitchRequest}}},y.rules.DownloadRatioRule.prototype={constructor:y.rules.DownloadRatioRule},y.rules.DroppedFramesRule=function(){var e=null,t=-1,n=-1,r=function(r){var i;if(null===e)return void(e=r);(i=r.mt-e.mt)<1||(t=r.droppedFrames-e.droppedFrames,n=r.totalVideoFrames-e.totalVideoFrames,e=r)};return{debug:void 0,metricsExt:void 0,manifestModel:void 0,config:void 0,name:"DroppedFramesRule",checkIndex:function(i,o,a,s){var l,u=this.config.getParamFor(a.type,"ABR.droppedFramesMaxRatio","number",.3),d=this.config.getParamFor(a.type,"ABR.droppedFramesMinRatio","number",.1),c=this.metricsExt.getCurrentPlaybackQuality(o),f=y.rules.SwitchRequest.prototype.NO_CHANGE,h=y.rules.SwitchRequest.prototype.DEFAULT;return null===a?new y.rules.SwitchRequest:"video"!==a.type?new y.rules.SwitchRequest:null===c?(e=null,t=n=-1,new y.rules.SwitchRequest):"buffering"===s?(e=null,t=n=-1,new y.rules.SwitchRequest):(r(c),-1===t?new y.rules.SwitchRequest:(l=t/n,this.debug.info("[DroppedFramesRule]["+a.type+"] DroppedFrames:"+t+", totalVideoFrames:"+n+" => ratio = "+l),l>u&&i>0?(f=i-1,h=y.rules.SwitchRequest.prototype.STRONG):l>d&&(f=i,h=y.rules.SwitchRequest.prototype.STRONG),this.debug.info("[DroppedFramesRule]["+a.type+"] SwitchRequest: q="+f+", p="+h),new y.rules.SwitchRequest(f,h)))}}},y.rules.DroppedFramesRule.prototype={constructor:y.rules.DroppedFramesRule},y.rules.InsufficientBufferRule=function(){return{debug:void 0,manifestExt:void 0,metricsExt:void 0,manifestModel:void 0,config:void 0,isStartBuffering:{},name:"InsufficientBufferRule",checkIndex:function(e,t,n,r){var i,o,a,s,l,u,d,c=this,f=c.metricsExt.getCurrentBufferLevel(t),h=e,p=y.rules.SwitchRequest.prototype.DEFAULT;if(null===n)return new y.rules.SwitchRequest;if("buffering"===r&&(c.isStartBuffering[n.type]=!0),null===f)return new y.rules.SwitchRequest;if(c.debug.info("[InsufficientBufferRule]["+n.type+"] Checking buffer level ... (current = "+e+", buffer level = "+Math.round(100*f.level)/100+", buffering = "+c.isStartBuffering[n.type]+")"),d=c.manifestExt.getMpd(c.manifestModel.getValue())){if(i=c.config.getParamFor(n.type,"BufferController.minBufferTime","number",d.manifest.minBufferTime),o=c.config.getParamFor(n.type,"ABR.switchLowerBufferRatio","number",.25),a=c.config.getParamFor(n.type,"ABR.switchLowerBufferTime","number",o*i),s=c.config.getParamFor(n.type,"ABR.switchDownBufferRatio","number",.5),l=c.config.getParamFor(n.type,"ABR.switchDownBufferTime","number",s*i),u=c.config.getParamFor(n.type,"ABR.switchUpBufferRatio","number",.75),c.config.getParamFor(n.type,"ABR.switchUpBufferTime","number",u*i),f.level<l&&c.isStartBuffering[n.type])return new y.rules.SwitchRequest;f.level>=l&&(c.isStartBuffering[n.type]=!1);var m=c.manifestExt.getRepresentationCount(n);return m-=1,f.level<=a?(h=0,p=y.rules.SwitchRequest.prototype.STRONG):f.level<=l&&(h=e>0?e-1:0,p=y.rules.SwitchRequest.prototype.DEFAULT),c.debug.info("[InsufficientBufferRule]["+n.type+"] SwitchRequest: q="+h+", p="+p),new y.rules.SwitchRequest(h,p)}return c.debug.log("[InsufficientBufferRule]["+n.type+"] Manifest not present yet"),new y.rules.SwitchRequest}}},y.rules.InsufficientBufferRule.prototype={constructor:y.rules.OInsufficientBufferRule},y.rules.LimitSwitchesRule=function(){var e=0;return{debug:void 0,name:"LimitSwitchesRule",checkIndex:function(t,n){if(e>0)return e-=1,new y.rules.SwitchRequest(t,y.rules.SwitchRequest.prototype.STRONG);var r,i,o=this,a=!1,s=(new Date).getTime(),l=n.RepSwitchList.length;for(i=l-1;i>=0;i-=1){if(r=n.RepSwitchList[i],s-r.t.getTime()>=2e4){o.debug.log("Reached time limit, bailing.");break}if(i>=10){o.debug.log("Found too many switches within validation time, force the stream to not change."),a=!0;break}}return a?(o.debug.log("Wait some time before allowing another switch."),e=5,new y.rules.SwitchRequest(t,y.rules.SwitchRequest.prototype.STRONG)):new y.rules.SwitchRequest(y.rules.SwitchRequest.prototype.NO_CHANGE,y.rules.SwitchRequest.prototype.STRONG)}}},y.rules.LimitSwitchesRule.prototype={constructor:y.rules.LimitSwitchesRule},y.rules.SwitchRequest=function(e,t){this.quality=e,this.priority=t,void 0===this.quality&&(this.quality=999),void 0===this.priority&&(this.priority=.5)},y.rules.SwitchRequest.prototype={constructor:y.rules.SwitchRequest,NO_CHANGE:999,DEFAULT:.5,STRONG:1,WEAK:0},y.vo.Error=function(e,t,n){this.code=e||null,this.message=t||null,this.data=n||null},y.vo.Error.prototype={constructor:y.vo.Error},y.vo.Event=function(){this.type=null,this.sender=null,this.data=null,this.error=null,this.timestamp=NaN},y.vo.Event.prototype={constructor:y.vo.Event},y.models.MetricsList=function(){return{TcpList:[],HttpList:[],RepSwitchList:[],BufferedSwitchList:[],BufferLevel:[],PlayList:[],DroppedFrames:[],PlaybackQuality:[],VideoResolution:[],DVRInfo:[],ManifestUpdate:[]}},y.models.MetricsList.prototype={constructor:y.models.MetricsList},y.vo.Mp4Track=function(){this.type="und",this.trackId=0,this.timescale=0,this.duration=0,this.codecs="",this.codecPrivateData="",this.bandwidth="",this.width=0,this.height=0,this.language="und",this.channels=0,this.samplingRate=0,this.contentProtection=void 0,this.samples=[],this.data=null},y.vo.Mp4Track.prototype={constructor:y.vo.Mp4Track},y.vo.Mp4Track.Sample=function(){this.dts=0,this.cts=0,this.duration=0,this.flags=0,this.data=null,this.size=0},y.vo.Mp4Track.Sample.prototype={constructor:y.vo.Mp4Track.Sample},y.vo.SegmentRequest=function(){this.action="download",this.startTime=NaN,this.streamType=null,this.type=null,this.duration=NaN,this.timescale=NaN,this.range=null,this.url=null,this.requestStartDate=null,this.firstByteDate=null,this.requestEndDate=null,this.deferred=null,this.quality=NaN,this.index=NaN,this.availabilityStartTime=null,this.availabilityEndTime=null,this.wallStartTime=null},y.vo.SegmentRequest.prototype={constructor:y.vo.SegmentRequest,ACTION_DOWNLOAD:"download",ACTION_COMPLETE:"complete"},y.vo.URIFragmentData=function(){this.t=null,this.xywh=null,this.track=null,this.id=null,this.s=null},y.vo.URIFragmentData.prototype={constructor:y.vo.URIFragmentData},y.vo.metrics.BufferLevel=function(){this.t=null,this.level=null},y.vo.metrics.BufferLevel.prototype={constructor:y.vo.metrics.BufferLevel},y.vo.metrics.BufferedSwitch=function(){this.mt=null,this.to=null,this.lto=null},y.vo.metrics.BufferedSwitch.prototype={constructor:y.vo.metrics.BufferedSwitch},y.vo.metrics.Condition=function(){this.isFullScreen=null,this.windowSize=null,this.droppedFrames=null,this.fps=null,this.bandwidth=null},y.vo.metrics.Condition.prototype={constructor:y.vo.metrics.Condition},y.vo.metrics.DVRInfo=function(){this.time=null,this.range=null},y.vo.metrics.DVRInfo.prototype={constructor:y.vo.metrics.DVRInfo},y.vo.metrics.DroppedFrames=function(){this.time=null,this.droppedFrames=null},y.vo.metrics.DroppedFrames.prototype={constructor:y.vo.metrics.DroppedFrames},y.vo.metrics.HTTPRequest=function(){this.stream=null,this.tcpid=null,this.type=null,this.url=null,this.actualurl=null,this.range=null,this.trequest=null,this.tresponse=null,this.tfinish=null,this.responsecode=null,this.interval=null,this.mediaduration=null,this.trace=[],this.startTime=null,this.quality=null,this.bytesLength=null};y.vo.metrics.HTTPRequest.prototype={constructor:y.vo.metrics.HTTPRequest},y.vo.metrics.HTTPRequest.Trace=function(){this.s=null,this.d=null,this.b=[]},y.vo.metrics.HTTPRequest.Trace.prototype={constructor:y.vo.metrics.HTTPRequest.Trace},y.vo.metrics.ManifestUpdate=function(){this.streamType=null,this.type=null,this.requestTime=null,this.fetchTime=null,this.availabilityStartTime=null,this.presentationStartTime=0,this.clientTimeOffset=0,this.currentTime=null,this.buffered=null,this.latency=0,this.periodInfo=[],this.representationInfo=[]},y.vo.metrics.ManifestUpdate.PeriodInfo=function(){this.id=null,this.index=null,this.start=null,this.duration=null},y.vo.metrics.ManifestUpdate.RepresentationInfo=function(){this.id=null,this.index=null,this.streamType=null,this.periodIndex=null,this.presentationTimeOffset=null,this.startNumber=null,this.segmentInfoType=null},y.vo.metrics.ManifestUpdate.prototype={constructor:y.vo.metrics.ManifestUpdate},y.vo.metrics.ManifestUpdate.PeriodInfo.prototype={constructor:y.vo.metrics.ManifestUpdate.PeriodInfo},y.vo.metrics.ManifestUpdate.RepresentationInfo.prototype={constructor:y.vo.metrics.ManifestUpdate.RepresentationInfo},y.vo.metrics.PlayList=function(){this.stream=null,this.start=null,this.mstart=null,this.starttype=null,this.trace=[]},y.vo.metrics.PlayList.Trace=function(){this.representationid=null,this.subreplevel=null,this.start=null,this.mstart=null,this.duration=null,this.playbackspeed=null,this.stopreason=null},y.vo.metrics.PlayList.prototype={constructor:y.vo.metrics.PlayList},y.vo.metrics.PlayList.INITIAL_PLAY_START_REASON="initial_start",y.vo.metrics.PlayList.SEEK_START_REASON="seek",y.vo.metrics.PlayList.Trace.prototype={constructor:y.vo.metrics.PlayList.Trace()},y.vo.metrics.PlayList.Trace.USER_REQUEST_STOP_REASON="user_request",y.vo.metrics.PlayList.Trace.REPRESENTATION_SWITCH_STOP_REASON="representation_switch",y.vo.metrics.PlayList.Trace.END_OF_CONTENT_STOP_REASON="end_of_content",y.vo.metrics.PlayList.Trace.REBUFFERING_REASON="rebuffering",y.vo.metrics.PlaybackQuality=function(){this.t=null,this.mt=null,this.droppedFrames=null,this.totalVideoFrames=null},y.vo.metrics.PlaybackQuality.prototype={constructor:y.vo.metrics.PlaybackQuality},y.vo.metrics.RepresentationSwitch=function(){this.t=null,this.mt=null,this.to=null,this.lto=null},y.vo.metrics.RepresentationSwitch.prototype={constructor:y.vo.metrics.RepresentationSwitch},y.vo.metrics.Session=function(){this.uri=null,this.loopMode=null,this.endTime=null,this.playerType=null},y.vo.metrics.Session.prototype={constructor:y.vo.metrics.Session},y.vo.metrics.State=function(){this.t=null,this.current=null,this.position=null,this.reason=null},y.vo.metrics.State.prototype={constructor:y.vo.metrics.State},y.vo.metrics.TCPConnection=function(){this.tcpid=null,this.dest=null,this.topen=null,this.tclose=null,this.tconnect=null},y.vo.metrics.TCPConnection.prototype={constructor:y.vo.metrics.TCPConnection},y.vo.metrics.VideoResolution=function(){this.t=null,this.mt=null,this.width=null,this.height=null},y.vo.metrics.VideoResolution.prototype={constructor:y.vo.metrics.VideoResolution},g=function(){return{modules:{},dependencies:{},vo:{},di:{}}}(),g.dependencies.BaseURLExtensions=function(){var e=function(e,t){for(var n,r,i,o,a,s,l,u,d,c,f=new DataView(e),h={},p=0;"sidx"!==u&&p<f.byteLength;){for(d=f.getUint32(p),p+=4,u="",o=0;o<4;o+=1)c=f.getInt8(p),u+=String.fromCharCode(c),p+=1;"moof"!==u&&"traf"!==u&&"sidx"!==u?p+=d-8:"sidx"===u&&(p-=8)}if((i=f.getUint32(p,!1)+p)>e.byteLength)throw"sidx terminates after array buffer";for(h.version=f.getUint8(p+8),p+=12,h.timescale=f.getUint32(p+4,!1),p+=8,0===h.version?(h.earliest_presentation_time=f.getUint32(p,!1),h.first_offset=f.getUint32(p+4,!1),p+=8):(h.earliest_presentation_time=T.Math.to64BitNumber(f.getUint32(p+4,!1),f.getUint32(p,!1)),h.first_offset=(f.getUint32(p+8,!1)<<32)+f.getUint32(p+12,!1),p+=16),h.first_offset+=i+(t||0),h.reference_count=f.getUint16(p+2,!1),p+=4,h.references=[],n=h.first_offset,r=h.earliest_presentation_time,o=0;o<h.reference_count;o+=1)s=f.getUint32(p,!1),a=s>>>31,s&=2147483647,l=f.getUint32(p+4,!1),p+=12,s>0&&h.references.push({size:s,type:a,offset:n,duration:l,time:r,timescale:h.timescale}),n+=s,r+=l;if(p!==i)throw"Error: final pos "+p+" differs from SIDX end "+i;return h},t=function(t,n,r){var i,o,a,s,l,u,d,c;for(i=e.call(this,t,r),o=i.references,a=[],l=0,u=o.length;l<u;l+=1)s=new g.vo.Segment,s.duration=o[l].duration,s.media=n,s.startTime=o[l].time,s.timescale=o[l].timescale,d=o[l].offset,c=o[l].offset+o[l].size-1,s.mediaRange=d+"-"+c,a.push(s);return this.debug.log("Parsed SIDX box: "+a.length+" segments."),a},n=function e(t,n){var r,i,o,a,s,l,u,d,f=c.defer(),h=new DataView(t),p=0,m="",g=0,y=!1,v=this;for(v.debug.log("Searching for initialization.");"moov"!==m&&p<h.byteLength;){for(g=h.getUint32(p),p+=4,m="",s=0;s<4;s+=1)l=h.getInt8(p),m+=String.fromCharCode(l),p+=1;"ftyp"===m&&(r=p-8),"moov"===m&&(i=p-8),"moov"!==m&&(p+=g-8)}return h.byteLength-p,"moov"!==m?(v.debug.log("Loading more bytes to find initialization."),n.range.start=0,n.range.end=n.bytesLoaded+n.bytesToLoad,u=new XMLHttpRequest,u.onloadend=function(){y||f.reject("Error loading initialization.")},u.onload=function(){y=!0,n.bytesLoaded=n.range.end,e.call(v,u.response).then(function(e){f.resolve(e)})},u.onerror=function(){f.reject("Error loading initialization.")},u.open("GET",v.tokenAuthentication.addTokenAsQueryArg(n.url)),u.responseType="arraybuffer",u.setRequestHeader("Range","bytes="+n.range.start+"-"+n.range.end),u=v.tokenAuthentication.setTokenInRequestHeader(u),u.send(null)):(o=void 0===r?i:r,a=i+g-1,d=o+"-"+a,v.debug.log("Found the initialization.  Range: "+d),f.resolve(d)),f.promise},r=function(e){var t=c.defer(),r=new XMLHttpRequest,i=!0,o=this,a={url:e,range:{},searching:!1,bytesLoaded:0,bytesToLoad:1500,request:r};return o.debug.log("Start searching for initialization."),a.range.start=0,a.range.end=a.bytesToLoad,r.onload=function(){r.status<200||r.status>299||(i=!1,a.bytesLoaded=a.range.end,n.call(o,r.response,a).then(function(e){t.resolve(e)},function(){t.reject()}))},r.onloadend=r.onerror=function(){if(i){i=!1;var e={};e.url=a.url,e.request=r,o.errHandler.sendError(y.dependencies.ErrorHandler.prototype.DOWNLOAD_ERR_INIT,null,e),t.reject(r)}},r.open("GET",o.tokenAuthentication.addTokenAsQueryArg(a.url)),r.responseType="arraybuffer",r.setRequestHeader("Range","bytes="+a.range.start+"-"+a.range.end),r=o.tokenAuthentication.setTokenInRequestHeader(r),r.send(null),o.debug.log("Perform init search: "+a.url),t.promise},i=function e(n,r){var i,o,a,s,l,u,d,f,h=c.defer(),p=new DataView(n),m=new XMLHttpRequest,g=0,v="",_=0,b=!0,E=!1,T=this;for(T.debug.log("Searching for SIDX box."),T.debug.log(r.bytesLoaded+" bytes loaded.");"sidx"!==v&&g<p.byteLength;){for(_=p.getUint32(g),g+=4,v="",l=0;l<4;l+=1)u=p.getInt8(g),v+=String.fromCharCode(u),g+=1;"sidx"!==v&&(g+=_-8)}if(i=p.byteLength-g,"sidx"!==v)h.reject();else if(i<_-8)T.debug.log("Found SIDX but we don't have all of it."),r.range.start=0,r.range.end=r.bytesLoaded+(_-i),m.onload=function(){m.status<200||m.status>299||(b=!1,r.bytesLoaded=r.range.end,e.call(T,m.response,r).then(function(e){h.resolve(e)}))},m.onloadend=m.onerror=function(){if(b){b=!1;var e={};e.url=r.url,e.request=m,T.errHandler.sendError(y.dependencies.ErrorHandler.prototype.DOWNLOAD_ERR_SIDX,null,e),h.reject(m)}},m.open("GET",T.tokenAuthentication.addTokenAsQueryArg(r.url)),m.responseType="arraybuffer",m.setRequestHeader("Range","bytes="+r.range.start+"-"+r.range.end),m=T.tokenAuthentication.setTokenInRequestHeader(m),m.send(null);else if(r.range.start=g-8,r.range.end=r.range.start+_,T.debug.log("Found the SIDX box.  Start: "+r.range.start+" | End: "+r.range.end),o=new ArrayBuffer(r.range.end-r.range.start),s=new Uint8Array(o),a=new Uint8Array(n,r.range.start,r.range.end-r.range.start),s.set(a),d=this.parseSIDX.call(this,o,r.range.start),f=d.references,null!==f&&void 0!==f&&f.length>0&&(E=1===f[0].type),E){T.debug.log("Initiate multiple SIDX load.");var S,x,w,I,D,R,A=[];for(S=0,x=f.length;S<x;S+=1)w=f[S].offset,I=f[S].offset+f[S].size-1,D=w+"-"+I,A.push(this.loadSegments.call(T,r.url,D));c.all(A).then(function(e){for(R=[],S=0,x=e.length;S<x;S+=1)R=R.concat(e[S]);h.resolve(R)},function(e){h.reject(e)})}else T.debug.log("Parsing segments from SIDX."),h.resolve(t.call(T,o,r.url,r.range.start));return h.promise};return{debug:void 0,errHandler:void 0,tokenAuthentication:void 0,loadSegments:function(e,n){var r,o=c.defer(),a=new XMLHttpRequest,s=!0,l=this,u={url:e,range:{},searching:!1,bytesLoaded:0,bytesToLoad:1500,request:a};return null===n?(l.debug.log("No known range for SIDX request."),u.searching=!0,u.range.start=0,u.range.end=u.bytesToLoad):(r=n.split("-"),u.range.start=parseFloat(r[0]),u.range.end=parseFloat(r[1])),a.onload=function(){a.status<200||a.status>299||(s=!1,u.searching?(u.bytesLoaded=u.range.end,i.call(l,a.response,u).then(function(e){o.resolve(e)},function(){o.reject()})):o.resolve(t.call(l,a.response,u.url,u.range.start)))},a.onloadend=a.onerror=function(){if(s){s=!1;var e={};e.url=u.url,e.request=a,l.errHandler.sendError(y.dependencies.ErrorHandler.prototype.DOWNLOAD_ERR_SIDX,null,e),o.reject(a)}},a.open("GET",l.tokenAuthentication.addTokenAsQueryArg(u.url)),a.responseType="arraybuffer",a.setRequestHeader("Range","bytes="+u.range.start+"-"+u.range.end),a=l.tokenAuthentication.setTokenInRequestHeader(a),a.send(null),l.debug.log("Perform SIDX load: "+u.url),o.promise},loadInitialization:r,parseSegments:t,parseSIDX:e,findSIDX:i}},g.dependencies.BaseURLExtensions.prototype={constructor:g.dependencies.BaseURLExtensions},g.di.DashContext=function(){return{system:void 0,setup:function(){g.di.DashContext.prototype.setup.call(this),this.system.mapClass("parser",g.dependencies.DashParser),this.system.mapClass("indexHandler",g.dependencies.DashHandler),this.system.mapClass("baseURLExt",g.dependencies.BaseURLExtensions),this.system.mapClass("fragmentExt",g.dependencies.FragmentExtensions),this.system.mapSingleton("manifestExt",g.dependencies.DashManifestExtensions),this.system.mapSingleton("metricsExt",g.dependencies.DashMetricsExtensions),this.system.mapSingleton("timelineConverter",g.dependencies.TimelineConverter)}}},g.di.DashContext.prototype=new y.di.Context,g.di.DashContext.prototype.constructor=g.di.DashContext,g.dependencies.DashHandler=function(){var e,t,n=-1,r=null,i=function(e,t){for(;e.length<t;)e="0"+e;return e},o=function(e,t,n){for(var r,o,a,s,l=0,u=0,d=t.length,c="%0".length;;){if((l=e.indexOf("$"+t))<0)return e;if((u=e.indexOf("$",l+d))<0)return e;if((r=e.indexOf("%0",l+d))>l&&r<u)switch(o=e.charAt(u-1),a=parseInt(e.substring(r+c,u-1),10),o){case"d":case"i":case"u":s=i(n.toString(),a);break;case"x":s=i(n.toString(16),a);break;case"X":s=i(n.toString(16),a).toUpperCase();break;case"o":s=i(n.toString(8),a);break;default:return this.debug.log("Unsupported/invalid IEEE 1003.1 format identifier string in URL"),e}else s=n;e=e.substring(0,l)+s+e.substring(u+1)}},a=function(e){return e.split("$$").join("$")},s=function(e,t){if(null===t||-1===e.indexOf("$RepresentationID$"))return e;var n=t.toString();return e.split("$RepresentationID$").join(n)},l=function(e,t){return e.representation.startNumber+t},u=function(e,t){var n=t.adaptation.period.mpd.manifest.Period_asArray[t.adaptation.period.index].AdaptationSet_asArray[t.adaptation.index].Representation_asArray[t.index].BaseURL;return e===n?e:-1!==e.indexOf("http://")||-1!==e.indexOf("https://")?e:n+e},d=function(t,n){var r,i,o=this,a=new y.vo.SegmentRequest;return r=t.adaptation.period,a.streamType=n,a.type="Initialization Segment",a.url=u(t.initialization,t),a.range=t.range,i=r.start,a.availabilityStartTime=o.timelineConverter.calcAvailabilityStartTimeFromPresentationTime(i,t.adaptation.period.mpd,e),a.availabilityEndTime=o.timelineConverter.calcAvailabilityEndTimeFromPresentationTime(i+r.duration,r.mpd,e),a.quality=t.index,a},f=function(e){var n=c.defer(),r=null,i=null,o=this;return e?(e.initialization?(r=d.call(o,e,t),n.resolve(r)):(i=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].BaseURL,o.baseURLExt.loadInitialization(i).then(function(a){e.range=a,e.initialization=i,r=d.call(o,e,t),n.resolve(r)},function(e){n.reject(e)})),n.promise):c.reject("no represenation")},h=function(t){var r,i,o,a=t.adaptation.period,s=!1;return e?s=!1:n<0?s=!1:n<t.availableSegmentsNumber+t.segmentStartIndex?(i=R(n,t))&&(o=i.presentationStartTime-a.start,r=t.adaptation.period.duration,s=o>=r):s=!0,s},p=function(t,n){var r,i,o,a,s=this;return i=t.segmentDuration,o=t.adaptation.period.start+n*i,a=o+i,r=new g.vo.Segment,r.representation=t,r.duration=i,r.presentationStartTime=o,r.mediaStartTime=s.timelineConverter.calcMediaTimeFromPresentationTime(r.presentationStartTime,t),r.availabilityStartTime=s.timelineConverter.calcAvailabilityStartTimeFromPresentationTime(r.presentationStartTime,t.adaptation.period.mpd,e),r.availabilityEndTime=s.timelineConverter.calcAvailabilityEndTimeFromPresentationTime(a,t.adaptation.period.mpd,e),r.wallStartTime=s.timelineConverter.calcWallTimeForSegment(r,e),r.replacementNumber=l(r,n),r.availabilityIdx=n,r},m=function(e){var t,n,i,o,a,s,l,u,d,f,h,p,m,g=this,y=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentTemplate,v=y.SegmentTimeline,_=e.availableSegmentsNumber>0,E=[],S=0,x=-1,w=!1,I=function(t){return T.call(g,e,S,t.d,m,y.media,t.mediaRange,x)};for(m=e.timescale,t=v.S_asArray,d=b.call(g,e),d?(h=d.start,p=d.end):f=g.timelineConverter.calcMediaTimeFromPresentationTime(r||0,e),i=0,o=t.length;i<o;i+=1)if(n=t[i],s=0,n.hasOwnProperty("r")&&(s=n.r),n.hasOwnProperty("t")&&(S=n.t),s<0&&(u=t[i+1],l=u&&u.hasOwnProperty("t")?u.t/m:e.adaptation.period.duration,s=Math.ceil((l-S/m)/(n.d/m))-1),w){if(_)break;x+=s+1}else for(a=0;a<=s;a+=1){if(x+=1,d){if(x>p){if(w=!0,_)break;continue}x>=h&&E.push(I.call(g,n))}else{if(E.length>10){if(w=!0,_)break;continue}S/m>=f-n.d/m&&E.push(I.call(g,n))}S+=n.d}if(!_){var D,R,A=t[0];D=void 0===A.t?0:g.timelineConverter.calcPresentationTimeFromMediaTime(A.t/m,e),R=g.timelineConverter.calcPresentationTimeFromMediaTime((S-n.d)/m,e),e.segmentAvailabilityRange={start:D,end:R},e.availableSegmentsNumber=x+1,e.segmentStartIndex=0}return c.when(E)},v=function(t){var n,r,i,a,s=[],l=this,u=c.defer(),d=t.adaptation.period.mpd.manifest.Period_asArray[t.adaptation.period.index].AdaptationSet_asArray[t.adaptation.index].Representation_asArray[t.index].SegmentTemplate,f=t.segmentDuration,h=null,m=Math.floor(t.adaptation.period.start/f),g=null,y=null;return a=t.startNumber,E.call(l,t).then(function(c){for(t.segmentAvailabilityRange=c,h=_.call(l,t),r=h.start,i=h.end,n=r;n<=i;n+=1)g=p.call(l,t,n-(e?m:0)),g.replacementTime=(a+n-1)*t.segmentDuration,y=d.media,y=o(y,"Number",g.replacementNumber),y=o(y,"Time",g.replacementTime),g.media=y,s.push(g),g=null;t.availableSegmentsNumber=m+Math.ceil((c.end-c.start)/f),t.segmentStartIndex=r,u.resolve(s)}),u.promise},_=function(t){var i,o,a=this,s=t.adaptation.period.start,l=t.segmentDuration,u=t.adaptation.period.mpd.manifest.minBufferTime,d=t.segmentAvailabilityRange,c=NaN,f=null,h=t.segments,p=2*l,m=Math.max(2*u,10*l);return d||(d=a.timelineConverter.calcSegmentAvailabilityRange(t,e)),e&&!t.adaptation.period.mpd.isClientServerTimeSyncCompleted?(i=Math.floor(d.start/l),o=Math.floor(d.end/l),{start:i,end:o}):(h?(f=R(n,t),c=f?f.presentationStartTime-s:n>0?n*l:r-s||h[0].presentationStartTime-s):c=n>0?n*l:e?d.end:d.start,i=Math.floor(Math.max(c-p,d.start)/l),o=Math.floor(Math.min(i+m/l,d.end/l)),{start:i,end:o})},b=function(t){var i,o,a=NaN,s=t.segments,l=Number.POSITIVE_INFINITY;if(e&&!t.adaptation.period.mpd.isClientServerTimeSyncCompleted)return{start:0,end:l};if(!e&&null!==r)return null;if(s){if(n<0)return null;a=n}else a=n>0?n:e?l:0;return i=Math.max(a-2,0),o=Math.min(a+10,l),{start:i,end:o}},E=function(t){var n,r,i=this,o=c.defer();return function a(){n=i.timelineConverter.calcSegmentAvailabilityRange(t,e),n.end>0?o.resolve(n):(r=1e3*Math.abs(n.end),setTimeout(a,r))}(),o.promise},T=function(t,n,r,i,a,s,u){var d,c,f,h=this,p=n/i,m=Math.min(r/i,t.adaptation.period.mpd.maxSegmentDuration);return d=h.timelineConverter.calcPresentationTimeFromMediaTime(p,t),d=p,c=d+m,f=new g.vo.Segment,f.representation=t,f.duration=m,f.mediaStartTime=p,f.presentationStartTime=d,f.availabilityStartTime=t.adaptation.period.mpd.manifest.mpdLoadedTime,f.availabilityEndTime=h.timelineConverter.calcAvailabilityEndTimeFromPresentationTime(c,t.adaptation.period.mpd,e),f.wallStartTime=h.timelineConverter.calcWallTimeForSegment(f,e),f.replacementTime=n,f.replacementNumber=l(f,u),a=o(a,"Number",f.replacementNumber),a=o(a,"Time",f.replacementTime),f.media=a,f.mediaRange=s,f.availabilityIdx=u,f},S=function(t){var n,r,i,o,a,s=this,l=[],u=c.defer(),d=t.adaptation.period.mpd.manifest.Period_asArray[t.adaptation.period.index].AdaptationSet_asArray[t.adaptation.index].Representation_asArray[t.index].SegmentList,f=d.SegmentURL_asArray.length,h=0,m=d.SegmentURL_asArray.length;return a=t.startNumber,E.call(s,t).then(function(c){for(e||(o=_.call(s,t),h=o.start,m=o.end),n=h;n<m;n+=1)i=d.SegmentURL_asArray[n],r=p.call(s,t,n),r.replacementTime=(a+n-1)*t.segmentDuration,r.media=i.media,r.mediaRange=i.mediaRange,r.index=i.index,r.indexRange=i.indexRange,void 0!==i.sequenceNumber&&(r.sequenceNumber=i.sequenceNumber),void 0!==i.decryptionInfo&&(r.decryptionInfo=i.decryptionInfo),l.push(r),r=null;t.segmentAvailabilityRange=c,t.availableSegmentsNumber=f,t.segmentStartIndex=h,u.resolve(l)}),u.promise},x=function(e){var t,n,r,i,o=this,a=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].BaseURL,s=c.defer(),l=[],u=0,d=null;return e.indexRange&&(d=e.indexRange),this.baseURLExt.loadSegments(a,d).then(function(a){for(n=0,r=a.length;n<r;n+=1)t=a[n],i=T.call(o,e,t.startTime,t.duration,t.timescale,t.media,t.mediaRange,u),l.push(i),i=null,u+=1;e.segmentAvailabilityRange={start:l[0].presentationStartTime,end:l[r-1].presentationStartTime},e.availableSegmentsNumber=r,e.segmentStartIndex=0,s.resolve(l)},function(){s.reject()}),s.promise},w=function(t){var n,r,i=c.defer(),o=this;return P.call(o,t)?(n="SegmentTimeline"===t.segmentInfoType?m.call(o,t):"SegmentTemplate"===t.segmentInfoType?v.call(o,t):"SegmentList"===t.segmentInfoType?S.call(o,t):x.call(o,t),c.when(n).then(function(n){if(t.segments=n,r=n.length-1,e&&isNaN(t.adaptation.period.liveEdge)){var a=o.metricsModel.getMetricsFor("stream"),s=n[r].presentationStartTime;t.adaptation.period.liveEdge=s,o.metricsModel.updateManifestUpdateInfo(o.metricsExt.getCurrentManifestUpdate(a),{presentationStartTime:s})}i.resolve(n)},function(){i.reject()}),i.promise):c.when(t.segments)},I=function(e){var n=this,r=c.defer();return e.segments=null,n.debug.log("[DashHandler]["+t+"] updateSegmentList for representation ",e.id),w.call(n,e).then(function(t){e.segments=t,r.resolve(t)}),r.promise},D=function(e,n){var r,i,o,a,s=null===n?null:n.segments,l=null===s?0:s.length-1,u=-1,d=this;if(d.debug.log("[DashHandler]["+t+"] getIndexForSegments for time ",e),s&&s.length>0)for(a=l;a>=0;a--){if(r=s[a],i=r.presentationStartTime,o=r.duration,e+g.dependencies.DashHandler.EPSILON>=i&&e-g.dependencies.DashHandler.EPSILON<=i+o){u=r.availabilityIdx,d.debug.log("[DashHandler]["+t+"] getIndexForSegments, idx =  ",u);break}if(-1===u&&e-g.dependencies.DashHandler.EPSILON>i+o){d.debug.log("[DashHandler]["+t+"] getIndexForSegments, (past the end) idx =  ",u),u=isNaN(n.segmentDuration)?r.availabilityIdx+1:Math.floor((e-n.adaptation.period.start)/n.segmentDuration);break}}return-1===u&&(isNaN(n.segmentDuration)?d.debug.log("[DashHandler]["+t+"] Couldn't figure out segment for time: "+e):(d.debug.log("[DashHandler]["+t+"] getIndexForSegments, (segment duration) idx =  ",u),u=Math.floor((e-n.adaptation.period.start)/n.segmentDuration))),c.when(u)},R=function(e,t){if(!t||!t.segments)return null;var n,r,i=t.segments.length;for(r=0;r<i;r+=1)if(n=t.segments[r],n.availabilityIdx===e)return n;return null},A=function(e,t){if(!t||!t.segments)return null;var n,r,i=t.segments.length;for(r=0;r<i;r+=1)if(n=t.segments[r],void 0!==n.sequenceNumber&&n.sequenceNumber===e)return r<i-1?t.segments[r+1]:null;return null},P=function(e){var t,i,o,a,s=!1,l=e.segments;return l&&0!==l.length?null!==r?(a=l[0].presentationStartTime,o=l[l.length-1].presentationStartTime,s=r<a||r>o):(i=l[0].availabilityIdx,t=l[l.length-1].availabilityIdx,s=n<i||n>t):s=!0,s},M=function(e){if(null===e||void 0===e)return null;var n,r=new y.vo.SegmentRequest,i=e.representation,l=i.adaptation.period.mpd.manifest.Period_asArray[i.adaptation.period.index].AdaptationSet_asArray[i.adaptation.index].Representation_asArray[i.index].bandwidth;return n=u(e.media,i),n=o(n,"Number",e.replacementNumber),n=o(n,"Time",e.replacementTime),n=o(n,"Bandwidth",l),n=s(n,i.id),n=a(n),r.streamType=t,r.type="Media Segment",r.url=n,r.range=e.mediaRange,r.startTime=e.presentationStartTime,r.duration=e.duration,r.timescale=i.timescale,r.availabilityStartTime=e.availabilityStartTime,r.availabilityEndTime=e.availabilityEndTime,r.wallStartTime=e.wallStartTime,r.quality=i.index,r.index=e.availabilityIdx,void 0!==e.sequenceNumber&&(r.sequenceNumber=e.sequenceNumber),void 0!==e.decryptionInfo&&(r.decryptionInfo=e.decryptionInfo),r},L=function(e,i){var o,a,s,l=this;return e?(r=i,l.debug.log("[DashHandler]["+t+"] Getting the request for time: "+i),o=c.defer(),w.call(l,e).then(function(){return D.call(l,i,e)},function(){o.reject()}).then(function(r){return l.debug.log("[DashHandler]["+t+"] Index for time "+i+" is "+r),n=r,c.when(h.call(l,e))}).then(function(r){var i=null;return r?(a=new y.vo.SegmentRequest,a.action=a.ACTION_COMPLETE,a.index=n,l.debug.log("[DashHandler]["+t+"] Signal complete."),l.debug.log(a),o.resolve(a)):(s=R(n,e),i=M.call(l,s)),c.when(i)}).then(function(e){o.resolve(e)}),o.promise):c.reject("no representation")},C=function(e){var i,o,a,s,l=this;if(!e)return c.reject("no represenation");if(-1===n)throw"You must call getSegmentRequestForTime first.";return r=null,n+=1,i=c.defer(),l.debug.log("[DashHandler]["+t+"] Getting the next request => index = "+n),s=h.call(l,e),s?(o=new y.vo.SegmentRequest,o.action=o.ACTION_COMPLETE,o.index=n,l.debug.log("[DashHandler]["+t+"] Signal complete."),i.resolve(o)):w.call(l,e).then(function(){var t;return a=R(n,e),t=M.call(l,a),c.when(t)}).then(function(e){i.resolve(e)}),i.promise},O=function(e,r){var i,o,a,s,l=this;if(!e)return c.reject("no represenation");if(-1===n)throw"You must call getSegmentRequestForTime first.";return i=c.defer(),l.debug.log("[DashHandler]["+t+"] Getting the next request => sn = "+r),w.call(l,e).then(function(){if(s=h.call(l,e))o=new y.vo.SegmentRequest,o.action=o.ACTION_COMPLETE,o.index=n,l.debug.log("[DashHandler]["+t+"] Signal complete."),i.resolve(o);else if(null===(a=A(r,e)))i.resolve(null);else{n=a.availabilityIdx;var u=M.call(l,a);i.resolve(u)}}),i.promise},k=function(e,n,r){var i,o=this,a=Math.max(n-r,0),s=c.defer(),l=0;return e?(o.debug.log("[DashHandler]["+t+"] getSegmentCountForDuration"),w.call(o,e).then(function(e){i=e[0].duration,l=Math.ceil(a/i),s.resolve(l)},function(){s.resolve(0)}),s.promise):c.reject("no represenation")},N=function(e){var r,i,o=this,a=c.defer();return e?(i=n,w.call(o,e).then(function(n){i<0?r=o.timelineConverter.calcPresentationStartTime(e.adaptation.period):(i=i<n[0].availabilityIdx?n[0].availabilityIdx:Math.min(n[n.length-1].availabilityIdx,i),r=R(i,e).presentationStartTime,o.debug.log("[DashHandler]["+t+"] getSegmentByIndex, index = "+i+" => time = "+r)),o.debug.log("[DashHandler]["+t+"] getCurrentTime => ",r),a.resolve(r)},function(){a.reject()}),a.promise):c.reject("no represenation")},F=function(){},B=function(){};return{debug:void 0,baseURLExt:void 0,metricsModel:void 0,metricsExt:void 0,manifestModel:void 0,manifestExt:void 0,timelineConverter:void 0,capabilities:void 0,videoModel:void 0,getType:function(){return t},setType:function(e){t=e},getIsDynamic:function(){return e},setIsDynamic:function(t){e=t},getInitRequest:f,getSegmentRequestForTime:L,getNextSegmentRequest:C,getNextSegmentRequestFromSN:O,getCurrentTime:N,getSegmentCountForDuration:k,updateSegmentList:I,getIFrameRequest:F,getFragmentInfoRequest:B}},g.dependencies.DashHandler.EPSILON=.003,g.dependencies.DashHandler.prototype={constructor:g.dependencies.DashHandler},g.dependencies.DashManifestExtensions=function(){this.timelineConverter=void 0},g.dependencies.DashManifestExtensions.prototype={constructor:g.dependencies.DashManifestExtensions,getIsType:function(e,t,n){var r,i,o,a=!1;if(!e)return!1;if(void 0===e.type&&(e.type=null),e.ContentComponent_asArray)for(r=0;r<e.ContentComponent_asArray.length&&!a;r++)e.ContentComponent_asArray[r].contentType===t&&(e.type=t,a=!0);if(!a&&e.mimeType)for(r=0;r<n.length&&!a;r++)-1!==e.mimeType.indexOf(n[r])&&(e.type=t,a=!0);if(!a)for(r=0;r<e.Representation_asArray.length&&!a;r++)for(o=e.Representation_asArray[r],i=0;i<n.length&&!a;i++)-1!==o.mimeType.indexOf(n[i])&&(e.type=t,a=!0);return a},getIsVideo:function(e){return this.getIsType(e,"video",["video"])},getIsAudio:function(e){return this.getIsType(e,"audio",["audio"])},getIsText:function(e){return this.getIsType(e,"text",["vtt","ttml","application/mp4"])},getIsTextTrack:function(e){return"text/vtt"===e||"application/ttml+xml"===e||"application/ttml+xml+mp4"===e||"application/mp4"===e},getIsMain:function(){return!1},processAdaptation:function(e){return void 0!==e.Representation_asArray&&null!==e.Representation_asArray&&e.Representation_asArray.sort(function(e,t){return e.bandwidth-t.bandwidth}),e},getDataForId:function(e,t,n){var r,i,o=t.Period_asArray[n].AdaptationSet_asArray;for(r=0,i=o.length;r<i;r+=1)if(o[r].hasOwnProperty("id")&&o[r].id===e)return o[r];return null},getDataForIndex:function(e,t,n){var r;return t&&n>=0&&(r=t.Period_asArray[n].AdaptationSet_asArray)&&r.length>0&&!isNaN(e)?r[e]:[]},getIndex:function(e,t){var n,r,i,o=t.Period_asArray;for(r=0;r<o.length;r+=1)for(n=o[r].AdaptationSet_asArray,i=0;i<n.length;i+=1)if(n[i]===e)return i;return-1},getDataIndex:function(e,t,n){var r,i,o;if(t&&n>=0)if(r=t.Period_asArray[n].AdaptationSet_asArray,e.id){for(i=0,o=r.length;i<o;i+=1)if(r[i].id&&r[i].id===e.id)return i}else{var a=JSON.stringify(e);for(i=0,o=r.length;i<o;i+=1)if(JSON.stringify(r[i])===a)return i}return-1},getVideoData:function(e,t){var n,r;if(!e||t<0)return null;if(n=e.Period_asArray[t].AdaptationSet_asArray,0===n.length)return null;for(r=0;r<n.length;r+=1)if(this.getIsVideo(n[r]))return n[r];return null},getTextDatas:function(e,t){var n,r,i=[];if(!e||t<0)return i;if(n=e.Period_asArray[t].AdaptationSet_asArray,0===n.length)return i;for(r=0;r<n.length;r+=1)this.getIsText(n[r])&&i.push(n[r]);return i},getAudioDatas:function(e,t){var n,r,i=[];if(!e||t<0)return i;if(n=e.Period_asArray[t].AdaptationSet_asArray,0===n.length)return i;for(r=0;r<n.length;r+=1)this.getIsAudio(n[r])&&i.push(n[r]);return i},getSpecificAudioData:function(e,t,n){var r,i;if(!e||t<0)return null;if(i=this.getAudioDatas(e,t),0===i.length)return null;for(r=0;r<i.length;r+=1)if(i[r].lang===n)return this.processAdaptation(i[r]);return this.processAdaptation(i[0])},getSpecificTextData:function(e,t,n){var r,i;if(!e||t<0)return null;if(i=this.getTextDatas(e,t),0===i.length)return null;for(r=0;r<i.length;r+=1)if(i[r].lang===n)return this.processAdaptation(i[r]);return this.processAdaptation(i[0])},getCodec:function(e){for(var t,n=0,r=null;null===r&&n<e.Representation_asArray.length;)t=e.Representation_asArray[n],null!==t.codecs&&""!==t.codecs&&(r=t.mimeType+';codecs="'+t.codecs+'"'),n++;return r},getMimeType:function(e){return e.Representation_asArray[0].mimeType},getKID:function(e){return e&&e.hasOwnProperty("cenc:default_KID")?e["cenc:default_KID"]:null},getContentProtectionData:function(e){return e&&e.hasOwnProperty("ContentProtection_asArray")&&0!==e.ContentProtection_asArray.length?e.ContentProtection_asArray:null},getIsDynamic:function(e){var t=!1;return e&&e.hasOwnProperty("type")&&(t="dynamic"===e.type),t},getIsDVR:function(e){var t,n=this.getIsDynamic(e);return t=!isNaN(e.timeShiftBufferDepth),n&&t},getIsOnDemand:function(e){var t=!1;return e.profiles&&e.profiles.length>0&&(t=-1!==e.profiles.indexOf("urn:mpeg:dash:profile:isoff-on-demand:2011")),t},getDuration:function(e){return e&&e.hasOwnProperty("mediaPresentationDuration")?e.mediaPresentationDuration:Number.POSITIVE_INFINITY},getBandwidth:function(e){return e.bandwidth},getRefreshDelay:function(e){var t=NaN;return e.hasOwnProperty("minimumUpdatePeriod")&&(t=Math.max(parseFloat(e.minimumUpdatePeriod),2)),t},getRepresentationCount:function(e){return e?e.Representation_asArray.length:null},getRepresentationFor:function(e,t){return t.Representation_asArray[e]},getRepresentationsForAdaptation:function(e,t){var n,r,i,o,a,s=[];if(e&&t){n=this.processAdaptation(e.Period_asArray[t.period.index].AdaptationSet_asArray[t.index]);for(var l=0;l<n.Representation_asArray.length;l+=1)a=n.Representation_asArray[l],r=new g.vo.Representation,r.index=l,r.adaptation=t,a.hasOwnProperty("id")&&(r.id=a.id),a.hasOwnProperty("SegmentBase")?(o=a.SegmentBase,r.segmentInfoType="SegmentBase"):a.hasOwnProperty("SegmentList")?(o=a.SegmentList,r.segmentInfoType="SegmentList",r.useCalculatedLiveEdgeTime=!0):a.hasOwnProperty("SegmentTemplate")?(o=a.SegmentTemplate,o.hasOwnProperty("SegmentTimeline")?r.segmentInfoType="SegmentTimeline":r.segmentInfoType="SegmentTemplate",o.hasOwnProperty("initialization")&&(r.initialization=o.initialization.split("$Bandwidth$").join(a.bandwidth).split("$RepresentationID$").join(a.id))):(o=a.BaseURL,r.segmentInfoType="BaseURL"),o.hasOwnProperty("Initialization")?(i=o.Initialization,i.hasOwnProperty("sourceURL")?r.initialization=i.sourceURL:i.hasOwnProperty("range")&&(r.initialization=a.BaseURL,r.range=i.range)):a.hasOwnProperty("mimeType")&&this.getIsTextTrack(a.mimeType)&&(r.initialization=a.BaseURL,r.range=0),o.hasOwnProperty("timescale")&&(r.timescale=o.timescale),o.hasOwnProperty("duration")&&(r.segmentDuration=o.duration/r.timescale),o.hasOwnProperty("startNumber")&&(r.startNumber=o.startNumber),o.hasOwnProperty("indexRange")&&(r.indexRange=o.indexRange),o.hasOwnProperty("presentationTimeOffset")&&(r.presentationTimeOffset=o.presentationTimeOffset/r.timescale),r.MSETimeOffset=this.timelineConverter.calcMSETimeOffset(r),s.push(r)}return s},getAdaptationsForPeriod:function(e,t){var n,r=null===e?null:e.Period_asArray[t.index],i=[];if(r)for(var o=0;o<r.AdaptationSet_asArray.length;o+=1)n=new g.vo.AdaptationSet,n.index=o,n.period=t,i.push(n);return i},getRegularPeriods:function(e,t){var n,r,i=[],o=this.getIsDynamic(e),a=null,s=null,l=null,u=null;for(n=0,r=e.Period_asArray.length;n<r;n+=1)s=e.Period_asArray[n],s.hasOwnProperty("start")?(u=new g.vo.Period,u.start=s.start):null!==a&&s.hasOwnProperty("duration")?(u=new g.vo.Period,u.start=l.start+l.duration,u.duration=s.duration):0!==n||o||(u=new g.vo.Period,u.start=0),null!==l&&isNaN(l.duration)&&(l.duration=u.start-l.start),null!==u&&s.hasOwnProperty("id")&&(u.id=s.id),null!==u&&s.hasOwnProperty("duration")&&(u.duration=s.duration),null!==u&&(u.index=n,u.mpd=t,i.push(u)),a=s,s=null,l=u,u=null;return 0===i.length?i:(t.checkTime=this.getCheckTime(e,i[0]),null!==l&&isNaN(l.duration)&&(l.duration=this.getEndTimeForLastPeriod(t)-l.start),i)},getMpd:function(e){var t=new g.vo.Mpd;return e?(t.manifest=e,e.hasOwnProperty("availabilityStartTime")?t.availabilityStartTime=new Date(e.availabilityStartTime.getTime()):t.availabilityStartTime=new Date(e.mpdLoadedTime.getTime()),e.hasOwnProperty("availabilityEndTime")&&(t.availabilityEndTime=new Date(e.availabilityEndTime.getTime())),e.hasOwnProperty("suggestedPresentationDelay")&&(t.suggestedPresentationDelay=e.suggestedPresentationDelay),e.hasOwnProperty("timeShiftBufferDepth")&&(t.timeShiftBufferDepth=e.timeShiftBufferDepth),e.hasOwnProperty("maxSegmentDuration")&&(t.maxSegmentDuration=e.maxSegmentDuration),t):null},getFetchTime:function(e,t){return this.timelineConverter.calcPresentationTimeFromWallTime(e.mpdLoadedTime,t)},getCheckTime:function(e,t){var n=NaN;return e.hasOwnProperty("minimumUpdatePeriod")&&(n=this.getFetchTime(e,t)+e.minimumUpdatePeriod),n},getEndTimeForLastPeriod:function(e){var t;if(e.manifest.mediaPresentationDuration)t=e.manifest.mediaPresentationDuration;else{if(isNaN(e.checkTime))return new Error("Must have @mediaPresentationDuration or @minimumUpdatePeriod on MPD or an explicit @duration on the last period.");t=e.checkTime}return t},getEventsForPeriod:function(e,t){var n=null===e?null:e.Period_asArray,r=null===n?null:n[t.index].EventStream_asArray,i=[];if(r)for(var o=0;o<r.length;o+=1){var a=new g.vo.EventStream;if(a.period=t,a.timescale=1,!r[o].hasOwnProperty("schemeIdUri"))throw"Invalid EventStream. SchemeIdUri has to be set";a.schemeIdUri=r[o].schemeIdUri,r[o].hasOwnProperty("timescale")&&(a.timescale=r[o].timescale),r[o].hasOwnProperty("value")&&(a.value=r[o].value);for(var s=0;s<r[o].Event_asArray.length;s+=1){var l=new g.vo.Event;l.presentationTime=0,l.eventStream=a,r[o].Event_asArray[s].hasOwnProperty("presentationTime")&&(l.presentationTime=r[o].Event_asArray[s].presentationTime),r[o].Event_asArray[s].hasOwnProperty("duration")&&(l.duration=r[o].Event_asArray[s].duration),r[o].Event_asArray[s].hasOwnProperty("id")&&(l.id=r[o].Event_asArray[s].id),i.push(l)}}return i},getEventStreamForAdaptationSet:function(e){var t,n=[];if(e&&(t=e.InbandEventStream_asArray))for(var r=0;r<t.length;r+=1){var i=new g.vo.EventStream;if(i.timescale=1,!t[r].hasOwnProperty("schemeIdUri"))throw"Invalid EventStream. SchemeIdUri has to be set";i.schemeIdUri=t[r].schemeIdUri,t[r].hasOwnProperty("timescale")&&(i.timescale=t[r].timescale),t[r].hasOwnProperty("value")&&(i.value=t[r].value),n.push(i)}return n},getEventStreamForRepresentation:function(e,t){var n,r=[];if(e&&t&&(n=e.Representation_asArray[t.index].InbandEventStream_asArray))for(var i=0;i<n.length;i++){var o=new g.vo.EventStream;if(o.timescale=1,o.representation=t,!n[i].hasOwnProperty("schemeIdUri"))throw"Invalid EventStream. SchemeIdUri has to be set";o.schemeIdUri=n[i].schemeIdUri,n[i].hasOwnProperty("timescale")&&(o.timescale=n[i].timescale),n[i].hasOwnProperty("value")&&(o.value=n[i].value),r.push(o)}return r},getRepresentationBandwidth:function(e,t){return this.getBandwidth(this.getRepresentationFor(t,e))}},g.dependencies.DashMetricsExtensions=function(){var e=function(e,t){var n,r,i,o,a,s,l,u;for(s=0;s<e.length;s+=1)for(n=e[s],i=n.AdaptationSet_asArray,l=0;l<i.length;l+=1)for(r=i[l],a=r.Representation_asArray,u=0;u<a.length;u+=1)if(o=a[u],t===o.id)return u;return-1},t=function(e,t){var n,r,i,o,a,s,l,u;for(s=0;s<e.length;s+=1)for(n=e[s],i=n.AdaptationSet_asArray,l=0;l<i.length;l+=1)for(r=i[l],a=r.Representation_asArray,u=0;u<a.length;u+=1)if(o=a[u],t===o.id)return o;return null},n=function(e,t){var n=!1;return"video"===t?(this.manifestExt.getIsVideo(e),"video"===e.type&&(n=!0)):"audio"===t?(this.manifestExt.getIsAudio(e),"audio"===e.type&&(n=!0)):n=!1,n},r=function(e,t){var r,i,o,a,s,l;for(s=0;s<e.length;s+=1)for(r=e[s],o=r.AdaptationSet_asArray,l=0;l<o.length;l+=1)if(i=o[l],a=i.Representation_asArray,n.call(this,i,t))return a.length;return-1};return{manifestModel:void 0,manifestExt:void 0,getBandwidthForRepresentation:function(e){var n,r=this,i=r.manifestModel.getValue(),o=null===i?null:i.Period_asArray;return o?(n=t.call(r,o,e),null===n?null:n.bandwidth):null},getIndexForRepresentation:function(t){var n=this,r=n.manifestModel.getValue(),i=null===r?null:r.Period_asArray;return i?e.call(n,i,t):null},getMaxIndexForBufferType:function(e){var t=this,n=t.manifestModel.getValue(),i=null===n?null:n.Period_asArray;return i?r.call(this,i,e):null},getCurrentRepresentationSwitch:function(e){if(null===e)return null;var t,n,r=e.RepSwitchList;return null===r||r.length<=0?null:(t=r.length,n=t-1,r[n])},getCurrentBufferLevel:function(e){if(null===e)return null;var t,n,r=e.BufferLevel;return null===r||r.length<=0?null:(t=r.length,n=t-1,r[n])},getCurrentHttpRequest:function(e){if(null===e)return null;var t,n,r=e.HttpList,i=null;if(null===r||r.length<=0)return null;for(t=r.length,n=t-1;n>=0;){if(null!==r[n].responsecode){i=r[n];break}n-=1}return i},getHttpRequests:function(e){return null===e?[]:e.HttpList?e.HttpList:[]},getCurrentDroppedFrames:function(e){if(null===e)return null;var t,n,r=e.DroppedFrames;return null===r||r.length<=0?null:(t=r.length,n=t-1,r[n])},getCurrentPlaybackQuality:function(e){if(null===e)return null;var t=e.PlaybackQuality;return null===t||t.length<=0?null:t[t.length-1]},getCurrentDVRInfo:function(e){if(null===e)return null;var t,n=e.DVRInfo;return null===n||n.length<=0?null:(t=n.length-1,n[t])},getCurrentManifestUpdate:function(e){if(null===e)return null;var t,n,r=e.ManifestUpdate;return null===r||r.length<=0?null:(t=r.length,n=t-1,r[n])}}},g.dependencies.DashMetricsExtensions.prototype={constructor:g.dependencies.DashMetricsExtensions},g.dependencies.DashParser=function(){var e=/^P(([\d.]*)Y)?(([\d.]*)M)?(([\d.]*)D)?T?(([\d.]*)H)?(([\d.]*)M)?(([\d.]*)S)?/,n=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+-])([0-9]{2})([0-9]{2}))?/,i=/^[-+]?[0-9]+[.]?[0-9]*([eE][-+]?[0-9]+)?$/,o=[{type:"duration",test:function(t){return e.test(t)},converter:function(t){var n=e.exec(t);return 31536e3*parseFloat(n[2]||0)+2592e3*parseFloat(n[4]||0)+86400*parseFloat(n[6]||0)+3600*parseFloat(n[8]||0)+60*parseFloat(n[10]||0)+parseFloat(n[12]||0)}},{type:"datetime",test:function(e){return n.test(e)},converter:function(e){var t,r=n.exec(e);if(t=Date.UTC(parseInt(r[1],10),parseInt(r[2],10)-1,parseInt(r[3],10),parseInt(r[4],10),parseInt(r[5],10),r[6]&&parseInt(r[6],10)||0,r[7]&&1e3*parseFloat(r[7])||0),r[9]&&r[10]){var i=60*parseInt(r[9],10)+parseInt(r[10],10);t+=("+"===r[8]?-1:1)*i*60*1e3}return new Date(t)}},{type:"numeric",test:function(e){return i.test(e)},converter:function(e){return parseFloat(e)}}],a=function(){var e,t,n,r;return r=[{name:"profiles",merge:!1},{name:"width",merge:!1},{name:"height",merge:!1},{name:"sar",merge:!1},{name:"frameRate",merge:!1},{name:"audioSamplingRate",merge:!1},{name:"mimeType",merge:!1},{name:"segmentProfiles",merge:!1},{name:"codecs",merge:!1},{name:"maximumSAPPeriod",merge:!1},{name:"startsWithSap",merge:!1},{name:"maxPlayoutRate",merge:!1},{name:"codingDependency",merge:!1},{name:"scanType",merge:!1},{name:"FramePacking",merge:!0},{name:"AudioChannelConfiguration",merge:!0},{name:"ContentProtection",merge:!0}],e={},e.name="AdaptationSet",e.isRoot=!1,e.isArray=!0,e.parent=null,e.children=[],e.properties=r,t={},t.name="Representation",t.isRoot=!1,t.isArray=!0,t.parent=e,t.children=[],t.properties=r,e.children.push(t),n={},n.name="SubRepresentation",n.isRoot=!1,n.isArray=!0,n.parent=t,n.children=[],n.properties=r,t.children.push(n),e},s=function(){var e,t,n,r;return r=[{name:"SegmentBase",merge:!0},{name:"SegmentTemplate",merge:!0},{name:"SegmentList",merge:!0}],e={},e.name="Period",e.isRoot=!1,e.isArray=!0,e.parent=null,e.children=[],e.properties=r,t={},t.name="AdaptationSet",t.isRoot=!1,t.isArray=!0,t.parent=e,t.children=[],t.properties=r,e.children.push(t),n={},n.name="Representation",n.isRoot=!1,n.isArray=!0,n.parent=t,n.children=[],n.properties=r,t.children.push(n),e},l=function(){var e,t,n,r,i;return i=[{name:"BaseURL",merge:!0,mergeFunction:function(e,t){return 0===t.indexOf("http://")?t:e+t}}],e={},e.name="mpd",e.isRoot=!0,e.isArray=!0,e.parent=null,e.children=[],e.properties=i,t={},t.name="Period",t.isRoot=!1,t.isArray=!0,t.parent=null,t.children=[],t.properties=i,e.children.push(t),n={},n.name="AdaptationSet",n.isRoot=!1,n.isArray=!0,n.parent=t,n.children=[],n.properties=i,t.children.push(n),r={},r.name="Representation",r.isRoot=!1,r.isArray=!0,r.parent=n,r.children=[],r.properties=i,n.children.push(r),e},u=function(){var e=[];return e.push(a()),e.push(s()),e.push(l()),e};return{debug:void 0,parse:function(e,n){var i,a=new r(o,"",!0),s=new t(u()),l=new Date,d=null,f=null;try{i=a.xml_str2json(e),d=new Date,i.hasOwnProperty("BaseURL")?(i.BaseURL=i.BaseURL_asArray[0],0!==i.BaseURL.toString().indexOf("http")&&(i.BaseURL=n+i.BaseURL)):i.BaseURL=n,s.run(i),f=new Date,this.debug.log("Parsing complete: ( xml2json: "+(d.getTime()-l.getTime())+"ms, objectiron: "+(f.getTime()-d.getTime())+"ms, total: "+(f.getTime()-l.getTime())/1e3+"s)")}catch(e){return c.reject(null)}return c.when(i)}}},g.dependencies.DashParser.prototype={constructor:g.dependencies.DashParser},g.dependencies.FragmentExtensions=function(){var e=function(e){for(var t,n,r,i,o,a,s=new DataView(e),l=0;"tfdt"!==i&&l<s.byteLength;){for(r=s.getUint32(l),l+=4,i="",o=0;o<4;o+=1)a=s.getInt8(l),i+=String.fromCharCode(a),l+=1;"moof"!==i&&"traf"!==i&&"tfdt"!==i&&(l+=r-8)}if(l===s.byteLength)throw"Error finding live offset.";return n=s.getUint8(l),this.debug.log("position: "+l),0===n?(l+=4,t=s.getUint32(l,!1)):(l+=r-16,t=T.Math.to64BitNumber(s.getUint32(l+4,!1),s.getUint32(l,!1))),{version:n,base_media_decode_time:t}},t=function(e){for(var t,n,r,i,o,a,s,l=new DataView(e),u=0;"sidx"!==o&&u<l.byteLength;){for(a=l.getUint32(u),u+=4,o="",i=0;i<4;i+=1)s=l.getInt8(u),o+=String.fromCharCode(s),u+=1;"moof"!==o&&"traf"!==o&&"sidx"!==o?u+=a-8:"sidx"===o&&(u-=8)}return t=l.getUint8(u+8),u+=12,n=l.getUint32(u+4,!1),u+=8,r=0===t?l.getUint32(u,!1):T.Math.to64BitNumber(l.getUint32(u+4,!1),l.getUint32(u,!1)),c.when({earliestPresentationTime:r,timescale:n})};return{debug:void 0,loadFragment:function(t){var n,r,i,o=c.defer(),a=new XMLHttpRequest,s=!1;return n=t,a.onloadend=function(){s||(r="Error loading fragment: "+n,o.reject(r))},a.onload=function(){s=!0,i=e(a.response),o.resolve(i)},a.onerror=function(){r="Error loading fragment: "+n,o.reject(r)},a.responseType="arraybuffer",a.open("GET",n),a.send(null),o.promise},parseTFDT:e,parseSIDX:t}},g.dependencies.FragmentExtensions.prototype={constructor:g.dependencies.FragmentExtensions},g.dependencies.TimelineConverter=function(){var e=function(e,t,n,r){return r?n&&t.timeShiftBufferDepth!==Number.POSITIVE_INFINITY?new Date(t.availabilityStartTime.getTime()+1e3*(e+t.timeShiftBufferDepth)):t.availabilityEndTime:n?new Date(t.availabilityStartTime.getTime()+1e3*e):t.availabilityStartTime},t=function(t,n,r){return e.call(this,t,n,r)},n=function(t,n,r){return e.call(this,t,n,r,!0)},r=function(e){var t,n="dynamic"===e.mpd.manifest.type,r=parseInt(this.uriQueryFragModel.getURIFragmentData().s,10);return n?(!isNaN(r)&&r>1262304e3&&((t=r-e.mpd.availabilityStartTime.getTime()/1e3)>e.liveEdge||t<e.liveEdge-e.mpd.timeShiftBufferDepth)&&(t=null),t=t||e.liveEdge):t=!isNaN(r)&&r<e.duration&&r>=0?r:e.start,t},i=function(e,t){return(e.getTime()-t.mpd.availabilityStartTime.getTime())/1e3},o=function(e,t){return e-t.presentationTimeOffset},a=function(e,t){return t.presentationTimeOffset+e},s=function(e,t){var n,r,i;return t&&(n=e.representation.adaptation.period.mpd.suggestedPresentationDelay,r=e.presentationStartTime+n,i=new Date(e.availabilityStartTime.getTime()+1e3*r)),i},l=function(e,t,n){var r=this,i=r.calcSegmentAvailabilityRange(e,n);return t>=i.start&&t<=i.end?t:Math.max(i.end-2*e.adaptation.period.mpd.manifest.minBufferTime,i.start)},u=function(e,t){var n,r,o=e.segmentDuration,a=0,s=e.adaptation.period.duration,l={start:a,end:s};return t?e.adaptation.period.mpd.isClientServerTimeSyncCompleted&&!isNaN(o)||!e.segmentAvailabilityRange?(n=e.adaptation.period.mpd.checkTime,r=i(new Date((new Date).getTime()+0),e.adaptation.period),a=Math.max(r-e.adaptation.period.mpd.timeShiftBufferDepth,0),n+=0,s=isNaN(n)?r:Math.min(n,r),l={start:a,end:s}):e.segmentAvailabilityRange:l},d=function(e){return-e.presentationTimeOffset};return{system:void 0,debug:void 0,uriQueryFragModel:void 0,setup:function(){},calcAvailabilityStartTimeFromPresentationTime:t,calcAvailabilityEndTimeFromPresentationTime:n,calcPresentationTimeFromWallTime:i,calcPresentationTimeFromMediaTime:o,calcPresentationStartTime:r,calcActualPresentationTime:l,calcMediaTimeFromPresentationTime:a,calcSegmentAvailabilityRange:u,calcWallTimeForSegment:s,calcMSETimeOffset:d}},g.dependencies.TimelineConverter.prototype={constructor:g.dependencies.TimelineConverter},g.vo.AdaptationSet=function(){this.period=null,this.index=-1},g.vo.AdaptationSet.prototype={constructor:g.vo.AdaptationSet},g.vo.Event=function(){this.duration=NaN,this.presentationTime=NaN,this.id=NaN,this.messageData="",this.eventStream=null,this.presentationTimeDelta=NaN},g.vo.Event.prototype={constructor:g.vo.Event},g.vo.EventStream=function(){this.adaptionSet=null,this.representation=null,this.period=null,this.timescale=1,this.value="",this.schemeIdUri=""},g.vo.EventStream.prototype={constructor:g.vo.EventStream},g.vo.Mpd=function(){this.manifest=null,this.suggestedPresentationDelay=0,this.availabilityStartTime=null,this.availabilityEndTime=Number.POSITIVE_INFINITY,this.timeShiftBufferDepth=Number.POSITIVE_INFINITY,this.maxSegmentDuration=Number.POSITIVE_INFINITY,this.checkTime=NaN,this.clientServerTimeShift=0,this.isClientServerTimeSyncCompleted=!1},g.vo.Mpd.prototype={constructor:g.vo.Mpd},g.vo.Period=function(){this.id=null,this.index=-1,this.duration=NaN,this.start=NaN,this.mpd=null,this.liveEdge=NaN},g.vo.Period.prototype={constructor:g.vo.Period},g.vo.Representation=function(){this.id=null,this.index=-1,this.adaptation=null,this.segmentInfoType=null,this.initialization=null,this.segmentDuration=NaN,this.timescale=1,this.startNumber=1,this.indexRange=null,this.range=null,this.presentationTimeOffset=0,this.MSETimeOffset=NaN,this.segmentAvailabilityRange=null,this.availableSegmentsNumber=0},g.vo.Representation.prototype={constructor:g.vo.Representation},g.vo.Segment=function(){this.indexRange=null,this.index=null,this.mediaRange=null,this.media=null,this.duration=NaN,this.replacementTime=null,this.replacementNumber=NaN,this.mediaStartTime=NaN,this.presentationStartTime=NaN,this.availabilityStartTime=NaN,this.availabilityEndTime=NaN,this.availabilityIdx=NaN,this.wallStartTime=NaN,this.representation=null},g.vo.Segment.prototype={constructor:g.vo.Segment},y.models.ProtectionModel=function(){},y.models.ProtectionModel.eventList={ENAME_NEED_KEY:"needkey",ENAME_KEY_SYSTEM_ACCESS_COMPLETE:"keySystemAccessComplete",ENAME_KEY_SYSTEM_SELECTED:"keySystemSelected",ENAME_VIDEO_ELEMENT_SELECTED:"videoElementSelected",ENAME_SERVER_CERTIFICATE_UPDATED:"serverCertificateUpdated",ENAME_KEY_MESSAGE:"keyMessage",ENAME_KEY_ADDED:"keyAdded",ENAME_KEY_ERROR:"keyError",ENAME_KEY_SESSION_CREATED:"keySessionCreated",ENAME_KEY_SESSION_REMOVED:"keySessionRemoved",ENAME_KEY_SESSION_CLOSED:"keySessionClosed",ENAME_KEY_STATUSES_CHANGED:"keyStatusesChanged",ENAME_TEARDOWN_COMPLETE:"protectionTeardownComplete"},y.utils.copyMethods=function(e){var t=new e;t.parent={};for(var n in t)t.parent[n]=t[n];return t.setup=function(){for(var e in this.parent)void 0===this.parent[e]&&(this.parent[e]=this[e])},t},y.utils.DOMParser=function(){var e=null,t=null;return{getAllSpecificNodes:function(e,t){var n,r,i=0,o=[];if(e&&(r=e.querySelectorAll(t)))for(i=0;i<r.length;i++)(n=this.getAttributeValue(r[i],"xml:id"))&&(o[n]=r[i].attributes,r[i].childNodes.length>0&&(o[n].childNodes=r[i].childNodes));return o},getAttributeName:function(e,t){var n=[],r=null,i=0,o=null;if(e&&e.attributes&&(o=e.attributes))for(i=0;i<o.length;i++)r=o[i],r.value===t&&n.push(r.name);return n},getTextNodesIn:function(e){var t=[],n=0,r=null,i=null,o=null;if(e)for(r=e.childNodes,n=0;n<r.length;n++)i=r[n],o=i.nodeType,3==o?t.push(i):1!=o&&9!=o&&11!=o||(t=t.concat(this.getTextNodesIn(i)));return t},getAttributeValue:function(e,t,n){var r=null;return e&&"function"==typeof e.getAttribute&&null===(r=e.getAttribute(t))&&n&&(r=e.getAttributeNS(n,t)),r},getChildNode:function(e,t){var n,r=0;if(e&&e.childNodes)for(r=0;r<e.childNodes.length;r++){if(n=e.childNodes[r],n.nodeName===t)return n;n=void 0}return n},getChildNodes:function(e,t){var n=0,r=[];if(e&&e.childNodes)for(n=0;n<e.childNodes.length;n++)e.childNodes[n].nodeName===t&&r.push(e.childNodes[n]);return r},createXmlTree:function(n){if(window.DOMParser)try{if(e||(e=new window.DOMParser),t=e.parseFromString(n,"text/xml"),t.getElementsByTagName("parsererror").length>0)throw new Error("Error parsing XML")}catch(e){t=null}return t}}},y.utils.ObjectIron=function(e){var t;t=[];for(var n=0,r=e.length;n<r;n+=1)e[n].isRoot?t.push("root"):t.push(e[n].name);var i=function(e,t){var n;if(null!==e&&null!==t)for(n in e)e.hasOwnProperty(n)&&(t.hasOwnProperty(n)||(t[n]=e[n]))},o=function(e,t,n){var r,o,a,s,l;if(null!==e&&0!==e.length)for(r=0,o=e.length;r<o;r+=1)a=e[r],t.hasOwnProperty(a.name)&&(n.hasOwnProperty(a.name)?a.merge&&(s=t[a.name],l=n[a.name],"object"===(void 0===s?"undefined":d(s))&&"object"===(void 0===l?"undefined":d(l))?i(s,l):null!==a.mergeFunction?n[a.name]=a.mergeFunction(s,l):n[a.name]=s+l):n[a.name]=t[a.name])},a=function e(t,n){var r,i,a,s,l,u,d,c=t;if(t.transformFunc&&(n=t.transformFunc(n)),null===c.children||0===c.children.length)return n;for(r=0,i=c.children.length;r<i;r+=1){u=c.children[r];var f=null;if(n.hasOwnProperty(u.name))if(u.isArray)for(l=n[u.name+"_asArray"],a=0,s=l.length;a<s;a+=1)d=l[a],o(c.properties,n,d),f=e(u,d),n[u.name+"_asArray"][a]=f,n[u.name][a]=f;else d=n[u.name],o(c.properties,n,d),f=e(u,d),n[u.name]=f,n[u.name+"_asArray"]=[f]}return n};return{run:function n(r){var i,o,s,l,u,c,f;if(null===r)return r;if("object"!==(void 0===r?"undefined":d(r)))return r;for(i=0,o=t.length;i<o;i+=1)"root"===t[i]&&(u=e[i],c=r,r=a(u,c));for(l in r)if(r.hasOwnProperty(l)){if(-1!==(s=t.indexOf(l)))if(u=e[s],u.isArray)for(f=r[l+"_asArray"],i=0,o=f.length;i<o;i+=1)c=f[i],r[l][i]=a(u,c),r[l+"_asArray"][i]=a(u,c);else c=r[l],r[l]=a(u,c),r[l+"_asArray"]=[a(u,c)];r[l]=n(r[l])}return r}}},y.dependencies.protection.CommonEncryption={findCencContentProtection:function(e){var t,n=null,r=0;for(r=0;r<e.length;++r)t=e[r],"urn:mpeg:dash:mp4protection:2011"===t.schemeIdUri.toLowerCase()&&"cenc"===t.value.toLowerCase()&&(n=t);return n},getPSSHData:function(e){var t=8,n=new DataView(e),r=n.getUint8(t);return t+=20,r>0&&(t+=4+16*n.getUint32(t)),t+=4,e.slice(t)},getPSSHForKeySystem:function(e,t){var n=y.dependencies.protection.CommonEncryption.parsePSSHList(t);return n.hasOwnProperty(e.uuid.toLowerCase())?n[e.uuid.toLowerCase()]:null},parseInitDataFromContentProtection:function(e){return e&&"pssh"in e?_.decodeArray(e.pssh.__text).buffer:null},readBytes:function(e,t,n){var r=0,i=0;for(i=0;i<n;i++)r<<=8,r+=e[t],t++;return r},parsePSSHList:function(e){if(null===e)return[];var t,n,r,i,o,a,s,l=e,u={},d=0;for(e.buffer||(l=new Uint8Array(e));;){if(o=d,d>=l.byteLength)break;if(t=this.readBytes(l,d,4),n=d+t,d+=4,1886614376===this.readBytes(l,d,4))if(d+=4,0===(r=this.readBytes(l,d,1))||1===r){for(d+=1,d+=3,i="",a=0;a<4;a++)s=this.readBytes(l,d+a,1).toString(16),i+=1===s.length?"0"+s:s;for(d+=4,i+="-",a=0;a<2;a++)s=this.readBytes(l,d+a,1).toString(16),i+=1===s.length?"0"+s:s;for(d+=2,i+="-",a=0;a<2;a++)s=this.readBytes(l,d+a,1).toString(16),i+=1===s.length?"0"+s:s;for(d+=2,i+="-",a=0;a<2;a++)s=this.readBytes(l,d+a,1).toString(16),i+=1===s.length?"0"+s:s;for(d+=2,i+="-",a=0;a<6;a++)s=this.readBytes(l,d+a,1).toString(16),i+=1===s.length?"0"+s:s;d+=6,i=i.toLowerCase(),this.readBytes(l,d,4),d+=4,u[i]=l.subarray(o,n).buffer,d=n}else d=n;else d=n}return u},getKeySystemConfigurations:function(e,t,n){var r=[],i=[];return e&&i.push(new y.vo.protection.MediaCapability(e)),t&&r.push(new y.vo.protection.MediaCapability(t)),[new y.vo.protection.KeySystemConfiguration(r,i,"optional","temporary"===n?"optional":"required",[n])]}},ArrayBuffer.isView||(ArrayBuffer.isView=function(e){return e instanceof ArrayBuffer}),ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=function(e,t){var n,r,i,o=this.byteLength;return e=0|e||0,t=void 0===t?o:0|t,e<0&&(e=Math.max(e+o,0)),t<0&&(t=Math.max(t+o,0)),0===o||e>=o||e>=t?new ArrayBuffer(0):(n=Math.min(o-e,t-e),r=new ArrayBuffer(n),i=new Uint8Array(r),i.set(new Uint8Array(this,e,n)),r)}),y.dependencies.ProtectionController=function(){var e,t,n,r=null,i=[],o=null,a=!1,s=function(e){var t=null,r=e.systemString;return n&&(t=r in n?n[r]:null),t},l=function(n,r){var o,a,s,l,u,d=this,c=[],f=[],h=0;if(d.debug.log("[DRM] Select key system"),this.keySystem){for(a=0;a<n.length;a++)if(this.keySystem===n[a].ks){o=n[a].ks.sessionType,c.push({ks:n[a].ks,configs:n[a].ks.getKeySystemConfigurations(t,e,o)}),f.push({schemeIdURI:n[a].ks.schemeIdURI,systemString:n[a].ks.systemString}),s={},s[y.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE]=function(e){e.error?d.eventBus.dispatchEvent({type:y.dependencies.ProtectionController.events.KEY_SYSTEM_SELECTED,error:"[DRM] KeySystem Access Denied! -- "+e.error}):(d.debug.log("[DRM] KeySystem Access Granted"),d.eventBus.dispatchEvent({type:y.dependencies.ProtectionController.events.KEY_SYSTEM_SELECTED,data:e.data}),d.createKeySession(n[a].initData,n[a].cdmData))},this.protectionModel.subscribe(y.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE,s,void 0,!0),this.protectionModel.requestKeySystemAccess(c);break}}else if(void 0===this.keySystem){for(this.keySystem=null,i.push(n),h=0;h<n.length;h++)o=n[h].ks.sessionType,c.push({ks:n[h].ks,configs:n[h].ks.getKeySystemConfigurations(t,e,o)}),f.push({schemeIdURI:n[h].ks.schemeIdURI,systemString:n[h].ks.systemString});l={},l[y.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE]=function(e){e.error?(d.debug.log("[DRM] KeySystem Access Denied!"),d.keySystem=void 0,d.protectionModel.unsubscribe(y.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_SELECTED,l),r||d.eventBus.dispatchEvent({type:y.dependencies.ProtectionController.events.KEY_SYSTEM_SELECTED,error:"[DRM] KeySystem Access Denied! -- "+e.error}),d.notify(y.dependencies.ProtectionController.eventList.ENAME_PROTECTION_ERROR,new y.vo.Error(y.dependencies.ErrorHandler.prototype.MEDIA_KEYSYSERR_ACCESS_DENIED,"No KeySystem/CDM available",{keySystems:f}))):(u=e.data,d.debug.log("[DRM] KeySystem Access ("+u.keySystem.systemString+") Granted!  Selecting key system..."),d.protectionModel.selectKeySystem(u))},l[y.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_SELECTED]=function(e){if(e.error)d.keySystem=void 0,r||d.eventBus.dispatchEvent({type:y.dependencies.ProtectionController.events.KEY_SYSTEM_SELECTED,error:"[DRM] Error selecting key system! -- "+e.error}),d.notify(y.dependencies.ProtectionController.eventList.ENAME_PROTECTION_ERROR,new y.vo.Error(y.dependencies.ErrorHandler.prototype.MEDIA_KEYSYSERR_ACCESS_DENIED,"No KeySystem/CDM available",{keySystems:f}));else for(d.debug.log("[DRM] KeySystem selected => create key session"),d.keySystem=d.protectionModel.keySystem,d.eventBus.dispatchEvent({type:y.dependencies.ProtectionController.events.KEY_SYSTEM_SELECTED,data:u}),h=0;h<i.length;h++)for(a=0;a<i[h].length;a++)if(d.keySystem===i[h][a].ks){d.createKeySession(i[h][a].initData,i[h][a].cdmData);break}},this.protectionModel.subscribe(y.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_SELECTED,l,void 0,!0),this.protectionModel.subscribe(y.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE,l,void 0,!0),this.protectionModel.requestKeySystemAccess(c)}else i.push(n)},u=function(e){var t,n,r=this,i=null;t=e.data,n=t.messageType?t.messageType:"license-request",this.debug.log("[DRM] Key message: type = "+n),this.eventBus.dispatchEvent({type:y.dependencies.ProtectionController.events.KEY_MESSAGE,data:t});var a=t.message,l=t.sessionToken,u=s(this.keySystem),c=this.keySystem.systemString,f=this.protectionExt.getLicenseServer(this.keySystem,u,n),h=!0;if(!a||0===a.byteLength)return void this.notify(y.dependencies.ProtectionController.eventList.ENAME_PROTECTION_ERROR,new y.vo.Error(y.dependencies.ErrorHandler.prototype.MEDIA_KEYMESSERR_NO_CHALLENGE,"Empty key message from CDM"));if(!f)return void this.debug.log("[DRM] License server request not required for this message (type = "+e.data.messageType+").  Session ID = "+l.getSessionID());if(this.protectionExt.isClearKey(this.keySystem)){var p=this.protectionExt.processClearKeyLicenseRequest(u,a);if(p)return this.debug.log("[DRM] ClearKey license request handled by application!"),void this.protectionModel.updateKeySession(l,p)}o=new XMLHttpRequest;var m=null;if(u)if(u.serverURL){var g=u.serverURL;"string"==typeof g&&""!==g?m=g:"object"===(void 0===g?"undefined":d(g))&&g.hasOwnProperty(n)&&(m=g[n])}else u.laURL&&""!==u.laURL&&(m=u.laURL);if(null===m&&((m=this.keySystem.getLicenseServerURLFromInitData(y.dependencies.protection.CommonEncryption.getPSSHData(l.initData)))||(m=e.data.defaultURL)),m=f.getServerURLFromMessage(m,a,n),this.debug.log("[DRM] Licenser server url: "+m),!m)return void this.notify(y.dependencies.ProtectionController.eventList.ENAME_PROTECTION_ERROR,new y.vo.Error(y.dependencies.ErrorHandler.prototype.MEDIA_KEYMESSERR_URL_LICENSER_UNKNOWN,"No license server URL specified"));o.open(f.getHTTPMethod(n),m,!0),o.responseType=f.getResponseType(c,n),o.onload=function(){this.status<200||this.status>299||200===this.status&&4===this.readyState&&(r.debug.log("[DRM] Received license response"),h=!1,i=f.getLicenseMessage(this.response,c,n),null!==i?(h=!1,r.protectionModel.updateKeySession(l,i)):h=!0)},o.onerror=o.onloadend=function(){if(!h)return void(o=null);h=!1,this.aborted||r.notify(y.dependencies.ProtectionController.eventList.ENAME_PROTECTION_ERROR,new y.vo.Error(y.dependencies.ErrorHandler.prototype.MEDIA_KEYMESSERR_LICENSER_ERROR,"License request failed",{url:m,status:this.status,error:this.response&&null!==this.response?f.getErrorResponse(this.response):""})),o=null};var v=function(e){var t;if(e)for(t in e)"authorization"===t.toLowerCase()&&(o.withCredentials=!0),o.setRequestHeader(t,e[t])};u&&v(u.httpRequestHeaders),v(this.keySystem.getRequestHeadersFromMessage(a)),u&&u.withCredentials&&(o.withCredentials=!0),this.debug.log("[DRM] Send license request");var _=this.keySystem.getLicenseRequestFromMessage(a);null===_&&this.notify(y.dependencies.ProtectionController.eventList.ENAME_PROTECTION_ERROR,new y.vo.Error(y.dependencies.ErrorHandler.prototype.MEDIA_KEYMESSERR_NO_CHALLENGE,"No license challenge from CDM key message")),o.send(_)},c=function(e){var t,n,r=this;return r.debug.log("[DRM] onNeedKey, initDataType = "+e.data.initDataType),"cenc"!==e.data.initDataType?void r.debug.log("[DRM] Only 'cenc' initData is supported!  Ignoring initData of type: "+e.data.initDataType):(t=e.data.initData,ArrayBuffer.isView(t)&&(t=t.buffer),n=this.protectionExt.getSupportedKeySystems(t),0===n.length?void r.debug.log("[DRM] Received needkey event with initData, but we don't support any of the key systems!"):void l.call(this,n,!1))},f=function(e){e.error?(this.debug.error("[DRM] Failed to set license server certificate"),this.notify(y.dependencies.ProtectionController.eventList.ENAME_PROTECTION_ERROR,new y.vo.Error(y.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_SERVER_CERTIFICATE,"Failed to set server certificate",e.error))):this.debug.log("[DRM] License server certificate successfully updated")},h=function(e){e.error?(this.debug.error("[DRM] Failed to create key session"),this.notify(y.dependencies.ProtectionController.eventList.ENAME_PROTECTION_ERROR,new y.vo.Error(y.dependencies.ErrorHandler.prototype.MEDIA_KEYMESSERR_NO_SESSION,"Failed to create key session",e.error))):this.debug.log("[DRM] Session created.  SessionID = "+e.data.getSessionID())},p=function(){this.debug.log("[DRM] Key added")},m=function(e){this.notify(y.dependencies.ProtectionController.eventList.ENAME_PROTECTION_ERROR,new y.vo.Error(e.data.code,e.data.message,e.data.data))},g=function(e){e.error?this.debug.warn("[DRM] Failed to close session"):this.debug.log("[DRM] Session closed.  SessionID = "+e.data)},v=function(e){e.error?this.debug.warn("[DRM] Failed to remove session"):this.debug.log("[DRM] Session removed.  SessionID = "+e.data)},_=function(e){e.error?this.notify(y.dependencies.ProtectionController.eventList.ENAME_PROTECTION_ERROR,new y.vo.Error(e.error.code,e.error.message,e.error.data)):this.debug.log("[DRM] Key statuses changed. statuses = "+e.data)};return{system:void 0,debug:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,protectionExt:void 0,keySystem:void 0,setup:function(){this[y.models.ProtectionModel.eventList.ENAME_KEY_MESSAGE]=u.bind(this),this[y.models.ProtectionModel.eventList.ENAME_NEED_KEY]=c.bind(this),this[y.models.ProtectionModel.eventList.ENAME_SERVER_CERTIFICATE_UPDATED]=f.bind(this),this[y.models.ProtectionModel.eventList.ENAME_KEY_ADDED]=p.bind(this),this[y.models.ProtectionModel.eventList.ENAME_KEY_ERROR]=m.bind(this),this[y.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CREATED]=h.bind(this),this[y.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CLOSED]=g.bind(this),this[y.models.ProtectionModel.eventList.ENAME_KEY_SESSION_REMOVED]=v.bind(this),this[y.models.ProtectionModel.eventList.ENAME_KEY_STATUSES_CHANGED]=_.bind(this),r=this.protectionExt.getKeySystems(),this.protectionModel=this.system.getObject("protectionModel"),this.protectionModel.init(),this.eventBus=this.system.getObject("eventBus"),this.protectionModel.subscribe(y.models.ProtectionModel.eventList.ENAME_SERVER_CERTIFICATE_UPDATED,this),this.protectionModel.subscribe(y.models.ProtectionModel.eventList.ENAME_KEY_ADDED,this),this.protectionModel.subscribe(y.models.ProtectionModel.eventList.ENAME_KEY_ERROR,this),this.protectionModel.subscribe(y.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CREATED,this),this.protectionModel.subscribe(y.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CLOSED,this),this.protectionModel.subscribe(y.models.ProtectionModel.eventList.ENAME_KEY_SESSION_REMOVED,this),this.protectionModel.subscribe(y.models.ProtectionModel.eventList.ENAME_KEY_MESSAGE,this),this.protectionModel.subscribe(y.models.ProtectionModel.eventList.ENAME_KEY_STATUSES_CHANGED,this)},init:function(n,r,i){var o;a||(this.debug.log("[DRM] Initialize ProtectionController ("+i+", "+r+")"),e=r,t=i,o=this.protectionExt.getSupportedKeySystemsFromContentProtection(n),o&&o.length>0&&l.call(this,o,!0),a=!0)},addEventListener:function(e,t){this.eventBus.addEventListener(e,t)},removeEventListener:function(e,t){this.eventBus.removeEventListener(e,t)},teardown:function(){o&&(o.aborted=!0,o.abort()),this.protectionModel.unsubscribe(y.models.ProtectionModel.eventList.ENAME_KEY_MESSAGE,this),this.protectionModel.unsubscribe(y.models.ProtectionModel.eventList.ENAME_SERVER_CERTIFICATE_UPDATED,this),this.protectionModel.unsubscribe(y.models.ProtectionModel.eventList.ENAME_KEY_ADDED,this),this.protectionModel.unsubscribe(y.models.ProtectionModel.eventList.ENAME_KEY_ERROR,this),this.protectionModel.unsubscribe(y.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CREATED,this),this.protectionModel.unsubscribe(y.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CLOSED,this),this.protectionModel.unsubscribe(y.models.ProtectionModel.eventList.ENAME_KEY_SESSION_REMOVED,this),this.protectionModel.unsubscribe(y.models.ProtectionModel.eventList.ENAME_KEY_MESSAGE,this),this.protectionModel.unsubscribe(y.models.ProtectionModel.eventList.ENAME_KEY_STATUSES_CHANGED,this),this.keySystem=void 0,this.protectionModel.teardown(),this.setMediaElement(null),this.protectionModel=void 0},createKeySession:function(e,t){this.debug.log("[DRM] Create key session");var n,r=y.dependencies.protection.CommonEncryption.getPSSHForKeySystem(this.keySystem,e),i=0;if(r){for(n=this.protectionModel.getAllInitData(),i=0;i<n.length;i++)if(this.protectionExt.initDataEquals(r,n[i]))return void this.debug.log("[DRM] Ignoring initData because we have already seen it!");try{this.protectionModel.createKeySession(r,this.keySystem.sessionType,t)}catch(e){this.notify(y.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CREATED,null,{reason:"Create key session raised en exception",error:new y.vo.Error(e.code,e.name,e.message)})}}else this.notify(y.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CREATED,null,{reason:"needkey/encrypted event contains no initData corresponding to that key system "+this.keySystem.systemString,error:null})},loadKeySession:function(e){this.protectionModel.loadKeySession(e)},removeKeySession:function(e){this.protectionModel.removeKeySession(e)},closeKeySession:function(e){this.protectionModel.closeKeySession(e)},setServerCertificate:function(e){this.protectionModel.setServerCertificate(e)},setMediaElement:function(e){e?(this.protectionModel.setMediaElement(e),this.protectionModel.subscribe(y.models.ProtectionModel.eventList.ENAME_NEED_KEY,this)):null===e&&(this.protectionModel.setMediaElement(e),this.protectionModel.unsubscribe(y.models.ProtectionModel.eventList.ENAME_NEED_KEY,this))},setSessionType:function(e){this.keysystem&&(this.keySystem.sessionType=e)},setProtectionData:function(e){n=e,this.protectionExt.init(e)}}},y.dependencies.ProtectionController.events={KEY_SYSTEM_SELECTED:"keySystemSelected",SERVER_CERTIFICATE_UPDATED:"serverCertificateUpdated",KEY_ADDED:"keyAdded",KEY_SESSION_CREATED:"keySessionCreated",KEY_SESSION_REMOVED:"keySessionRemoved",KEY_SESSION_CLOSED:"keySessionClosed",KEY_STATUSES_CHANGED:"keyStatusesChanged",KEY_MESSAGE:"keyMessage",LICENSE_REQUEST_COMPLETE:"licenseRequestComplete"},y.dependencies.ProtectionController.eventList={ENAME_PROTECTION_ERROR:"protectionError"},y.dependencies.ProtectionController.prototype={constructor:y.dependencies.ProtectionController},y.dependencies.ProtectionExtensions=function(){this.system=void 0,this.debug=void 0,this.keySystems=[],this.clearkeyKeySystem=void 0},y.dependencies.ProtectionExtensions.prototype={constructor:y.dependencies.ProtectionExtensions,setup:function(){var e;e=this.system.getObject("ksPlayReady"),this.keySystems.push(e),e=this.system.getObject("ksWidevine"),this.keySystems.push(e),e=this.system.getObject("ksClearKey"),this.keySystems.push(e),this.clearkeyKeySystem=e},init:function(e){for(var t=0;t<this.keySystems.length;t++){var n=this.keySystems[t];n.init(function(t){var n=null;return e&&(n=t in e?e[t]:null),n}(n.systemString))}},getKeySystems:function(){return this.keySystems},getKeySystemBySystemString:function(e){for(var t=0;t<this.keySystems.length;t++)if(this.keySystems[t].systemString===e)return this.keySystems[t];return null},isClearKey:function(e){return e===this.clearkeyKeySystem},initDataEquals:function(e,t){if(e.byteLength===t.byteLength){for(var n=new Uint8Array(e),r=new Uint8Array(t),i=0;i<n.length;i++)if(n[i]!==r[i])return!1;return!0}return!1},getSupportedKeySystemsFromContentProtection:function(e){var t,n,r,i,o=[];if(this.debug.log("[DRM] Get supported key systems from content protection"),e)for(r=0;r<this.keySystems.length;++r)for(n=this.keySystems[r],i=0;i<e.length;++i)if(t=e[i],t.schemeIdUri.toLowerCase()===n.schemeIdURI){var a=n.getInitData(t);a&&o.push({ks:this.keySystems[r],initData:a,cdmData:n.getCDMData()})}return o},getSupportedKeySystems:function(e){var t,n=[],r=y.dependencies.protection.CommonEncryption.parsePSSHList(e);for(this.debug.log("[DRM] Get supported key systems from init data"),t=0;t<this.keySystems.length;++t)this.keySystems[t].uuid in r&&n.push({ks:this.keySystems[t],initData:r[this.keySystems[t].uuid],cdmData:this.keySystems[t].getCDMData()});return n},getLicenseServer:function(e,t,n){if("license-release"===n||"individualization-request"==n)return null;var r=null;return t&&t.hasOwnProperty("drmtoday")?r=this.system.getObject("serverDRMToday"):"com.widevine.alpha"===e.systemString?r=this.system.getObject("serverWidevine"):"com.microsoft.playready"===e.systemString?r=this.system.getObject("serverPlayReady"):"org.w3.clearkey"===e.systemString&&(r=this.system.getObject("serverClearKey")),r},processClearKeyLicenseRequest:function(e,t){try{return y.dependencies.protection.KeySystem_ClearKey.getClearKeysFromProtectionData(e,t)}catch(e){return this.log("Failed to retrieve clearkeys from ProtectionData"),null}},autoSelectKeySystem:function(e,t,n,r){if(this.debug.log("[DRM] Auto select key system: "),this.debug.log("[DRM] ---- video codec = "+n),this.debug.log("[DRM] ---- audio codec = "+r),0===e.length)throw new Error("DRM system for this content not supported by the player!");var i=[],o=[];n&&o.push(new y.vo.protection.MediaCapability(n)),r&&i.push(new y.vo.protection.MediaCapability(r));for(var a=new y.vo.protection.KeySystemConfiguration(i,o),s=[],l=0;l<e.length;l++)s.push({ks:e[l].ks,configs:[a]});var u=this;!function(e){var t={};t[y.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE]=function(t){if(e.protectionModel.unsubscribe(y.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE,this),t.error)u.debug.log(t.error),e.notify(y.dependencies.ProtectionController.eventList.ENAME_PROTECTION_ERROR,new y.vo.Error(y.dependencies.ErrorHandler.prototype.MEDIA_KEYSYSERR_ACCESS_DENIED,"[DRM] KeySystem Access Denied! -- "+t.error,null));else{var n=t.data;u.debug.log("[DRM] KeySystem Access Granted ("+n.keySystem.systemString+")!"),e.selectKeySystem(n)}},e.protectionModel.subscribe(y.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE,t),e.requestKeySystemAccess(s)}(t)}},y.models.ProtectionModel_01b=function(){var e,t=null,n=null,r=[],i=[],o=function(){var t=this;return{handleEvent:function(o){var a=null;switch(o.type){case n.needkey:var l=ArrayBuffer.isView(o.initData)?o.initData.buffer:o.initData;t.notify(y.models.ProtectionModel.eventList.ENAME_NEED_KEY,new y.vo.protection.NeedKey(l,"cenc"));break;case n.keyerror:if(a=s(i,o.sessionId),a||(a=s(r,o.sessionId)),a){var u=y.dependencies.ErrorHandler.prototype.MEDIA_KEYERR,d="MediakeyError";switch(o.errorCode.code){case 1:u=y.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_UNKNOWN,d+="An unspecified error occurred. This value is used for errors that don't match any of the other codes.";break;case 2:u=y.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_CLIENT,d+="The Key System could not be installed or updated.";break;case 3:u=y.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_SERVICE,d+="The message passed into update indicated an error from the license service.";break;case 4:u=y.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_OUTPUT,d+="There is no available output device with the required characteristics for the content protection system.";break;case 5:u=y.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_HARDWARECHANGE,d+="A hardware configuration change caused a content protection error.";break;case 6:u=y.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_DOMAIN,d+="An error occurred in a multi-device domain licensing configuration. The most common error is a failure to join the domain."}o.systemCode&&(d+="  (System Code = "+o.systemCode+")"),t.notify(y.models.ProtectionModel.eventList.ENAME_KEY_ERROR,new y.vo.protection.KeyError(u,d))}else t.log("No session token found for key error");break;case n.keyadded:a=s(i,o.sessionId),a||(a=s(r,o.sessionId)),a?t.notify(y.models.ProtectionModel.eventList.ENAME_KEY_ADDED,a):t.log("No session token found for key added");break;case n.keymessage:if(e=null!==o.sessionId&&void 0!==o.sessionId,e?!(a=s(i,o.sessionId))&&r.length>0&&(a=r.shift(),i.push(a),a.sessionID=o.sessionId):r.length>0&&(a=r.shift(),i.push(a),0!==r.length&&t.errHandler.mediaKeyMessageError("Multiple key sessions were creates with a user-agent that does not support sessionIDs!! Unpredictable behavior ahead!")),a){var c=ArrayBuffer.isView(o.message)?o.message.buffer:o.message;a.keyMessage=c,t.notify(y.models.ProtectionModel.eventList.ENAME_KEY_MESSAGE,new y.vo.protection.KeyMessage(a,c,o.defaultURL))}else t.log("No session token found for key message")}}}},a=null,s=function(e,t){if(t&&e){for(var n=e.length,r=0;r<n;r++)if(e[r].sessionID===t)return e[r];return null}return null},l=function(){t.removeEventListener(n.keyerror,a),t.removeEventListener(n.needkey,a),t.removeEventListener(n.keymessage,a),t.removeEventListener(n.keyadded,a)};return{system:void 0,log:void 0,errHandler:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,protectionExt:void 0,keySystem:null,setup:function(){a=o.call(this)},init:function(){var e=document.createElement("video");n=y.models.ProtectionModel_01b.detect(e)},teardown:function(){t&&l();for(var e=0;e<i.length;e++)this.closeKeySession(i[e]);this.notify(y.models.ProtectionModel.eventList.ENAME_TEARDOWN_COMPLETE)},getAllInitData:function(){var e,t=[];for(e=0;e<r.length;e++)t.push(r[e].initData);for(e=0;e<i.length;e++)t.push(i[e].initData);return t},requestKeySystemAccess:function(e){var n=t;n||(n=document.createElement("video"));for(var r=!1,i=0;i<e.length;i++)for(var o=e[i].ks.systemString,a=e[i].configs,s=null,l=0;l<a.length;l++){var u=a[l].videoCapabilities;if(u&&0!==u.length){s=[];for(var d=0;d<u.length;d++)""!==n.canPlayType(u[d].contentType,o)&&s.push(u[d])}if(s&&(!s||0!==s.length)){r=!0;var c=new y.vo.protection.KeySystemConfiguration(null,s),f=this.protectionExt.getKeySystemBySystemString(o),h=new y.vo.protection.KeySystemAccess(f,c);this.notify(y.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE,h);break}}r||this.notify(y.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE,null,"Key system access denied! -- No valid audio/video content configurations detected!")},selectKeySystem:function(e){this.keySystem=e.keySystem,this.notify(y.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_SELECTED)},setMediaElement:function(e){t!==e&&(t&&l(),(t=e)&&(t.addEventListener(n.keyerror,a),t.addEventListener(n.needkey,a),t.addEventListener(n.keymessage,a),t.addEventListener(n.keyadded,a),this.notify(y.models.ProtectionModel.eventList.ENAME_VIDEO_ELEMENT_SELECTED)))},createKeySession:function(o){if(!this.keySystem)throw new Error("Can not create sessions until you have selected a key system");if(e||0===i.length){var a={sessionID:null,initData:o,getSessionID:function(){return this.sessionID},getExpirationTime:function(){return NaN},getSessionType:function(){return"temporary"}};return r.push(a),t[n.generateKeyRequest](this.keySystem.systemString,new Uint8Array(o)),a}throw new Error("Multiple sessions not allowed!")},updateKeySession:function(e,r){var i=e.sessionID;if(this.protectionExt.isClearKey(this.keySystem))for(var o=0;o<r.keyPairs.length;o++)t[n.addKey](this.keySystem.systemString,r.keyPairs[o].key,r.keyPairs[o].keyID,i);else t[n.addKey](this.keySystem.systemString,new Uint8Array(r),e.initData,i)},closeKeySession:function(e){t[n.cancelKeyRequest](this.keySystem.systemString,e.sessionID)},setServerCertificate:function(){},loadKeySession:function(){},removeKeySession:function(){},checkIfEncrypted:function(){}}},y.models.ProtectionModel_01b.prototype={constructor:y.models.ProtectionModel_01b},y.models.ProtectionModel_01b.APIs=[{generateKeyRequest:"generateKeyRequest",addKey:"addKey",cancelKeyRequest:"cancelKeyRequest",needkey:"needkey",keyerror:"keyerror",keyadded:"keyadded",keymessage:"keymessage"},{generateKeyRequest:"webkitGenerateKeyRequest",addKey:"webkitAddKey",cancelKeyRequest:"webkitCancelKeyRequest",needkey:"webkitneedkey",keyerror:"webkitkeyerror",keyadded:"webkitkeyadded",keymessage:"webkitkeymessage"}],y.models.ProtectionModel_01b.detect=function(e){for(var t=y.models.ProtectionModel_01b.APIs,n=0;n<t.length;n++){var r=t[n];if("function"==typeof e[r.generateKeyRequest]&&("function"==typeof e[r.addKey]&&"function"==typeof e[r.cancelKeyRequest]))return r}return null},y.models.ProtectionModel_3Feb2014=function(){var e=null,t=null,n=null,r=null,i=null,o=[],a=function(){var e=this;return{handleEvent:function(t){switch(t.type){case i.needkey:if(t.initData){var n=ArrayBuffer.isView(t.initData)?t.initData.buffer:t.initData;e.notify(y.models.ProtectionModel.eventList.ENAME_NEED_KEY,new y.vo.protection.NeedKey(n,"cenc"))}}}}},s=null,l=function(){return},u=function(e){var t=y.dependencies.ErrorHandler.prototype.MEDIA_KEYERR,n="MediakeyError";if(e.errorCode)switch(e.errorCode.code){case 1:t=y.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_UNKNOWN,n="An unspecified error occurred. This value is used for errors that don't match any of the other codes.";break;case 2:t=y.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_CLIENT,n="The Key System could not be installed or updated.";break;case 3:t=y.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_SERVICE,n="The message passed into update indicated an error from the license service.";break;case 4:t=y.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_OUTPUT,n="There is no available output device with the required characteristics for the content protection system.";break;case 5:t=y.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_HARDWARECHANGE,n+="A hardware configuration change caused a content protection error.";break;case 6:t=y.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_DOMAIN,n="An error occurred in a multi-device domain licensing configuration. The most common error is a failure to join the domain.";break;default:t=y.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_UNKNOWN,n="An unspecified error occurred. This value is used for errors that don't match any of the other codes."}else t=y.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_UNKNOWN,n="An unspecified error occurred. This value is used for errors that don't match any of the other codes.";return e.systemCode&&(n+="  (System Code = "+e.systemCode+")"),new y.vo.protection.KeyError(t,n)},d=function(e,t){var n=this;return{session:e,initData:t,handleEvent:function(e){switch(e.type){case i.error:n.notify(y.models.ProtectionModel.eventList.ENAME_KEY_ERROR,u(e));break;case i.message:var t=ArrayBuffer.isView(e.message)?e.message.buffer:e.message;n.notify(y.models.ProtectionModel.eventList.ENAME_KEY_MESSAGE,new y.vo.protection.KeyMessage(this,t,e.destinationURL));break;case i.ready:n.notify(y.models.ProtectionModel.eventList.ENAME_KEY_ADDED,this);break;case i.close:n.notify(y.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CLOSED,this.getSessionID())}},getSessionID:function(){return this.session.sessionId},getExpirationTime:function(){return NaN},getSessionType:function(){return"temporary"}}};return{system:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,protectionExt:void 0,debug:void 0,keySystem:null,setup:function(){s=a.call(this)},init:function(){var e=document.createElement("video");i=y.models.ProtectionModel_3Feb2014.detect(e)},teardown:function(){try{for(var t=0;t<o.length;t++)this.closeKeySession(o[t]);e&&e.removeEventListener(i.needkey,s),this.notify(y.models.ProtectionModel.eventList.ENAME_TEARDOWN_COMPLETE)}catch(e){this.notify(y.models.ProtectionModel.eventList.ENAME_TEARDOWN_COMPLETE,null,"Error tearing down key sessions and MediaKeys! -- "+e.message)}},getAllInitData:function(){for(var e=[],t=0;t<o.length;t++)e.push(o[t].initData);return e},requestKeySystemAccess:function(e){for(var t=!1,n=0;n<e.length;n++){var r=e[n].ks.systemString,o=e[n].configs,a=null,s=null;this.debug.log("[DRM][3Feb2014] Request access for key system "+r);for(var l=0;l<o.length;l++){var u=o[l].audioCapabilities,d=o[l].videoCapabilities;if(u&&0!==u.length){a=[];for(var c=0;c<u.length;c++)window[i.MediaKeys].isTypeSupported(r,u[c].contentType)&&a.push(u[c])}if(d&&0!==d.length){s=[];for(var f=0;f<d.length;f++)window[i.MediaKeys].isTypeSupported(r,d[f].contentType)&&s.push(d[f])}if(!(!a&&!s||a&&0===a.length||s&&0===s.length)){t=!0;var h=new y.vo.protection.KeySystemConfiguration(a,s),p=this.protectionExt.getKeySystemBySystemString(r),m=new y.vo.protection.KeySystemAccess(p,h);this.debug.log("[DRM][3Feb2014] configuration supported = audio:"+JSON.stringify(a)+", video:"+JSON.stringify(s)),this.notify(y.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE,m);break}}}t||this.notify(y.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE,null,"[DRM][3Feb2014] Key system access denied! -- No valid audio/video content configurations detected!")},selectKeySystem:function(r){this.debug.log("[DRM][3Feb2014] Select key system "+r.keySystem.systemString);try{t=r.mediaKeys=new window[i.MediaKeys](r.keySystem.systemString),this.keySystem=r.keySystem,n=r,e&&l.call(this),this.notify(y.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_SELECTED)}catch(e){this.notify(y.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_SELECTED,null,"Error selecting keys system ("+this.keySystem.systemString+")! Could not create MediaKeys -- TODO")}},setMediaElement:function(n){e!==n&&(e&&(e.removeEventListener(i.needkey,s),e.removeEventListener("loadedmetadata",r)),(e=n)&&t&&l.call(this))},createKeySession:function(e,r,a){if(!this.keySystem||!t||!n)throw new Error("Can not create sessions until you have selected a key system");this.debug.log("[DRM][3Feb2014] Create key session");var s=n.ksConfiguration.videoCapabilities[0].contentType,l=t.createSession(s,new Uint8Array(e),a?new Uint8Array(a):null),u=d.call(this,l,e);l.addEventListener(i.error,u),l.addEventListener(i.message,u),l.addEventListener(i.ready,u),l.addEventListener(i.close,u),o.push(u),this.notify(y.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CREATED,u)},updateKeySession:function(e,t){var n=e.session;this.debug.log("[DRM][3Feb2014] Update key session"),this.protectionExt.isClearKey(this.keySystem)?n.update(new Uint8Array(t.toJWK())):n.update(new Uint8Array(t))},closeKeySession:function(e){this.debug.log("[DRM][3Feb2014] Close key session, token = "+e.session.sessionId);var t=e.session;t.removeEventListener(i.error,e),t.removeEventListener(i.message,e),t.removeEventListener(i.ready,e),t.removeEventListener(i.close,e);for(var n=0;n<o.length;n++)if(o[n]===e){o.splice(n,1);break}t[i.release]()},setServerCertificate:function(){},loadKeySession:function(){},removeKeySession:function(){},checkIfEncrypted:function(){}}},y.models.ProtectionModel_3Feb2014.APIs=[{setMediaKeys:"msSetMediaKeys",MediaKeys:"MSMediaKeys",release:"close",needkey:"msneedkey",error:"mskeyerror",message:"mskeymessage",ready:"mskeyadded",close:"mskeyclose"},{setMediaKeys:"setMediaKeys",MediaKeys:"MediaKeys",release:"close",needkey:"needkey",error:"keyerror",message:"keymessage",ready:"keyadded",close:"keyclose"}],y.models.ProtectionModel_3Feb2014.detect=function(e){for(var t=y.models.ProtectionModel_3Feb2014.APIs,n=0;n<t.length;n++){var r=t[n];if("function"==typeof e[r.setMediaKeys]&&"function"==typeof window[r.MediaKeys])return r}return null},y.models.ProtectionModel_3Feb2014.prototype={constructor:y.models.ProtectionModel_3Feb2014},y.models.ProtectionModel_21Jan2015=function(){var e=null,t=null,n=null,r=[],i=function(e){var t,n="[";for(t=0;t<e.length;t++)n+="0x"+e[t].toString(16),t<e.length-1&&(n+=",");return n+="]"},o=function e(t,n){var r=this;!function(n){var i=t[n].ks,o=t[n].configs;r.debug.log("[DRM][PM_21Jan2015] requestMediaKeySystemAccess: "+i.systemString),navigator.requestMediaKeySystemAccess(i.systemString,o).then(function(e){var t="function"==typeof e.getConfiguration?e.getConfiguration():null,n=new y.vo.protection.KeySystemAccess(i,t);n.mksa=e,r.notify(y.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE,n)}).catch(function(){++n<t.length?e.call(r,t,n):r.notify(y.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE,null,"Key system access denied!")})}(n)},a=function(e){var t=e.session;return t.removeEventListener("keystatuseschange",e),t.removeEventListener("message",e),t.close()},s=function(){var t=this;return{session:null,handleEvent:function(r){switch(r.type){case"encrypted":t.debug.log("[DRM][PM_21Jan2015] 'encrypted' event");break;case"waitingforkey":t.debug.log("[DRM][PM_21Jan2015] 'waitingforkey' event"),null!==this.session&&!0===this.session.licenseStored&&(this.session.licenseStored=!1,this.session=null,e.removeEventListener("waitingforkey",n),t.notify(y.models.ProtectionModel.eventList.ENAME_KEY_ERROR,new y.vo.protection.KeyError(y.dependencies.ErrorHandler.prototype.MEDIA_ERR_ENCRYPTED,"Media is encrypted and no valid key is available")))}}}},l=function(e){for(var t=0;t<r.length;t++)if(r[t]===e){r.splice(t,1);break}},u=function(e,t,n){var o=this,a=function(e,t){for(var n=0;n<r.length;n++)if(r[n].session===e){r[n].usable=t;break}},s={session:e,initData:t,licenseStored:!1,usable:!1,handleEvent:function(e){switch(e.type){case"keystatuseschange":o.notify(y.models.ProtectionModel.eventList.ENAME_KEY_STATUSES_CHANGED,this),e.target.keyStatuses.forEach(function(){var t,n;switch(arguments&&arguments.length>0&&(arguments[0]&&("string"==typeof arguments[0]?t=arguments[0]:n=arguments[0]),arguments[1]&&("string"==typeof arguments[1]?t=arguments[1]:n=arguments[1])),o.debug.log("[DRM][PM_21Jan2015] status = "+t+" for KID "+i(new Uint8Array(n))),t){case"expired":a(e.target,!1),o.notify(y.models.ProtectionModel.eventList.ENAME_KEY_STATUSES_CHANGED,null,new y.vo.Error(y.dependencies.ErrorHandler.prototype.MEDIA_ERR_ENCRYPTED,"License has expired",null));break;case"output-restricted":a(e.target,!1),o.notify(y.models.ProtectionModel.eventList.ENAME_KEY_STATUSES_CHANGED,null,new y.vo.Error(y.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_OUTPUT,"There is no available output device with the required characteristics for the content protection system",null));break;case"usable":a(e.target,!0);break;default:o.notify(y.models.ProtectionModel.eventList.ENAME_KEY_STATUSES_CHANGED,{status:t,keyId:n})}});break;case"message":o.debug.log("[DRM][PM_21Jan2015] 'message' event: ",e);var t=ArrayBuffer.isView(e.message)?e.message.buffer:e.message;o.notify(y.models.ProtectionModel.eventList.ENAME_KEY_MESSAGE,new y.vo.protection.KeyMessage(this,t,void 0,e.messageType))}},getSessionID:function(){return this.session.sessionId},getExpirationTime:function(){return this.session.expiration},getKeyStatuses:function(){return this.session.keyStatuses},getSessionType:function(){return n}};return e.addEventListener("keystatuseschange",s),e.addEventListener("message",s),e.closed.then(function(){l(s),o.notify(y.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CLOSED,s.getSessionID())}),r.push(s),s};return{system:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,protectionExt:void 0,keySystem:null,debug:null,setup:function(){n=s.call(this)},init:function(){n.session=null},teardown:function(){var t,i;for(this.debug.log("[DRM][PM_21Jan2015] Teardown"),i=0;i<r.length;i++)t=r[i],t.licenseStored||(r.splice(i,1),i--);e.removeEventListener("waitingforkey",n),this.notify(y.models.ProtectionModel.eventList.ENAME_TEARDOWN_COMPLETE)},getAllInitData:function(){for(var e=[],t=0;t<r.length;t++)r[t].usable?e.push(r[t].initData):(r.splice(t,1),t--);return e},requestKeySystemAccess:function(e){o.call(this,e,0)},selectKeySystem:function(n){var r=this;if(r.debug.log("[DRM][PM_21Jan2015] Select key system, create new MediaKeys"),null!==t)return r.debug.log("[DRM][PM_21Jan2015] MediaKeys already created"),void r.notify(y.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_SELECTED);n.mksa.createMediaKeys().then(function(i){r.keySystem=n.keySystem,t=i,e&&e.setMediaKeys(t),r.notify(y.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_SELECTED)}).catch(function(){r.notify(y.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_SELECTED,null,"Error selecting keys system ("+n.keySystem.systemString+")! Could not create MediaKeys -- TODO")})},setMediaElement:function(r){e!==r&&null!==r&&(e&&(e.removeEventListener("encrypted",n),e.removeEventListener("waitingforkey",n),e.setMediaKeys(null)),(e=r)&&(e.addEventListener("encrypted",n),t&&e.setMediaKeys(t)))},setServerCertificate:function(e){if(!this.keySystem||!t)throw new Error("Can not set server certificate until you have selected a key system");var n=this;t.setServerCertificate(e).then(function(){n.notify(y.models.ProtectionModel.eventList.ENAME_SERVER_CERTIFICATE_UPDATED)}).catch(function(e){n.notify(y.models.ProtectionModel.eventList.ENAME_SERVER_CERTIFICATE_UPDATED,null,"Error updating server certificate -- "+e.name)})},createKeySession:function(e,n){if(!this.keySystem||!t)throw new Error("Can not create sessions until you have selected a key system");this.debug.log("[DRM][PM_21Jan2015] Create key session, type = "+n);var r=t.createSession(n),i=u.call(this,r,e,n),o=this;r.generateRequest("cenc",e).then(function(){o.notify(y.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CREATED,i)}).catch(function(e){l(i),o.notify(y.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CREATED,null,{reason:"Failed to generate key request",error:new y.vo.Error(e.code,e.name,e.message)})})},updateKeySession:function(t,r){var i=t.session,o=this;o.debug.log("[DRM][PM_21Jan2015] Update key session "+i.sessionId),this.protectionExt.isClearKey(this.keySystem)&&(r=r.toJWK()),i.update(r).then(function(){t.licenseStored=!0,n.session=t,e.addEventListener("waitingforkey",n)}).catch(function(e){o.notify(y.models.ProtectionModel.eventList.ENAME_KEY_ERROR,new y.vo.protection.KeyError(y.dependencies.ErrorHandler.prototype.MEDIA_KEYERR,"Error while providing license to the CDM",e))})},loadKeySession:function(e){if(!this.keySystem||!t)throw new Error("Can not load sessions until you have selected a key system");this.debug.log("[DRM][PM_21Jan2015] Load key session, id = "+e);var n=t.createSession(),r=this;n.load(e).then(function(t){if(t){var i=u.call(this,n);r.notify(y.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CREATED,i)}else r.notify(y.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CREATED,null,{reason:"Failed to load session "+e,error:null})}).catch(function(t){r.notify(y.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CREATED,{reason:"Failed to load session "+e,error:new y.vo.Error(t.code,t.name,t.message)})})},removeKeySession:function(e){var t=e.session;this.debug.log("[DRM][PM_21Jan2015] Remove key session");var n=this;t.remove().then(function(){n.notify(y.models.ProtectionModel.eventList.ENAME_KEY_SESSION_REMOVED,e.getSessionID())},function(t){n.notify(y.models.ProtectionModel.eventList.ENAME_KEY_SESSION_REMOVED,null,"Error removing session ("+e.getSessionID()+"). "+t.name)})},closeKeySession:function(e){this.debug.log("[DRM][PM_21Jan2015] Close key session");var t=this;a(e).catch(function(n){l(e),t.notify(y.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CLOSED,null,"Error closing session ("+e.getSessionID()+") "+n.name)})},checkIfEncrypted:function(){e.addEventListener("waitingforkey",n)}}},y.models.ProtectionModel_21Jan2015.detect=function(e){return void 0!==e.onencrypted&&void 0!==e.mediaKeys&&(void 0!==navigator.requestMediaKeySystemAccess&&"function"==typeof navigator.requestMediaKeySystemAccess&&!window.MSMediaKeys)},y.models.ProtectionModel_21Jan2015.prototype={constructor:y.models.ProtectionModel_21Jan2015},y.dependencies.protection.KeySystem=function(){},y.dependencies.protection.KeySystem_Access=function(){},y.dependencies.protection.KeySystem_Access.prototype={constructor:y.dependencies.protection.KeySystem_Access},y.dependencies.protection.KeySystem_ClearKey=function(){var e;return{system:void 0,schemeIdURI:"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b",systemString:"org.w3.clearkey",uuid:"1077efec-c0b2-4d02-ace3-3c1e52e2fb4b",sessionType:"temporary",init:function(t){e=t},getInitData:y.dependencies.protection.CommonEncryption.parseInitDataFromContentProtection,getKeySystemConfigurations:y.dependencies.protection.CommonEncryption.getKeySystemConfigurations,getRequestHeadersFromMessage:function(){return null},getLicenseRequestFromMessage:function(e){return new Uint8Array(e)},getLicenseServerURLFromInitData:function(){return null},getCDMData:function(){return null}}},y.dependencies.protection.KeySystem_ClearKey.prototype={constructor:y.dependencies.protection.KeySystem_ClearKey},y.dependencies.protection.KeySystem_ClearKey.getClearKeysFromProtectionData=function(e,t){var n=null;if(e){for(var r=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(t))),i=[],o=0;o<r.kids.length;o++){var a=r.kids[o],s=e.clearkeys.hasOwnProperty(a)?e.clearkeys[a]:null;if(!s)throw new Error("[DRM] ClearKey keyID ("+a+") is not known!");i.push(new y.vo.protection.KeyPair(a,s))}n=new y.vo.protection.ClearKeyKeySet(i)}return n},y.dependencies.protection.KeySystem_PlayReady=function(){var e,t="utf16",n='<PlayReadyCDMData type="LicenseAcquisition"><LicenseAcquisition version="1.0" Proactive="false"><CustomData encoding="base64encoded">%CUSTOMDATA%</CustomData></LicenseAcquisition></PlayReadyCDMData>',r=function(e){var n,r,i,o,a={},s=e instanceof ArrayBuffer?e:e.buffer,l="utf16"===t?new Uint16Array(s):new Uint8Array(s),u=0;for(n=String.fromCharCode.apply(null,l),r=this.domParser.createXmlTree(n),i=r.getElementsByTagName("name"),o=r.getElementsByTagName("value"),u=0;u<i.length;u+=1)a[i[u].childNodes[0].nodeValue]=o[u].childNodes[0].nodeValue;return a.hasOwnProperty("Content")&&(a["Content-Type"]=a.Content,delete a.Content),a.hasOwnProperty("Content-Type")||(a["Content-Type"]="text/xml; charset=utf-8"),a},i=function(e){var n,r,i,o=null,a=e instanceof ArrayBuffer?e:e.buffer,s="utf16"===t?new Uint16Array(a):new Uint8Array(a);return n=String.fromCharCode.apply(null,s),r=this.domParser.createXmlTree(n),r.getElementsByTagName("Challenge")[0]?(i=r.getElementsByTagName("Challenge")[0].childNodes[0].nodeValue)&&(o=_.decode(i)):o=n,o},o=function(e){if(e){var t,n,r,i,o,a,s,l=new DataView(e),u=l.getUint16(4,!0),d=6,c=0;for(c=0;c<u;c++)if(t=l.getUint16(d,!0),d+=2,n=l.getUint16(d,!0),d+=2,1===t){if(r=e.slice(d,d+n),i=String.fromCharCode.apply(null,new Uint16Array(r)),o=this.domParser.createXmlTree(i),o.getElementsByTagName("LA_URL")[0]&&(a=o.getElementsByTagName("LA_URL")[0].childNodes[0].nodeValue))return a;if(o.getElementsByTagName("LUI_URL")[0]&&(s=o.getElementsByTagName("LUI_URL")[0].childNodes[0].nodeValue))return s}else d+=n}return null},a=function(e){var t,n,r,i,o,a=0,s=new Uint8Array([112,115,115,104,0,0,0,0]),l=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),u=null;if("pssh"in e)return y.dependencies.protection.CommonEncryption.parseInitDataFromContentProtection(e);if("pro"in e)u=_.decodeArray(e.pro.__text);else{if(!("prheader"in e))return null;u=_.decodeArray(e.prheader.__text)}return t=u.length,n=4+s.length+l.length+4+t,r=new ArrayBuffer(n),i=new Uint8Array(r),o=new DataView(r),o.setUint32(a,n),a+=4,i.set(s,a),a+=s.length,i.set(l,a),a+=l.length,o.setUint32(a,t),a+=4,i.set(u,a),a+=t,i.buffer},s=function(){var t,r,i,o;if(e&&e.cdmData){for(t=[],o=0;o<e.cdmData.length;++o)t.push(e.cdmData.charCodeAt(o)),t.push(0);for(t=String.fromCharCode.apply(null,t),t=_.encode(t),r=n.replace("%CUSTOMDATA%",t),i=[],o=0;o<r.length;++o)i.push(r.charCodeAt(o)),i.push(0);return new Uint8Array(i).buffer}return null};return{schemeIdURI:"urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95",systemString:"com.microsoft.playready",uuid:"9a04f079-9840-4286-ab92-e65be0885f95",notify:void 0,subscribe:void 0,unsubscribe:void 0,domParser:void 0,sessionType:"temporary",init:function(t){t&&(e=t,e.sessionType&&(this.sessionType=e.sessionType))},getInitData:a,getKeySystemConfigurations:y.dependencies.protection.CommonEncryption.getKeySystemConfigurations,getRequestHeadersFromMessage:r,getLicenseRequestFromMessage:i,getLicenseServerURLFromInitData:o,getCDMData:s,setPlayReadyMessageFormat:function(e){if("utf8"!==e&&"utf16"!==e)throw new Error("Illegal PlayReady message format! -- "+e);t=e}}},y.dependencies.protection.KeySystem_PlayReady.prototype={constructor:y.dependencies.protection.KeySystem_PlayReady},y.dependencies.protection.KeySystem_Widevine=function(){var e=null,t=function(t){return e&&e.pssh?_.decodeArray(e.pssh).buffer:y.dependencies.protection.CommonEncryption.parseInitDataFromContentProtection(t)};return{schemeIdURI:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",systemString:"com.widevine.alpha",uuid:"edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",sessionType:"temporary",init:function(t){t&&(e=t,e.sessionType&&(this.sessionType=e.sessionType))},getInitData:t,getKeySystemConfigurations:y.dependencies.protection.CommonEncryption.getKeySystemConfigurations,getRequestHeadersFromMessage:function(){return null},getLicenseRequestFromMessage:function(e){return new Uint8Array(e)},getLicenseServerURLFromInitData:function(){return null},getCDMData:function(){return null}}},y.dependencies.protection.KeySystem_Widevine.prototype={constructor:y.dependencies.protection.KeySystem_Widevine},y.dependencies.protection.servers.ClearKey=function(){return{getServerURLFromMessage:function(e,t){var n=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(t))),r=0;for(e+="/?",r=0;r<n.kids.length;r++)e+=n.kids[r]+"&";return e=e.substring(0,e.length-1)},getHTTPMethod:function(){return"GET"},getResponseType:function(){return"json"},getLicenseMessage:function(e){var t,n,r,i,o=[];if(!e.hasOwnProperty("keys"))return null;for(t=0;t<e.keys.length;t++)n=e.keys[t],r=n.kid.replace(/=/g,""),i=n.k.replace(/=/g,""),o.push(new y.vo.protection.KeyPair(r,i));return new y.vo.protection.ClearKeyKeySet(o)},getErrorResponse:function(e){return{code:0,name:"UnknownError",message:String.fromCharCode.apply(null,new Uint8Array(e))}}}},y.dependencies.protection.servers.ClearKey.prototype={constructor:y.dependencies.protection.servers.ClearKey},y.dependencies.protection.servers.DRMToday=function(){var e={"com.widevine.alpha":{responseType:"json",getLicenseMessage:function(e){return _.decodeArray(e.license)},getErrorResponse:function(e){return e}},"com.microsoft.playready":{responseType:"arraybuffer",getLicenseMessage:function(e){return e},getErrorResponse:function(e){return String.fromCharCode.apply(null,new Uint8Array(e))}}};return{getServerURLFromMessage:function(e){return e},getHTTPMethod:function(){return"POST"},getResponseType:function(t){return e[t].responseType},getLicenseMessage:function(t,n){return e[n].getLicenseMessage(t)},getErrorResponse:function(t,n){return{code:0,name:"UnknownError",message:e[n].getErrorResponse(t)}}}},y.dependencies.protection.servers.DRMToday.prototype={constructor:y.dependencies.protection.servers.DRMToday},y.dependencies.protection.servers.LicenseServer=function(){},y.dependencies.protection.servers.PlayReady=function(){var e=function(e){var t="",n=0,r=0,i=0,o=0,a=new Uint8Array(e);for(a.length>=3&&239===a[0]&&187===a[1]&&191===a[2]&&(n=3);n<a.length;)if((r=a[n])<128)t+=String.fromCharCode(r),n++;else if(r>191&&r<224){if(n+1>=a.length)throw"UTF-8 Decode failed. Two byte character was truncated.";i=a[n+1],t+=String.fromCharCode((31&r)<<6|63&i),n+=2}else{if(n+2>=a.length)throw"UTF-8 Decode failed. Multi byte character was truncated.";i=a[n+1],o=a[n+2],t+=String.fromCharCode((15&r)<<12|(63&i)<<6|63&o),n+=3}return t},t=function(t){var n=e(t),r=this.domParser.createXmlTree(n),i=r?this.domParser.getChildNode(r,"soap:Envelope"):null,o=i?this.domParser.getChildNode(i,"soap:Body"):null;return(o?this.domParser.getChildNode(o,"soap:Fault"):null)?null:t},n=function(t){var n=e(t),r=this.domParser.createXmlTree(n),i=r?this.domParser.getChildNode(r,"soap:Envelope"):null,o=i?this.domParser.getChildNode(i,"soap:Body"):null,a=o?this.domParser.getChildNode(o,"soap:Fault"):null,s=a?this.domParser.getChildNode(a,"detail"):null,l=s?this.domParser.getChildNode(s,"Exception"):null,u=null,d="",c="",f="",h=-1,p=-1;return null===a?{code:0,name:"UnknownError",message:String.fromCharCode.apply(null,new Uint8Array(t))}:(u=this.domParser.getChildNode(a,"faultstring").firstChild,d=u?u.nodeValue:null,null!==l&&(u=this.domParser.getChildNode(l,"StatusCode"),c=u?u.firstChild.nodeValue:null,u=this.domParser.getChildNode(l,"Message"),f=u?u.firstChild.nodeValue:null,h=f?f.lastIndexOf("[")+1:-1,p=f?f.indexOf("]"):-1),{code:c,name:d,message:f?f.substring(h,p):""})};return{domParser:void 0,getServerURLFromMessage:function(e){return e},getHTTPMethod:function(){return"POST"},getResponseType:function(){return"arraybuffer"},getLicenseMessage:function(e){return t.call(this,e)},getErrorResponse:function(e){return n.call(this,e)}}},y.dependencies.protection.servers.PlayReady.prototype={constructor:y.dependencies.protection.servers.PlayReady},y.dependencies.protection.servers.Widevine=function(){return{getServerURLFromMessage:function(e){return e},getHTTPMethod:function(){return"POST"},getResponseType:function(){return"arraybuffer"},getLicenseMessage:function(e){return e},getErrorResponse:function(e){return{code:0,name:"UnknownError",message:String.fromCharCode.apply(null,new Uint8Array(e))}}}},y.dependencies.protection.servers.Widevine.prototype={constructor:y.dependencies.protection.servers.Widevine},y.vo.protection.ClearKeyKeySet=function(e,t){if(t&&"persistent"!==t&&"temporary"!==t)throw new Error("Invalid ClearKey key set type!  Must be one of 'persistent' or 'temporary'");this.keyPairs=e,this.type=t,this.toJWK=function(){var e,t=this.keyPairs.length,n={};for(n.keys=[],e=0;e<t;e++){var r={kty:"oct",alg:"A128KW",kid:this.keyPairs[e].keyID,k:this.keyPairs[e].key};n.keys.push(r)}this.type&&(n.type=this.type);var i=JSON.stringify(n),o=i.length,a=new ArrayBuffer(o),s=new Uint8Array(a);for(e=0;e<o;e++)s[e]=i.charCodeAt(e);return a}},y.vo.protection.ClearKeyKeySet.prototype={constructor:y.vo.protection.ClearKeyKeySet},y.vo.protection.KeyError=function(e,t,n){this.code=e,this.message=t,this.data=n},y.vo.protection.KeyError.prototype={constructor:y.vo.protection.KeyError},y.vo.protection.KeyMessage=function(e,t,n,r){this.sessionToken=e,this.message=t,this.defaultURL=n,this.messageType=r},y.vo.protection.KeyMessage.prototype={constructor:y.vo.protection.KeyMessage},y.vo.protection.KeyPair=function(e,t){this.keyID=e,this.key=t},y.vo.protection.KeyPair.prototype={constructor:y.vo.protection.KeyPair},y.vo.protection.KeySystemAccess=function(e,t){this.keySystem=e,this.ksConfiguration=t},y.vo.protection.KeySystemAccess.prototype={constructor:y.vo.protection.KeySystemAccess},y.vo.protection.KeySystemConfiguration=function(e,t,n,r,i){this.initDataTypes=["cenc"],this.audioCapabilities=e,this.videoCapabilities=t,this.distinctiveIdentifier=n,this.persistentState=r,this.sessionTypes=i},y.vo.protection.KeySystemConfiguration.prototype={constructor:y.vo.protection.KeySystemConfiguration},y.vo.protection.LicenseRequestComplete=function(e,t){this.message=e,this.requestData=t},y.vo.protection.LicenseRequestComplete.prototype={constructor:y.vo.protection.LicenseRequestComplete},y.vo.protection.MediaCapability=function(e,t){this.contentType=e,this.robustness=t},y.vo.protection.MediaCapability.prototype={constructor:y.vo.protection.MediaCapability},y.vo.protection.NeedKey=function(e,t){this.initData=e,this.initDataType=t},y.vo.protection.NeedKey.prototype={constructor:y.vo.protection.NeedKey},y.vo.protection.ProtectionData=function(e,t,n,r){this.laURL=e,this.httpRequestHeaders=t,this.bearerToken=n,this.clearkeys=r},y.vo.protection.ProtectionData.prototype={constructor:y.vo.protection.ProtectionData},y.models.SessionToken=function(){},y.models.SessionToken.prototype={initData:null,getSessionID:function(){return""},getExpirationTime:function(){return NaN},getKeyStatuses:function(){return null}},m=function(){return{dependencies:{}}}(),m.dependencies.AES=function(){this.init=function(e){this._tables=[[[],[],[],[],[]],[[],[],[],[],[]]],this._precompute.call(this);var t,n,r,i,o,a=this._tables[0][4],s=this._tables[1],l=e.length,u=1;if(4!==l&&6!==l&&8!==l)throw new Error("Invalid aes key size="+l);for(i=e.slice(0),o=[],this._key=[i,o],t=l;t<4*l+28;t++)r=i[t-1],(t%l==0||8===l&&t%l==4)&&(r=a[r>>>24]<<24^a[r>>16&255]<<16^a[r>>8&255]<<8^a[255&r],t%l==0&&(r=r<<8^r>>>24^u<<24,u=u<<1^283*(u>>7))),i[t]=i[t-l]^r;for(n=0;t;n++,t--)r=i[3&n?t:t-4],o[n]=t<=4||n<4?r:s[0][a[r>>>24]]^s[1][a[r>>16&255]]^s[2][a[r>>8&255]]^s[3][a[255&r]]},this._precompute=function(){var e,t,n,r,i,o,a,s,l,u=this._tables[0],d=this._tables[1],c=u[4],f=d[4],h=[],p=[];for(e=0;e<256;e++)p[(h[e]=e<<1^283*(e>>7))^e]=e;for(t=n=0;!c[t];t^=r||1,n=p[n]||1)for(a=n^n<<1^n<<2^n<<3^n<<4,a=a>>8^255&a^99,c[t]=a,f[a]=t,o=h[i=h[r=h[t]]],l=16843009*o^65537*i^257*r^16843008*t,s=257*h[a]^16843008*a,e=0;e<4;e++)u[e][t]=s=s<<24^s>>>8,d[e][a]=l=l<<24^l>>>8;for(e=0;e<5;e++)u[e]=u[e].slice(0),d[e]=d[e].slice(0)},this.decrypt=function(e,t,n,r,i,o){var a,s,l,u,d=this._key[1],c=e^d[0],f=r^d[1],h=n^d[2],p=t^d[3],m=d.length/4-2,g=4,y=this._tables[1],v=y[0],_=y[1],b=y[2],E=y[3],T=y[4];for(u=0;u<m;u++)a=v[c>>>24]^_[f>>16&255]^b[h>>8&255]^E[255&p]^d[g],s=v[f>>>24]^_[h>>16&255]^b[p>>8&255]^E[255&c]^d[g+1],l=v[h>>>24]^_[p>>16&255]^b[c>>8&255]^E[255&f]^d[g+2],p=v[p>>>24]^_[c>>16&255]^b[f>>8&255]^E[255&h]^d[g+3],g+=4,c=a,f=s,h=l;for(u=0;u<4;u++)i[(3&-u)+o]=T[c>>>24]<<24^T[f>>16&255]<<16^T[h>>8&255]<<8^T[255&p]^d[g++],a=c,c=f,f=h,h=p,p=a}},m.dependencies.AES.prototype={constructor:m.dependencies.AES},m.dependencies.AES128Decrypter=function(e,t){this.key=e,this.iv=t,this.ntoh=function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24},this.doDecrypt=function(e,t,n){var r,i,o,a,s,l,u,d,c,f=new Int32Array(e.buffer,e.byteOffset,e.byteLength>>2),h=new m.dependencies.AES,p=new Uint8Array(e.byteLength),g=new Int32Array(p.buffer);for(h.init(Array.prototype.slice.call(t)),r=~~n[0],i=~~n[1],o=~~n[2],a=~~n[3],c=0;c<f.length;c+=4)s=~~this.ntoh(f[c]),l=~~this.ntoh(f[c+1]),u=~~this.ntoh(f[c+2]),d=~~this.ntoh(f[c+3]),h.decrypt(s,l,u,d,g,c),g[c]=this.ntoh(g[c]^r),g[c+1]=this.ntoh(g[c+1]^i),g[c+2]=this.ntoh(g[c+2]^o),g[c+3]=this.ntoh(g[c+3]^a),r=s,i=l,o=u,a=d;return p},this.localDecrypt=function(e,t,n,r){var i=this.doDecrypt(e,t,n);r.set(i,e.byteOffset)},this.decrypt=function(e){var t=new Int32Array(e),n=new Uint8Array(e.byteLength),r=0,i=this.key,o=this.iv;for(this.localDecrypt(t.subarray(r,r+32e3),i,o,n),r=32e3;r<t.length;r+=32e3)o=new Uint32Array([this.ntoh(t[r-4]),this.ntoh(t[r-3]),this.ntoh(t[r-2]),this.ntoh(t[r-1])]),this.localDecrypt(t.subarray(r,r+32e3),i,o,n);return n}},m.dependencies.AES128Decrypter.prototype={constructor:m.dependencies.AES128Decrypter},m.dependencies.HlsDemux=function(){var e=function(e,t){var n=new Uint8Array(e.byteLength+t.byteLength);return n.set(e,0),n.set(t,e.byteLength),n},t=null,n=null,r=[],i=[],o=-1,a=-1,s=function(e,t,n,r){for(var i,o=t;o<e.length;){if(i=new x.ts.TsPacket,i.parse(e.subarray(o,o+x.ts.TsPacket.prototype.TS_PACKET_SIZE)),i.getPid()===n&&(void 0===r||i.getPusi()===r))return{offset:o,packet:i};o+=x.ts.TsPacket.prototype.TS_PACKET_SIZE}return null},l=function(e){var n=s.call(this,e,0,x.ts.TsPacket.prototype.PAT_PID);return null===n?null:(t=new x.si.PAT,t.parse(n.packet.getPayload()),t)},u=function(e,t){var r,o,a,l=s.call(this,e,0,t),u=0;if(null===l)return null;for(n=new x.si.PMT,n.parse(l.packet.getPayload()),u=0;u<n.m_listOfComponents.length;u++){if(r=n.m_listOfComponents[u],o=new y.vo.Mp4Track,null!==(a=n.gStreamTypes[r.m_stream_type]))switch(o.streamType=a.name,a.value){case 224:o.type="video";break;case 192:o.type="audio";break;case 252:o.type="data";break;default:o.type="und"}else this.debug.log("[HlsDemux] Stream Type "+r.m_stream_type+" unknown!");o.timescale=x.Pts.prototype.SYSTEM_CLOCK_FREQUENCY,o.pid=r.m_elementary_PID,i.push(o)}return n},d=function(e){var t,n,s,l,u,d=null,c=null;t=new x.ts.TsPacket,t.parse(e),t.hasAdaptationFieldOnly()||(n=t.getPid(),void 0!==(s=r[n])&&(l=i[s-1],t.getPusi()?(u=new x.pes.PesPacket,u.parse(t.getPayload()),d=new y.vo.Mp4Track.Sample,d.cts=u.getPts().getValue(),d.dts=null!==u.getDts()?u.getDts().getValue():d.cts,d.size=0,d.duration=0,d.subSamples=[],-1===o&&(o=d.dts),d.dts-=o,d.cts-=o,d.dts+=a,d.cts+=a,c=u.getPayload(),"audio"===l.type&&(d.flags=16777216),"video"===l.type&&-1!==l.streamType.search("H.264")&&(d.flags=x.h264.isIDR(c)?33554432:16842752),d.subSamples.push(c),l.samples.push(d)):(l.samples.length>0&&(d=l.samples[l.samples.length-1]),d.subSamples.push(t.getPayload()))))},c=function(e){var t,n,r,i,o=0,a=0;for(r=0;r<e.samples.length;r++){for(n=0,t=e.samples[r],i=0;i<t.subSamples.length;i++)n+=t.subSamples[i].length;r>0&&(e.samples[r-1].duration=e.samples[r].dts-e.samples[r-1].dts),t.size=n,o+=n}for(e.samples[e.samples.length-1].duration=e.samples[e.samples.length-2].duration,e.data=new Uint8Array(o),e.dataCTS=[],r=0;r<e.samples.length;r++)for(t=e.samples[r],-1!==e.streamType.search("ADTS")&&(e.dataCTS[a]=t.cts),i=0;i<t.subSamples.length;i++)e.data.set(t.subSamples[i],a),a+=t.subSamples[i].length;if(-1!==e.streamType.search("H.264")&&x.h264.bytestreamToMp4(e.data),-1!==e.streamType.search("ADTS")&&f.call(this,e),e.previousCts&&e.previousDuration){t=e.samples[0];var s=t.cts-(e.previousCts+e.previousDuration);s>0&&(t.cts-=s,t.dts-=s,t.duration+=s,this.debug.log("[HlsDemux]["+e.type+"] Patch sample duration, cts = "+(t.cts/9e4).toFixed(3)+", duration = "+(t.duration/9e4).toFixed(3)))}},f=function(e){var t,n,r,i,o,a,s,l,u=[];for(t=x.aac.parseADTS(e.data,e.dataCTS),n=0,l=0;l<t.length;l++)n+=t[l].length;for(i=new Uint8Array(n),a=e.samples[0].cts,s=1024*e.timescale/e.samplingRate,r=0,l=0;l<t.length;l++)o=new y.vo.Mp4Track.Sample,o.cts=o.dts=t[l].cts?t[l].cts:a,o.size=t[l].length,o.duration=s,o.flags=16777216,u.push(o),a=o.cts+s,l>0&&(u[l-1].duration=u[l].cts-u[l-1].cts,u[l-1].duration>s&&this.debug.log("[HlsDemux]["+e.type+"] Patch sample duration, cts = "+(u[l-1].cts/9e4).toFixed(3)+", duration = "+(u[l-1].duration/9e4).toFixed(3))),i.set(e.data.subarray(t[l].offset,t[l].offset+t[l].length),r),r+=t[l].length;e.data=i,e.samples=u},h=function(e){var t="",n=0,r=0;for(n=0;n<e.length;n++)r=e[n].toString(16),r.length<2&&(r="0"+r),t+=r;return t},p=function(){this.debug.log("[HlsDemux] Reset"),t=null,n=null,r=[],i=[],o=-1,a=-1},m=function(t,n){var r,i,o,a,l,u,d,c;if(null===(r=s.call(this,t,0,n.pid,!0)))throw{name:y.dependencies.ErrorHandler.prototype.HLS_DEMUX_ERROR,message:"No packets for track "+n.type};if(i=new x.pes.PesPacket,i.parse(r.packet.getPayload()),o=i.getPayload(),-1!==n.streamType.search("H.264")){for(a=x.h264.getSequenceHeader(o);null===a;)r=s.call(this,t,r.offset+x.ts.TsPacket.prototype.TS_PACKET_SIZE,n.pid,!1),o=e(o,r.packet.getPayload()),a=x.h264.getSequenceHeader(o);n.codecPrivateData=h(a.bytes),n.codecs="avc1.",l=/00000001[0-9]7/.exec(n.codecPrivateData),l&&l[0]&&(n.codecs+=n.codecPrivateData.substr(n.codecPrivateData.indexOf(l[0])+10,6)),n.width=a.width,n.height=a.height}-1!==n.streamType.search("AAC")&&(u=x.aac.getAudioSpecificConfig(o),d=(248&u[0])>>3,n.codecPrivateData=h(u),n.codecs="mp4a.40."+d,c=(7&u[0])<<1|(128&u[1])>>7,n.samplingRate=x.aac.SAMPLING_FREQUENCY[c],n.channels=(120&u[1])>>3,n.bandwidth=0),this.debug.log("[HlsDemux]["+n.type+"] track codecPrivateData = "+n.codecPrivateData),this.debug.log("[HlsDemux]["+n.type+"] track codecs = "+n.codecs)},g=function(e){var o,a=0,s=1;if(null===t&&null===(t=l.call(this,e)))throw{name:y.dependencies.ErrorHandler.prototype.HLS_DEMUX_ERROR,message:"Failed to demux, missing signalization (PAT)"};if(null===n&&null===(n=u.call(this,e,t.getPmtPid())))throw{name:y.dependencies.ErrorHandler.prototype.HLS_DEMUX_ERROR,message:"Failed to demux, missing signalization (PMT)"};for(a=i.length-1;a>=0;a--)if(m.call(this,e,i[a]),""===i[a].codecs)throw o=i[a].type,i.splice(a,1),{name:y.dependencies.ErrorHandler.prototype.HLS_DEMUX_ERROR,message:"Failed to get codec information for track "+o};for(a=0;a<i.length;a++)i[a].trackId=s,r[i[a].pid]=s,s++;return i};return{debug:void 0,reset:p,getTracks:g,demux:function(e,t){var r,o,s=0,l=-1;for(-1===a&&(a=9e4*t.startTime,this.debug.log("[HlsDemux] Media start time = "+a+" ("+t.startTime+")")),this.debug.log("[HlsDemux] Demux chunk, size = "+e.length+", nb packets = "+Math.round(e.length/x.ts.TsPacket.prototype.TS_PACKET_SIZE)),null===n&&g.call(this,e),s=0;s<i.length;s++)r=i[s],r.samples.length>0&&(r.previousCts=r.samples[r.samples.length-1].cts,r.previousDuration=r.samples[r.samples.length-1].duration),i[s].samples=[],i[s].data=null;for(s=0;s<e.length;)s+x.ts.TsPacket.prototype.TS_PACKET_SIZE<e.length?d.call(this,e.subarray(s,s+x.ts.TsPacket.prototype.TS_PACKET_SIZE)):this.debug.log("[HlsDemux] Demux chunk, residual bytes = "+(e.length-s)),s+=x.ts.TsPacket.prototype.TS_PACKET_SIZE;for(s=0;s<i.length;s++)if(r=i[s],c.call(this,r),this.debug.log("[HlsDemux]["+r.type+"] Demux: 1st PTS = "+r.samples[0].dts+" ("+r.samples[0].dts/9e4+")"),l=Math.max(l,r.samples[0].dts),(o=Math.abs(r.samples[0].dts-l)/9e4)>10)throw{name:y.dependencies.ErrorHandler.prototype.HLS_DEMUX_ERROR,message:"A/V desynchronization ("+Math.round(o)+" s.)"};return i}}},m.dependencies.HlsDemux.prototype={constructor:m.dependencies.HlsDemux},m.dependencies.HlsFragmentController=function(){var e=-1,t=function(e){var t=0,n=o.manifestModel.getValue(),r=o.hlsDemux.getTracks(new Uint8Array(e));for(t=0;t<r.length;t+=1)r[t].duration=n.mediaPresentationDuration;return o.mp4Processor.generateInitSegment(r)},n=function(e,t){var n=0,r=o.hlsDemux.demux(new Uint8Array(e),t);for(n=0;n<r.length;n+=1)"video"===r[n].type&&(t.startTime=r[n].samples[0].dts/r[n].timescale);return o.mp4Processor.generateMediaSegment(r)},r=function(e){var t=new Uint8Array(16),n=0;for(n=12;n<16;n++)t[n]=e>>8*(15-n)&255;return t},i=function(e,t){var n=new DataView(t.key.buffer),i=new Uint32Array([n.getUint32(0),n.getUint32(4),n.getUint32(8),n.getUint32(12)]);n=new DataView(r(t.iv).buffer);var o=new Uint32Array([n.getUint32(0),n.getUint32(4),n.getUint32(8),n.getUint32(12)]);return new m.dependencies.AES128Decrypter(i,o).decrypt(e)},o=y.utils.copyMethods(y.dependencies.FragmentController);return o.manifestModel=void 0,o.hlsDemux=void 0,o.mp4Processor=void 0,o.process=function(r,a,s){var l=null,u=null,d=null;if(null===r||void 0===r||0===r.byteLength)return r;if(a&&"Media Segment"===a.type&&s&&s.length>0){if(a.decryptionInfo&&"NONE"!==a.decryptionInfo.method){var c=new Date;r=i(r,a.decryptionInfo),o.debug.log("[HlsFragmentController] decrypted chunk ("+(((new Date).getTime()-c.getTime())/1e3).toFixed(3)+"s.)")}e!==a.quality&&(u=t(r),a.index=void 0,e=a.quality),l=n(r,a),null!==u&&(d=new Uint8Array(u.length+l.length),d.set(u,0),d.set(l,u.length),l=d),o.sequenceNumber++}return l},o.reset=function(){e=-1},o},m.dependencies.HlsFragmentController.prototype={constructor:m.dependencies.HlsFragmentController},m.dependencies.HlsHandler=function(){var e=function(e){var n,r,i,o=null,a=this,s=null,l=c.defer();return o=e.adaptation.period,s=o.start,n=t.manifestModel.getValue(),r=t.manifestExt.getIsDynamic(n),i=new y.vo.SegmentRequest,i.streamType=t.getType(),i.type="Initialization Segment",i.url=null,i.data=1,i.range=e.range,i.availabilityStartTime=a.timelineConverter.calcAvailabilityStartTimeFromPresentationTime(s,e.adaptation.period.mpd,r),i.availabilityEndTime=a.timelineConverter.calcAvailabilityEndTimeFromPresentationTime(s+o.duration,o.mpd,r),i.quality=e.index,l.resolve(i),l.promise},t=y.utils.copyMethods(g.dependencies.DashHandler);return t.getInitRequest=e,t},m.dependencies.HlsHandler.prototype={constructor:m.dependencies.HlsHandler},m.dependencies.HlsParser=function(){var e,t=2,n=500,r=function(e){var t=0;for(e=e.split("\n"),t=0;t<e.length;t+=1)""!==e[t]&&" "!==e[t]||(e.splice(t,1),t--);return e},i=function(e,t){return e.indexOf(t)>-1},o=function(e,t){return e.substring(t.length+1,e.length)},a=function(e){return e.substring(e.indexOf(":")+1).split(",")},s=function(e){return 0===e.indexOf("http://")||0===e.indexOf("https://")},l=function(e){var t,n={programId:"",bandwidth:0,resolution:"0x0",codecs:""},r="",i="",o=a(e[0]);for(t=o.length-1;t>=0;t-=1)if(-1===o[t].indexOf("=")&&t>0)o[t-1]+=","+o[t];else switch(r=o[t].trim().split("=")[0],i=o[t].trim().split("=")[1],r){case"PROGRAM-ID":n.programId=i;break;case"BANDWIDTH":n.bandwidth=parseInt(i,10);break;case"RESOLUTION":n.resolution=i;break;case"CODECS":n.codecs=i.replace(/"/g,"");break;case"AUDIO":n.audioId=i;break;case"SUBTITLES":n.subtitlesId=i}return n.uri=e[1],n},u=function(e){var t={},n=a(e[0]);return t.duration=parseInt(n[0],10),t.title=n[1],t.uri=e[1],t},d=function(e){var t,n,r,i={},o=a(e);for(t=0;t<o.length;t++)switch(n=o[t].trim().split("=")[0],r=o[t].trim().split("=")[1],n){case"METHOD":i.method=r;break;case"URI":i.uri=r.replace(/"/g,"");break;case"IV":i.iv=parseInt(r,16)}return i},f=function(e){var t=[],n=0;for(n=0;n<e.length;n+=1)i(e[n],"#EXT-X-STREAM-INF")&&t.push(l([e[n],e[n+1]]));return t},h=function(e,t){var n,a,l,f,h,m,g=c.defer(),v=null,_=[],b=0,E=0,T=this;for((!e||e&&e.length<0)&&g.reject({name:y.dependencies.ErrorHandler.prototype.MANIFEST_ERR_PARSE,message:"Failed to parse variant stream playlist",data:{url:t.url}}),T.debug.log(e),e=r(e),"#EXTM3U"!==e[0].trim()&&g.reject({name:y.dependencies.ErrorHandler.prototype.MANIFEST_ERR_PARSE,message:"Failed to parse variant stream playlist",data:{url:t.url}}),n={name:"SegmentList",isRoot:!1,isArray:!1,duration:0,startNumber:0,timescale:1,BaseURL:t.BaseURL,SegmentURL_asArray:[]},t[n.name]=n,a=n.SegmentURL_asArray,t.duration=1/0,m=1;m<e.length;m++)i(e[m],"#EXT-X-VERSION")?o(e[m],"#EXT-X-VERSION"):i(e[m],"#EXT-X-TARGETDURATION")?n.duration=parseInt(o(e[m],"#EXT-X-TARGETDURATION"),10):i(e[m],"#EXT-X-MEDIA-SEQUENCE")?n.startNumber=parseInt(o(e[m],"#EXT-X-MEDIA-SEQUENCE"),10):i(e[m],"#EXT-X-KEY")?(v=d(e[m]),v.uri=s(v.uri)?v.uri:n.BaseURL+v.uri,_.push(p.call(this,v))):i(e[m],"#EXTINF")?(h=u([e[m],e[m+1]]),l={name:"SegmentURL",isRoot:!1,isArray:!0,media:s(h.uri)?h.uri:n.BaseURL+h.uri,sequenceNumber:n.startNumber+E,time:0===a.length?0:a[a.length-1].time+a[a.length-1].duration,duration:h.duration},null!==v&&(l.decryptionInfo=v,void 0===l.decryptionInfo.iv&&(l.decryptionInfo.iv=l.sequenceNumber)),a.push(l),b+=h.duration,E++):i(e[m],"#EXT-X-ENDLIST")&&(t.duration=b);return f={name:"Initialization",sourceURL:t.SegmentList.SegmentURL_asArray[0].media},t.SegmentList.Initialization=f,c.all(_).then(function(){g.resolve()},function(e){g.reject(e)}),g.promise},p=function(e){var t=c.defer();this.debug.log("[HlsParser]","Load decryption key: "+e.uri);var n=new y.dependencies.XHRLoader;return n.initialize("arraybuffer",0,0),n.load(e.uri).then(function(n){e.key=new Uint8Array(n.response),t.resolve()},function(n){!n||n.aborted?t.reject():t.reject({name:y.dependencies.ErrorHandler.prototype.DOWNLOAD_ERR_MANIFEST,message:"Failed to download HLS decryption key",data:{url:e.uri,status:n.status}})}),t.promise},m=function(e,t){var n,r,i=c.defer(),o=e.Period_asArray[0],a=o.AdaptationSet_asArray[0],s=a.Representation_asArray[t],l=new y.vo.SegmentRequest,u=this;o.start=0,a.duration=s.duration,o.duration=s.duration,s.duration!==1/0&&(e.mediaPresentationDuration=s.duration),e.type=s.duration===1/0?"dynamic":"static",n=s.SegmentList.duration*s.SegmentList.SegmentURL_asArray.length,"dynamic"===e.type&&(r=new Date,e.availabilityStartTime=new Date(r.getTime()-1e3*n),e.timeShiftBufferDepth=n),e.minBufferTime=3*s.SegmentList.duration,s=a.Representation_asArray[t],l.type="Initialization Segment",l.url=s.SegmentList.Initialization.sourceURL;var d=function(e,t){var n=this.hlsDemux.getTracks(new Uint8Array(t.data)),r=0;for(e.codecs="",r=0;r<n.length;r++)e.codecs+=n[r].codecs,r<n.length-1&&(e.codecs+=",");i.resolve()},f=function(){i.resolve()};return""===s.codecs?(u.debug.log("[HlsParser]","Load initialization segment: "+l.url),u.fragmentLoader.load(l).then(d.bind(u,s),f.bind(u))):i.resolve(),i.promise},g=function(e){var t=null;return-1!==e.indexOf("/")&&(-1!==e.indexOf("?")&&(e=e.substring(0,e.indexOf("?"))),t=e.substring(0,e.lastIndexOf("/")+1)),t},v=function(r){var i=c.defer(),o=this;return this.debug.log("[HlsParser]","Load playlist manifest: "+r.url),e=new y.dependencies.XHRLoader,e.initialize("text",t,n),e.load(r.url).then(function(e){h.call(o,e.response,r).then(function(){i.resolve()},function(e){i.reject(e)})},function(e){!e||e.aborted?i.reject():i.reject({name:y.dependencies.ErrorHandler.prototype.DOWNLOAD_ERR_MANIFEST,message:"Failed to download variant stream playlist",data:{url:r.url,status:e.status}})}),i.promise},_=function(e,t){var n,r,i,o,a,l,u=c.defer(),d=[],h=[],p=0,y=[],_=this,b=0;if(!e||e.length<=0||"#EXTM3U"!==e[0].trim())return this.debug.error("[HlsParser] no stream in HLS manifest"),u.reject(),u.promise;for(n={},n.name="M3U",n.isRoot=!0,n.isArray=!0,n.parent=null,n.BaseURL=t,n.profiles="urn:mpeg:dash:profile:isoff-live:2011",n.type="static",r={},r.name="Period",r.isRoot=!1,r.isArray=!1,r.parent=n,r.duration=0,r.BaseURL=n.BaseURL,n.Period=r,n.Period_asArray=[r],d=[],r.AdaptationSet=d,r.AdaptationSet_asArray=d,y=f(e.slice(1)),y.sort(function(e,t){return e.bandwidth-t.bandwidth}),i={name:"AdaptationSet",isRoot:!1,isArray:!0,id:"video",lang:"",contentType:"video",mimeType:"video/mp4",maxWidth:0,maxHeight:0,BaseURL:r.BaseURL,Representation:h,Representation_asArray:h},b=0;b<y.length;b+=1)a=y[b],a.bandwidth>64e3&&(o={name:"Representation",isRoot:!1,isArray:!0,id:p.toString(),mimeType:"video/mp4",codecs:a.codecs,bandwidth:a.bandwidth,width:parseInt(a.resolution.split("x")[0],10),height:parseInt(a.resolution.split("x")[1],10),url:s(a.uri)?a.uri:i.BaseURL+a.uri},o.BaseURL=g(o.url),h.push(o),p++);return 0===y.length?(this.debug.error("[HlsParser] no stream in HLS manifest"),u.reject(),u.promise):(d.push(i),l=this.abrController.getPlaybackQuality("video",i),o=i.Representation_asArray[l.quality],v.call(this,o).then(function(){m.call(_,n,l.quality).then(function(){u.resolve(n)})},function(e){e?u.reject(e):u.resolve(null)}),u.promise)},b=function(e,t){return this.hlsDemux.reset(),this.debug.log("[HlsParser]","Doing parse."),this.debug.log("[HlsParser]",e),_.call(this,r(e),t)},E=function(){null!==e&&e.abort()};return{debug:void 0,config:void 0,manifestModel:void 0,fragmentLoader:void 0,abrController:void 0,hlsDemux:void 0,setup:function(){t=this.config.getParam("ManifestLoader.RetryAttempts","number",2),n=this.config.getParam("ManifestLoader.RetryInterval","number",500)},parse:b,updatePlaylist:v,abort:E}},m.dependencies.HlsParser.prototype={constructor:m.dependencies.HlsParser},p=function(){return{dependencies:{}}}(),p.dependencies.MssParser=function(){var e=["AAC","AACL","AVC1","H264","TTML","DFXP"],t={96e3:0,88200:1,64e3:2,48e3:3,44100:4,32e3:5,24e3:6,22050:7,16e3:8,12e3:9,11025:10,8e3:11,7350:12},n={video:"video/mp4",audio:"audio/mp4",text:"application/ttml+xml+mp4"},r=null,i=null,o=function(){var e,t,n={},o=[],s=this.domParser.getChildNode(r,"SmoothStreamingMedia");for(n.duration=0===parseFloat(this.domParser.getAttributeValue(s,"Duration"))?1/0:parseFloat(this.domParser.getAttributeValue(s,"Duration"))/1e7,n.BaseURL=i,t=0;t<s.childNodes.length;t++)"StreamIndex"===s.childNodes[t].nodeName&&null!==(e=a.call(this,s.childNodes[t]))&&o.push(e);return o.length>0&&(n.AdaptationSet=o.length>1?o:o[0]),n.AdaptationSet_asArray=o,n},a=function(e){var t,r,o,a,l={},u=[],c={},f=null;for(l.id=this.domParser.getAttributeValue(e,"Name"),l.lang=this.domParser.getAttributeValue(e,"Language"),l.contentType=this.domParser.getAttributeValue(e,"Type"),l.mimeType=n[l.contentType],l.subType=this.domParser.getAttributeValue(e,"Subtype"),l.maxWidth=this.domParser.getAttributeValue(e,"MaxWidth"),l.maxHeight=this.domParser.getAttributeValue(e,"MaxHeight"),l.BaseURL=i,c=d.call(this,e),f=this.domParser.getChildNodes(e,"QualityLevel"),a=0;a<f.length;a++)f[a].BaseURL=l.BaseURL,f[a].mimeType=l.mimeType,f[a].Id=l.id+"_"+this.domParser.getAttributeValue(f[a],"Index"),null!==(t=s.call(this,f[a],e))&&(t.SegmentTemplate=c,u.push(t));return 0===u.length?null:(l.Representation=u.length>1?u:u[0],l.Representation_asArray=u,l.SegmentTemplate=c,r=c.SegmentTimeline.S_asArray,o={start:r[0].t/c.timescale,end:(r[r.length-1].t+r[r.length-1].d)/c.timescale},this.metricsModel.addDVRInfo(l.contentType,new Date,o),l)},s=function(t,n){var r={},i=null;return r.id=t.Id,r.bandwidth=parseInt(this.domParser.getAttributeValue(t,"Bitrate"),10),r.mimeType=t.mimeType,r.width=parseInt(this.domParser.getAttributeValue(t,"MaxWidth"),10),r.height=parseInt(this.domParser.getAttributeValue(t,"MaxHeight"),10),i=this.domParser.getAttributeValue(t,"FourCC"),null===i&&(i=this.domParser.getAttributeValue(n,"FourCC")),null===i&&(i="AAC"),-1===e.indexOf(i.toUpperCase())?(this.debug.warn("[MssParser] Codec not supported: "+i),null):("H264"===i||"AVC1"===i?r.codecs=l.call(this,t):i.indexOf("AAC")>=0&&(r.codecs=u.call(this,t,i),r.audioSamplingRate=parseInt(this.domParser.getAttributeValue(t,"SamplingRate"),10),r.audioChannels=parseInt(this.domParser.getAttributeValue(t,"Channels"),10)),r.codecPrivateData=""+this.domParser.getAttributeValue(t,"CodecPrivateData"),r.BaseURL=t.BaseURL,r)},l=function(e){var t,n=this.domParser.getAttributeValue(e,"CodecPrivateData").toString();return t=/00000001[0-9]7/.exec(n),"avc1."+(t&&t[0]?n.substr(n.indexOf(t[0])+10,6):void 0)},u=function(e,n){var r,i,o,a,s=0,l=this.domParser.getAttributeValue(e,"CodecPrivateData").toString(),u=parseInt(this.domParser.getAttributeValue(e,"SamplingRate"),10);return"AACH"===n&&(s=5),void 0===l||""===l?(s=2,o=t[u],"AACH"===n?(s=5,l=new Uint8Array(4),a=t[2*u],l[0]=s<<3|o>>1,l[1]=o<<7|e.Channels<<3|a>>1,l[2]=a<<7|8,l[3]=0,i=new Uint16Array(2),i[0]=(l[0]<<8)+l[1],i[1]=(l[2]<<8)+l[3],r=i[0].toString(16),r=i[0].toString(16)+i[1].toString(16)):(l=new Uint8Array(2),l[0]=s<<3|o>>1,l[1]=o<<7|parseInt(this.domParser.getAttributeValue(e,"Channels"),10)<<3,i=new Uint16Array(1),i[0]=(l[0]<<8)+l[1],r=i[0].toString(16)),l=""+r,l=l.toUpperCase(),e.setAttribute("CodecPrivateData",l)):0===s&&(s=(248&parseInt(l.substr(0,2),16))>>3),"mp4a.40."+s},d=function(e){var t,n={};return t=this.domParser.getAttributeValue(e,"Url").replace("{bitrate}","$Bandwidth$"),t=t.replace("{start time}","$Time$"),n.media=t,n.timescale=1e7,n.SegmentTimeline=f.call(this,e),n},f=function(e){var t,n,r,i={},o=this.domParser.getChildNodes(e,"c"),a=[];for(t=0;t<o.length;t++)n=parseFloat(this.domParser.getAttributeValue(o[t],"t")),r=parseFloat(this.domParser.getAttributeValue(o[t],"d")),0!==t||n||(n=0),t>0&&(a[a.length-1].d||(a[a.length-1].d=n-a[a.length-1].t),n||(n=a[a.length-1].t+a[a.length-1].d)),a.push({d:r,t:n});return i.S=a,i.S_asArray=a,i},h=function(e){var t,n,r,i;return t=_.decodeArray(e.firstChild.data),n=p(t),n=new Uint16Array(n.buffer),n=String.fromCharCode.apply(null,n),r=(new DOMParser).parseFromString(n,"application/xml"),i=r.querySelector("KID").textContent,i=_.decodeArray(i),m(i),i},p=function(e){var t,n,r,i=0;for((e[i+3]<<24)+(e[i+2]<<16)+(e[i+1]<<8)+e[i],i+=4,(e[i+1]<<8)+e[i],i+=2;i<e.length;)if(t=(e[i+1]<<8)+e[i],i+=2,1===t)return n=(e[i+1]<<8)+e[i],i+=2,r=new Uint8Array(n),r.set(e.subarray(i,i+n)),r;return null},m=function(e){g(e,0,3),g(e,1,2),g(e,4,5),g(e,6,7)},g=function(e,t,n){var r=e[t];e[t]=e[n],e[n]=r},v=function(e){var t,n={},r=this.system.getObject("ksPlayReady");return t={__text:e.firstChild.data,__prefix:"mspr"},n.schemeIdUri=r.schemeIdURI,n.value=r.systemString,n.pro=t,n.pro_asArray=t,n},b=function(){var e={},t=this.system.getObject("ksWidevine");return e.schemeIdUri=t.schemeIdURI,e.value=t.systemString,e},E=function(e){var t,n,a,s,l,u,d,c,f,p={},m=[],g=this.domParser.getChildNode(r,"SmoothStreamingMedia"),_=this.domParser.getChildNode(g,"Protection"),E=null;for(p.name="MSS",p.profiles="urn:mpeg:dash:profile:isoff-live:2011",p.type=Boolean(this.domParser.getAttributeValue(g,"IsLive"))?"dynamic":"static",p.timeShiftBufferDepth=parseFloat(this.domParser.getAttributeValue(g,"DVRWindowLength"))/1e7,p.mediaPresentationDuration=0===parseFloat(this.domParser.getAttributeValue(g,"Duration"))?1/0:parseFloat(this.domParser.getAttributeValue(g,"Duration"))/1e7,p.BaseURL=i,p.minBufferTime=y.dependencies.BufferExtensions.DEFAULT_MIN_BUFFER_TIME,"dynamic"===p.type&&(p.availabilityStartTime=new Date(e.getTime()-1e3*p.timeShiftBufferDepth)),p.Period=o.call(this),p.Period_asArray=[p.Period],t=p.Period,t.start=0,void 0!==_&&(E=this.domParser.getChildNode(_,"ProtectionHeader"),E.firstChild.data=E.firstChild.data.replace(/\n|\r/g,""),s=h(E),a=v.call(this,E),a["cenc:default_KID"]=s,m.push(a),a=b.call(this,E),a["cenc:default_KID"]=s,m.push(a),p.ContentProtection=m.length>1?m:m[0],p.ContentProtection_asArray=m),n=t.AdaptationSet_asArray,f=0;f<n.length;f+=1)"static"===p.type&&"text"!==n[f].contentType&&(u=n[f].SegmentTemplate.SegmentTimeline.S_asArray[0],d=n[f].SegmentTemplate.SegmentTimeline.S_asArray[n[f].SegmentTemplate.SegmentTimeline.S_asArray.length-1],c=parseFloat(u.t)/1e7,t.start=0===t.start?c:Math.max(t.start,c),l=parseFloat(((d.t+d.d)/1e7).toFixed(3)),!isNaN(l)&&l<p.mediaPresentationDuration&&(p.mediaPresentationDuration=l,t.duration=l)),void 0!==p.ContentProtection&&(n[f].ContentProtection=p.ContentProtection,n[f].ContentProtection_asArray=p.ContentProtection_asArray);return delete p.ContentProtection,delete p.ContentProtection_asArray,p};return{debug:void 0,system:void 0,errHandler:void 0,domParser:void 0,metricsModel:void 0,parse:function(e,t){this.debug.info("[MssParser]","Doing parse.");var n=new Date,o=null,a=null,s=null;return r=this.domParser.createXmlTree(e),o=new Date,null===r?c.reject(null):(i=t,a=E.call(this,n),s=new Date,this.debug.info("[MssParser]","Parsing complete (xmlParser: "+(o.getTime()-n.getTime())+"ms, mss2dash: "+(s.getTime()-o.getTime())+"ms, total: "+((new Date).getTime()-n.getTime())/1e3+"s)"),c.when(a))}}},p.dependencies.MssParser.prototype={constructor:p.dependencies.MssParser},p.dependencies.MssHandler=function(){var e=function(e,t){var n=1;return e.audioChannels?n=e.audioChannels:t.audioChannels&&(n=t.audioChannels),n},t=function(e,t){return e.audioSamplingRate?e.audioSamplingRate:t.audioSamplingRate},n=function(n){var i,o,a,s,l,u=r.manifestModel.getValue();if(n.initData)return n.initData;if(i=n.adaptation,o=u.Period_asArray[i.period.index].AdaptationSet_asArray[i.index],a=o.Representation_asArray[n.index],s=new y.vo.Mp4Track,s.type=r.getType()||"und",s.trackId=i.index+1,s.timescale=n.timescale,s.duration=n.adaptation.period.duration,s.codecs=a.codecs,s.codecPrivateData=a.codecPrivateData,s.bandwidth=a.bandwidth,"text"!==s.type&&(l=a.mimeType+';codecs="'+a.codecs+'"',!this.capabilities.supportsCodec(this.videoModel.getElement(),l)))throw{name:y.dependencies.ErrorHandler.prototype.MEDIA_ERR_CODEC_UNSUPPORTED,message:"Codec is not supported",data:{codec:l}};return o.ContentProtection_asArray&&o.ContentProtection_asArray.length>0&&(s.contentProtection=o.ContentProtection_asArray),s.width=a.width||o.maxWidth,s.height=a.height||o.maxHeight,s.language=o.lang?o.lang:"und",s.channels=e(o,a),s.samplingRate=t(o,a),n.initData=r.mp4Processor.generateInitSegment([s]),n.initData},r=y.utils.copyMethods(g.dependencies.DashHandler);return r.mp4Processor=void 0,r.getInitRequest=function(e){var t=null,i=this,o=null,a=null,s=c.defer();if(!e)throw new Error("MssHandler.getInitRequest(): representation is undefined");t=e.adaptation.period,o=t.start,a=new y.vo.SegmentRequest,a.streamType=r.getType(),a.type="Initialization Segment",a.url=null;try{a.data=n.call(this,e)}catch(e){return s.reject(e),s.promise}return a.range=e.range,a.availabilityStartTime=i.timelineConverter.calcAvailabilityStartTimeFromPresentationTime(o,e.adaptation.period.mpd,r.getIsDynamic()),a.availabilityEndTime=i.timelineConverter.calcAvailabilityEndTimeFromPresentationTime(o+t.duration,t.mpd,r.getIsDynamic()),a.quality=e.index,s.resolve(a),s.promise},r.getIFrameRequest=function(e){return e&&e.url&&("video"===e.streamType||"audio"===e.streamType)&&(e.url=e.url.replace("Fragments","KeyFrames")),e},r.getFragmentInfoRequest=function(e){return e&&e.url&&(e.url=e.url.replace("Fragments","FragmentInfo"),e.type="FragmentInfo Segment"),e},r},p.dependencies.MssHandler.prototype={constructor:p.dependencies.MssHandler},p.dependencies.MssFragmentController=function(){var e=function(e,t,n,r){for(var i,o=this.manifestModel.getValue(),a=!1,s=r.SegmentTemplate.SegmentTimeline.S,l=t.entry,u=0,d=0,c=null,f=0,h=0,p=0,m=-1,g=null;h<l.length;)u=l[h].fragment_absolute_time,d=l[h].fragment_duration,c=s[s.length-1],f=c.t,u>f&&(this.debug.log("[MssFragmentController] Add new segment - t = "+u/1e7),s.push({t:u,d:d}),a=!0),h+=1;for(p=s.length-1;p>=0;p-=1)if(s[p].t===n.baseMediaDecodeTime){m=p;break}if(m>=0)for(h=0;h<l.length;h+=1)m+h<s.length&&(f=s[m+h].t)+s[m+h].d!==l[h].fragment_absolute_time&&(s[m+h].t=l[h].fragment_absolute_time,s[m+h].d=l[h].fragment_duration,this.debug.log("[MssFragmentController] Correct tfrf time  = "+l[h].fragment_absolute_time+"and duration = "+l[h].fragment_duration+"! ********"),a=!0);if(o.timeShiftBufferDepth&&o.timeShiftBufferDepth>0){if(a)for(c=s[s.length-1],f=c.t,g=f-1e7*o.timeShiftBufferDepth,c=s[0];c.t<g;)this.debug.log("[MssFragmentController] Remove segment  - t = "+c.t/1e7),s.splice(0,1),c=s[0];i={start:s[0].t/r.SegmentTemplate.timescale,end:n.baseMediaDecodeTime/r.SegmentTemplate.timescale+e.duration};var y=this.metricsModel.getMetricsFor(r.type).DVRInfo;y&&y.length>0&&i.end>y[y.length-1].range.end&&this.metricsModel.addDVRInfo(r.type,new Date,i)}return a},t=function(t,n,r){var i,o=null,a=null,s=null,l=null,u=null,d=0;if(o=S.deserialize(t),a=o.getBoxByType("moof"),s=a.getBoxByType("traf"),l=s.getBoxByType("tfdt"),null===l&&(l=new S.boxes.TrackFragmentBaseMediaDecodeTimeBox,l.version=1,l.flags=0,l.baseMediaDecodeTime=Math.floor(n.startTime*n.timescale),i=s.getBoxIndexByType("tfhd"),s.boxes.splice(i+1,0,l)),u=s.getBoxesByType("tfrf"),0!==u.length)for(d=0;d<u.length;d+=1)e.call(this,n,u[d],l,r)},n=function(e,t){var n,r,i,o,a,s=null,l=null,u=null,d=null,c=null,f=null;for(s=e.getBoxByType("moof"),l=e.getBoxByType("mdat"),u=s.getBoxByType("traf"),d=u.getBoxByType("trun"),n=u.getBoxByType("tfhd"),void 0===d.samples_table[0].sample_duration&&(d.samples_table[0].sample_duration=n.default_sample_duration),i=Math.floor(t/d.samples_table[0].sample_duration),r=0;r<i-1;r++)d.samples_table.push(d.samples_table[0]);if(o=i*d.samples_table[0].sample_duration,o<t&&(d.samples_table[d.samples_table.length-1].sample_duration+=t-o),d.sample_count=d.samples_table.length,null!==(c=u.getBoxByType("sepiff"))){for(c.sample_count>1&&(c.entry=c.entry.slice(0,1)),r=0;r<i-1;r+=1)c.entry.push(c.entry[0]);c.sample_count=c.entry.length}if(null!==(f=u.getBoxByType("saiz"))){if(0===f.default_sample_info_size)for(f.sample_count>1&&(f.sample_info_size=f.sample_info_size.slice(0,1)),r=0;r<i-1;r+=1)f.sample_info_size.push(f.sample_info_size[0]);f.sample_count=c.entry.length}for(a=l.data,l.data=new Uint8Array(a.length*d.sample_count),r=0;r<d.sample_count;r+=1)l.data.set(a,a.length*r)},r=function(t,r,i){var o,a,s=0,l=this.manifestModel.getValue(),u=l?this.manifestExt.getIndex(i,l)+1:-1,d=S.deserialize(t),c=null,f=null,h=null,p=null,m=null,g=null,y=null,v=null,_=null,b=null,E=-1,T=0,x=0,w=0,I=0;if(!d)return null;if(c=d.getBoxByType("moof"),f=d.getBoxByType("mdat"),h=c.getBoxByType("traf"),p=h.getBoxByType("trun"),m=h.getBoxByType("tfhd"),a=void 0!==p.samples_table[0].sample_duration?p.samples_table[0].sample_duration:m.default_sample_duration,o=r.duration*r.timescale,1===p.samples_table.length&&a<o&&n(d,o),m.track_ID=u,h.removeBoxByType("tfxd"),_=h.getBoxByType("tfdt"),null===_&&(_=new S.boxes.TrackFragmentBaseMediaDecodeTimeBox,_.version=1,_.flags=0,_.baseMediaDecodeTime=Math.floor(r.startTime*r.timescale),E=h.getBoxIndexByType("tfhd"),h.boxes.splice(E+1,0,_)),b=h.getBoxesByType("tfrf"),0!==b.length)for(s=0;s<b.length;s+=1)e.call(this,r,b[s],_,i),h.removeBoxByType("tfrf");if(null!==(y=h.getBoxByType("sepiff"))&&(y.boxtype="senc",y.extended_type=void 0,null===(g=h.getBoxByType("saio")))){if(g=new S.boxes.SampleAuxiliaryInformationOffsetsBox,g.version=0,g.flags=0,g.entry_count=1,g.offset=[],v=new S.boxes.SampleAuxiliaryInformationSizesBox,v.version=0,v.flags=0,v.sample_count=y.sample_count,v.default_sample_info_size=0,v.sample_info_size=[],2&y.flags)for(s=0;s<y.sample_count;s+=1)v.sample_info_size[s]=10+6*y.entry[s].NumberOfEntries;else v.default_sample_info_size=8;h.boxes.push(v),h.boxes.push(g)}return m.flags&=16777214,m.flags|=131072,p.flags|=1,p.data_offset=0,T=d.getLength(),p.data_offset=T-f.size+8,g=h.getBoxByType("saio"),null!==g&&(x=d.getBoxOffsetByType("moof"),w=c.getBoxOffsetByType("traf"),I=h.getBoxOffsetByType("senc"),g.offset[0]=x+w+I+16),S.serialize(d)},i=y.utils.copyMethods(y.dependencies.FragmentController);return i.manifestModel=void 0,i.manifestExt=void 0,i.metricsModel=void 0,i.process=function(e,n,i){var o=null,a=this.manifestModel.getValue(),s=null;if(!(null!==e&&void 0!==e&&e.byteLength>0))return null;if(o=new Uint8Array(e),a&&i&&i.length>0&&(s=a.Period_asArray[i[0].adaptation.period.index].AdaptationSet_asArray[i[0].adaptation.index],n))if("Media Segment"===n.type){if(!(o=r.call(this,o,n,s)))return null}else"FragmentInfo Segment"===n.type&&t.call(this,o,n,s);return o},i},p.dependencies.MssFragmentController.prototype={constructor:p.dependencies.MssFragmentController};var v={};v.encode=function(e){for(var t=[],n=0;n<e.length;++n){var r=e.charCodeAt(n);r<128?t.push(r):r<2048?(t.push(192|r>>6),t.push(128|63&r)):r<65536?(t.push(224|r>>12),t.push(128|63&r>>6),t.push(128|63&r)):(t.push(240|r>>18),t.push(128|63&r>>12),t.push(128|63&r>>6),t.push(128|63&r))}return t},v.decode=function(e){for(var t=[],n=0;n<e.length;){var r=e[n++];r<128||(r<224?(r=(31&r)<<6,r|=63&e[n++]):r<240?(r=(15&r)<<12,r|=(63&e[n++])<<6,r|=63&e[n++]):(r=(7&r)<<18,r|=(63&e[n++])<<12,r|=(63&e[n++])<<6,r|=63&e[n++])),t.push(String.fromCharCode(r))}return t.join("")};var _={};if(function(e){var t=function(t){for(var n=0,r=[],i=0|t.length/3;0<i--;){var o=(t[n]<<16)+(t[n+1]<<8)+t[n+2];n+=3,r.push(e.charAt(63&o>>18)),r.push(e.charAt(63&o>>12)),r.push(e.charAt(63&o>>6)),r.push(e.charAt(63&o))}if(2==t.length-n){var o=(t[n]<<16)+(t[n+1]<<8);r.push(e.charAt(63&o>>18)),r.push(e.charAt(63&o>>12)),r.push(e.charAt(63&o>>6)),r.push("=")}else if(1==t.length-n){var o=t[n]<<16;r.push(e.charAt(63&o>>18)),r.push(e.charAt(63&o>>12)),r.push("==")}return r.join("")},n=function(){for(var t=[],n=0;n<e.length;++n)t[e.charCodeAt(n)]=n;return t["=".charCodeAt(0)]=0,t}(),r=function(e){for(var t=0,r=[],i=0|e.length/4;0<i--;){var o=(n[e.charCodeAt(t)]<<18)+(n[e.charCodeAt(t+1)]<<12)+(n[e.charCodeAt(t+2)]<<6)+n[e.charCodeAt(t+3)];r.push(255&o>>16),r.push(255&o>>8),r.push(255&o),t+=4}return r&&("="==e.charAt(t-2)?(r.pop(),r.pop()):"="==e.charAt(t-1)&&r.pop()),r},i={};i.encode=function(e){for(var t=[],n=0;n<e.length;++n)t.push(e.charCodeAt(n));return t},i.decode=function(e){for(var t=0;t<s.length;++t)a[t]=String.fromCharCode(a[t]);return a.join("")},_.decodeArray=function(e){var t=r(e);return new Uint8Array(t)},_.encodeASCII=function(e){var n=i.encode(e);return t(n)},_.decodeASCII=function(e){var t=r(e);return i.decode(t)},_.encode=function(e){var n=v.encode(e);return t(n)},_.decode=function(e){var t=r(e);return v.decode(t)}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),void 0===b)var b=_.encode;if(void 0===E)var E=_.decode;if(function(e){e=window;var t={VERSION:"0.5.3"};t.System=function(){this._mappings={},this._outlets={},this._handlers={},this.strictInjections=!0,this.autoMapOutlets=!1,this.postInjectionHook="setup"},t.System.prototype={_createAndSetupInstance:function(e,t){var n=new t;return this.injectInto(n,e),n},_retrieveFromCacheOrCreate:function(e,t){void 0===t&&(t=!1);var n;if(!this._mappings.hasOwnProperty(e))throw new Error(1e3);var r=this._mappings[e];return!t&&r.isSingleton?(null==r.object&&(r.object=this._createAndSetupInstance(e,r.clazz)),n=r.object):n=r.clazz?this._createAndSetupInstance(e,r.clazz):r.object,n},mapOutlet:function(e,t,n){if(void 0===e)throw new Error(1010);return t=t||"global",n=n||e,this._outlets.hasOwnProperty(t)||(this._outlets[t]={}),this._outlets[t][n]=e,this},getObject:function(e){if(void 0===e)throw new Error(1020);return this._retrieveFromCacheOrCreate(e)},mapValue:function(e,t){if(void 0===e)throw new Error(1030);return this._mappings[e]={clazz:null,object:t,isSingleton:!0},this.autoMapOutlets&&this.mapOutlet(e),this.hasMapping(e)&&this.injectInto(t,e),this},hasMapping:function(e){if(void 0===e)throw new Error(1040);return this._mappings.hasOwnProperty(e)},mapClass:function(e,t){if(void 0===e)throw new Error(1050);if(void 0===t)throw new Error(1051);return this._mappings[e]={clazz:t,object:null,isSingleton:!1},this.autoMapOutlets&&this.mapOutlet(e),this},mapSingleton:function(e,t){if(void 0===e)throw new Error(1060);if(void 0===t)throw new Error(1061);return this._mappings[e]={clazz:t,object:null,isSingleton:!0},this.autoMapOutlets&&this.mapOutlet(e),this},instantiate:function(e){if(void 0===e)throw new Error(1070);return this._retrieveFromCacheOrCreate(e,!0)},injectInto:function(e,t){if(void 0===e)throw new Error(1080);if("object"===(void 0===e?"undefined":d(e))){var n=[];this._outlets.hasOwnProperty("global")&&n.push(this._outlets.global),void 0!==t&&this._outlets.hasOwnProperty(t)&&n.push(this._outlets[t]);for(var r in n){var i=n[r];for(var o in i){var a=i[o];(!this.strictInjections||o in e)&&(e[o]=this.getObject(a))}}"setup"in e&&e.setup.call(e)}return this},unmap:function(e){if(void 0===e)throw new Error(1090);return delete this._mappings[e],this},unmapOutlet:function(e,t){if(void 0===e)throw new Error(1100);if(void 0===t)throw new Error(1101);return delete this._outlets[e][t],this},mapHandler:function(e,t,n,r,i){if(void 0===e)throw new Error(1110);return t=t||"global",n=n||e,void 0===r&&(r=!1),void 0===i&&(i=!1),this._handlers.hasOwnProperty(e)||(this._handlers[e]={}),this._handlers[e].hasOwnProperty(t)||(this._handlers[e][t]=[]),this._handlers[e][t].push({handler:n,oneShot:r,passEvent:i}),this},unmapHandler:function(e,t,n){if(void 0===e)throw new Error(1120);if(t=t||"global",this._handlers.hasOwnProperty(e)&&this._handlers[e].hasOwnProperty(t)){var r=this._handlers[e][t];for(var i in r){var o=r[i];if(!n||o.handler===n){r.splice(i,1);break}}}return this},notify:function(e){if(void 0===e)throw new Error(1130);var t=Array.prototype.slice.call(arguments),n=t.slice(1);if(this._handlers.hasOwnProperty(e)){var r=this._handlers[e];for(var i in r){var o,a=r[i];"global"!==i&&(o=this.getObject(i));var s,l,u=[];for(s=0,l=a.length;s<l;s++){var d,c=a[s];d=o&&"string"==typeof c.handler?o[c.handler]:c.handler,c.oneShot&&u.unshift(s),c.passEvent?d.apply(o,t):d.apply(o,n)}for(s=0,l=u.length;s<l;s++)a.splice(u[s],1)}}return this}},e.dijon=t}(this),f={},f.math={},f.math.Long=function(e,t){this.low_=0|e,this.high_=0|t},f.math.Long.IntCache_={},f.math.Long.fromInt=function(e){if(-128<=e&&e<128){var t=f.math.Long.IntCache_[e];if(t)return t}var n=new f.math.Long(0|e,e<0?-1:0);return-128<=e&&e<128&&(f.math.Long.IntCache_[e]=n),n},f.math.Long.fromNumber=function(e){return isNaN(e)||!isFinite(e)?f.math.Long.ZERO:e<=-f.math.Long.TWO_PWR_63_DBL_?f.math.Long.MIN_VALUE:e+1>=f.math.Long.TWO_PWR_63_DBL_?f.math.Long.MAX_VALUE:e<0?f.math.Long.fromNumber(-e).negate():new f.math.Long(e%f.math.Long.TWO_PWR_32_DBL_|0,e/f.math.Long.TWO_PWR_32_DBL_|0)},f.math.Long.fromBits=function(e,t){return new f.math.Long(e,t)},f.math.Long.fromString=function(e,t){if(0==e.length)throw Error("number format error: empty string");var n=t||10;if(n<2||36<n)throw Error("radix out of range: "+n);if("-"==e.charAt(0))return f.math.Long.fromString(e.substring(1),n).negate();if(e.indexOf("-")>=0)throw Error('number format error: interior "-" character: '+e);for(var r=f.math.Long.fromNumber(Math.pow(n,8)),i=f.math.Long.ZERO,o=0;o<e.length;o+=8){var a=Math.min(8,e.length-o),s=parseInt(e.substring(o,o+a),n);if(a<8){var l=f.math.Long.fromNumber(Math.pow(n,a));i=i.multiply(l).add(f.math.Long.fromNumber(s))}else i=i.multiply(r),i=i.add(f.math.Long.fromNumber(s))}return i},f.math.Long.TWO_PWR_16_DBL_=65536,f.math.Long.TWO_PWR_24_DBL_=1<<24,f.math.Long.TWO_PWR_32_DBL_=f.math.Long.TWO_PWR_16_DBL_*f.math.Long.TWO_PWR_16_DBL_,f.math.Long.TWO_PWR_31_DBL_=f.math.Long.TWO_PWR_32_DBL_/2,f.math.Long.TWO_PWR_48_DBL_=f.math.Long.TWO_PWR_32_DBL_*f.math.Long.TWO_PWR_16_DBL_,f.math.Long.TWO_PWR_64_DBL_=f.math.Long.TWO_PWR_32_DBL_*f.math.Long.TWO_PWR_32_DBL_,f.math.Long.TWO_PWR_63_DBL_=f.math.Long.TWO_PWR_64_DBL_/2,f.math.Long.ZERO=f.math.Long.fromInt(0),f.math.Long.ONE=f.math.Long.fromInt(1),f.math.Long.NEG_ONE=f.math.Long.fromInt(-1),f.math.Long.MAX_VALUE=f.math.Long.fromBits(-1,2147483647),f.math.Long.MIN_VALUE=f.math.Long.fromBits(0,-2147483648),f.math.Long.TWO_PWR_24_=f.math.Long.fromInt(1<<24),f.math.Long.prototype.toInt=function(){return this.low_},f.math.Long.prototype.toNumber=function(){return this.high_*f.math.Long.TWO_PWR_32_DBL_+this.getLowBitsUnsigned()},f.math.Long.prototype.toString=function(e){var t=e||10;if(t<2||36<t)throw Error("radix out of range: "+t);if(this.isZero())return"0";if(this.isNegative()){if(this.equals(f.math.Long.MIN_VALUE)){var n=f.math.Long.fromNumber(t),r=this.div(n),i=r.multiply(n).subtract(this);return r.toString(t)+i.toInt().toString(t)}return"-"+this.negate().toString(t)}for(var o=f.math.Long.fromNumber(Math.pow(t,6)),i=this,a="";;){var s=i.div(o),l=i.subtract(s.multiply(o)).toInt(),u=l.toString(t);if(i=s,i.isZero())return u+a;for(;u.length<6;)u="0"+u;a=""+u+a}},f.math.Long.prototype.getHighBits=function(){return this.high_},f.math.Long.prototype.getLowBits=function(){return this.low_},f.math.Long.prototype.getLowBitsUnsigned=function(){return this.low_>=0?this.low_:f.math.Long.TWO_PWR_32_DBL_+this.low_},f.math.Long.prototype.getNumBitsAbs=function(){if(this.isNegative())return this.equals(f.math.Long.MIN_VALUE)?64:this.negate().getNumBitsAbs();for(var e=0!=this.high_?this.high_:this.low_,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high_?t+33:t+1},f.math.Long.prototype.isZero=function(){return 0==this.high_&&0==this.low_},f.math.Long.prototype.isNegative=function(){return this.high_<0},f.math.Long.prototype.isOdd=function(){return 1==(1&this.low_)},f.math.Long.prototype.equals=function(e){return this.high_==e.high_&&this.low_==e.low_},f.math.Long.prototype.notEquals=function(e){return this.high_!=e.high_||this.low_!=e.low_},f.math.Long.prototype.lessThan=function(e){return this.compare(e)<0},f.math.Long.prototype.lessThanOrEqual=function(e){return this.compare(e)<=0},f.math.Long.prototype.greaterThan=function(e){return this.compare(e)>0},f.math.Long.prototype.greaterThanOrEqual=function(e){return this.compare(e)>=0},f.math.Long.prototype.compare=function(e){if(this.equals(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.subtract(e).isNegative()?-1:1},f.math.Long.prototype.negate=function(){return this.equals(f.math.Long.MIN_VALUE)?f.math.Long.MIN_VALUE:this.not().add(f.math.Long.ONE)},f.math.Long.prototype.add=function(e){var t=this.high_>>>16,n=65535&this.high_,r=this.low_>>>16,i=65535&this.low_,o=e.high_>>>16,a=65535&e.high_,s=e.low_>>>16,l=65535&e.low_,u=0,d=0,c=0,h=0;return h+=i+l,c+=h>>>16,h&=65535,c+=r+s,d+=c>>>16,c&=65535,d+=n+a,u+=d>>>16,d&=65535,u+=t+o,u&=65535,f.math.Long.fromBits(c<<16|h,u<<16|d)},f.math.Long.prototype.subtract=function(e){return this.add(e.negate())},f.math.Long.prototype.multiply=function(e){if(this.isZero())return f.math.Long.ZERO;if(e.isZero())return f.math.Long.ZERO;if(this.equals(f.math.Long.MIN_VALUE))return e.isOdd()?f.math.Long.MIN_VALUE:f.math.Long.ZERO;if(e.equals(f.math.Long.MIN_VALUE))return this.isOdd()?f.math.Long.MIN_VALUE:f.math.Long.ZERO;if(this.isNegative())return e.isNegative()?this.negate().multiply(e.negate()):this.negate().multiply(e).negate();if(e.isNegative())return this.multiply(e.negate()).negate();if(this.lessThan(f.math.Long.TWO_PWR_24_)&&e.lessThan(f.math.Long.TWO_PWR_24_))return f.math.Long.fromNumber(this.toNumber()*e.toNumber());var t=this.high_>>>16,n=65535&this.high_,r=this.low_>>>16,i=65535&this.low_,o=e.high_>>>16,a=65535&e.high_,s=e.low_>>>16,l=65535&e.low_,u=0,d=0,c=0,h=0;return h+=i*l,c+=h>>>16,h&=65535,c+=r*l,d+=c>>>16,c&=65535,c+=i*s,d+=c>>>16,c&=65535,d+=n*l,u+=d>>>16,d&=65535,d+=r*s,u+=d>>>16,d&=65535,d+=i*a,u+=d>>>16,d&=65535,u+=t*l+n*s+r*a+i*o,u&=65535,f.math.Long.fromBits(c<<16|h,u<<16|d)},f.math.Long.prototype.div=function(e){if(e.isZero())throw Error("division by zero");if(this.isZero())return f.math.Long.ZERO;if(this.equals(f.math.Long.MIN_VALUE)){if(e.equals(f.math.Long.ONE)||e.equals(f.math.Long.NEG_ONE))return f.math.Long.MIN_VALUE;if(e.equals(f.math.Long.MIN_VALUE))return f.math.Long.ONE;var t=this.shiftRight(1),n=t.div(e).shiftLeft(1);if(n.equals(f.math.Long.ZERO))return e.isNegative()?f.math.Long.ONE:f.math.Long.NEG_ONE;var r=this.subtract(e.multiply(n));return n.add(r.div(e))}if(e.equals(f.math.Long.MIN_VALUE))return f.math.Long.ZERO;if(this.isNegative())return e.isNegative()?this.negate().div(e.negate()):this.negate().div(e).negate();if(e.isNegative())return this.div(e.negate()).negate();for(var i=f.math.Long.ZERO,r=this;r.greaterThanOrEqual(e);){for(var n=Math.max(1,Math.floor(r.toNumber()/e.toNumber())),o=Math.ceil(Math.log(n)/Math.LN2),a=o<=48?1:Math.pow(2,o-48),s=f.math.Long.fromNumber(n),l=s.multiply(e);l.isNegative()||l.greaterThan(r);)n-=a,s=f.math.Long.fromNumber(n),l=s.multiply(e);s.isZero()&&(s=f.math.Long.ONE),i=i.add(s),r=r.subtract(l)}return i},f.math.Long.prototype.modulo=function(e){return this.subtract(this.div(e).multiply(e))},f.math.Long.prototype.not=function(){return f.math.Long.fromBits(~this.low_,~this.high_)},f.math.Long.prototype.and=function(e){return f.math.Long.fromBits(this.low_&e.low_,this.high_&e.high_)},f.math.Long.prototype.or=function(e){return f.math.Long.fromBits(this.low_|e.low_,this.high_|e.high_)},f.math.Long.prototype.xor=function(e){return f.math.Long.fromBits(this.low_^e.low_,this.high_^e.high_)},f.math.Long.prototype.shiftLeft=function(e){if(0==(e&=63))return this;var t=this.low_;if(e<32){var n=this.high_;return f.math.Long.fromBits(t<<e,n<<e|t>>>32-e)}return f.math.Long.fromBits(0,t<<e-32)},f.math.Long.prototype.shiftRight=function(e){if(0==(e&=63))return this;var t=this.high_;if(e<32){var n=this.low_;return f.math.Long.fromBits(n>>>e|t<<32-e,t>>e)}return f.math.Long.fromBits(t>>e-32,t>=0?0:-1)},f.math.Long.prototype.shiftRightUnsigned=function(e){if(0==(e&=63))return this;var t=this.high_;if(e<32){var n=this.low_;return f.math.Long.fromBits(n>>>e|t<<32-e,t>>>e)}return 32==e?f.math.Long.fromBits(t,0):f.math.Long.fromBits(t>>>e-32,0)},void 0===T)var T={};void 0===T.Math&&(T.Math={}),T.Math.to64BitNumber=function(e,t){var n,r,i;return n=new f.math.Long(0,t),r=new f.math.Long(e,0),i=n.add(r),i.toNumber()},/*!
 *
 * Copyright 2009-2012 Kris Kowal under the terms of the MIT
 * license found at http://github.com/kriskowal/q/raw/master/LICENSE
 *
 * With parts by Tyler Close
 * Copyright 2007-2009 Tyler Close under the terms of the MIT X license found
 * at http://www.opensource.org/licenses/mit-license.html
 * Forked at ref_send.js version: 2009-05-11
 *
 * With parts by Mark Miller
 * Copyright (C) 2011 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */
function(e){c=function(){function e(e){var t=Function.call;return function(){return t.apply(e,arguments)}}function t(e){return"[object StopIteration]"===ue(e)||e instanceof te}function r(e,t){t.stack&&"object"===(void 0===e?"undefined":d(e))&&null!==e&&e.stack&&-1===e.stack.indexOf(de)&&(e.stack=i(e.stack)+"\n"+de+"\n"+i(t.stack))}function i(e){for(var t=e.split("\n"),n=[],r=0;r<t.length;++r){var i=t[r];s(i)||a(i)||n.push(i)}return n.join("\n")}function a(e){return-1!==e.indexOf("(module.js:")||-1!==e.indexOf("(node.js:")}function s(e){var t=/at .+ \((.*):(\d+):\d+\)/.exec(e);if(!t)return!1;var n=t[1],r=t[2];return n===Z&&r>=$&&r<=pe}function l(){if(Error.captureStackTrace){var e,t,n=Error.prepareStackTrace;return Error.prepareStackTrace=function(n,r){e=r[1].getFileName(),t=r[1].getLineNumber()},(new Error).stack,Error.prepareStackTrace=n,Z=e,t}}function u(e){return T(e)}function c(){function e(e){n&&(t=T(e),re(n,function(e,n){J(function(){t.promiseDispatch.apply(t,n)})},void 0),n=void 0,r=void 0)}var t,n=[],r=[],i=ae(c.prototype),o=ae(h.prototype);return o.promiseDispatch=function(e,i,o){var a=ne(arguments);n?(n.push(a),"when"===i&&o[1]&&r.push(o[1])):J(function(){t.promiseDispatch.apply(t,a)})},o.valueOf=function(){return n?o:t=p(t)},Error.captureStackTrace&&u.longStackJumpLimit>0&&(Error.captureStackTrace(o,c),o.stack=o.stack.substring(o.stack.indexOf("\n")+1)),i.promise=o,i.resolve=e,i.fulfill=function(t){e(E(t))},i.reject=function(t){e(b(t))},i.notify=function(e){n&&re(r,function(t,n){J(function(){n(e)})},void 0)},i}function f(e){var t=c();return O(e,t.resolve,t.reject,t.notify).fail(t.reject),t.promise}function h(e,t,n,r,i){void 0===t&&(t=function(e){return b(new Error("Promise does not support operation: "+e))});var o=ae(h.prototype);return o.promiseDispatch=function(n,r,i){var a;try{a=e[r]?e[r].apply(o,i):t.call(o,r,i)}catch(e){a=b(e)}n&&n(a)},n&&(o.valueOf=n),i&&(o.exception=r),o}function p(e){return m(e)?e.valueOf():e}function m(e){return e&&"function"==typeof e.promiseDispatch}function g(e){return e&&"function"==typeof e.then}function y(e){return!v(e)&&!_(e)}function v(e){return!g(p(e))}function _(e){return e=p(e),m(e)&&"exception"in e}function b(e){var t=h({when:function(t){if(t){var n=ie(ce,this);-1!==n&&(fe.splice(n,1),ce.splice(n,1))}return t?t(e):this}},function(){return b(e)},function(){return this},e,!0);return ce.push(t),fe.push(e),t}function E(e){return h({when:function(){return e},get:function(t){return e[t]},set:function(t,n){e[t]=n},delete:function(t){delete e[t]},post:function(t,n){return null==t?e.apply(void 0,n):e[t].apply(e,n)},apply:function(t,n){return e.apply(t,n)},keys:function(){return le(e)}},void 0,function(){return e})}function T(e){return m(e)?e:(e=p(e),g(e)?S(e):E(e))}function S(e){var t=c();return J(function(){try{e.then(t.resolve,t.reject,t.notify)}catch(e){t.reject(e)}}),t.promise}function x(e){return h({isDef:function(){}},function(t,n){return P(e,t,n)},function(){return p(e)})}function w(e,t,n,i){function o(e){try{return"function"==typeof t?t(e):e}catch(e){return b(e)}}function a(e){if("function"==typeof n){r(e,f);try{return n(e)}catch(e){return b(e)}}return b(e)}function s(e){return"function"==typeof i?i(e):e}var l=c(),d=!1,f=T(e);return J(function(){f.promiseDispatch(function(e){d||(d=!0,l.resolve(o(e)))},"when",[function(e){d||(d=!0,l.resolve(a(e)))}])}),f.promiseDispatch(void 0,"when",[void 0,function(e){var t,n=!1;try{t=s(e)}catch(e){if(n=!0,!u.onerror)throw e;u.onerror(e)}n||l.notify(t)}]),l.promise}function I(e,t,n){return w(e,function(e){return N(e).then(function(e){return t.apply(void 0,e)},n)},n)}function D(e){return function(){function n(e,n){var a;try{a=r[e](n)}catch(e){return t(e)?e.value:b(e)}return w(a,i,o)}var r=e.apply(this,arguments),i=n.bind(n,"send"),o=n.bind(n,"throw");return i()}}function R(e){throw new te(e)}function A(e){return function(){return I([this,N(arguments)],function(t,n){return e.apply(t,n)})}}function P(e,t,n){var r=c();return J(function(){T(e).promiseDispatch(r.resolve,t,n)}),r.promise}function M(e){return function(t){var n=ne(arguments,1);return P(t,e,n)}}function L(e,t){var n=ne(arguments,2);return he(e,t,n)}function C(e,t){return P(e,"apply",[void 0,t])}function O(e){return C(e,ne(arguments,1))}function k(e){var t=ne(arguments,1);return function(){var n=t.concat(ne(arguments));return P(e,"apply",[this,n])}}function N(e){return w(e,function(e){var t=e.length;if(0===t)return T(e);var n=c();return re(e,function(r,i,o){v(i)?(e[o]=p(i),0==--t&&n.resolve(e)):w(i,function(r){e[o]=r,0==--t&&n.resolve(e)}).fail(n.reject)},void 0),n.promise})}function F(e){return w(e,function(e){return e=oe(e,T),w(N(oe(e,function(e){return w(e,ee,ee)})),function(){return e})})}function B(e,t){return w(e,void 0,t)}function U(e,t){return w(e,void 0,void 0,t)}function j(e,t){return w(e,function(e){return w(t(),function(){return e})},function(e){return w(t(),function(){return b(e)})})}function H(e,t,i,o){var a=function(t){J(function(){if(r(t,e),!u.onerror)throw t;u.onerror(t)})},s=t||i||o?w(e,t,i,o):e;"object"===(void 0===n?"undefined":d(n))&&n&&n.domain&&(a=n.domain.bind(a)),B(s,a)}function q(e,t){var n=c(),r=setTimeout(function(){n.reject(new Error("Timed out after "+t+" ms"))},t);return w(e,function(e){clearTimeout(r),n.resolve(e)},function(e){clearTimeout(r),n.reject(e)}),n.promise}function V(e,t){void 0===t&&(t=e,e=void 0);var n=c();return setTimeout(function(){n.resolve(e)},t),n.promise}function G(e,t){var n=ne(t),r=c();return n.push(r.makeNodeResolver()),C(e,n).fail(r.reject),r.promise}function K(e){var t=ne(arguments,1),n=c();return t.push(n.makeNodeResolver()),C(e,t).fail(n.reject),n.promise}function z(e){var t=ne(arguments,1);return function(){var n=t.concat(ne(arguments)),r=c();return n.push(r.makeNodeResolver()),C(e,n).fail(r.reject),r.promise}}function Y(e){var t=ne(arguments,1);return function(){function n(){return e.apply(o,arguments)}var r=t.concat(ne(arguments)),i=c();r.push(i.makeNodeResolver());var o=this;return C(n,r).fail(i.reject),i.promise}}function W(e,t,n){var r=ne(n||[]),i=c();return r.push(i.makeNodeResolver()),he(e,t,r).fail(i.reject),i.promise}function X(e,t){var n=ne(arguments,2),r=c();return n.push(r.makeNodeResolver()),he(e,t,n).fail(r.reject),r.promise}function Q(e,t){if(!t)return e;e.then(function(e){J(function(){t(null,e)})},function(e){J(function(){t(e)})})}var Z,J,$=l(),ee=function(){};void 0!==n?J=n.nextTick:"function"==typeof o?J="undefined"!=typeof window?o.bind(window):o:function(){function e(){if(--o,++s>=i){s=0,i*=4;for(var e=a&&Math.min(a-1,i);o<e;)++o,t()}for(;a;){--a,n=n.next;var r=n.task;n.task=void 0,r()}s=0}var t,n={task:void 0,next:null},r=n,i=2,o=0,a=0,s=0;if(J=function(e){r=r.next={task:e,next:null},o<++a&&o<i&&(++o,t())},"undefined"!=typeof MessageChannel){var l=new MessageChannel;l.port1.onmessage=e,t=function(){l.port2.postMessage(0)}}else t=function(){setTimeout(e,0)}}();var te,ne=e(Array.prototype.slice),re=e(Array.prototype.reduce||function(e,t){var n=0,r=this.length;if(1===arguments.length)for(;;){if(n in this){t=this[n++];break}if(++n>=r)throw new TypeError}for(;n<r;n++)n in this&&(t=e(t,this[n],n));return t}),ie=e(Array.prototype.indexOf||function(e){for(var t=0;t<this.length;t++)if(this[t]===e)return t;return-1}),oe=e(Array.prototype.map||function(e,t){var n=this,r=[];return re(n,function(i,o,a){r.push(e.call(t,o,a,n))},void 0),r}),ae=Object.create||function(e){function t(){}return t.prototype=e,new t},se=e(Object.prototype.hasOwnProperty),le=Object.keys||function(e){var t=[];for(var n in e)se(e,n)&&t.push(n);return t},ue=e(Object.prototype.toString);te="undefined"!=typeof ReturnValue?ReturnValue:function(e){this.value=e},u.longStackJumpLimit=1;var de="From previous event:";u.nextTick=J,u.defer=c,c.prototype.makeNodeResolver=function(){var e=this;return function(t,n){t?e.reject(t):arguments.length>2?e.resolve(ne(arguments,1)):e.resolve(n)}},u.promise=f,u.makePromise=h,h.prototype.then=function(e,t,n){return w(this,e,t,n)},h.prototype.thenResolve=function(e){return w(this,function(){return e})},re(["isFulfilled","isRejected","isPending","dispatch","when","spread","get","put","set","del","delete","post","send","invoke","keys","fapply","fcall","fbind","all","allResolved","timeout","delay","catch","finally","fail","fin","progress","done","nfcall","nfapply","nfbind","denodeify","nbind","ncall","napply","nbind","npost","nsend","ninvoke","nodeify"],function(e,t){h.prototype[t]=function(){return u[t].apply(u,[this].concat(ne(arguments)))}},void 0),h.prototype.toSource=function(){return this.toString()},h.prototype.toString=function(){return"[object Promise]"},u.nearer=p,u.isPromise=m,u.isPromiseAlike=g,u.isPending=y,u.isFulfilled=v,u.isRejected=_;var ce=[],fe=[];void 0!==n&&n.on&&n.on("exit",function(){for(var e=0;e<fe.length;e++){var t=fe[e];t&&void 0!==t.stack?console.warn("Unhandled rejected promise:",t.stack):console.warn("Unhandled rejected promise (no stack):",t)}}),u.reject=b,u.fulfill=E,u.resolve=T,u.master=x,u.when=w,u.spread=I,u.async=D,u.return=R,u.promised=A,u.dispatch=P,u.dispatcher=M,u.get=M("get"),u.set=M("set"),u.delete=u.del=M("delete");var he=u.post=M("post");u.send=L,u.invoke=L,u.fapply=C,u.try=O,u.fcall=O,u.fbind=k,u.keys=M("keys"),u.all=N,u.allResolved=F,u.catch=u.fail=B,u.progress=U,u.finally=u.fin=j,u.done=H,u.timeout=q,u.delay=V,u.nfapply=G,u.nfcall=K,u.nfbind=z,u.denodeify=u.nfbind,u.nbind=Y,u.npost=W,u.nsend=X,u.ninvoke=u.nsend,u.nodeify=Q;var pe=l();return u}()}();var S=function(){var e={boxes:{},fields:{},debug:!1,warningHandler:function(e){}},t={};return e.registerTypeBoxes=function(){t.moov=e.boxes.MovieBox,t.moof=e.boxes.MovieFragmentBox,t.ftyp=e.boxes.FileTypeBox,t.mfhd=e.boxes.MovieFragmentHeaderBox,t.mfra=e.boxes.MovieFragmentRandomAccessBox,t.udta=e.boxes.UserDataBox,t.trak=e.boxes.TrackBox,t.edts=e.boxes.EditBox,t.mdia=e.boxes.MediaBox,t.minf=e.boxes.MediaInformationBox,t.dinf=e.boxes.DataInformationBox,t.stbl=e.boxes.SampleTableBox,t.mvex=e.boxes.MovieExtendsBox,t.traf=e.boxes.TrackFragmentBox,t.meta=e.boxes.MetaBox,t.mvhd=e.boxes.MovieHeaderBox,t.mdat=e.boxes.MediaDataBox,t.free=e.boxes.FreeSpaceBox,t.sidx=e.boxes.SegmentIndexBox,t.tkhd=e.boxes.TrackHeaderBox,t.mdhd=e.boxes.MediaHeaderBox,t.mehd=e.boxes.MovieExtendsHeaderBox,t.hdlr=e.boxes.HandlerBox,t.stts=e.boxes.TimeToSampleBox,t.stsc=e.boxes.SampleToChunkBox,t.stco=e.boxes.ChunkOffsetBox,t.trex=e.boxes.TrackExtendsBox,t.vmhd=e.boxes.VideoMediaHeaderBox,t.smhd=e.boxes.SoundMediaHeaderBox,t.dref=e.boxes.DataReferenceBox,t["url "]=e.boxes.DataEntryUrlBox,t["urn "]=e.boxes.DataEntryUrnBox,t.tfhd=e.boxes.TrackFragmentHeaderBox,t.tfdt=e.boxes.TrackFragmentBaseMediaDecodeTimeBox,t.trun=e.boxes.TrackFragmentRunBox,t.stsd=e.boxes.SampleDescriptionBox,t.sdtp=e.boxes.SampleDependencyTableBox,t.avc1=e.boxes.AVC1VisualSampleEntryBox,t.encv=e.boxes.EncryptedVideoBox,t.avcC=e.boxes.AVCConfigurationBox,t.pasp=e.boxes.PixelAspectRatioBox,t.mp4a=e.boxes.MP4AudioSampleEntryBox,t.enca=e.boxes.EncryptedAudioBox,t.esds=e.boxes.ESDBox,t.stsz=e.boxes.SampleSizeBox,t.pssh=e.boxes.ProtectionSystemSpecificHeaderBox,t.senc=e.boxes.SampleEncryptionBox,t.saiz=e.boxes.SampleAuxiliaryInformationSizesBox,t.saio=e.boxes.SampleAuxiliaryInformationOffsetsBox,t.sinf=e.boxes.ProtectionSchemeInformationBox,t.schi=e.boxes.SchemeInformationBox,t.tenc=e.boxes.TrackEncryptionBox,t.schm=e.boxes.SchemeTypeBox,t.elst=e.boxes.EditListBox,t.hmhd=e.boxes.HintMediaHeaderBox,t.nmhd=e.boxes.NullMediaHeaderBox,t.ctts=e.boxes.CompositionOffsetBox,t.cslg=e.boxes.CompositionToDecodeBox,t.stss=e.boxes.SyncSampleBox,t.tref=e.boxes.TrackReferenceBox,t.frma=e.boxes.OriginalFormatBox,t[JSON.stringify([109,29,155,5,66,213,68,230,128,226,20,29,175,247,87,178])]=e.boxes.TfxdBox,t[JSON.stringify([212,128,126,242,202,57,70,149,142,84,38,203,158,70,167,159])]=e.boxes.TfrfBox,t[JSON.stringify([208,138,79,24,16,243,74,130,182,200,50,216,171,161,131,211])]=e.boxes.PiffProtectionSystemSpecificHeaderBox,t[JSON.stringify([137,116,219,206,123,231,76,81,132,249,113,72,249,136,37,84])]=e.boxes.PiffTrackEncryptionBox,t[JSON.stringify([162,57,79,82,90,155,79,20,162,68,108,66,124,100,141,244])]=e.boxes.PiffSampleEncryptionBox},e.constructorTypeBox=function(e){var t,n;return t=Object.create(e.prototype),n=Array.prototype.slice.call(arguments,1),e.apply(t,n),t},e.searchBox=function(n,r){var i;return i=r?t[r]:t[n],i||(i=e.boxes.UnknownBox),i},e.createBox=function(t,n,r){return e.constructorTypeBox.apply(null,[e.searchBox(t,r),n])},e.deserialize=function(t){var n=new e.boxes.File;try{n.read(t)}catch(t){return e.warningHandler(t.message),null}return n},e.serialize=function(e){var t=e.getLength(),n=new Uint8Array(t);return e.write(n),n},e.ParseException=function(e){this.message=e,this.name="ParseException"},e.DataIntegrityException=function(e){this.message=e,this.name="DataIntegrityException"},e}();void 0!==e&&void 0!==e.exports?e.exports=S:window.mp4lib=S,S.fields.readBytes=function(e,t,n){var r=0,i=0;for(i=0;i<n;i++)r<<=8,r+=e[t],t++;return r},S.fields.writeBytes=function(e,t,n,r){var i=0;for(i=0;i<n;i++)e[t+n-i-1]=255&r,r>>=8},S.fields.readString=function(e,t,n){var r,i="";for(r=t;r<t+n;r++)i+=String.fromCharCode(e[r]);return i},S.fields.NumberField=function(e,t){this.bits=e,this.signed=t},S.fields.NumberField.prototype.read=function(e,t){return S.fields.readBytes(e,t,this.bits/8)},S.fields.NumberField.prototype.write=function(e,t,n){S.fields.writeBytes(e,t,this.bits/8,n)},S.fields.NumberField.prototype.getLength=function(){return this.bits/8},S.fields.LongNumberField=function(){},S.fields.LongNumberField.prototype.read=function(e,t){var n=S.fields.readBytes(e,t,4),r=S.fields.readBytes(e,t+4,4);return f.math.Long.fromBits(r,n).toNumber()},S.fields.LongNumberField.prototype.write=function(e,t,n){var r=f.math.Long.fromNumber(n),i=r.getLowBits(),o=r.getHighBits();S.fields.writeBytes(e,t,4,o),S.fields.writeBytes(e,t+4,4,i)},S.fields.LongNumberField.prototype.getLength=function(){return 8},S.fields.FixedLenStringField=function(e){this.size=e},S.fields.FixedLenStringField.prototype.read=function(e,t){var n="",r=0;for(r=0;r<this.size;r++)n+=String.fromCharCode(e[t+r]);return n},S.fields.FixedLenStringField.prototype.write=function(e,t,n){var r=0;for(r=0;r<this.size;r++)e[t+r]=n.charCodeAt(r)},S.fields.FixedLenStringField.prototype.getLength=function(){return this.size},S.fields.BoxTypeField=function(){},S.fields.BoxTypeField.prototype.read=function(e,t){var n="",r=0;for(r=0;r<4;r++)n+=String.fromCharCode(e[t+r]);return n},S.fields.BoxTypeField.prototype.write=function(e,t,n){var r=0;for(r=0;r<4;r++)e[t+r]=n.charCodeAt(r)},S.fields.BoxTypeField.prototype.getLength=function(){return 4},S.fields.StringField=function(){},S.fields.StringField.prototype.read=function(e,t,n){var r="",i=0;for(i=t;i<n;i++)if(r+=String.fromCharCode(e[i]),0===e[i])return r;if(n-t<255&&e[0]==String.fromCharCode(n-t))return r=r.substr(1,n-t),S.warningHandler('null-terminated string expected, but found a string "'+r+'", which seems to be length-prefixed instead. Conversion done.'),r;throw new S.ParseException('expected null-terminated string, but end of field reached without termination. Read so far:"'+r+'"')},S.fields.StringField.prototype.write=function(e,t,n){var r=0;for(r=0;r<n.length;r++)e[t+r]=n.charCodeAt(r);e[t+n.length]=0},S.fields.StringField.prototype.getLength=function(e){return e.length},S.fields.ArrayField=function(e,t){this.innerField=e,this.size=t},S.fields.ArrayField.prototype.read=function(e,t){var n=-1,r=[],i=0;for(i=0;i<this.size;i++)r.push(this.innerField.read(e,t)),-1==n&&(n=this.innerField.getLength(r[i])),t+=n;return r},S.fields.FIELD_INT8=new S.fields.NumberField(8,!0),S.fields.FIELD_INT16=new S.fields.NumberField(16,!0),S.fields.FIELD_INT32=new S.fields.NumberField(32,!0),S.fields.FIELD_INT64=new S.fields.LongNumberField,S.fields.FIELD_UINT8=new S.fields.NumberField(8,!1),S.fields.FIELD_UINT16=new S.fields.NumberField(16,!1),S.fields.FIELD_UINT32=new S.fields.NumberField(32,!1),S.fields.FIELD_UINT64=new S.fields.LongNumberField,S.fields.FIELD_BIT8=new S.fields.NumberField(8,!1),S.fields.FIELD_BIT16=new S.fields.NumberField(16,!1),S.fields.FIELD_BIT24=new S.fields.NumberField(24,!1),S.fields.FIELD_BIT32=new S.fields.NumberField(32,!1),S.fields.FIELD_ID=new S.fields.BoxTypeField(4),S.fields.FIELD_STRING=new S.fields.StringField,S.boxes.File=function(){this.boxes=[]},S.boxes.File.prototype.getBoxByType=function(e){var t=0;for(t=0;t<this.boxes.length;t++)if(this.boxes[t].boxtype===e)return this.boxes[t];return null},S.boxes.File.prototype.getLength=function(){var e=0,t=0;for(t=0;t<this.boxes.length;t++)this.boxes[t].computeLength(),e+=this.boxes[t].size;return e},S.boxes.File.prototype.write=function(e){var t=0,n=0;for(n=0;n<this.boxes.length;n++)t=this.boxes[n].write(e,t)},S.boxes.File.prototype.read=function(e){for(var t,n=0,r=null,i=0,o=null,a=0,s=e.length;a<s;)if(n=S.fields.FIELD_UINT32.read(e,a),r=S.fields.readString(e,a+4,4),"uuid"==r&&(i=1==n?16:8,o=new S.fields.ArrayField(S.fields.FIELD_INT8,16).read(e,a+i,a+i+16),o=JSON.stringify(o)),t=S.createBox(r,n,o),"uuid"===r?(a=t.read(e,a+16*S.fields.FIELD_INT8.getLength()+8,a+n),o=null):a=t.read(e,a+8,a+n),S.debug&&(t.__sourceBuffer=e.subarray(a-t.size,a)),t.boxtype&&this.boxes.push(t),t.size<=0||null===t.size)throw new S.ParseException("Problem on size of box "+t.boxtype+", parsing stopped to avoid infinite loop")},S.boxes.File.prototype.getBoxOffsetByType=function(e){var t=0,n=0;for(n=0;n<this.boxes.length;n++){if(this.boxes[n].boxtype===e)return t;t+=this.boxes[n].size}return-1},S.boxes.File.prototype.getBoxIndexByType=function(e){var t=0,n=0;for(n=0;n<this.boxes.length;n++){if(this.boxes[n].boxtype===e)return t;t++}return-1},S.boxes.Box=function(e,t,n,r){this.size=t||null,this.boxtype=e,1===this.size&&r&&(this.largesize=r),n&&(this.extended_type=n),this.localPos=0,this.localEnd=0},S.boxes.Box.prototype.write=function(e,t){this.localPos=t;var n=0;if(this._writeData(e,S.fields.FIELD_UINT32,this.size),this.extended_type?this._writeData(e,S.fields.FIELD_ID,"uuid"):this._writeData(e,S.fields.FIELD_ID,this.boxtype),1===this.size&&this._writeData(e,S.fields.FIELD_INT64,this.largesize),this.extended_type)for(n=0;n<16;n++)this._writeData(e,S.fields.FIELD_INT8,this.extended_type[n])},S.boxes.Box.prototype.getBoxByType=function(e){var t=0;if(this.hasOwnProperty("boxes"))for(t=0;t<this.boxes.length;t++)if(this.boxes[t].boxtype===e)return this.boxes[t];return null},S.boxes.Box.prototype.getBoxesByType=function(e){var t=[],n=0;if(this.hasOwnProperty("boxes"))for(n=0;n<this.boxes.length;n++)this.boxes[n].boxtype===e&&t.push(this.boxes[n]);return t},S.boxes.Box.prototype.removeBoxByType=function(e){var t=0;if(this.hasOwnProperty("boxes"))for(t=0;t<this.boxes.length;t++)this.boxes[t].boxtype===e&&this.boxes.splice(t,1);else S.warningHandler(this.boxtype+"does not have "+e+" box, impossible to remove it")},S.boxes.Box.prototype.getBoxOffsetByType=function(e){var t=8,n=0;if(this.hasOwnProperty("boxes"))for(n=0;n<this.boxes.length;n++){if(this.boxes[n].boxtype===e)return t;t+=this.boxes[n].size}return null},S.boxes.Box.prototype.getBoxIndexByType=function(e){var t=0,n=0;if(this.hasOwnProperty("boxes"))for(n=0;n<this.boxes.length;n++){if(this.boxes[n].boxtype===e)return t;t++}return null},S.boxes.Box.prototype.computeLength=function(){this.size=S.fields.FIELD_UINT32.getLength()+S.fields.FIELD_ID.getLength(),this.extended_type&&(this.size+=16*S.fields.FIELD_INT8.getLength())},S.boxes.Box.prototype._readData=function(e,t){var n=t.read(e,this.localPos,this.localEnd);return this.localPos+=t.getLength(n),n},S.boxes.Box.prototype._writeData=function(e,t,n){if(void 0===n||null===n)throw new S.ParseException("a field to write is null or undefined for box : "+this.boxtype);t.write(e,this.localPos,n),this.localPos+=t.getLength(n)},S.boxes.Box.prototype._writeBuffer=function(e,t,n){e.set(t,this.localPos),this.localPos+=n},S.boxes.Box.prototype._writeArrayData=function(e,t,n){var r=0;if(void 0===n||null===n||0===n.length)throw new S.ParseException("an array to write is null, undefined or length = 0 for box : "+this.boxtype);for(r=0;r<n.length;r++)this._writeData(e,t,n[r])},S.boxes.Box.prototype._readArrayData=function(e,t){var n=[],r=t.getLength(),i=(this.localEnd-this.localPos)/r,o=0;for(o=0;o<i;o++)n.push(t.read(e,this.localPos)),this.localPos+=r;return n},S.boxes.Box.prototype._readArrayFieldData=function(e,t,n){var r=-1,i=[],o=0;for(o=0;o<n;o++)i.push(t.read(e,this.localPos)),-1===r&&(r=t.getLength(i[o])),this.localPos+=r;return i},S.boxes.ContainerBox=function(e,t){S.boxes.Box.call(this,e,t),this.boxes=[]},S.boxes.ContainerBox.prototype=Object.create(S.boxes.Box.prototype),S.boxes.ContainerBox.prototype.constructor=S.boxes.ContainerBox,S.boxes.ContainerBox.prototype.computeLength=function(){S.boxes.Box.prototype.computeLength.call(this);var e=0;for(e=0;e<this.boxes.length;e++)this.boxes[e].computeLength(),this.size+=this.boxes[e].size},S.boxes.ContainerBox.prototype.write=function(e,t){S.boxes.Box.prototype.write.call(this,e,t);var n=0;for(n=0;n<this.boxes.length;n++)this.localPos=this.boxes[n].write(e,this.localPos);return this.localPos},S.boxes.ContainerBox.prototype.read=function(e,t,n){for(var r,i,o=0,a=0,s=null;t<n;)if(o=S.fields.FIELD_UINT32.read(e,t),r=S.fields.readString(e,t+4,4),"uuid"===r&&(a=1==o?16:8,s=new S.fields.ArrayField(S.fields.FIELD_INT8,16).read(e,t+a,t+a+16),s=JSON.stringify(s)),i=S.createBox(r,o,s),"uuid"===r?(t=i.read(e,t+16*S.fields.FIELD_INT8.getLength()+8,t+o),s=null):t=i.read(e,t+8,t+o),S.debug&&(i.__sourceBuffer=e.subarray(t-i.size,t)),i.boxtype&&this.boxes.push(i),i.size<=0||null===i.size)throw new S.ParseException("Problem on size of box "+i.boxtype+", parsing stopped to avoid infinite loop");return t},S.boxes.FullBox=function(e,t,n){S.boxes.Box.call(this,e,t,n),this.version=null,this.flags=null},S.boxes.FullBox.prototype=Object.create(S.boxes.Box.prototype),S.boxes.FullBox.prototype.constructor=S.boxes.FullBox,S.boxes.FullBox.prototype.read=function(e,t,n){this.localPos=t,this.localEnd=n,this.version=this._readData(e,S.fields.FIELD_INT8),this.flags=this._readData(e,S.fields.FIELD_BIT24)},S.boxes.FullBox.prototype.write=function(e,t){S.boxes.Box.prototype.write.call(this,e,t),this._writeData(e,S.fields.FIELD_INT8,this.version),this._writeData(e,S.fields.FIELD_BIT24,this.flags)},S.boxes.FullBox.prototype.getFullBoxAttributesLength=function(){this.size+=S.fields.FIELD_INT8.getLength()+S.fields.FIELD_BIT24.getLength()},S.boxes.FullBox.prototype.computeLength=function(){S.boxes.Box.prototype.computeLength.call(this),S.boxes.FullBox.prototype.getFullBoxAttributesLength.call(this)},S.boxes.ContainerFullBox=function(e,t){S.boxes.FullBox.call(this,e,t),this.boxes=[]},S.boxes.ContainerFullBox.prototype=Object.create(S.boxes.FullBox.prototype),S.boxes.ContainerFullBox.prototype.constructor=S.boxes.ContainerFullBox,S.boxes.ContainerFullBox.prototype.computeLength=function(e){S.boxes.FullBox.prototype.computeLength.call(this);var t=0;for(e&&(this.size+=S.fields.FIELD_UINT32.getLength()),t=0;t<this.boxes.length;t++)this.boxes[t].computeLength(),this.size+=this.boxes[t].size},S.boxes.ContainerFullBox.prototype.read=function(e,t,n,r){S.boxes.FullBox.prototype.read.call(this,e,t,n);var i,o,a=0,s=0,l=null;for(r&&(this.entry_count=this._readData(e,S.fields.FIELD_UINT32));this.localPos<this.localEnd;)if(a=S.fields.FIELD_UINT32.read(e,this.localPos),i=S.fields.readString(e,this.localPos+4,4),"uuid"==i&&(s=1==a?16:8,l=new S.fields.ArrayField(S.fields.FIELD_INT8,16).read(e,this.localPos+s,this.localPos+s+16),l=JSON.stringify(l)),o=S.createBox(i,a,l),"uuid"===i?(this.localPos=o.read(e,this.localPos+16*S.fields.FIELD_INT8.getLength()+8,this.localPos+a),l=null):this.localPos=o.read(e,this.localPos+8,this.localPos+a),S.debug&&(o.__sourceBuffer=e.subarray(this.localPos-o.size,this.localPos)),o.boxtype&&this.boxes.push(o),o.size<=0||null===o.size)throw new S.ParseException("Problem on size of box "+o.boxtype+", parsing stopped to avoid infinite loop");return this.localPos},S.boxes.ContainerFullBox.prototype.write=function(e,t,n){S.boxes.FullBox.prototype.write.call(this,e,t);var r=0;for(!0===n&&this._writeData(e,S.fields.FIELD_UINT32,this.entry_count),r=0;r<this.boxes.length;r++)this.localPos=this.boxes[r].write(e,this.localPos);return this.localPos},S.boxes.UnknownBox=function(e){S.boxes.Box.call(this,null,e)},S.boxes.UnknownBox.prototype=Object.create(S.boxes.Box.prototype),S.boxes.UnknownBox.prototype.constructor=S.boxes.UnknownBox,S.boxes.UnknownBox.prototype.read=function(e,t,n){return this.localPos=t,this.localEnd=n,this.unrecognized_data=e.subarray(this.localPos,this.localEnd),this.localEnd},S.boxes.UnknownBox.prototype.write=function(e,t){return S.boxes.Box.prototype.write.call(this,e,t),this._writeBuffer(e,this.unrecognized_data,this.unrecognized_data.length),this.localPos},S.boxes.UnknownBox.prototype.computeLength=function(){S.boxes.Box.prototype.computeLength.call(this),this.size+=this.unrecognized_data.length},S.boxes.FileTypeBox=function(e){S.boxes.Box.call(this,"ftyp",e)},S.boxes.FileTypeBox.prototype=Object.create(S.boxes.Box.prototype),S.boxes.FileTypeBox.prototype.constructor=S.boxes.FileTypeBox,S.boxes.FileTypeBox.prototype.computeLength=function(){S.boxes.Box.prototype.computeLength.call(this),this.size+=2*S.fields.FIELD_INT32.getLength()+S.fields.FIELD_INT32.getLength()*this.compatible_brands.length},S.boxes.FileTypeBox.prototype.read=function(e,t,n){return this.localPos=t,this.localEnd=n,this.major_brand=this._readData(e,S.fields.FIELD_INT32),this.minor_brand=this._readData(e,S.fields.FIELD_INT32),this.compatible_brands=this._readArrayData(e,S.fields.FIELD_INT32),this.localPos},S.boxes.FileTypeBox.prototype.write=function(e,t){return S.boxes.Box.prototype.write.call(this,e,t),this._writeData(e,S.fields.FIELD_INT32,this.major_brand),this._writeData(e,S.fields.FIELD_INT32,this.minor_brand),this._writeArrayData(e,S.fields.FIELD_INT32,this.compatible_brands),this.localPos},S.boxes.MovieBox=function(e){S.boxes.ContainerBox.call(this,"moov",e)},S.boxes.MovieBox.prototype=Object.create(S.boxes.ContainerBox.prototype),S.boxes.MovieBox.prototype.constructor=S.boxes.MovieBox,S.boxes.MovieFragmentBox=function(e){S.boxes.ContainerBox.call(this,"moof",e)},S.boxes.MovieFragmentBox.prototype=Object.create(S.boxes.ContainerBox.prototype),S.boxes.MovieFragmentBox.prototype.constructor=S.boxes.MovieFragmentBox,S.boxes.MovieFragmentRandomAccessBox=function(e){S.boxes.ContainerBox.call(this,"mfra",e)},S.boxes.MovieFragmentRandomAccessBox.prototype=Object.create(S.boxes.ContainerBox.prototype),S.boxes.MovieFragmentRandomAccessBox.prototype.constructor=S.boxes.MovieFragmentRandomAccessBox,S.boxes.UserDataBox=function(e){S.boxes.ContainerBox.call(this,"udta",e)},S.boxes.UserDataBox.prototype=Object.create(S.boxes.ContainerBox.prototype),S.boxes.UserDataBox.prototype.constructor=S.boxes.UserDataBox,S.boxes.TrackBox=function(e){S.boxes.ContainerBox.call(this,"trak",e)},S.boxes.TrackBox.prototype=Object.create(S.boxes.ContainerBox.prototype),S.boxes.TrackBox.prototype.constructor=S.boxes.TrackBox,S.boxes.EditBox=function(e){S.boxes.ContainerBox.call(this,"edts",e)},S.boxes.EditBox.prototype=Object.create(S.boxes.ContainerBox.prototype),S.boxes.EditBox.prototype.constructor=S.boxes.EditBox,S.boxes.MediaBox=function(e){S.boxes.ContainerBox.call(this,"mdia",e)},S.boxes.MediaBox.prototype=Object.create(S.boxes.ContainerBox.prototype),S.boxes.MediaBox.prototype.constructor=S.boxes.MediaBox,S.boxes.MediaInformationBox=function(e){S.boxes.ContainerBox.call(this,"minf",e)},S.boxes.MediaInformationBox.prototype=Object.create(S.boxes.ContainerBox.prototype),S.boxes.MediaInformationBox.prototype.constructor=S.boxes.MediaInformationBox,S.boxes.DataInformationBox=function(e){S.boxes.ContainerBox.call(this,"dinf",e)},S.boxes.DataInformationBox.prototype=Object.create(S.boxes.ContainerBox.prototype),S.boxes.DataInformationBox.prototype.constructor=S.boxes.DataInformationBox,S.boxes.SampleTableBox=function(e){S.boxes.ContainerBox.call(this,"stbl",e)},S.boxes.SampleTableBox.prototype=Object.create(S.boxes.ContainerBox.prototype),S.boxes.SampleTableBox.prototype.constructor=S.boxes.SampleTableBox,S.boxes.MovieExtendsBox=function(e){S.boxes.ContainerBox.call(this,"mvex",e)},S.boxes.MovieExtendsBox.prototype=Object.create(S.boxes.ContainerBox.prototype),S.boxes.MovieExtendsBox.prototype.constructor=S.boxes.MovieExtendsBox,S.boxes.TrackFragmentBox=function(e){S.boxes.ContainerBox.call(this,"traf",e)},S.boxes.TrackFragmentBox.prototype=Object.create(S.boxes.ContainerBox.prototype),S.boxes.TrackFragmentBox.prototype.constructor=S.boxes.TrackFragmentBox,S.boxes.MetaBox=function(e){S.boxes.ContainerFullBox.call(this,"meta",e)},S.boxes.MetaBox.prototype=Object.create(S.boxes.ContainerFullBox.prototype),S.boxes.MetaBox.prototype.constructor=S.boxes.MetaBox,S.boxes.MetaBox.prototype.computeLength=function(){S.boxes.ContainerFullBox.prototype.computeLength.call(this,!1)},S.boxes.MetaBox.prototype.read=function(e,t,n){return S.boxes.ContainerFullBox.prototype.read.call(this,e,t,n,!1)},S.boxes.MetaBox.prototype.write=function(e,t){return S.boxes.ContainerFullBox.prototype.write.call(this,e,t,!1)},S.boxes.MovieHeaderBox=function(e){S.boxes.FullBox.call(this,"mvhd",e)},S.boxes.MovieHeaderBox.prototype=Object.create(S.boxes.FullBox.prototype),S.boxes.MovieHeaderBox.prototype.constructor=S.boxes.MovieHeaderBox,S.boxes.MovieHeaderBox.prototype.computeLength=function(){S.boxes.FullBox.prototype.computeLength.call(this),this.size+=S.fields.FIELD_INT32.getLength()+2*S.fields.FIELD_INT16.getLength(),this.size+=2*S.fields.FIELD_INT32.getLength()+9*S.fields.FIELD_INT32.getLength(),this.size+=6*S.fields.FIELD_BIT32.getLength()+S.fields.FIELD_UINT32.getLength(),1===this.version?this.size+=3*S.fields.FIELD_UINT64.getLength()+S.fields.FIELD_UINT32.getLength():this.size+=4*S.fields.FIELD_UINT32.getLength()},S.boxes.MovieHeaderBox.prototype.write=function(e,t){return S.boxes.FullBox.prototype.write.call(this,e,t),1===this.version?(this._writeData(e,S.fields.FIELD_UINT64,this.creation_time),this._writeData(e,S.fields.FIELD_UINT64,this.modification_time),this._writeData(e,S.fields.FIELD_UINT32,this.timescale),this._writeData(e,S.fields.FIELD_UINT64,this.duration)):(this._writeData(e,S.fields.FIELD_UINT32,this.creation_time),this._writeData(e,S.fields.FIELD_UINT32,this.modification_time),this._writeData(e,S.fields.FIELD_UINT32,this.timescale),this._writeData(e,S.fields.FIELD_UINT32,this.duration)),this._writeData(e,S.fields.FIELD_INT32,this.rate),this._writeData(e,S.fields.FIELD_INT16,this.volume),this._writeData(e,S.fields.FIELD_INT16,this.reserved),this._writeArrayData(e,S.fields.FIELD_INT32,this.reserved_2),this._writeArrayData(e,S.fields.FIELD_INT32,this.matrix),this._writeArrayData(e,S.fields.FIELD_BIT32,this.pre_defined),this._writeData(e,S.fields.FIELD_UINT32,this.next_track_ID),this.localPos},S.boxes.MovieHeaderBox.prototype.read=function(e,t,n){return S.boxes.FullBox.prototype.read.call(this,e,t,n),1==this.version?(this.creation_time=this._readData(e,S.fields.FIELD_UINT64),this.modification_time=this._readData(e,S.fields.FIELD_UINT64),this.timescale=this._readData(e,S.fields.FIELD_UINT32),this.duration=this._readData(e,S.fields.FIELD_UINT64)):(this.creation_time=this._readData(e,S.fields.FIELD_UINT32),this.modification_time=this._readData(e,S.fields.FIELD_UINT32),this.timescale=this._readData(e,S.fields.FIELD_UINT32),this.duration=this._readData(e,S.fields.FIELD_UINT32)),this.rate=this._readData(e,S.fields.FIELD_INT32),this.volume=this._readData(e,S.fields.FIELD_INT16),this.reserved=this._readData(e,S.fields.FIELD_INT16),this.reserved_2=this._readArrayFieldData(e,S.fields.FIELD_INT32,2),this.matrix=this._readArrayFieldData(e,S.fields.FIELD_INT32,9),this.pre_defined=this._readArrayFieldData(e,S.fields.FIELD_BIT32,6),this.next_track_ID=this._readData(e,S.fields.FIELD_UINT32),this.localPos},S.boxes.MediaDataBox=function(e){S.boxes.Box.call(this,"mdat",e)},S.boxes.MediaDataBox.prototype=Object.create(S.boxes.Box.prototype),S.boxes.MediaDataBox.prototype.constructor=S.boxes.MediaDataBox,S.boxes.MediaDataBox.prototype.computeLength=function(){S.boxes.Box.prototype.computeLength.call(this),this.size+=this.data.length},S.boxes.MediaDataBox.prototype.read=function(e,t,n){return this.data=e.subarray(t,n),n},S.boxes.MediaDataBox.prototype.write=function(e,t){return S.boxes.Box.prototype.write.call(this,e,t),this._writeBuffer(e,this.data,this.data.length),this.localPos},S.boxes.FreeSpaceBox=function(e){S.boxes.Box.call(this,"free",e)},S.boxes.FreeSpaceBox.prototype=Object.create(S.boxes.Box.prototype),S.boxes.FreeSpaceBox.prototype.constructor=S.boxes.FreeSpaceBox,S.boxes.FreeSpaceBox.prototype.computeLength=function(){S.boxes.Box.prototype.computeLength.call(this),this.size+=this.data.length},S.boxes.FreeSpaceBox.prototype.read=function(e,t,n){return this.localPos=t,this.localEnd=n,this.data=e.subarray(this.localPos,this.localEnd),this.localEnd},S.boxes.FreeSpaceBox.prototype.write=function(e,t){return S.boxes.Box.prototype.write.call(this,e,t),this._writeBuffer(e,this.data,this.data.length),this.localPos},S.boxes.SegmentIndexBox=function(e){S.boxes.FullBox.call(this,"sidx",e)},S.boxes.SegmentIndexBox.prototype=Object.create(S.boxes.FullBox.prototype),S.boxes.SegmentIndexBox.prototype.constructor=S.boxes.SegmentIndexBox,S.boxes.SegmentIndexBox.prototype.computeLength=function(){S.boxes.FullBox.prototype.computeLength.call(this),this.size+=2*S.fields.FIELD_UINT32.getLength(),1===this.version?this.size+=2*S.fields.FIELD_UINT64.getLength():this.size+=2*S.fields.FIELD_UINT32.getLength(),this.size+=S.fields.FIELD_UINT16.getLength(),this.size+=S.fields.FIELD_UINT16.getLength(),this.size+=(S.fields.FIELD_UINT64.getLength()+S.fields.FIELD_UINT32.getLength())*this.reference_count},S.boxes.SegmentIndexBox.prototype.read=function(e,t,n){S.boxes.FullBox.prototype.read.call(this,e,t,n);var r=0,i={};for(this.reference_ID=this._readData(e,S.fields.FIELD_UINT32),this.timescale=this._readData(e,S.fields.FIELD_UINT32),1===this.version?(this.earliest_presentation_time=this._readData(e,S.fields.FIELD_UINT64),this.first_offset=this._readData(e,S.fields.FIELD_UINT64)):(this.earliest_presentation_time=this._readData(e,S.fields.FIELD_UINT32),this.first_offset=this._readData(e,S.fields.FIELD_UINT32)),this.reserved=this._readData(e,S.fields.FIELD_UINT16),this.reference_count=this._readData(e,S.fields.FIELD_UINT16),this.references=[],r=0;r<this.reference_count;r++)i={},i.reference_info=this._readData(e,S.fields.FIELD_UINT64),i.SAP=this._readData(e,S.fields.FIELD_UINT32),this.references.push(i);return this.localPos},S.boxes.SegmentIndexBox.prototype.write=function(e,t){S.boxes.FullBox.prototype.write.call(this,e,t);var n=0;for(this._writeData(e,S.fields.FIELD_UINT32,this.reference_ID),this._writeData(e,S.fields.FIELD_UINT32,this.timescale),1===this.version?(this._writeData(e,S.fields.FIELD_UINT64,this.earliest_presentation_time),this._writeData(e,S.fields.FIELD_UINT64,this.first_offset)):(this._writeData(e,S.fields.FIELD_UINT32,this.earliest_presentation_time),this._writeData(e,S.fields.FIELD_UINT32,this.first_offset)),this._writeData(e,S.fields.FIELD_UINT16,this.reserved),this._writeData(e,S.fields.FIELD_UINT16,this.reference_count),n=0;n<this.reference_count;n++)this._writeData(e,S.fields.FIELD_UINT64,this.references[n].reference_info),this._writeData(e,S.fields.FIELD_UINT32,this.references[n].SAP);return this.localPos},S.boxes.TrackHeaderBox=function(e){S.boxes.FullBox.call(this,"tkhd",e)},S.boxes.TrackHeaderBox.prototype=Object.create(S.boxes.FullBox.prototype),S.boxes.TrackHeaderBox.prototype.constructor=S.boxes.TrackHeaderBox,S.boxes.TrackHeaderBox.prototype.computeLength=function(){S.boxes.FullBox.prototype.computeLength.call(this),this.size+=4*S.fields.FIELD_INT16.getLength()+2*S.fields.FIELD_INT32.getLength()+2*S.fields.FIELD_UINT32.getLength()+9*S.fields.FIELD_INT32.getLength(),1==this.version?this.size+=3*S.fields.FIELD_UINT64.getLength()+2*S.fields.FIELD_UINT32.getLength():this.size+=5*S.fields.FIELD_UINT32.getLength()},S.boxes.TrackHeaderBox.prototype.read=function(e,t,n){return S.boxes.FullBox.prototype.read.call(this,e,t,n),1===this.version?(this.creation_time=this._readData(e,S.fields.FIELD_UINT64),this.modification_time=this._readData(e,S.fields.FIELD_UINT64),this.track_id=this._readData(e,S.fields.FIELD_UINT32),this.reserved=this._readData(e,S.fields.FIELD_UINT32),this.duration=this._readData(e,S.fields.FIELD_UINT64)):(this.creation_time=this._readData(e,S.fields.FIELD_UINT32),this.modification_time=this._readData(e,S.fields.FIELD_UINT32),this.track_id=this._readData(e,S.fields.FIELD_UINT32),this.reserved=this._readData(e,S.fields.FIELD_UINT32),this.duration=this._readData(e,S.fields.FIELD_UINT32)),this.reserved_2=this._readArrayFieldData(e,S.fields.FIELD_UINT32,2),this.layer=this._readData(e,S.fields.FIELD_INT16),this.alternate_group=this._readData(e,S.fields.FIELD_INT16),this.volume=this._readData(e,S.fields.FIELD_INT16),this.reserved_3=this._readData(e,S.fields.FIELD_INT16),this.matrix=this._readArrayFieldData(e,S.fields.FIELD_INT32,9),this.width=this._readData(e,S.fields.FIELD_INT32),this.height=this._readData(e,S.fields.FIELD_INT32),this.localPos},S.boxes.TrackHeaderBox.prototype.write=function(e,t){return S.boxes.FullBox.prototype.write.call(this,e,t),1===this.version?(this._writeData(e,S.fields.FIELD_UINT64,this.creation_time),this._writeData(e,S.fields.FIELD_UINT64,this.modification_time),this._writeData(e,S.fields.FIELD_UINT32,this.track_id),this._writeData(e,S.fields.FIELD_UINT32,this.reserved),this._writeData(e,S.fields.FIELD_UINT64,this.duration)):(this._writeData(e,S.fields.FIELD_UINT32,this.creation_time),this._writeData(e,S.fields.FIELD_UINT32,this.modification_time),this._writeData(e,S.fields.FIELD_UINT32,this.track_id),this._writeData(e,S.fields.FIELD_UINT32,this.reserved),this._writeData(e,S.fields.FIELD_UINT32,this.duration)),this._writeArrayData(e,S.fields.FIELD_UINT32,this.reserved_2),this._writeData(e,S.fields.FIELD_INT16,this.layer),this._writeData(e,S.fields.FIELD_INT16,this.alternate_group),this._writeData(e,S.fields.FIELD_INT16,this.volume),this._writeData(e,S.fields.FIELD_INT16,this.reserved_3),this._writeArrayData(e,S.fields.FIELD_INT32,this.matrix),this._writeData(e,S.fields.FIELD_INT32,this.width),this._writeData(e,S.fields.FIELD_INT32,this.height),this.localPos},S.boxes.MediaHeaderBox=function(e){S.boxes.FullBox.call(this,"mdhd",e)},S.boxes.MediaHeaderBox.prototype=Object.create(S.boxes.FullBox.prototype),S.boxes.MediaHeaderBox.prototype.constructor=S.boxes.MediaHeaderBox,S.boxes.MediaHeaderBox.prototype.computeLength=function(){S.boxes.FullBox.prototype.computeLength.call(this),this.size+=2*S.fields.FIELD_UINT16.getLength(),1==this.version?this.size+=3*S.fields.FIELD_UINT64.getLength()+S.fields.FIELD_UINT32.getLength():this.size+=4*S.fields.FIELD_UINT32.getLength()},S.boxes.MediaHeaderBox.prototype.read=function(e,t,n){return S.boxes.FullBox.prototype.read.call(this,e,t,n),1===this.version?(this.creation_time=this._readData(e,S.fields.FIELD_UINT64),this.modification_time=this._readData(e,S.fields.FIELD_UINT64),this.timescale=this._readData(e,S.fields.FIELD_UINT32),this.duration=this._readData(e,S.fields.FIELD_UINT64)):(this.creation_time=this._readData(e,S.fields.FIELD_UINT32),this.modification_time=this._readData(e,S.fields.FIELD_UINT32),this.timescale=this._readData(e,S.fields.FIELD_UINT32),this.duration=this._readData(e,S.fields.FIELD_UINT32)),this.language=this._readData(e,S.fields.FIELD_UINT16),this.pre_defined=this._readData(e,S.fields.FIELD_UINT16),this.localPos},S.boxes.MediaHeaderBox.prototype.write=function(e,t){return S.boxes.FullBox.prototype.write.call(this,e,t),1===this.version?(this._writeData(e,S.fields.FIELD_UINT64,this.creation_time),this._writeData(e,S.fields.FIELD_UINT64,this.modification_time),this._writeData(e,S.fields.FIELD_UINT32,this.timescale),this._writeData(e,S.fields.FIELD_UINT64,this.duration)):(this._writeData(e,S.fields.FIELD_UINT32,this.creation_time),this._writeData(e,S.fields.FIELD_UINT32,this.modification_time),this._writeData(e,S.fields.FIELD_UINT32,this.timescale),this._writeData(e,S.fields.FIELD_UINT32,this.duration)),this._writeData(e,S.fields.FIELD_UINT16,this.language),this._writeData(e,S.fields.FIELD_UINT16,this.pre_defined),this.localPos},S.boxes.MovieExtendsHeaderBox=function(e){S.boxes.FullBox.call(this,"mehd",e)},S.boxes.MovieExtendsHeaderBox.prototype=Object.create(S.boxes.FullBox.prototype),S.boxes.MovieExtendsHeaderBox.prototype.constructor=S.boxes.MovieExtendsHeaderBox,S.boxes.MovieExtendsHeaderBox.prototype.computeLength=function(){S.boxes.FullBox.prototype.computeLength.call(this),1==this.version?this.size+=S.fields.FIELD_UINT64.getLength():this.size+=S.fields.FIELD_UINT32.getLength()},S.boxes.MovieExtendsHeaderBox.prototype.read=function(e,t,n){return S.boxes.FullBox.prototype.read.call(this,e,t,n),1===this.version?this.fragment_duration=this._readData(e,S.fields.FIELD_UINT64):this.fragment_duration=this._readData(e,S.fields.FIELD_UINT32),this.localPos},S.boxes.MovieExtendsHeaderBox.prototype.write=function(e,t){return S.boxes.FullBox.prototype.write.call(this,e,t),1===this.version?this._writeData(e,S.fields.FIELD_UINT64,this.fragment_duration):this._writeData(e,S.fields.FIELD_UINT32,this.fragment_duration),this.localPos},S.boxes.HandlerBox=function(e){S.boxes.FullBox.call(this,"hdlr",e)},S.boxes.HandlerBox.prototype=Object.create(S.boxes.FullBox.prototype),S.boxes.HandlerBox.prototype.constructor=S.boxes.HandlerBox,S.boxes.HandlerBox.prototype.HANDLERTYPEVIDEO="vide",S.boxes.HandlerBox.prototype.HANDLERTYPEAUDIO="soun",S.boxes.HandlerBox.prototype.HANDLERTYPETEXT="meta",S.boxes.HandlerBox.prototype.HANDLERVIDEONAME="Video Track",S.boxes.HandlerBox.prototype.HANDLERAUDIONAME="Audio Track",S.boxes.HandlerBox.prototype.HANDLERTEXTNAME="Text Track",S.boxes.HandlerBox.prototype.computeLength=function(){S.boxes.FullBox.prototype.computeLength.call(this),this.size+=2*S.fields.FIELD_UINT32.getLength()+3*S.fields.FIELD_UINT32.getLength()+S.fields.FIELD_STRING.getLength(this.name)},S.boxes.HandlerBox.prototype.read=function(e,t,n){return S.boxes.FullBox.prototype.read.call(this,e,t,n),this.pre_defined=this._readData(e,S.fields.FIELD_UINT32),this.handler_type=this._readData(e,S.fields.FIELD_UINT32),this.reserved=this._readArrayFieldData(e,S.fields.FIELD_UINT32,3),this.name=this._readData(e,S.fields.FIELD_STRING),this.localPos},S.boxes.HandlerBox.prototype.write=function(e,t){return S.boxes.FullBox.prototype.write.call(this,e,t),this._writeData(e,S.fields.FIELD_UINT32,this.pre_defined),this._writeData(e,S.fields.FIELD_UINT32,this.handler_type),this._writeArrayData(e,S.fields.FIELD_UINT32,this.reserved),this._writeData(e,S.fields.FIELD_STRING,this.name),this.localPos},S.boxes.TimeToSampleBox=function(e){S.boxes.FullBox.call(this,"stts",e)},S.boxes.TimeToSampleBox.prototype=Object.create(S.boxes.FullBox.prototype),S.boxes.TimeToSampleBox.prototype.constructor=S.boxes.TimeToSampleBox,S.boxes.TimeToSampleBox.prototype.computeLength=function(){S.boxes.FullBox.prototype.computeLength.call(this),this.size+=S.fields.FIELD_UINT32.getLength(),this.size+=this.entry_count*(2*S.fields.FIELD_UINT32.getLength())},S.boxes.TimeToSampleBox.prototype.read=function(e,t,n){S.boxes.FullBox.prototype.read.call(this,e,t,n);var r=0,i={};for(this.entry_count=this._readData(e,S.fields.FIELD_UINT32),this.entry=[],r=0;r<this.entry_count;r++)i={},i.sample_count=this._readData(e,S.fields.FIELD_UINT32),i.sample_delta=this._readData(e,S.fields.FIELD_UINT32),this.entry.push(i);return this.localPos},S.boxes.TimeToSampleBox.prototype.write=function(e,t){S.boxes.FullBox.prototype.write.call(this,e,t);var n=0;for(this._writeData(e,S.fields.FIELD_UINT32,this.entry_count),n=0;n<this.entry_count;n++)this._writeData(e,S.fields.FIELD_UINT32,this.entry[n].sample_count),this._writeData(e,S.fields.FIELD_UINT32,this.entry[n].sample_delta);return this.localPos},S.boxes.SampleToChunkBox=function(e){S.boxes.FullBox.call(this,"stsc",e)},S.boxes.SampleToChunkBox.prototype=Object.create(S.boxes.FullBox.prototype),S.boxes.SampleToChunkBox.prototype.constructor=S.boxes.SampleToChunkBox,S.boxes.SampleToChunkBox.prototype.computeLength=function(){S.boxes.FullBox.prototype.computeLength.call(this),this.size+=S.fields.FIELD_UINT32.getLength(),this.size+=this.entry_count*(3*S.fields.FIELD_UINT32.getLength())},S.boxes.SampleToChunkBox.prototype.read=function(e,t,n){S.boxes.FullBox.prototype.read.call(this,e,t,n);var r=0,i={};for(this.entry_count=this._readData(e,S.fields.FIELD_UINT32),this.entry=[],r=0;r<this.entry_count;r++)i={},i.first_chunk=this._readData(e,S.fields.FIELD_UINT32),i.samples_per_chunk=this._readData(e,S.fields.FIELD_UINT32),i.samples_description_index=this._readData(e,S.fields.FIELD_UINT32),this.entry.push(i);return this.localPos},S.boxes.SampleToChunkBox.prototype.write=function(e,t){S.boxes.FullBox.prototype.write.call(this,e,t);var n=0;for(this._writeData(e,S.fields.FIELD_UINT32,this.entry_count),n=0;n<this.entry_count;n++)this._writeData(e,S.fields.FIELD_UINT32,this.entry[n].first_chunk),this._writeData(e,S.fields.FIELD_UINT32,this.entry[n].samples_per_chunk),this._writeData(e,S.fields.FIELD_UINT32,this.entry[n].samples_description_index);return this.localPos};S.boxes.ChunkOffsetBox=function(e){S.boxes.FullBox.call(this,"stco",e)},S.boxes.ChunkOffsetBox.prototype=Object.create(S.boxes.FullBox.prototype),S.boxes.ChunkOffsetBox.prototype.constructor=S.boxes.ChunkOffsetBox,S.boxes.ChunkOffsetBox.prototype.computeLength=function(){S.boxes.FullBox.prototype.computeLength.call(this),this.size+=S.fields.FIELD_UINT32.getLength()+this.entry_count*S.fields.FIELD_UINT32.getLength()},S.boxes.ChunkOffsetBox.prototype.read=function(e,t,n){return S.boxes.FullBox.prototype.read.call(this,e,t,n),this.entry_count=this._readData(e,S.fields.FIELD_UINT32),this.chunk_offset=this._readArrayFieldData(e,S.fields.FIELD_UINT32,this.entry_count),this.localPos},S.boxes.ChunkOffsetBox.prototype.write=function(e,t){S.boxes.FullBox.prototype.write.call(this,e,t);var n=0;for(this._writeData(e,S.fields.FIELD_UINT32,this.entry_count),n=0;n<this.entry_count;n++)this._writeData(e,S.fields.FIELD_UINT32,this.chunk_offset[n]);return this.localPos},S.boxes.TrackExtendsBox=function(e){S.boxes.FullBox.call(this,"trex",e)},S.boxes.TrackExtendsBox.prototype=Object.create(S.boxes.FullBox.prototype),S.boxes.TrackExtendsBox.prototype.constructor=S.boxes.TrackExtendsBox,S.boxes.TrackExtendsBox.prototype.computeLength=function(){S.boxes.FullBox.prototype.computeLength.call(this),this.size+=5*S.fields.FIELD_UINT32.getLength()},S.boxes.TrackExtendsBox.prototype.read=function(e,t,n){return S.boxes.FullBox.prototype.read.call(this,e,t,n),this.track_ID=this._readData(e,S.fields.FIELD_UINT32),this.default_sample_description_index=this._readData(e,S.fields.FIELD_UINT32),this.default_sample_duration=this._readData(e,S.fields.FIELD_UINT32),this.default_sample_size=this._readData(e,S.fields.FIELD_UINT32),this.default_sample_flags=this._readData(e,S.fields.FIELD_UINT32),this.localPos},S.boxes.TrackExtendsBox.prototype.write=function(e,t){return S.boxes.FullBox.prototype.write.call(this,e,t),this._writeData(e,S.fields.FIELD_UINT32,this.track_ID),this._writeData(e,S.fields.FIELD_UINT32,this.default_sample_description_index),this._writeData(e,S.fields.FIELD_UINT32,this.default_sample_duration),this._writeData(e,S.fields.FIELD_UINT32,this.default_sample_size),this._writeData(e,S.fields.FIELD_UINT32,this.default_sample_flags),this.localPos},S.boxes.VideoMediaHeaderBox=function(e){S.boxes.FullBox.call(this,"vmhd",e)},S.boxes.VideoMediaHeaderBox.prototype=Object.create(S.boxes.FullBox.prototype),S.boxes.VideoMediaHeaderBox.prototype.constructor=S.boxes.VideoMediaHeaderBox,S.boxes.VideoMediaHeaderBox.prototype.computeLength=function(){S.boxes.FullBox.prototype.computeLength.call(this),this.size+=S.fields.FIELD_INT16.getLength()+3*S.fields.FIELD_UINT16.getLength()},S.boxes.VideoMediaHeaderBox.prototype.read=function(e,t,n){return S.boxes.FullBox.prototype.read.call(this,e,t,n),this.graphicsmode=this._readData(e,S.fields.FIELD_INT16),this.opcolor=this._readArrayFieldData(e,S.fields.FIELD_UINT16,3),this.localPos},S.boxes.VideoMediaHeaderBox.prototype.write=function(e,t){return S.boxes.FullBox.prototype.write.call(this,e,t),this._writeData(e,S.fields.FIELD_INT16,this.graphicsmode),this._writeArrayData(e,S.fields.FIELD_UINT16,this.opcolor),this.localPos},S.boxes.SoundMediaHeaderBox=function(e){S.boxes.FullBox.call(this,"smhd",e)},S.boxes.SoundMediaHeaderBox.prototype=Object.create(S.boxes.FullBox.prototype),S.boxes.SoundMediaHeaderBox.prototype.constructor=S.boxes.SoundMediaHeaderBox,S.boxes.SoundMediaHeaderBox.prototype.computeLength=function(){S.boxes.FullBox.prototype.computeLength.call(this),this.size+=S.fields.FIELD_INT16.getLength()+S.fields.FIELD_UINT16.getLength()},S.boxes.SoundMediaHeaderBox.prototype.read=function(e,t,n){return S.boxes.FullBox.prototype.read.call(this,e,t,n),this.balance=this._readData(e,S.fields.FIELD_INT16),this.reserved=this._readData(e,S.fields.FIELD_UINT16),this.localPos},S.boxes.SoundMediaHeaderBox.prototype.write=function(e,t){return S.boxes.FullBox.prototype.write.call(this,e,t),this._writeData(e,S.fields.FIELD_INT16,this.balance),this._writeData(e,S.fields.FIELD_UINT16,this.reserved),this.localPos},S.boxes.DataReferenceBox=function(e){S.boxes.ContainerFullBox.call(this,"dref",e)},S.boxes.DataReferenceBox.prototype=Object.create(S.boxes.ContainerFullBox.prototype),S.boxes.DataReferenceBox.prototype.constructor=S.boxes.DataReferenceBox,S.boxes.DataReferenceBox.prototype.computeLength=function(){S.boxes.ContainerFullBox.prototype.computeLength.call(this,!0)},S.boxes.DataReferenceBox.prototype.read=function(e,t,n){return S.boxes.ContainerFullBox.prototype.read.call(this,e,t,n,!0)},S.boxes.DataReferenceBox.prototype.write=function(e,t){return this.entry_count||(this.entry_count=this.boxes.length),S.boxes.ContainerFullBox.prototype.write.call(this,e,t,!0)},S.boxes.DataEntryUrlBox=function(e){S.boxes.FullBox.call(this,"url ",e)},S.boxes.DataEntryUrlBox.prototype=Object.create(S.boxes.FullBox.prototype),S.boxes.DataEntryUrlBox.prototype.constructor=S.boxes.DataEntryUrlBox,S.boxes.DataEntryUrlBox.prototype.computeLength=function(){S.boxes.FullBox.prototype.computeLength.call(this),void 0!==this.location&&(this.size+=S.fields.FIELD_STRING.getLength(this.location))},S.boxes.DataEntryUrlBox.prototype.read=function(e,t,n){return S.boxes.FullBox.prototype.read.call(this,e,t,n),!1&this.flags&&(this.location=this._readData(e,S.fields.FIELD_STRING)),this.localPos},S.boxes.DataEntryUrlBox.prototype.write=function(e,t){return S.boxes.FullBox.prototype.write.call(this,e,t),void 0!==this.location&&this._writeData(e,S.fields.FIELD_STRING,this.location),this.localPos},S.boxes.DataEntryUrnBox=function(e){S.boxes.FullBox.call(this,"urn ",e)},S.boxes.DataEntryUrnBox.prototype=Object.create(S.boxes.FullBox.prototype),S.boxes.DataEntryUrnBox.prototype.constructor=S.boxes.DataEntryUrnBox,S.boxes.DataEntryUrnBox.prototype.computeLength=function(){S.boxes.FullBox.prototype.computeLength.call(this),!1&this.flags&&(this.size+=S.fields.FIELD_STRING.getLength(this.name)+S.fields.FIELD_STRING.getLength(this.location))},S.boxes.DataEntryUrnBox.prototype.read=function(e,t,n){return S.boxes.FullBox.prototype.read.call(this,e,t,n),!1&this.flags&&(this.name=this._readData(e,S.fields.FIELD_STRING),this.location=this._readData(e,S.fields.FIELD_STRING)),this.localPos},S.boxes.DataEntryUrnBox.prototype.write=function(e,t){return S.boxes.FullBox.prototype.write.call(this,e,t),!1&this.flags&&(this._writeData(e,S.fields.FIELD_STRING,this.name),this._writeData(e,S.fields.FIELD_STRING,this.location)),this.localPos},S.boxes.MovieFragmentHeaderBox=function(e){S.boxes.FullBox.call(this,"mfhd",e)},S.boxes.MovieFragmentHeaderBox.prototype=Object.create(S.boxes.FullBox.prototype),S.boxes.MovieFragmentHeaderBox.prototype.constructor=S.boxes.MovieFragmentHeaderBox,S.boxes.MovieFragmentHeaderBox.prototype.computeLength=function(){S.boxes.FullBox.prototype.computeLength.call(this),this.size+=S.fields.FIELD_UINT32.getLength()},S.boxes.MovieFragmentHeaderBox.prototype.read=function(e,t,n){return S.boxes.FullBox.prototype.read.call(this,e,t,n),this.sequence_number=this._readData(e,S.fields.FIELD_UINT32),this.localPos},S.boxes.MovieFragmentHeaderBox.prototype.write=function(e,t){return S.boxes.FullBox.prototype.write.call(this,e,t),this._writeData(e,S.fields.FIELD_UINT32,this.sequence_number),this.localPos},S.boxes.TrackFragmentHeaderBox=function(e){S.boxes.FullBox.call(this,"tfhd",e)},S.boxes.TrackFragmentHeaderBox.prototype=Object.create(S.boxes.FullBox.prototype),S.boxes.TrackFragmentHeaderBox.prototype.constructor=S.boxes.TrackFragmentHeaderBox,S.boxes.TrackFragmentHeaderBox.prototype.computeLength=function(){S.boxes.FullBox.prototype.computeLength.call(this),this.size+=S.fields.FIELD_UINT32.getLength(),0!=(1&this.flags)&&void 0!==this.base_data_offset&&(this.size+=S.fields.FIELD_UINT64.getLength()),0!=(2&this.flags)&&void 0!==this.sample_description_index&&(this.size+=S.fields.FIELD_UINT32.getLength()),0!=(8&this.flags)&&void 0!==this.default_sample_duration&&(this.size+=S.fields.FIELD_UINT32.getLength()),0!=(16&this.flags)&&void 0!==this.default_sample_size&&(this.size+=S.fields.FIELD_UINT32.getLength()),0!=(32&this.flags)&&void 0!==this.default_sample_flags&&(this.size+=S.fields.FIELD_UINT32.getLength())},S.boxes.TrackFragmentHeaderBox.prototype.read=function(e,t,n){return S.boxes.FullBox.prototype.read.call(this,e,t,n),this.track_ID=this._readData(e,S.fields.FIELD_UINT32),0!=(1&this.flags)&&(this.base_data_offset=this._readData(e,S.fields.FIELD_UINT64)),0!=(2&this.flags)&&(this.sample_description_index=this._readData(e,S.fields.FIELD_UINT32)),0!=(8&this.flags)&&(this.default_sample_duration=this._readData(e,S.fields.FIELD_UINT32)),0!=(16&this.flags)&&(this.default_sample_size=this._readData(e,S.fields.FIELD_UINT32)),0!=(32&this.flags)&&(this.default_sample_flags=this._readData(e,S.fields.FIELD_UINT32)),this.localPos},S.boxes.TrackFragmentHeaderBox.prototype.write=function(e,t){return S.boxes.FullBox.prototype.write.call(this,e,t),this._writeData(e,S.fields.FIELD_UINT32,this.track_ID),0!=(1&this.flags)&&this._writeData(e,S.fields.FIELD_UINT64,this.base_data_offset),0!=(2&this.flags)&&this._writeData(e,S.fields.FIELD_UINT32,this.sample_description_index),0!=(8&this.flags)&&this._writeData(e,S.fields.FIELD_UINT32,this.default_sample_duration),0!=(16&this.flags)&&this._writeData(e,S.fields.FIELD_UINT32,this.default_sample_size),0!=(32&this.flags)&&this._writeData(e,S.fields.FIELD_UINT32,this.default_sample_flags),this.localPos},S.boxes.TrackFragmentBaseMediaDecodeTimeBox=function(e){S.boxes.FullBox.call(this,"tfdt",e)},S.boxes.TrackFragmentBaseMediaDecodeTimeBox.prototype=Object.create(S.boxes.FullBox.prototype),S.boxes.TrackFragmentBaseMediaDecodeTimeBox.prototype.constructor=S.boxes.TrackFragmentBaseMediaDecodeTimeBox,S.boxes.TrackFragmentBaseMediaDecodeTimeBox.prototype.computeLength=function(){S.boxes.FullBox.prototype.computeLength.call(this),1===this.version?this.size+=S.fields.FIELD_UINT64.getLength():this.size+=S.fields.FIELD_UINT32.getLength()},S.boxes.TrackFragmentBaseMediaDecodeTimeBox.prototype.read=function(e,t,n){return S.boxes.FullBox.prototype.read.call(this,e,t,n),1===this.version?this.baseMediaDecodeTime=this._readData(e,S.fields.FIELD_UINT64):this.baseMediaDecodeTime=this._readData(e,S.fields.FIELD_UINT32),this.localPos},S.boxes.TrackFragmentBaseMediaDecodeTimeBox.prototype.write=function(e,t){return S.boxes.FullBox.prototype.write.call(this,e,t),1===this.version?this._writeData(e,S.fields.FIELD_UINT64,this.baseMediaDecodeTime):this._writeData(e,S.fields.FIELD_UINT32,this.baseMediaDecodeTime),this.localPos},S.boxes.TrackFragmentRunBox=function(e){S.boxes.FullBox.call(this,"trun",e)},S.boxes.TrackFragmentRunBox.prototype=Object.create(S.boxes.FullBox.prototype),S.boxes.TrackFragmentRunBox.prototype.constructor=S.boxes.TrackFragmentRunBox,S.boxes.TrackFragmentRunBox.prototype.computeLength=function(){S.boxes.FullBox.prototype.computeLength.call(this);var e=0;for(this.size+=S.fields.FIELD_UINT32.getLength(),0!=(1&this.flags)&&void 0!==this.data_offset&&(this.size+=S.fields.FIELD_INT32.getLength()),0!=(4&this.flags)&&void 0!==this.first_sample_flags&&(this.size+=S.fields.FIELD_UINT32.getLength()),e=0;e<this.sample_count;e++)0!=(256&this.flags)&&void 0!==this.samples_table[e].sample_duration&&(this.size+=S.fields.FIELD_UINT32.getLength()),0!=(512&this.flags)&&void 0!==this.samples_table[e].sample_size&&(this.size+=S.fields.FIELD_UINT32.getLength()),0!=(1024&this.flags)&&void 0!==this.samples_table[e].sample_flags&&(this.size+=S.fields.FIELD_UINT32.getLength()),1===this.version?0!=(2048&this.flags)&&void 0!==this.samples_table[e].sample_composition_time_offset&&(this.size+=S.fields.FIELD_INT32.getLength()):0!=(2048&this.flags)&&void 0!==this.samples_table[e].sample_composition_time_offset&&(this.size+=S.fields.FIELD_UINT32.getLength())},S.boxes.TrackFragmentRunBox.prototype.read=function(e,t,n){S.boxes.FullBox.prototype.read.call(this,e,t,n);var r=0,i={};for(this.sample_count=this._readData(e,S.fields.FIELD_UINT32),0!=(1&this.flags)&&(this.data_offset=this._readData(e,S.fields.FIELD_INT32)),0!=(4&this.flags)&&(this.first_sample_flags=this._readData(e,S.fields.FIELD_UINT32)),this.samples_table=[],r=0;r<this.sample_count;r++)i={},0!=(256&this.flags)&&(i.sample_duration=this._readData(e,S.fields.FIELD_UINT32)),0!=(512&this.flags)&&(i.sample_size=this._readData(e,S.fields.FIELD_UINT32)),0!=(1024&this.flags)&&(i.sample_flags=this._readData(e,S.fields.FIELD_UINT32)),1===this.version?0!=(2048&this.flags)&&(i.sample_composition_time_offset=this._readData(e,S.fields.FIELD_INT32)):0!=(2048&this.flags)&&(i.sample_composition_time_offset=this._readData(e,S.fields.FIELD_UINT32)),this.samples_table.push(i);return this.localPos},S.boxes.TrackFragmentRunBox.prototype.write=function(e,t){S.boxes.FullBox.prototype.write.call(this,e,t);var n=0;for(this._writeData(e,S.fields.FIELD_UINT32,this.sample_count),0!=(1&this.flags)&&this._writeData(e,S.fields.FIELD_INT32,this.data_offset),0!=(4&this.flags)&&this._writeData(e,S.fields.FIELD_UINT32,this.first_sample_flags),n=0;n<this.sample_count;n++)0!=(256&this.flags)&&this._writeData(e,S.fields.FIELD_UINT32,this.samples_table[n].sample_duration),0!=(512&this.flags)&&this._writeData(e,S.fields.FIELD_UINT32,this.samples_table[n].sample_size),0!=(1024&this.flags)&&this._writeData(e,S.fields.FIELD_UINT32,this.samples_table[n].sample_flags),1===this.version?0!=(2048&this.flags)&&this._writeData(e,S.fields.FIELD_INT32,this.samples_table[n].sample_composition_time_offset):0!=(2048&this.flags)&&this._writeData(e,S.fields.FIELD_UINT32,this.samples_table[n].sample_composition_time_offset);return this.localPos},S.boxes.SampleDescriptionBox=function(e){S.boxes.ContainerFullBox.call(this,"stsd",e)},S.boxes.SampleDescriptionBox.prototype=Object.create(S.boxes.ContainerFullBox.prototype),S.boxes.SampleDescriptionBox.prototype.constructor=S.boxes.SampleDescriptionBox,S.boxes.SampleDescriptionBox.prototype.computeLength=function(){S.boxes.ContainerFullBox.prototype.computeLength.call(this,!0)},S.boxes.SampleDescriptionBox.prototype.read=function(e,t,n){return S.boxes.ContainerFullBox.prototype.read.call(this,e,t,n,!0)},S.boxes.SampleDescriptionBox.prototype.write=function(e,t){return this.entry_count=this.boxes.length,S.boxes.ContainerFullBox.prototype.write.call(this,e,t,!0)},S.boxes.SampleDependencyTableBox=function(e){S.boxes.FullBox.call(this,"sdtp",e)},S.boxes.SampleDependencyTableBox.prototype=Object.create(S.boxes.FullBox.prototype),S.boxes.SampleDependencyTableBox.prototype.constructor=S.boxes.SampleDependencyTableBox,S.boxes.SampleDependencyTableBox.prototype.computeLength=function(){S.boxes.FullBox.prototype.computeLength.call(this),this.size+=S.fields.FIELD_UINT8.getLength()*this.sample_dependency_table.length},S.boxes.SampleDependencyTableBox.prototype.read=function(e,t,n){return S.boxes.FullBox.prototype.read.call(this,e,t,n),this.sample_dependency_table=this._readArrayData(e,S.fields.FIELD_UINT8),this.localPos},S.boxes.SampleDependencyTableBox.prototype.write=function(e,t){return S.boxes.FullBox.prototype.write.call(this,e,t),this._writeArrayData(e,S.fields.FIELD_UINT8,this.sample_dependency_table),this.localPos},S.boxes.SampleEntryBox=function(e,t){S.boxes.Box.call(this,e,t)},S.boxes.SampleEntryBox.prototype=Object.create(S.boxes.Box.prototype),S.boxes.SampleEntryBox.prototype.constructor=S.boxes.SampleEntryBox,S.boxes.SampleEntryBox.prototype.computeLength=function(){S.boxes.Box.prototype.computeLength.call(this),this.size+=S.fields.FIELD_UINT16.getLength()+6*S.fields.FIELD_UINT8.getLength()},S.boxes.SampleEntryBox.prototype.read=function(e,t,n){return this.localPos=t,this.localEnd=n,this.reserved=this._readArrayFieldData(e,S.fields.FIELD_UINT8,6),this.data_reference_index=this._readData(e,S.fields.FIELD_UINT16),this.localPos},S.boxes.SampleEntryBox.prototype.write=function(e,t){return S.boxes.Box.prototype.write.call(this,e,t),this._writeArrayData(e,S.fields.FIELD_UINT8,this.reserved),this._writeData(e,S.fields.FIELD_UINT16,this.data_reference_index),this.localPos},S.boxes.VisualSampleEntryBox=function(e,t){S.boxes.SampleEntryBox.call(this,e,t)},S.boxes.VisualSampleEntryBox.prototype=Object.create(S.boxes.SampleEntryBox.prototype),S.boxes.VisualSampleEntryBox.prototype.constructor=S.boxes.VisualSampleEntryBox,S.boxes.VisualSampleEntryBox.prototype.computeLength=function(){S.boxes.SampleEntryBox.prototype.computeLength.call(this),this.size+=7*S.fields.FIELD_UINT16.getLength()+3*S.fields.FIELD_UINT32.getLength(),this.size+=3*S.fields.FIELD_UINT32.getLength(),this.size+=32},S.boxes.VisualSampleEntryBox.prototype.read=function(e,t,n){return S.boxes.SampleEntryBox.prototype.read.call(this,e,t,n),this.pre_defined=this._readData(e,S.fields.FIELD_UINT16),this.reserved_2=this._readData(e,S.fields.FIELD_UINT16),this.pre_defined_2=this._readArrayFieldData(e,S.fields.FIELD_UINT32,3),this.width=this._readData(e,S.fields.FIELD_UINT16),this.height=this._readData(e,S.fields.FIELD_UINT16),this.horizresolution=this._readData(e,S.fields.FIELD_UINT32),this.vertresolution=this._readData(e,S.fields.FIELD_UINT32),this.reserved_3=this._readData(e,S.fields.FIELD_UINT32),this.frame_count=this._readData(e,S.fields.FIELD_UINT16),this.compressorname=this._readArrayFieldData(e,S.fields.FIELD_UINT8,32),this.depth=this._readData(e,S.fields.FIELD_UINT16),this.pre_defined_3=this._readData(e,S.fields.FIELD_INT16),this.localPos},S.boxes.VisualSampleEntryBox.prototype.write=function(e,t){return S.boxes.SampleEntryBox.prototype.write.call(this,e,t),this._writeData(e,S.fields.FIELD_UINT16,this.pre_defined),this._writeData(e,S.fields.FIELD_UINT16,this.reserved_2),this._writeArrayData(e,S.fields.FIELD_UINT32,this.pre_defined_2),this._writeData(e,S.fields.FIELD_UINT16,this.width),this._writeData(e,S.fields.FIELD_UINT16,this.height),this._writeData(e,S.fields.FIELD_UINT32,this.horizresolution),this._writeData(e,S.fields.FIELD_UINT32,this.vertresolution),this._writeData(e,S.fields.FIELD_UINT32,this.reserved_3),this._writeData(e,S.fields.FIELD_UINT16,this.frame_count),this._writeArrayData(e,S.fields.FIELD_UINT8,this.compressorname),this._writeData(e,S.fields.FIELD_UINT16,this.depth),this._writeData(e,S.fields.FIELD_INT16,this.pre_defined_3),this.localPos},S.boxes.VisualSampleEntryContainerBox=function(e,t){S.boxes.VisualSampleEntryBox.call(this,e,t),this.boxes=[]},S.boxes.VisualSampleEntryContainerBox.prototype=Object.create(S.boxes.VisualSampleEntryBox.prototype),S.boxes.VisualSampleEntryContainerBox.prototype.constructor=S.boxes.VisualSampleEntryContainerBox,S.boxes.VisualSampleEntryContainerBox.prototype.computeLength=function(){S.boxes.VisualSampleEntryBox.prototype.computeLength.call(this);var e=0;for(e=0;e<this.boxes.length;e++)this.boxes[e].computeLength(),this.size+=this.boxes[e].size},S.boxes.VisualSampleEntryContainerBox.prototype.read=function(e,t,n){S.boxes.VisualSampleEntryBox.prototype.read.call(this,e,t,n);for(var r,i,o=0,a=0,s=null;this.localPos<this.localEnd;){if(o=S.fields.FIELD_UINT32.read(e,this.localPos),r=S.fields.readString(e,this.localPos+4,4),"uuid"==r&&(a=1==o?16:8,s=new S.fields.ArrayField(S.fields.FIELD_INT8,16).read(e,this.localPos+a,this.localPos+a+16),s=JSON.stringify(s)),i=S.createBox(r,o,s),this.localPos="uuid"===r?i.read(e,this.localPos+16*S.fields.FIELD_INT8.getLength()+8,this.localPos+o):i.read(e,this.localPos+8,this.localPos+o),S.debug&&(i.__sourceBuffer=e.subarray(this.localPos-i.size,this.localPos)),this.boxes.push(i),i.size<=0||null===i.size)throw new S.ParseException("Problem on size of box "+i.boxtype+", parsing stopped to avoid infinite loop");if(!i.boxtype)throw new S.ParseException("Problem on unknown box, parsing stopped to avoid infinite loop")}return this.localPos},S.boxes.VisualSampleEntryContainerBox.prototype.write=function(e,t){S.boxes.VisualSampleEntryBox.prototype.write.call(this,e,t);var n=0;for(n=0;n<this.boxes.length;n++)this.localPos=this.boxes[n].write(e,this.localPos);return this.localPos},S.boxes.AVC1VisualSampleEntryBox=function(e){S.boxes.VisualSampleEntryContainerBox.call(this,"avc1",e)},S.boxes.AVC1VisualSampleEntryBox.prototype=Object.create(S.boxes.VisualSampleEntryContainerBox.prototype),S.boxes.AVC1VisualSampleEntryBox.prototype.constructor=S.boxes.AVC1VisualSampleEntryBox,S.boxes.EncryptedVideoBox=function(e){S.boxes.VisualSampleEntryContainerBox.call(this,"encv",e)},S.boxes.EncryptedVideoBox.prototype=Object.create(S.boxes.VisualSampleEntryContainerBox.prototype),S.boxes.EncryptedVideoBox.prototype.constructor=S.boxes.EncryptedVideoBox,S.boxes.AVCConfigurationBox=function(e){S.boxes.Box.call(this,"avcC",e)},S.boxes.AVCConfigurationBox.prototype=Object.create(S.boxes.Box.prototype),S.boxes.AVCConfigurationBox.prototype.constructor=S.boxes.AVCConfigurationBox,S.boxes.AVCConfigurationBox.prototype.computeLength=function(){S.boxes.Box.prototype.computeLength.call(this),this.size+=4*S.fields.FIELD_UINT8.getLength()+3*S.fields.FIELD_UINT8.getLength(),this.size+=this._getNALLength(this.numOfSequenceParameterSets,this.SPS_NAL),this.size+=this._getNALLength(this.numOfPictureParameterSets,this.PPS_NAL)},S.boxes.AVCConfigurationBox.prototype._getNALLength=function(e,t){var n=0,r=0;for(r=0;r<e;r++)n+=S.fields.FIELD_UINT16.getLength()+t[r].NAL_length;return n},S.boxes.AVCConfigurationBox.prototype.read=function(e,t,n){return this.localPos=t,this.localEnd=n,this.configurationVersion=this._readData(e,S.fields.FIELD_UINT8),this.AVCProfileIndication=this._readData(e,S.fields.FIELD_UINT8),this.profile_compatibility=this._readData(e,S.fields.FIELD_UINT8),this.AVCLevelIndication=this._readData(e,S.fields.FIELD_UINT8),this.temp=this._readData(e,S.fields.FIELD_UINT8),this.lengthSizeMinusOne=3&this.temp,this.numOfSequenceParameterSets_tmp=this._readData(e,S.fields.FIELD_UINT8),this.numOfSequenceParameterSets=31&this.numOfSequenceParameterSets_tmp,this.SPS_NAL=this._readNAL(e,this.numOfSequenceParameterSets),this.numOfPictureParameterSets=this._readData(e,S.fields.FIELD_UINT8),this.PPS_NAL=this._readNAL(e,this.numOfPictureParameterSets),this.localPos},S.boxes.AVCConfigurationBox.prototype._readNAL=function(e,t){var n=[],r=0,i={};for(r=0;r<t;r++)i={},i.NAL_length=this._readData(e,S.fields.FIELD_UINT16),i.NAL=e.subarray(this.localPos,this.localPos+i.NAL_length),this.localPos+=i.NAL_length,n.push(i);return n},S.boxes.AVCConfigurationBox.prototype.write=function(e,t){return S.boxes.Box.prototype.write.call(this,e,t),this._writeData(e,S.fields.FIELD_UINT8,this.configurationVersion),this._writeData(e,S.fields.FIELD_UINT8,this.AVCProfileIndication),this._writeData(e,S.fields.FIELD_UINT8,this.profile_compatibility),this._writeData(e,S.fields.FIELD_UINT8,this.AVCLevelIndication),this.temp=252|this.lengthSizeMinusOne,this._writeData(e,S.fields.FIELD_UINT8,this.temp),this.numOfSequenceParameterSets=this.SPS_NAL.length,this.numOfSequenceParameterSets_tmp=224|this.numOfSequenceParameterSets,this._writeData(e,S.fields.FIELD_UINT8,this.numOfSequenceParameterSets_tmp),this._writeNAL(e,this.numOfSequenceParameterSets,this.SPS_NAL),this._writeData(e,S.fields.FIELD_UINT8,this.numOfPictureParameterSets),this._writeNAL(e,this.numOfPictureParameterSets,this.PPS_NAL),this.localPos},S.boxes.AVCConfigurationBox.prototype._writeNAL=function(e,t,n){var r=0;for(r=0;r<t;r++)this._writeData(e,S.fields.FIELD_UINT16,n[r].NAL_length),this._writeBuffer(e,n[r].NAL,n[r].NAL_length)},S.boxes.PixelAspectRatioBox=function(e){S.boxes.Box.call(this,"pasp",e)},S.boxes.PixelAspectRatioBox.prototype=Object.create(S.boxes.Box.prototype),S.boxes.PixelAspectRatioBox.prototype.constructor=S.boxes.PixelAspectRatioBox,S.boxes.PixelAspectRatioBox.prototype.computeLength=function(){S.boxes.Box.prototype.computeLength.call(this),this.size+=2*S.fields.FIELD_INT32.getLength()},S.boxes.PixelAspectRatioBox.prototype.read=function(e,t,n){return this.localPos=t,this.localEnd=n,this.hSpacing=this._readData(e,S.fields.FIELD_INT32),this.vSpacing=this._readData(e,S.fields.FIELD_INT32),this.localPos},S.boxes.PixelAspectRatioBox.prototype.write=function(e,t){return S.boxes.Box.prototype.write.call(this,e,t),this._writeData(e,S.fields.FIELD_INT32,this.hSpacing),this._writeData(e,S.fields.FIELD_INT32,this.vSpacing),this.localPos},S.boxes.AudioSampleEntryBox=function(e,t){S.boxes.SampleEntryBox.call(this,e,t)},S.boxes.AudioSampleEntryBox.prototype=Object.create(S.boxes.SampleEntryBox.prototype),S.boxes.AudioSampleEntryBox.prototype.constructor=S.boxes.AudioSampleEntryBox,S.boxes.AudioSampleEntryBox.prototype.computeLength=function(){S.boxes.SampleEntryBox.prototype.computeLength.call(this),this.size+=4*S.fields.FIELD_UINT16.getLength()+3*S.fields.FIELD_UINT32.getLength()},S.boxes.AudioSampleEntryBox.prototype.read=function(e,t,n){return S.boxes.SampleEntryBox.prototype.read.call(this,e,t,n),this.reserved_2=this._readArrayFieldData(e,S.fields.FIELD_UINT32,2),this.channelcount=this._readData(e,S.fields.FIELD_UINT16),this.samplesize=this._readData(e,S.fields.FIELD_UINT16),this.pre_defined=this._readData(e,S.fields.FIELD_UINT16),this.reserved_3=this._readData(e,S.fields.FIELD_UINT16),this.samplerate=this._readData(e,S.fields.FIELD_UINT32),this.localPos},S.boxes.AudioSampleEntryBox.prototype.write=function(e,t){return S.boxes.SampleEntryBox.prototype.write.call(this,e,t),this._writeArrayData(e,S.fields.FIELD_UINT32,this.reserved_2),this._writeData(e,S.fields.FIELD_UINT16,this.channelcount),this._writeData(e,S.fields.FIELD_UINT16,this.samplesize),this._writeData(e,S.fields.FIELD_UINT16,this.pre_defined),this._writeData(e,S.fields.FIELD_UINT16,this.reserved_3),this._writeData(e,S.fields.FIELD_UINT32,this.samplerate),this.localPos},S.boxes.AudioSampleEntryContainerBox=function(e,t){S.boxes.AudioSampleEntryBox.call(this,e,t),this.boxes=[]},S.boxes.AudioSampleEntryContainerBox.prototype=Object.create(S.boxes.AudioSampleEntryBox.prototype),S.boxes.AudioSampleEntryContainerBox.prototype.constructor=S.boxes.AudioSampleEntryContainerBox,S.boxes.AudioSampleEntryContainerBox.prototype.computeLength=function(){S.boxes.AudioSampleEntryBox.prototype.computeLength.call(this);var e=0;for(e=0;e<this.boxes.length;e++)this.boxes[e].computeLength(),this.size+=this.boxes[e].size},S.boxes.AudioSampleEntryContainerBox.prototype.read=function(e,t,n){S.boxes.AudioSampleEntryBox.prototype.read.call(this,e,t,n);for(var r,i,o=0,a=0,s=null;this.localPos<this.localEnd;){if(o=S.fields.FIELD_UINT32.read(e,this.localPos),r=S.fields.readString(e,this.localPos+4,4),"uuid"==r&&(a=1==o?16:8,s=new S.fields.ArrayField(S.fields.FIELD_INT8,16).read(e,this.localPos+a,this.localPos+a+16),s=JSON.stringify(s)),i=S.createBox(r,o,s),this.localPos="uuid"===r?i.read(e,this.localPos+16*S.fields.FIELD_INT8.getLength()+8,this.localPos+o):i.read(e,this.localPos+8,this.localPos+o),S.debug&&(i.__sourceBuffer=e.subarray(this.localPos-i.size,this.localPos)),this.boxes.push(i),i.size<=0||null===i.size)throw new S.ParseException("Problem on size of box "+i.boxtype+", parsing stopped to avoid infinite loop");if(!i.boxtype)throw new S.ParseException("Problem on unknown box, parsing stopped to avoid infinite loop")}return this.localPos},S.boxes.AudioSampleEntryContainerBox.prototype.write=function(e,t){S.boxes.AudioSampleEntryBox.prototype.write.call(this,e,t);var n=0;for(n=0;n<this.boxes.length;n++)this.localPos=this.boxes[n].write(e,this.localPos);return this.localPos},S.boxes.MP4AudioSampleEntryBox=function(e){S.boxes.AudioSampleEntryContainerBox.call(this,"mp4a",e)},S.boxes.MP4AudioSampleEntryBox.prototype=Object.create(S.boxes.AudioSampleEntryContainerBox.prototype),S.boxes.MP4AudioSampleEntryBox.prototype.constructor=S.boxes.MP4AudioSampleEntryBox,S.boxes.EncryptedAudioBox=function(e){S.boxes.AudioSampleEntryContainerBox.call(this,"enca",e)},S.boxes.EncryptedAudioBox.prototype=Object.create(S.boxes.AudioSampleEntryContainerBox.prototype),S.boxes.EncryptedAudioBox.prototype.constructor=S.boxes.EncryptedAudioBox,S.boxes.ESDBox=function(e){S.boxes.FullBox.call(this,"esds",e)},S.boxes.ESDBox.prototype=Object.create(S.boxes.FullBox.prototype),S.boxes.ESDBox.prototype.constructor=S.boxes.ESDBox,S.boxes.ESDBox.prototype.computeLength=function(){S.boxes.FullBox.prototype.computeLength.call(this),this.size+=2*S.fields.FIELD_UINT8.getLength()+this.ES_length},S.boxes.ESDBox.prototype.read=function(e,t,n){return S.boxes.FullBox.prototype.read.call(this,e,t,n),this.ES_tag=this._readData(e,S.fields.FIELD_UINT8),this.ES_length=this._readData(e,S.fields.FIELD_UINT8),this.ES_data=e.subarray(this.localPos,this.localPos+this.ES_length),this.localPos+=this.ES_length,this.localPos},S.boxes.ESDBox.prototype.write=function(e,t){return S.boxes.FullBox.prototype.write.call(this,e,t),this._writeData(e,S.fields.FIELD_UINT8,this.ES_tag),this._writeData(e,S.fields.FIELD_UINT8,this.ES_length),this._writeBuffer(e,this.ES_data,this.ES_length),this.localPos},S.boxes.SampleSizeBox=function(e){S.boxes.FullBox.call(this,"stsz",e)},S.boxes.SampleSizeBox.prototype=Object.create(S.boxes.FullBox.prototype),S.boxes.SampleSizeBox.prototype.constructor=S.boxes.SampleSizeBox,S.boxes.SampleSizeBox.prototype.computeLength=function(){S.boxes.FullBox.prototype.computeLength.call(this),this.size+=2*S.fields.FIELD_UINT32.getLength()+S.fields.FIELD_UINT32.getLength()*this.sample_count},S.boxes.SampleSizeBox.prototype.read=function(e,t,n){return S.boxes.FullBox.prototype.read.call(this,e,t,n),this.sample_size=this._readData(e,S.fields.FIELD_UINT32),this.sample_count=this._readData(e,S.fields.FIELD_UINT32),this.entries=this._readArrayFieldData(e,S.fields.FIELD_UINT32,this.sample_count),this.localPos},S.boxes.SampleSizeBox.prototype.write=function(e,t){S.boxes.FullBox.prototype.write.call(this,e,t);var n=0;for(this._writeData(e,S.fields.FIELD_UINT32,this.sample_size),this._writeData(e,S.fields.FIELD_UINT32,this.sample_count),n=0;n<this.sample_count;n++)this._writeData(e,S.fields.FIELD_UINT32,this.entries[n]);return this.localPos},S.boxes.ProtectionSystemSpecificHeaderBox=function(e){S.boxes.FullBox.call(this,"pssh",e)},S.boxes.ProtectionSystemSpecificHeaderBox.prototype=Object.create(S.boxes.FullBox.prototype),S.boxes.ProtectionSystemSpecificHeaderBox.prototype.constructor=S.boxes.ProtectionSystemSpecificHeaderBox,S.boxes.ProtectionSystemSpecificHeaderBox.prototype.computeLength=function(){S.boxes.FullBox.prototype.computeLength.call(this),this.size+=16*S.fields.FIELD_UINT8.getLength(),this.size+=S.fields.FIELD_UINT32.getLength(),this.size+=S.fields.FIELD_UINT8.getLength()*this.DataSize},S.boxes.ProtectionSystemSpecificHeaderBox.prototype.read=function(e,t,n){return S.boxes.FullBox.prototype.read.call(this,e,t,n),this.SystemID=this._readArrayFieldData(e,S.fields.FIELD_UINT8,16),this.DataSize=this._readData(e,S.fields.FIELD_UINT32),this.Data=this._readArrayFieldData(e,S.fields.FIELD_UINT8,this.DataSize),this.localPos},S.boxes.ProtectionSystemSpecificHeaderBox.prototype.write=function(e,t){S.boxes.FullBox.prototype.write.call(this,e,t);var n=0;for(n=0;n<16;n++)this._writeData(e,S.fields.FIELD_UINT8,this.SystemID[n]);for(this._writeData(e,S.fields.FIELD_UINT32,this.DataSize),n=0;n<this.DataSize;n++)this._writeData(e,S.fields.FIELD_UINT8,this.Data[n]);return this.localPos},S.boxes.SampleEncryptionBox=function(e){S.boxes.FullBox.call(this,"senc",e)},S.boxes.SampleEncryptionBox.prototype=Object.create(S.boxes.FullBox.prototype),S.boxes.SampleEncryptionBox.prototype.constructor=S.boxes.SampleEncryptionBox,S.boxes.SampleEncryptionBox.prototype.computeLength=function(){S.boxes.FullBox.prototype.computeLength.call(this);var e=0,t=0;for(this.size+=S.fields.FIELD_UINT32.getLength(),1&this.flags&&(this.size+=S.fields.FIELD_UINT8.getLength()),e=0;e<this.sample_count;e++)if(this.size+=8,2&this.flags)for(this.size+=S.fields.FIELD_UINT16.getLength(),t=0;t<this.entry[e].NumberOfEntries;t++)this.size+=S.fields.FIELD_UINT16.getLength(),this.size+=S.fields.FIELD_UINT32.getLength()},S.boxes.SampleEncryptionBox.prototype.write=function(e,t){S.boxes.FullBox.prototype.write.call(this,e,t);var n=0,r=0;for(this._writeData(e,S.fields.FIELD_UINT32,this.sample_count),1&this.flags&&this._writeData(e,S.fields.FIELD_UINT8,this.IV_size),n=0;n<this.sample_count;n++)if(this._writeBuffer(e,this.entry[n].InitializationVector,8),2&this.flags)for(this._writeData(e,S.fields.FIELD_UINT16,this.entry[n].NumberOfEntries),r=0;r<this.entry[n].NumberOfEntries;r++)this._writeData(e,S.fields.FIELD_UINT16,this.entry[n].clearAndCryptedData[r].BytesOfClearData),this._writeData(e,S.fields.FIELD_UINT32,this.entry[n].clearAndCryptedData[r].BytesOfEncryptedData);return this.localPos},S.boxes.SampleEncryptionBox.prototype.read=function(e,t,n){S.boxes.FullBox.prototype.read.call(this,e,t,n);var r=0,i=0,o={},a={};for(this.sample_count=this._readData(e,S.fields.FIELD_UINT32),1&this.flags&&(this.IV_size=this._readData(e,S.fields.FIELD_UINT8)),this.entry=[],r=0;r<this.sample_count;r++){if(a={},a.InitializationVector=e.subarray(this.localPos,this.localPos+8),this.localPos+=8,2&this.flags)for(a.NumberOfEntries=this._readData(e,S.fields.FIELD_UINT16),a.clearAndCryptedData=[],i=0;i<a.NumberOfEntries;i++)o={},o.BytesOfClearData=this._readData(e,S.fields.FIELD_UINT16),o.BytesOfEncryptedData=this._readData(e,S.fields.FIELD_UINT32),a.clearAndCryptedData.push(o);this.entry.push(a)}return this.localPos},S.boxes.SampleAuxiliaryInformationSizesBox=function(e){S.boxes.FullBox.call(this,"saiz",e)},S.boxes.SampleAuxiliaryInformationSizesBox.prototype=Object.create(S.boxes.FullBox.prototype),S.boxes.SampleAuxiliaryInformationSizesBox.prototype.constructor=S.boxes.SampleAuxiliaryInformationSizesBox,S.boxes.SampleAuxiliaryInformationSizesBox.prototype.computeLength=function(){S.boxes.FullBox.prototype.computeLength.call(this),1&this.flags&&(this.size+=2*S.fields.FIELD_UINT32.getLength()),this.size+=S.fields.FIELD_UINT8.getLength()+S.fields.FIELD_UINT32.getLength(),0===this.default_sample_info_size&&(this.size+=S.fields.FIELD_UINT8.getLength()*this.sample_count)},S.boxes.SampleAuxiliaryInformationSizesBox.prototype.read=function(e,t,n){return S.boxes.FullBox.prototype.read.call(this,e,t,n),1&this.flags&&(this.aux_info_type=this._readData(e,S.fields.FIELD_UINT32),this.aux_info_type_parameter=this._readData(e,S.fields.FIELD_UINT32)),this.default_sample_info_size=this._readData(e,S.fields.FIELD_UINT8),this.sample_count=this._readData(e,S.fields.FIELD_UINT32),0===this.default_sample_info_size&&(this.sample_info_size=this._readArrayFieldData(e,S.fields.FIELD_UINT8,this.sample_count)),this.localPos},S.boxes.SampleAuxiliaryInformationSizesBox.prototype.write=function(e,t){S.boxes.FullBox.prototype.write.call(this,e,t);var n=0;if(1&this.flags&&(this._writeData(e,S.fields.FIELD_UINT32,this.aux_info_type),this._writeData(e,S.fields.FIELD_UINT32,this.aux_info_type_parameter)),this._writeData(e,S.fields.FIELD_UINT8,this.default_sample_info_size),this._writeData(e,S.fields.FIELD_UINT32,this.sample_count),0===this.default_sample_info_size)for(n=0;n<this.sample_count;n++)this._writeData(e,S.fields.FIELD_UINT8,this.sample_info_size[n]);return this.localPos},S.boxes.SampleAuxiliaryInformationOffsetsBox=function(e){S.boxes.FullBox.call(this,"saio",e)},S.boxes.SampleAuxiliaryInformationOffsetsBox.prototype=Object.create(S.boxes.FullBox.prototype),S.boxes.SampleAuxiliaryInformationOffsetsBox.prototype.constructor=S.boxes.SampleAuxiliaryInformationOffsetsBox,S.boxes.SampleAuxiliaryInformationOffsetsBox.prototype.computeLength=function(){S.boxes.FullBox.prototype.computeLength.call(this),1&this.flags&&(this.size+=2*S.fields.FIELD_UINT32.getLength()),this.size+=S.fields.FIELD_UINT32.getLength(),0===this.version?this.size+=S.fields.FIELD_UINT32.getLength()*this.entry_count:this.size+=S.fields.FIELD_UINT64.getLength()*this.entry_count},S.boxes.SampleAuxiliaryInformationOffsetsBox.prototype.read=function(e,t,n){return S.boxes.FullBox.prototype.read.call(this,e,t,n),1&this.flags&&(this.aux_info_type=this._readData(e,S.fields.FIELD_UINT32),this.aux_info_type_parameter=this._readData(e,S.fields.FIELD_UINT32)),this.entry_count=this._readData(e,S.fields.FIELD_UINT32),0===this.version?this.offset=this._readArrayFieldData(e,S.fields.FIELD_UINT32,this.entry_count):this.offset=this._readArrayFieldData(e,S.fields.FIELD_UINT64,this.entry_count),this.localPos},S.boxes.SampleAuxiliaryInformationOffsetsBox.prototype.write=function(e,t){S.boxes.FullBox.prototype.write.call(this,e,t);var n=0;if(1&this.flags&&(this._writeData(e,S.fields.FIELD_UINT32,this.aux_info_type),this._writeData(e,S.fields.FIELD_UINT32,this.aux_info_type_parameter)),this._writeData(e,S.fields.FIELD_UINT32,this.entry_count),0===this.version)for(n=0;n<this.entry_count;n++)this._writeData(e,S.fields.FIELD_UINT32,this.offset[n]);else for(n=0;n<this.entry_count;n++)this._writeData(e,S.fields.FIELD_UINT64,this.offset[n]);return this.localPos},S.boxes.ProtectionSchemeInformationBox=function(e){S.boxes.ContainerBox.call(this,"sinf",e)},S.boxes.ProtectionSchemeInformationBox.prototype=Object.create(S.boxes.ContainerBox.prototype),S.boxes.ProtectionSchemeInformationBox.prototype.constructor=S.boxes.ProtectionSchemeInformationBox,S.boxes.SchemeInformationBox=function(e){S.boxes.ContainerBox.call(this,"schi",e)},S.boxes.SchemeInformationBox.prototype=Object.create(S.boxes.ContainerBox.prototype),S.boxes.SchemeInformationBox.prototype.constructor=S.boxes.SchemeInformationBox,S.boxes.TrackEncryptionBox=function(e){S.boxes.FullBox.call(this,"tenc",e)},S.boxes.TrackEncryptionBox.prototype=Object.create(S.boxes.FullBox.prototype),S.boxes.TrackEncryptionBox.prototype.constructor=S.boxes.TrackEncryptionBox,S.boxes.TrackEncryptionBox.prototype.computeLength=function(){S.boxes.FullBox.prototype.computeLength.call(this),this.size+=S.fields.FIELD_BIT24.getLength(),this.size+=S.fields.FIELD_UINT8.getLength(),this.size+=16*S.fields.FIELD_UINT8.getLength()},S.boxes.TrackEncryptionBox.prototype.read=function(e,t,n){return S.boxes.FullBox.prototype.read.call(this,e,t,n),this.default_IsEncrypted=this._readData(e,S.fields.FIELD_BIT24),this.default_IV_size=this._readData(e,S.fields.FIELD_UINT8),this.default_KID=this._readArrayFieldData(e,S.fields.FIELD_UINT8,16),this.localPos},S.boxes.TrackEncryptionBox.prototype.write=function(e,t){return S.boxes.FullBox.prototype.write.call(this,e,t),this._writeData(e,S.fields.FIELD_BIT24,this.default_IsEncrypted),this._writeData(e,S.fields.FIELD_UINT8,this.default_IV_size),this._writeArrayData(e,S.fields.FIELD_UINT8,this.default_KID),this.localPos},S.boxes.SchemeTypeBox=function(e){S.boxes.FullBox.call(this,"schm",e)},S.boxes.SchemeTypeBox.prototype=Object.create(S.boxes.FullBox.prototype),S.boxes.SchemeTypeBox.prototype.constructor=S.boxes.SchemeTypeBox,S.boxes.SchemeTypeBox.prototype.computeLength=function(){S.boxes.FullBox.prototype.computeLength.call(this),this.size+=2*S.fields.FIELD_UINT32.getLength(),1&this.flags&&(this.size+=S.fields.FIELD_STRING.getLength(this.scheme_uri))},S.boxes.SchemeTypeBox.prototype.read=function(e,t,n){return S.boxes.FullBox.prototype.read.call(this,e,t,n),this.scheme_type=this._readData(e,S.fields.FIELD_UINT32),this.scheme_version=this._readData(e,S.fields.FIELD_UINT32),1&this.flags&&(this.scheme_uri=this._readData(e,S.fields.FIELD_STRING)),this.localPos},S.boxes.SchemeTypeBox.prototype.write=function(e,t){return S.boxes.FullBox.prototype.write.call(this,e,t),this._writeData(e,S.fields.FIELD_UINT32,this.scheme_type),this._writeData(e,S.fields.FIELD_UINT32,this.scheme_version),1&this.flags&&this._writeData(e,S.fields.FIELD_STRING,this.scheme_uri),this.localPos},S.boxes.EditListBox=function(e){S.boxes.FullBox.call(this,"elst",e),this.entries=[]},S.boxes.EditListBox.prototype=Object.create(S.boxes.FullBox.prototype),S.boxes.EditListBox.prototype.constructor=S.boxes.EditListBox,S.boxes.EditListBox.prototype.computeLength=function(){S.boxes.FullBox.prototype.computeLength.call(this),this.size+=S.fields.FIELD_UINT32.getLength(),1===this.version?this.size+=(2*S.fields.FIELD_UINT64.getLength()+2*S.fields.FIELD_UINT16.getLength())*this.entry_count:this.size+=(2*S.fields.FIELD_UINT32.getLength()+2*S.fields.FIELD_UINT16.getLength())*this.entry_count},S.boxes.EditListBox.prototype.read=function(e,t,n){S.boxes.FullBox.prototype.read.call(this,e,t,n);var r=0,i={};for(this.entry_count=this._readData(e,S.fields.FIELD_UINT32),r=0;r<this.entry_count;r++)i={},1===this.version?(i.segment_duration=this._readData(e,S.fields.FIELD_UINT64),i.media_time=this._readData(e,S.fields.FIELD_UINT64)):(i.segment_duration=this._readData(e,S.fields.FIELD_UINT32),i.media_time=this._readData(e,S.fields.FIELD_UINT32)),i.media_rate_integer=this._readData(e,S.fields.FIELD_UINT16),i.media_rate_fraction=this._readData(e,S.fields.FIELD_UINT16),this.entries.push(i);return this.localPos},S.boxes.EditListBox.prototype.write=function(e,t){S.boxes.FullBox.prototype.write.call(this,e,t);var n=0;for(this._writeData(e,S.fields.FIELD_UINT32,this.entry_count),n=0;n<this.entry_count;n++)1===this.version?(this._writeData(e,S.fields.FIELD_UINT64,this.entries[n].segment_duration),this._writeData(e,S.fields.FIELD_UINT64,this.entries[n].media_time)):(this._writeData(e,S.fields.FIELD_UINT32,this.entries[n].segment_duration),this._writeData(e,S.fields.FIELD_UINT32,this.entries[n].media_time)),this._writeData(e,S.fields.FIELD_UINT16,this.entries[n].media_rate_integer),this._writeData(e,S.fields.FIELD_UINT16,this.entries[n].media_rate_fraction);return this.localPos},S.boxes.HintMediaHeaderBox=function(e){S.boxes.FullBox.call(this,"hmhd",e)},S.boxes.HintMediaHeaderBox.prototype=Object.create(S.boxes.FullBox.prototype),S.boxes.HintMediaHeaderBox.prototype.constructor=S.boxes.HintMediaHeaderBox,S.boxes.HintMediaHeaderBox.prototype.computeLength=function(){S.boxes.FullBox.prototype.computeLength.call(this),this.size+=2*S.fields.FIELD_UINT16.getLength(),this.size+=3*S.fields.FIELD_UINT32.getLength()},S.boxes.HintMediaHeaderBox.prototype.read=function(e,t,n){return S.boxes.FullBox.prototype.read.call(this,e,t,n),this.maxPDUsize=this._readData(e,S.fields.FIELD_UINT16),this.avgPDUsize=this._readData(e,S.fields.FIELD_UINT16),this.maxbitrate=this._readData(e,S.fields.FIELD_UINT32),this.avgbitrate=this._readData(e,S.fields.FIELD_UINT32),this.reserved=this._readData(e,S.fields.FIELD_UINT32),this.localPos};S.boxes.HintMediaHeaderBox.prototype.write=function(e,t){return S.boxes.FullBox.prototype.write.call(this,e,t),this._writeData(e,S.fields.FIELD_UINT16,this.maxPDUsize),this._writeData(e,S.fields.FIELD_UINT16,this.avgPDUsize),this._writeData(e,S.fields.FIELD_UINT32,this.maxbitrate),this._writeData(e,S.fields.FIELD_UINT32,this.avgbitrate),this._writeData(e,S.fields.FIELD_UINT32,this.reserved),this.localPos},S.boxes.NullMediaHeaderBox=function(e){S.boxes.FullBox.call(this,"nmhd",e)},S.boxes.NullMediaHeaderBox.prototype=Object.create(S.boxes.FullBox.prototype),S.boxes.NullMediaHeaderBox.prototype.constructor=S.boxes.NullMediaHeaderBox,S.boxes.CompositionOffsetBox=function(e){S.boxes.FullBox.call(this,"ctts",e),this.entries=[]},S.boxes.CompositionOffsetBox.prototype=Object.create(S.boxes.FullBox.prototype),S.boxes.CompositionOffsetBox.prototype.constructor=S.boxes.CompositionOffsetBox,S.boxes.CompositionOffsetBox.prototype.computeLength=function(){S.boxes.FullBox.prototype.computeLength.call(this),this.size+=S.fields.FIELD_UINT32.getLength(),0===this.version?this.size+=2*S.fields.FIELD_UINT32.getLength()*this.entry_count:this.size+=(S.fields.FIELD_UINT32.getLength()+S.fields.FIELD_INT32.getLength())*this.entry_count},S.boxes.CompositionOffsetBox.prototype.read=function(e,t,n){S.boxes.FullBox.prototype.read.call(this,e,t,n);var r=0,i={};for(this.entry_count=this._readData(e,S.fields.FIELD_UINT32),r=0;r<this.entry_count;r++)i={},0===this.version?(i.sample_count=this._readData(e,S.fields.FIELD_UINT32),i.sample_offset=this._readData(e,S.fields.FIELD_UINT32)):(i.sample_count=this._readData(e,S.fields.FIELD_UINT32),i.sample_offset=this._readData(e,S.fields.FIELD_INT32)),this.entries.push(i);return this.localPos},S.boxes.CompositionOffsetBox.prototype.write=function(e,t){S.boxes.FullBox.prototype.write.call(this,e,t);var n=0;for(this._writeData(e,S.fields.FIELD_UINT32,this.entry_count),n=0;n<this.entry_count;n++)0===this.version?(this._writeData(e,S.fields.FIELD_UINT32,this.entries[n].sample_count),this._writeData(e,S.fields.FIELD_UINT32,this.entries[n].sample_offset)):(this._writeData(e,S.fields.FIELD_UINT32,this.entries[n].sample_count),this._writeData(e,S.fields.FIELD_INT32,this.entries[n].sample_offset));return this.localPos},S.boxes.CompositionToDecodeBox=function(e){S.boxes.FullBox.call(this,"cslg",e)},S.boxes.CompositionToDecodeBox.prototype=Object.create(S.boxes.FullBox.prototype),S.boxes.CompositionToDecodeBox.prototype.constructor=S.boxes.CompositionToDecodeBox,S.boxes.CompositionToDecodeBox.prototype.computeLength=function(){S.boxes.FullBox.prototype.computeLength.call(this),this.size+=5*S.fields.FIELD_INT32.getLength()},S.boxes.CompositionToDecodeBox.prototype.read=function(e,t,n){return S.boxes.FullBox.prototype.read.call(this,e,t,n),this.compositionToDTSShift=this._readData(e,S.fields.FIELD_INT32),this.leastDecodeToDisplayDelta=this._readData(e,S.fields.FIELD_INT32),this.greatestDecodeToDisplayDelta=this._readData(e,S.fields.FIELD_INT32),this.compositionStartTime=this._readData(e,S.fields.FIELD_INT32),this.compositionEndTime=this._readData(e,S.fields.FIELD_INT32),this.localPos},S.boxes.CompositionToDecodeBox.prototype.write=function(e,t){return S.boxes.FullBox.prototype.write.call(this,e,t),this._writeData(e,S.fields.FIELD_INT32,this.compositionToDTSShift),this._writeData(e,S.fields.FIELD_INT32,this.leastDecodeToDisplayDelta),this._writeData(e,S.fields.FIELD_INT32,this.greatestDecodeToDisplayDelta),this._writeData(e,S.fields.FIELD_INT32,this.compositionStartTime),this._writeData(e,S.fields.FIELD_INT32,this.compositionEndTime),this.localPos},S.boxes.SyncSampleBox=function(e){S.boxes.FullBox.call(this,"stss",e),this.entries=[]},S.boxes.SyncSampleBox.prototype=Object.create(S.boxes.FullBox.prototype),S.boxes.SyncSampleBox.prototype.constructor=S.boxes.SyncSampleBox,S.boxes.SyncSampleBox.prototype.computeLength=function(){S.boxes.FullBox.prototype.computeLength.call(this),this.size+=S.fields.FIELD_UINT32.getLength(),this.size+=S.fields.FIELD_UINT32.getLength()*this.entry_count},S.boxes.SyncSampleBox.prototype.read=function(e,t,n){S.boxes.FullBox.prototype.read.call(this,e,t,n);var r=0,i={};for(this.entry_count=this._readData(e,S.fields.FIELD_UINT32),r=0;r<this.entry_count;r++)i={},i.sample_number=this._readData(e,S.fields.FIELD_UINT32),this.entries.push(i);return this.localPos},S.boxes.SyncSampleBox.prototype.write=function(e,t){S.boxes.FullBox.prototype.write.call(this,e,t);var n=0;for(this._writeData(e,S.fields.FIELD_UINT32,this.entry_count),n=0;n<this.entry_count;n++)this._writeData(e,S.fields.FIELD_UINT32,this.entries[n].sample_number);return this.localPos},S.boxes.TrackReferenceBox=function(e){S.boxes.FullBox.call(this,"tref",e)},S.boxes.TrackReferenceBox.prototype=Object.create(S.boxes.FullBox.prototype),S.boxes.TrackReferenceBox.prototype.constructor=S.boxes.TrackReferenceBox,S.boxes.TrackReferenceBox.prototype.computeLength=function(){S.boxes.FullBox.prototype.computeLength.call(this),this.size+=S.fields.FIELD_UINT32.getLength()*this.track_IDs.length},S.boxes.TrackReferenceBox.prototype.read=function(e,t,n){return S.boxes.FullBox.prototype.read.call(this,e,t,n),this.track_IDs=this._readArrayData(e,S.fields.FIELD_UINT32),this.localPos},S.boxes.TrackReferenceBox.prototype.write=function(e,t){return S.boxes.FullBox.prototype.write.call(this,e,t),this._writeArrayData(e,S.fields.FIELD_UINT32,this.track_IDs),this.localPos},S.boxes.OriginalFormatBox=function(e){S.boxes.Box.call(this,"frma",e)},S.boxes.OriginalFormatBox.prototype=Object.create(S.boxes.Box.prototype),S.boxes.OriginalFormatBox.prototype.constructor=S.boxes.OriginalFormatBox,S.boxes.OriginalFormatBox.prototype.computeLength=function(){S.boxes.Box.prototype.computeLength.call(this),this.size+=S.fields.FIELD_UINT32.getLength()},S.boxes.OriginalFormatBox.prototype.read=function(e,t,n){return this.localPos=t,this.localEnd=n,this.data_format=this._readData(e,S.fields.FIELD_UINT32),this.localPos},S.boxes.OriginalFormatBox.prototype.write=function(e,t){return S.boxes.Box.prototype.write.call(this,e,t),this._writeData(e,S.fields.FIELD_UINT32,this.data_format),this.localPos},S.boxes.PiffSampleEncryptionBox=function(e){S.boxes.FullBox.call(this,"sepiff",e,[162,57,79,82,90,155,79,20,162,68,108,66,124,100,141,244])},S.boxes.PiffSampleEncryptionBox.prototype=Object.create(S.boxes.FullBox.prototype),S.boxes.PiffSampleEncryptionBox.prototype.constructor=S.boxes.PiffSampleEncryptionBox,S.boxes.PiffSampleEncryptionBox.prototype.computeLength=function(){S.boxes.FullBox.prototype.computeLength.call(this);var e=0,t=0;for(this.size+=S.fields.FIELD_UINT32.getLength(),1&this.flags&&(this.size+=S.fields.FIELD_UINT8.getLength()),e=0;e<this.sample_count;e++)if(this.size+=8,2&this.flags)for(this.size+=S.fields.FIELD_UINT16.getLength(),t=0;t<this.entry[e].NumberOfEntries;t++)this.size+=S.fields.FIELD_UINT16.getLength(),this.size+=S.fields.FIELD_UINT32.getLength()},S.boxes.PiffSampleEncryptionBox.prototype.write=function(e,t){S.boxes.FullBox.prototype.write.call(this,e,t);var n=0,r=0;for(this._writeData(e,S.fields.FIELD_UINT32,this.sample_count),1&this.flags&&this._writeData(e,S.fields.FIELD_UINT8,this.IV_size),n=0;n<this.sample_count;n++)if(this._writeBuffer(e,this.entry[n].InitializationVector,8),2&this.flags)for(this._writeData(e,S.fields.FIELD_UINT16,this.entry[n].NumberOfEntries),r=0;r<this.entry[n].NumberOfEntries;r++)this._writeData(e,S.fields.FIELD_UINT16,this.entry[n].clearAndCryptedData[r].BytesOfClearData),this._writeData(e,S.fields.FIELD_UINT32,this.entry[n].clearAndCryptedData[r].BytesOfEncryptedData);return this.localPos},S.boxes.PiffSampleEncryptionBox.prototype.read=function(e,t,n){S.boxes.FullBox.prototype.read.call(this,e,t,n);var r=0,i=0,o={},a={};for(this.sample_count=this._readData(e,S.fields.FIELD_UINT32),1&this.flags&&(this.IV_size=this._readData(e,S.fields.FIELD_UINT8)),this.entry=[],r=0;r<this.sample_count;r++){if(a={},a.InitializationVector=e.subarray(this.localPos,this.localPos+8),this.localPos+=8,2&this.flags)for(a.NumberOfEntries=this._readData(e,S.fields.FIELD_UINT16),a.clearAndCryptedData=[],i=0;i<a.NumberOfEntries;i++)o={},o.BytesOfClearData=this._readData(e,S.fields.FIELD_UINT16),o.BytesOfEncryptedData=this._readData(e,S.fields.FIELD_UINT32),a.clearAndCryptedData.push(o);this.entry.push(a)}return this.localPos},S.boxes.PiffTrackEncryptionBox=function(e){S.boxes.FullBox.call(this,"tepiff",e,[137,116,219,206,123,231,76,81,132,249,113,72,249,136,37,84])},S.boxes.PiffTrackEncryptionBox.prototype=Object.create(S.boxes.FullBox.prototype),S.boxes.PiffTrackEncryptionBox.prototype.constructor=S.boxes.PiffTrackEncryptionBox,S.boxes.PiffProtectionSystemSpecificHeaderBox=function(e){S.boxes.FullBox.call(this,"psshpiff",e,[208,138,79,24,16,243,74,130,182,200,50,216,171,161,131,211])},S.boxes.PiffProtectionSystemSpecificHeaderBox.prototype=Object.create(S.boxes.FullBox.prototype),S.boxes.PiffProtectionSystemSpecificHeaderBox.prototype.constructor=S.boxes.PiffProtectionSystemSpecificHeaderBox,S.boxes.TfxdBox=function(e){S.boxes.FullBox.call(this,"tfxd",e,[109,29,155,5,66,213,68,230,128,226,20,29,175,247,87,178])},S.boxes.TfxdBox.prototype=Object.create(S.boxes.FullBox.prototype),S.boxes.TfxdBox.prototype.constructor=S.boxes.TfxdBox,S.boxes.TfxdBox.prototype.computeLength=function(){S.boxes.FullBox.prototype.computeLength.call(this),1===this.version?this.size+=2*S.fields.FIELD_UINT64.getLength():this.size+=2*S.fields.FIELD_UINT32.getLength()},S.boxes.TfxdBox.prototype.write=function(e,t){return S.boxes.FullBox.prototype.write.call(this,e,t),1===this.version?(this._writeData(e,S.fields.FIELD_UINT64,this.fragment_absolute_time),this._writeData(e,S.fields.FIELD_UINT64,this.fragment_duration)):(this._writeData(e,S.fields.FIELD_UINT32,this.fragment_absolute_time),this._writeData(e,S.fields.FIELD_UINT32,this.fragment_duration)),this.localPos},S.boxes.TfxdBox.prototype.read=function(e,t,n){return S.boxes.FullBox.prototype.read.call(this,e,t,n),1===this.version?(this.fragment_absolute_time=this._readData(e,S.fields.FIELD_UINT64),this.fragment_duration=this._readData(e,S.fields.FIELD_UINT64)):(this.fragment_absolute_time=this._readData(e,S.fields.FIELD_UINT32),this.fragment_duration=this._readData(e,S.fields.FIELD_UINT32)),this.localPos},S.boxes.TfrfBox=function(e){S.boxes.FullBox.call(this,"tfrf",e,[212,128,126,242,202,57,70,149,142,84,38,203,158,70,167,159])},S.boxes.TfrfBox.prototype=Object.create(S.boxes.FullBox.prototype),S.boxes.TfrfBox.prototype.constructor=S.boxes.TfrfBox,S.boxes.TfrfBox.prototype.computeLength=function(){S.boxes.FullBox.prototype.computeLength.call(this),this.size+=S.fields.FIELD_UINT8.getLength(),1===this.version?this.size+=2*S.fields.FIELD_UINT64.getLength()*this.fragment_count:this.size+=2*S.fields.FIELD_UINT32.getLength()*this.fragment_count},S.boxes.TfrfBox.prototype.write=function(e,t){S.boxes.FullBox.prototype.write.call(this,e,t);var n=0;for(this._writeData(e,S.fields.FIELD_UINT8,this.fragment_count),n=0;n<this.fragment_count;n++)1===this.version?(this._writeData(e,S.fields.FIELD_UINT64,this.entry[n].fragment_absolute_time),this._writeData(e,S.fields.FIELD_UINT64,this.entry[n].fragment_duration)):(this._writeData(e,S.fields.FIELD_UINT32,this.entry[n].fragment_absolute_time),this._writeData(e,S.fields.FIELD_UINT32,this.entry[n].fragment_duration));return this.localPos},S.boxes.TfrfBox.prototype.read=function(e,t,n){S.boxes.FullBox.prototype.read.call(this,e,t,n);var r=0,i={};for(this.fragment_count=this._readData(e,S.fields.FIELD_UINT8),this.entry=[],r=0;r<this.fragment_count;r++)i={},1===this.version?(i.fragment_absolute_time=this._readData(e,S.fields.FIELD_UINT64),i.fragment_duration=this._readData(e,S.fields.FIELD_UINT64)):(i.fragment_absolute_time=this._readData(e,S.fields.FIELD_UINT32),i.fragment_duration=this._readData(e,S.fields.FIELD_UINT32)),this.entry.push(i);return this.localPos},S.registerTypeBoxes();var x=function(){return{pes:{},si:{},binary:{},ts:{},Pts:{},aac:{},h264:{}}}();return void 0!==e&&void 0!==e.exports?e.exports=x:window.mpegts=x,x.si.PSISection=function(e){this.m_table_id=e,this.m_section_syntax_indicator=1,this.m_section_length=x.si.PSISection.prototype.SECTION_LENGTH,this.m_transport_stream_id=0,this.m_version_number=0,this.m_current_next_indicator=!0,this.m_section_number=0,this.m_last_section_number=0,this.m_bValid=null},x.si.PSISection.prototype.parse=function(e){this.m_bValid=!1;var t=0,n=e[t];return t=0===n?t+1:t+n,this.m_table_id=e[t],t++,this.m_section_syntax_indicator=x.binary.getBitFromByte(e[t],0),this.m_section_length=x.binary.getValueFrom2Bytes(e.subarray(t,t+2),4),t+=2,this.m_transport_stream_id=x.binary.getValueFrom2Bytes(e.subarray(t,t+2)),t+=2,this.m_version_number=x.binary.getValueFromByte(e[t],2,5),this.m_current_next_indicator=x.binary.getBitFromByte(e[t],7),t++,this.m_section_number=e[t],t++,this.m_last_section_number=e[t],this.m_bValid=!0,t},x.si.PSISection.prototype.getSectionLength=function(){return this.m_section_length},x.si.PSISection.prototype.SECTION_LENGTH=9,x.si.PSISection.prototype.HEADER_LENGTH=8,x.aac.SAMPLING_FREQUENCY=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],x.aac.getAudioSpecificConfig=function(e){var t=x.binary.getValueFromByte(e[2],0,2),n=x.binary.getValueFromByte(e[2],2,4),r=x.binary.getValueFrom2Bytes(e.subarray(2,5),7,3),i=new Uint8Array(2);return i[0]=t+1<<3,i[0]|=(14&n)>>1,i[1]|=(1&n)<<7,i[1]|=r<<3,i},x.aac.parseADTS=function(e,t){for(var n,r,i=[],o={},a=0;a<e.length;)r=a,o.syncword=(e[a]<<4)+((240&e[a+1])>>4),o.protection_absent=1&e[a+1],o.sampling_frequency_index=(60&e[a+2])>>2,o.channel_configuration=((1&e[a+2])<<1)+((192&e[a+3])>>6),o.aac_frame_length=((3&e[a+3])<<11)+(e[a+4]<<3)+((224&e[a+5])>>5),o.number_of_raw_data_blocks_in_frame=(3&e[a+6])>>2,a+=7,0===o.number_of_raw_data_blocks_in_frame&&(0===o.protection_absent&&(a+=2),n={},n.offset=a,n.length=o.aac_frame_length-(a-r),t&&t[r]&&(n.cts=t[r]),i.push(n),a+=n.length);return i},x.ts.AdaptationField=function(){this.m_cAFLength=null,this.m_bDiscontinuityInd=null,this.m_bRAI=null,this.m_bESPriority=null,this.m_bPCRFlag=null,this.m_bOPCRFlag=null,this.m_bSplicingPointFlag=null,this.m_bPrivateDataFlag=null,this.m_bAdaptationFieldExtFlag=null},x.ts.AdaptationField.prototype.getLength=function(){return this.m_cAFLength+1},x.ts.AdaptationField.prototype.parse=function(e){if(this.m_cAFLength=e[0],0!==this.m_cAFLength){this.m_bDiscontinuityInd=x.binary.getBitFromByte(e[1],0),this.m_bRAI=x.binary.getBitFromByte(e[1],1),this.m_bESPriority=x.binary.getBitFromByte(e[1],2),this.m_bPCRFlag=x.binary.getBitFromByte(e[1],3),this.m_bOPCRFlag=x.binary.getBitFromByte(e[1],4),this.m_bSplicingPointFlag=x.binary.getBitFromByte(e[1],5),this.m_bPrivateDataFlag=x.binary.getBitFromByte(e[1],6),this.m_bAdaptationFieldExtFlag=x.binary.getBitFromByte(e[1],7)}},x.binary.readBytes=function(e,t,n){for(var r=0,i=0;i<n;i++)r<<=8,r+=e[t],t++;return r},x.binary.getBitFromByte=function(e,t){var n=0;return n+=1<<7-t,0!=(e&n)},x.binary.getValueFrom3Bytes=function(e,t,n){void 0===n&&(n=-1),void 0===t&&(t=0);var r=-1==n?-1:n-(16-t),i=-1==n?0:8-r;return(x.binary.getValueFromByte(e[0],t)<<16&16711680|x.binary.getValueFromByte(e[1])<<8&65280|255&x.binary.getValueFromByte(e[2],0,r,!1))>>i},x.binary.getValueFrom2Bytes=function(e,t,n){void 0===n&&(n=-1),void 0===t&&(t=0);var r=-1==n?-1:n-(8-t),i=-1==n?0:8-r;return(x.binary.getValueFromByte(e[0],t)<<8&65280|255&x.binary.getValueFromByte(e[1],0,r,!1))>>i},x.binary.getValueFromByte=function(e,t,n,r){var i=0,o=0;void 0===n&&(n=-1),void 0===t&&(t=0);var a=-1==n?7:t+n-1;for(o=t;o<=a;o++)i+=1<<7-o;var s=e&i;return(r||void 0===r)&&(s>>=7-a),s},x.h264.getSequenceHeader=function(e){for(var t,n=-1,r=-1,i=0,o=null,a=0,s=0;i<e.length;)if(0===e[i]&&0===e[i+1]&&0===e[i+2]&&1===e[i+3]){if((t=31&e[i+4])>=x.h264.NALUTYPE_SPS&&t<=x.h264.NALUTYPE_PPS){if(-1===n&&(n=i),t===x.h264.NALUTYPE_SPS){var l=x.h264.parseSPS(e.subarray(i+5));a=l.pic_width_in_mbs_minus1+1<<4,s=l.pic_height_in_map_units_minus1+1<<4}}else n>0&&(r=i-n);if(t===x.h264.NALUTYPE_IDR||t===x.h264.NALUTYPE_NONIDR)break;i+=4}else{if(0===e[i]&&0===e[i+1]&&1===e[i+2]){n>0&&(r=i-n);break}i++}return-1===n||-1===r?null:(o=new Uint8Array(r),o.set(e.subarray(n,n+r)),{bytes:o,width:a,height:s})},x.h264.read_ue=function(e,t){var n=1,r=0,i=0;for(t._bit=t._byte>>t._bitPos&1,t._bitPos--,t._bitPos<0&&(t._byte=e[t._bytePos],t._bytePos++,t._bitPos=7);0===t._bit;)i++,n<<=1,t._bit=t._byte>>t._bitPos&1,--t._bitPos<0&&(t._byte=e[t._bytePos],t._bytePos++,t._bitPos=7);if(n-=1,r=0,i)for(;i>0;)t._bit=t._byte>>t._bitPos&1,t._bitPos--,r=(r<<1)+t._bit,i--,t._bitPos<0&&(t._byte=e[t._bytePos],t._bytePos++,t._bitPos=7);return n+=r},x.h264.read_flag=function(e,t){return t._bit=t._byte>>t._bitPos&1,t._bitPos--,t._bitPos<0&&(t._byte=e[t._bytePos],t._bytePos++,t._bitPos=7),t._bit},x.h264.parseSPS=function(e){var t={profile_idc:0,constraint_set0_flag:0,constraint_set1_flag:0,constraint_set2_flag:0,constraint_set3_flag:0,level_idc:0,seq_parameter_set_id:0,chroma_format_idc:0,separate_colour_plane_flag:0,bit_depth_luma_minus8:0,bit_depth_chroma_minus8:0,qpprime_y_zero_transform_bypass_flag:0,seq_scaling_matrix_present_flag:0,log2_max_frame_num_minus4:0,pic_order_cnt_type:0,log2_max_pic_order_cnt_lsb_minus4:0,num_ref_frames:0,gaps_in_frame_num_value_allowed_flag:0,pic_width_in_mbs_minus1:0,pic_height_in_map_units_minus1:0},n={_byte:0,_bit:0,_bytePos:0,_bitPos:0};return n._bytePos=n._bitPos=0,n._byte=e[n._bytePos],n._bytePos++,t.profile_idc=n._byte,n._byte=e[n._bytePos],n._bytePos++,t.constraint_set0_flag=(128&n._byte)>>7,t.constraint_set1_flag=(64&n._byte)>>6,t.constraint_set2_flag=(32&n._byte)>>5,t.constraint_set3_flag=(16&n._byte)>>4,n._byte=e[n._bytePos],n._bytePos++,t.level_idc=n._byte,n._bitPos=7,t.seq_parameter_set_id=x.h264.read_ue(e,n),100!=t.profileIdc&&110!=t.profileIdc&&122!=t.profileIdc&&244!=t.profileIdc&&44!=t.profileIdc&&83!=t.profileIdc&&86!=t.profileIdc||(t.chroma_format_idc=x.h264.read_ue(e,n),3===t.chroma_format_idc&&(t.separate_colour_plane_flag=x.h264.read_flag(e,n)),t.bit_depth_luma_minus8=x.h264.read_ue(e,n),t.bit_depth_chroma_minus8=x.h264.read_ue(e,n),t.qpprime_y_zero_transform_bypass_flag=x.h264.read_flag(e,n),t.seq_scaling_matrix_present_flag=x.h264.read_flag(e,n),t.seq_scaling_matrix_present_flag),t.log2_max_frame_num_minus4=x.h264.read_ue(e,n),t.pic_order_cnt_type=x.h264.read_ue(e,n),0===t.pic_order_cnt_type?t.log2_max_pic_order_cnt_lsb_minus4=x.h264.read_ue(e,n):t.pic_order_cnt_type,t.num_ref_frames=x.h264.read_ue(e,n),t.gaps_in_frame_num_value_allowed_flag=x.h264.read_flag(e,n),t.pic_width_in_mbs_minus1=x.h264.read_ue(e,n),t.pic_height_in_map_units_minus1=x.h264.read_ue(e,n),t},x.h264.bytestreamToMp4=function(e){for(var t=0,n=e.length,r=-1,i=0;t<n;)0===e[t]&&0===e[t+1]&&0===e[t+2]&&1===e[t+3]?(r>=0&&(i=t-r-4,e[r]=(4278190080&i)>>24,e[r+1]=(16711680&i)>>16,e[r+2]=(65280&i)>>8,e[r+3]=255&i),r=t,t+=4):t++;i=t-r-4,e[r]=(4278190080&i)>>24,e[r+1]=(16711680&i)>>16,e[r+2]=(65280&i)>>8,e[r+3]=255&i},x.h264.isIDR=function(e){for(var t=0;t<e.length;)if(0===e[t]&&0===e[t+1]&&0===e[t+2]&&1===e[t+3]){if((31&e[t+4])===x.h264.NALUTYPE_IDR)return!0;t+=4}else t++;return!1},x.h264.NALUTYPE_NONIDR=1,x.h264.NALUTYPE_IDR=5,x.h264.NALUTYPE_SEI=6,x.h264.NALUTYPE_SPS=7,x.h264.NALUTYPE_PPS=8,x.h264.NALUTYPE_AU_DELIMITER=9,x.si.PAT=function(){x.si.PSISection.call(this,x.si.PAT.prototype.TABLE_ID),this.m_listOfProgramAssociation=[],this.m_network_pid=null},x.si.PAT.prototype=Object.create(x.si.PSISection.prototype),x.si.PAT.prototype.constructor=x.si.PAT,x.si.PAT.prototype.parse=function(e){var t=x.si.PSISection.prototype.parse.call(this,e);if(t++,this.m_bValid&&(this.m_bValid=!1,this.m_table_id===this.TABLE_ID)){for(var n=this.getSectionLength()-this.SECTION_LENGTH;n>=4;){var r=new x.si.ProgramAssociation(e.subarray(t,t+4));0===r.getProgramNumber()?this.m_network_pid=r.getProgramMapPid():this.m_listOfProgramAssociation.push(r),n-=4,t+=4}this.m_bValid=!0}},x.si.PAT.prototype.getPmtPid=function(){var e=x.ts.TsPacket.prototype.UNDEFINED_PID;if(this.m_listOfProgramAssociation.length>=1){e=this.m_listOfProgramAssociation[0].getProgramMapPid()}return e},x.si.PAT.prototype.TABLE_ID=0,x.si.PAT.prototype.PID=0,x.si.ProgramAssociation=function(e){this.m_program_number=0,this.m_program_map_pid=0,this.parse(e)},x.si.ProgramAssociation.prototype.getProgramNumber=function(){return this.m_program_number},x.si.ProgramAssociation.prototype.getProgramMapPid=function(){return this.m_program_map_pid},x.si.ProgramAssociation.prototype.getLength=function(){return 4},x.si.ProgramAssociation.prototype.parse=function(e){this.m_program_number=x.binary.getValueFrom2Bytes(e.subarray(0,2)),this.m_program_map_pid=x.binary.getValueFrom2Bytes(e.subarray(2,4),3,13)},x.pes.PesPacket=function(){this.m_cStreamID=null,this.m_nPESPacketLength=null,this.m_cPESScramblingCtrl=null,this.m_bPESpriority=null,this.m_bDataAlignement=null,this.m_bCopyright=null,this.m_bOriginalOrCopy=null,this.m_cPES_header_data_length=null,this.m_cPTS_DTS_flags=null,this.m_bESCR_flag=null,this.m_bES_rate_flag=null,this.m_bDSM_trick_mode_flag=null,this.m_bAdditional_copy_info_flag=null,this.m_bPES_CRC_flag=null,this.m_bPES_extension_flag=null,this.m_pPTS=null,this.m_pDTS=null,this.m_pESCR=null,this.m_ES_rate=null,this.m_DSM_trick_mode=null,this.m_Additional_copy_info=null,this.m_PES_CRC=null,this.m_cNbStuffingBytes=null,this.m_pPESExtension=null,this.m_pPrivateData=null,this.m_payloadArray=null,this.m_nPayloadLength=null,this.m_bDirty=null,this.m_bValid=!1},x.pes.PesPacket.prototype.parse=function(e){var t=0;if(this.m_nLength=e.length,x.binary.getValueFrom3Bytes(e.subarray(t,t+3))===this.START_CODE_PREFIX){if(t=3,this.m_cStreamID=e[t],t++,this.m_nPESPacketLength=x.binary.getValueFrom2Bytes(e.subarray(t,t+2)),t+=2,this.m_cStreamID===x.ts.TsPacket.prototype.STREAM_ID_PADDING_STREAM)return void(this.m_bValid=!0);if(!this.hasOptionalPESHeader())return this.m_payloadArray=e.subarray(t+x.pes.PesPacket.prototype.FIXED_HEADER_LENGTH),this.m_nPayloadLength=this.m_nLength-x.pes.PesPacket.prototype.FIXED_HEADER_LENGTH,void(this.m_bValid=!0);if(2===x.binary.getValueFromByte(e[t],0,2)){this.m_cPESScramblingCtrl=x.binary.getValueFromByte(e[t],2,2),this.m_bPESpriority=x.binary.getBitFromByte(e[t],4),this.m_bDataAlignement=x.binary.getBitFromByte(e[t],5),this.m_bCopyright=x.binary.getBitFromByte(e[t],6),this.m_bOriginalOrCopy=x.binary.getBitFromByte(e[t],7),t++,this.m_cPTS_DTS_flags=x.binary.getValueFromByte(e[t],0,2),this.m_bESCR_flag=x.binary.getBitFromByte(e[t],2),this.m_bES_rate_flag=x.binary.getBitFromByte(e[t],3),this.m_bDSM_trick_mode_flag=x.binary.getBitFromByte(e[t],4),this.m_bAdditional_copy_info_flag=x.binary.getBitFromByte(e[t],5),this.m_bPES_CRC_flag=x.binary.getBitFromByte(e[t],6),this.m_bPES_extension_flag=x.binary.getBitFromByte(e[t],7),t++,this.m_cPES_header_data_length=255&e[t],t++,(this.m_cPTS_DTS_flags&x.pes.PesPacket.prototype.FLAG_PTS)==x.pes.PesPacket.prototype.FLAG_PTS&&(this.m_pPTS=new x.Pts(e.subarray(t,t+5)),t+=5),(this.m_cPTS_DTS_flags&x.pes.PesPacket.prototype.FLAG_DTS)==x.pes.PesPacket.prototype.FLAG_DTS&&(this.m_pDTS=new x.Pts(e.subarray(t,t+5)),t+=5),this.m_bESCR_flag&&(t+=6),this.m_bES_rate_flag&&(this.m_ES_rate=x.binary.getValueFrom3Bytes(e.subarray(t,t+3),1,22),t+=3),this.m_bDSM_trick_mode_flag&&(this.m_DSM_trick_mode=e[t],t++),this.m_bAdditional_copy_info_flag&&(this.m_Additional_copy_info=e[t],t++),this.m_bPES_CRC_flag&&(this.m_PES_CRC=x.binary.getValueFrom2Bytes(e.subarray(t,t+2)),t+=2),this.m_bPES_extension_flag;var n=x.pes.PesPacket.prototype.FIXED_HEADER_LENGTH+x.pes.PesPacket.prototype.FIXED_OPTIONAL_HEADER_LENGTH+this.m_cPES_header_data_length;this.m_cNbStuffingBytes=n-t,t+=this.m_cNbStuffingBytes,this.m_nPayloadLength=this.m_nLength-n,this.m_payloadArray=e.subarray(n,n+this.m_nPayloadLength),this.m_bValid=!0}}},x.pes.PesPacket.prototype.hasOptionalPESHeader=function(){return this.m_cStreamID!==x.ts.TsPacket.prototype.STREAM_ID_PROGRAM_STREAM_MAP&&this.m_cStreamID!==x.ts.TsPacket.prototype.STREAM_ID_PADDING_STREAM&&this.m_cStreamID!==x.ts.TsPacket.prototype.STREAM_ID_PRIVATE_STREAM_2&&this.m_cStreamID!==x.ts.TsPacket.prototype.STREAM_ID_ECM_STREAM&&this.m_cStreamID!==x.ts.TsPacket.prototype.STREAM_ID_EMM_STREAM&&this.m_cStreamID!==x.ts.TsPacket.prototype.STREAM_ID_PROGRAM_STREAM_DIRECTORY&&this.m_cStreamID!==x.ts.TsPacket.prototype.STREAM_ID_DSMCC_STREAM&&this.m_cStreamID!==x.ts.TsPacket.prototype.STREAM_ID_H2221_TYPE_E_STREAM},x.pes.PesPacket.prototype.getHeaderLength=function(){return x.pes.PesPacket.prototype.FIXED_HEADER_LENGTH+x.pes.PesPacket.prototype.FIXED_OPTIONAL_HEADER_LENGTH+this.m_cPES_header_data_length},x.pes.PesPacket.prototype.getPayload=function(){return this.m_payloadArray},x.pes.PesPacket.prototype.getPts=function(){return this.m_pPTS},x.pes.PesPacket.prototype.getDts=function(){return this.m_pDTS},x.pes.PesPacket.prototype.START_CODE_PREFIX=1,x.pes.PesPacket.prototype.FIXED_HEADER_LENGTH=6,x.pes.PesPacket.prototype.FIXED_OPTIONAL_HEADER_LENGTH=3,x.pes.PesPacket.prototype.FLAG_DTS=1,x.pes.PesPacket.prototype.FLAG_PTS=2,x.si.PMT=function(){x.si.PSISection.call(this,x.si.PMT.prototype.TABLE_ID),this.m_listOfComponents=[],this.m_PCR_PID=null,this.m_program_info_length=null},x.si.PMT.prototype=Object.create(x.si.PSISection.prototype),x.si.PMT.prototype.constructor=x.si.PMT,x.si.PMT.prototype.parse=function(e){var t=x.si.PSISection.prototype.parse.call(this,e);if(t++,this.m_bValid&&(this.m_bValid=!1,this.m_table_id===this.TABLE_ID)){var n=this.getSectionLength()-this.SECTION_LENGTH;if(!(n<4)){this.m_PCR_PID=x.binary.getValueFrom2Bytes(e.subarray(t,t+2),3),t+=2,this.m_program_info_length=x.binary.getValueFrom2Bytes(e.subarray(t,t+2),4),t+=2,t+=this.m_program_info_length,n=this.m_section_length-this.SECTION_LENGTH-4-this.m_program_info_length;for(var r=null;n>0;)r=new x.si.ESDescription(e.subarray(t,t+n)),this.m_listOfComponents.push(r),n-=r.getLength(),t+=r.getLength();this.m_bValid=!0}}},x.si.PMT.prototype.TABLE_ID=2,x.si.PMT.prototype.gStreamTypes=[{name:"Reserved",value:0,desc:"ITU-T | ISO/IEC Reserved"},{name:"MPEG1-Video",value:224,desc:"ISO/IEC 11172-2 Video"},{name:"MPEG2-Video",value:224,desc:"ITU-T Rec. H.262 | ISO/IEC 13818-2 Video or ISO/IEC 11172-2 constrained parameter video stream"},{name:"MPEG1-Audio",value:192,desc:"ISO/IEC 11172-3 Audio"},{name:"MPEG2-Audio",value:192,desc:"ISO/IEC 13818-3 Audio"},{name:"PRIVATE_SECTIONS",value:189,desc:"ITU-T Rec. H.222.0 | ISO/IEC 13818-1 private_sections"},{name:"PRIVATE",value:189,desc:"ITU-T Rec. H.222.0 | ISO/IEC 13818-1 PES packets containing private data"},{name:"MHEG",value:243,desc:"ISO/IEC 13522 MHEG"},{name:"MPEG1-DSM-CC",value:242,desc:"ITU-T Rec. H.222.0 | ISO/IEC 13818-1 Annex A DSM-CC"},{name:"H.222.1",value:244,desc:"ITU-T Rec. H.222.1"},{name:"DSM-CC_A",value:244,desc:"ISO/IEC 13818-6 type A"},{name:"DSM-CC_B",value:245,desc:"ISO/IEC 13818-6 type B"},{name:"DSM-CC_C",value:246,desc:"ISO/IEC 13818-6 type C"},{name:"DSM-CC_D",value:247,desc:"ISO/IEC 13818-6 type D"},{name:"Auxiliary",value:0,desc:"ITU-T Rec. H.222.0 | ISO/IEC 13818-1 auxiliary"},{name:"MPEG2-AAC-ADTS",value:192,desc:"ISO/IEC 13818-7 Audio with ADTS transport syntax"},{name:"MPEG4-Video",value:224,desc:"ISO/IEC 14496-2 Visual"},{name:"MPEG4-AAC-LATM",value:192,desc:"ISO/IEC 14496-3 Audio with the LATM transport syntax as defined in ISO/IEC 14496-3/AMD-1"},{name:"MPEG4-SL",value:250,desc:"ISO/IEC 14496-1 SL-packetized stream or FlexMux stream carried in PES packets"},{name:"MPEG4-SL",value:250,desc:"ISO/IEC 14496-1 SL-packetized stream or FlexMux stream carried in ISO/IEC14496_sections"},{name:"DSM-CC_SDP",value:0,desc:"ISO/IEC 13818-6 Synchronized Download Protocol"},{name:"META_PES",value:252,desc:"Metadata carried in PES packets"},{name:"META_SECTIONS",value:252,desc:"Metadata carried in metadata_sections"},{name:"META_DSM-CC",value:252,desc:"Metadata carried in ISO/IEC 13818-6 Data Carousel"},{name:"META_DSM-CC",value:252,desc:"Metadata carried in ISO/IEC 13818-6 Object Carousel"},{name:"META_DSM-CC",value:252,desc:"Metadata carried in ISO/IEC 13818-6 Synchronized Download Protocol"},{name:"MPEG2-IPMP",value:0,desc:"IPMP stream (defined in ISO/IEC 13818-11, MPEG-2 IPMP)"},{name:"H.264",value:224,desc:"AVC video stream as defined in ITU-T Rec. H.264 | ISO/IEC 14496-10 Video"},{name:"MPEG4AAC",value:192,desc:"ISO/IEC 14496-3 Audio, without using any additional transport syntax, such as DST, ALS and SLS"},{name:"MPEG4Text",value:0,desc:"ISO/IEC 14496-17 Text"},{name:"Aux. Video (23002-3)",value:30,desc:"Auxiliary video stream as defined in ISO/IEC 23002-3"},{name:"H.264-SVC",value:224,desc:"SVC video sub-bitstream of a video stream as defined in the Annex G of ITU-T Rec. H.264 | ISO/IEC 14496-10 Video"},{name:"H.264-MVC",value:224,desc:"MVC video sub-bitstream of a video stream as defined in the Annex H of ITU-T Rec. H.264 | ISO/IEC 14496-10 Video"},{name:"Reserved1",value:0,desc:"TBC Reserved"},{name:"Reserved2",value:0,desc:"TBC Reserved"},{name:"Reserved3",value:0,desc:"TBC Reserved"},{name:"HEVC",value:224,desc:"ITU.-T Rec H.26x | ISO/IEC 23008-2 video stream"}],x.si.PMT.prototype.MPEG2_VIDEO_STREAM_TYPE=2,x.si.PMT.prototype.AVC_VIDEO_STREAM_TYPE=27,x.si.PMT.prototype.MPEG1_AUDIO_STREAM_TYPE=3,x.si.PMT.prototype.MPEG2_AUDIO_STREAM_TYPE=4,x.si.PMT.prototype.AAC_AUDIO_STREAM_TYPE=17,x.si.PMT.prototype.AC3_AUDIO_STREAM_TYPE=6,x.si.PMT.prototype.SUB_STREAM_TYPE=6,x.si.PMT.prototype.STREAM_TYPE_MP1V=1,x.si.PMT.prototype.STREAM_TYPE_MP2V=2,x.si.PMT.prototype.STREAM_TYPE_MP1A=3,x.si.PMT.prototype.STREAM_TYPE_MP2A=4,x.si.PMT.prototype.STREAM_TYPE_PRIVATE=6,x.si.PMT.prototype.STREAM_TYPE_TELETEXT=6,x.si.PMT.prototype.STREAM_TYPE_DVBSUBTITLE=6,x.si.PMT.prototype.STREAM_TYPE_AC3=6,x.si.PMT.prototype.STREAM_TYPE_MP2AAC_ADTS=15,x.si.PMT.prototype.STREAM_TYPE_MP4AAC_LATM=17,x.si.PMT.prototype.STREAM_TYPE_H264=27,x.si.PMT.prototype.STREAM_TYPE_MP4AAC=28,x.si.PMT.prototype.STREAM_TYPE_AUX_23002_3=30,x.si.PMT.prototype.STREAM_TYPE_SVC=31,x.si.PMT.prototype.STREAM_TYPE_MVC=32,x.si.PMT.prototype.STREAM_TYPE_HEVC=36,x.si.ESDescription=function(e){this.m_stream_type=null,this.m_elementary_PID=null,this.m_ES_info_length=null,this.parse(e)},x.si.ESDescription.prototype.getStreamType=function(){return this.m_stream_type},x.si.ESDescription.prototype.getPID=function(){return this.m_elementary_PID},x.si.ESDescription.prototype.getLength=function(){return 5+this.m_ES_info_length},x.si.ESDescription.prototype.parse=function(e){this.m_stream_type=e[0],this.m_elementary_PID=x.binary.getValueFrom2Bytes(e.subarray(1,3),3),this.m_ES_info_length=x.binary.getValueFrom2Bytes(e.subarray(3,5),4)},x.Pts=function(e){var t,n,r=e[0]>>1&7;n=r>>2,t=(3&r)<<30>>>0,t=(t|e[1]<<22)>>>0,t=(t|e[2]>>1<<15)>>>0,t=(t|e[3]<<7)>>>0,t=(t|e[4]>>1)>>>0,this.m_lPTS=f.math.Long.fromBits(t,n).toNumber(),this.m_fPTS=this.m_lPTS/x.Pts.prototype.SYSTEM_CLOCK_FREQUENCY},x.Pts.prototype.getValue=function(){return this.m_lPTS},x.Pts.prototype.getValueInSeconds=function(){return this.m_fPTS},x.Pts.prototype.SYSTEM_CLOCK_FREQUENCY=9e4,x.ts.TsPacket=function(){this.m_cSync=null,this.m_bTransportError=null,this.m_bPUSI=null,this.m_bTransportPriority=null,this.m_nPID=null,this.m_cTransportScramblingCtrl=null,this.m_cAdaptationFieldCtrl=null,this.m_cContinuityCounter=null,this.m_pAdaptationField=null,this.m_payloadArray=null,this.m_cPayloadLength=null,this.m_bDirty=null,this.m_time=null,this.m_arrivalTime=null,this.m_bIgnored=null},x.ts.TsPacket.prototype.parse=function(e){var t=0;if(this.m_cSync=e[t],this.m_cSync===this.SYNC_WORD){if(t++,this.m_bTransportError=x.binary.getBitFromByte(e[t],0),this.m_bPUSI=x.binary.getBitFromByte(e[t],1),this.m_bTransportPriority=x.binary.getBitFromByte(e[t],2),this.m_nPID=x.binary.getValueFrom2Bytes(e.subarray(t,t+2),3,13),t+=2,this.m_cTransportScramblingCtrl=x.binary.getValueFromByte(e[t],0,2),this.m_cAdaptationFieldCtrl=x.binary.getValueFromByte(e[t],2,2),this.m_cContinuityCounter=x.binary.getValueFromByte(e[t],4,4),t++,2&this.m_cAdaptationFieldCtrl){if(e[t]+t>=this.TS_PACKET_SIZE)return;this.m_pAdaptationField=new x.ts.AdaptationField,this.m_pAdaptationField.parse(e.subarray(t)),t+=this.m_pAdaptationField.getLength()}0!==this.m_cAdaptationFieldCtrl&&1&this.m_cAdaptationFieldCtrl&&(this.m_cPayloadLength=this.TS_PACKET_SIZE-t,this.m_payloadArray=e.subarray(t,t+this.m_cPayloadLength))}},x.ts.TsPacket.prototype.getPid=function(){return this.m_nPID},x.ts.TsPacket.prototype.getPayload=function(){return this.m_payloadArray},x.ts.TsPacket.prototype.getPayloadLength=function(){return this.m_cPayloadLength},x.ts.TsPacket.prototype.getPusi=function(){return this.m_bPUSI},x.ts.TsPacket.prototype.hasAdaptationFieldOnly=function(){return 2===this.m_cAdaptationFieldCtrl},x.ts.TsPacket.prototype.SYNC_WORD=71,x.ts.TsPacket.prototype.TS_PACKET_SIZE=188,x.ts.TsPacket.prototype.UNDEFINED_PID=65535,x.ts.TsPacket.prototype.PAT_PID=0,x.ts.TsPacket.prototype.STREAM_ID_PROGRAM_STREAM_MAP=188,x.ts.TsPacket.prototype.STREAM_ID_PADDING_STREAM=190,x.ts.TsPacket.prototype.STREAM_ID_PADDING_STREAM=190,x.ts.TsPacket.prototype.STREAM_ID_PRIVATE_STREAM_2=191,x.ts.TsPacket.prototype.STREAM_ID_ECM_STREAM=240,x.ts.TsPacket.prototype.STREAM_ID_EMM_STREAM=241,x.ts.TsPacket.prototype.STREAM_ID_DSMCC_STREAM=242,x.ts.TsPacket.prototype.STREAM_ID_H2221_TYPE_E_STREAM=248,x.ts.TsPacket.prototype.STREAM_ID_PROGRAM_STREAM_DIRECTORY=255,h=window.dijon,y})}).call(t,n(0),n(3).setImmediate)},function(e,t){e.exports={name:"@meisterplayer/plugin-smooth",version:"5.2.1",description:"Smooth plugin for Meister",main:"dist/Smooth.js",scripts:{},keywords:["meister","video","plugin","media"],repository:{type:"git",url:"https://github.com/meisterplayer/media-smooth.git"},author:"Triple",license:"Apache-2.0",devDependencies:{"meister-gulp-webpack-tasks":"^1.0.6","meister-js-dev":"^3.1.0","babel-preset-es2015":"^6.24.0","babel-preset-es2017":"^6.22.0",gulp:"^3.9.1"},peerDependencies:{"@meisterplayer/meisterplayer":">= 5.1.0"}}},function(e,t,n){e.exports=n(1)}])}).call(t,n(129).setImmediate,n(129).clearImmediate)},function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports=function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/",t(t.s=7)}([function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),n(5);var r=n(2),i=function(e){return e&&e.__esModule?e:{default:e}}(r);t.default=i.default},function(e,t,n){e.exports=function(){var e=[];return e.toString=function(){for(var e=[],t=0;t<this.length;t++){var n=this[t];n[2]?e.push("@media "+n[2]+"{"+n[1]+"}"):e.push(n[1])}return e.join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var r={},i=0;i<this.length;i++){var o=this[i][0];"number"==typeof o&&(r[o]=!0)}for(i=0;i<t.length;i++){var a=t[i];"number"==typeof a[0]&&r[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),e.push(a))}},e}},function(e,t,n){function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":r(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":r(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(6),u=function(e){return e&&e.__esModule?e:{default:e}}(l),d=function(e){function t(e,n){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));if(e.position=e.position||"top-left",!e.iconUrl){var a;return console.warn("iconUrl was not found in Watermark:{}, plugin will not load."),a=[],o(r,a)}return r.onPlayerCreated(),r}return a(t,e),s(t,[{key:"onPlayerCreated",value:function(){var e=this,t=document.createElement("div");t.className="meister-plugin-watermark-wrapper";var n=document.createElement("img");n.src=this.config.iconUrl,t.appendChild(n),this.config.style&&Object.keys(this.config.style).forEach(function(n){t.style[n]=e.config.style[n]}),this.meister.wrapper.appendChild(t),this.config.position&&(t.className+=" meister-plugin-watermark-"+this.config.position),this.config.autoHide&&t.classList.add("meister-plugin-watermark-autohide")}}],[{key:"pluginName",get:function(){return"Watermark"}},{key:"pluginVersion",get:function(){return u.default.version}}]),t}(Meister.ProtoPlugin);Meister.registerPlugin(d.pluginName,d),t.default=d},function(e,t,n){t=e.exports=n(1)(),t.push([e.i,".meister-plugin-watermark-wrapper {\n  position: absolute;\n  width: 7%;\n  margin: 1% 1%; }\n  .meister-plugin-watermark-wrapper.meister-plugin-watermark-top-right {\n    top: 0;\n    right: 0; }\n  .meister-plugin-watermark-wrapper.meister-plugin-watermark-top-left {\n    top: 0;\n    left: 0; }\n  .meister-plugin-watermark-wrapper.meister-plugin-watermark-bottom-left {\n    bottom: 0;\n    left: 0; }\n  .meister-plugin-watermark-wrapper.meister-plugin-watermark-bottom-right {\n    bottom: 0;\n    right: 0; }\n  .meister-plugin-watermark-wrapper img {\n    width: 100%;\n    height: 100%; }\n  .meister-plugin-watermark-wrapper.meister-plugin-watermark-autohide {\n    animation: hide-bars-animation 8s forwards; }\n",""])},function(e,t){function n(e,t){for(var n=0;n<e.length;n++){var r=e[n],i=h[r.id];if(i){i.refs++;for(var o=0;o<i.parts.length;o++)i.parts[o](r.parts[o]);for(;o<r.parts.length;o++)i.parts.push(u(r.parts[o],t))}else{for(var a=[],o=0;o<r.parts.length;o++)a.push(u(r.parts[o],t));h[r.id]={id:r.id,refs:1,parts:a}}}}function i(e){for(var t=[],n={},r=0;r<e.length;r++){var i=e[r],o=i[0],a=i[1],s=i[2],l=i[3],u={css:a,media:s,sourceMap:l};n[o]?n[o].parts.push(u):t.push(n[o]={id:o,parts:[u]})}return t}function o(e,t){var n=g(),r=_[_.length-1];if("top"===e.insertAt)r?r.nextSibling?n.insertBefore(t,r.nextSibling):n.appendChild(t):n.insertBefore(t,n.firstChild),_.push(t);else{if("bottom"!==e.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");n.appendChild(t)}}function a(e){e.parentNode.removeChild(e);var t=_.indexOf(e);t>=0&&_.splice(t,1)}function s(e){var t=document.createElement("style");return t.type="text/css",o(e,t),t}function l(e){var t=document.createElement("link");return t.rel="stylesheet",o(e,t),t}function u(e,t){var n,r,i;if(t.singleton){var o=v++;n=y||(y=s(t)),r=d.bind(null,n,o,!1),i=d.bind(null,n,o,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=l(t),r=f.bind(null,n),i=function(){a(n),n.href&&URL.revokeObjectURL(n.href)}):(n=s(t),r=c.bind(null,n),i=function(){a(n)});return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else i()}}function d(e,t,n,r){var i=n?"":r.css;if(e.styleSheet)e.styleSheet.cssText=b(t,i);else{var o=document.createTextNode(i),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(o,a[t]):e.appendChild(o)}}function c(e,t){var n=t.css,r=t.media;if(r&&e.setAttribute("media",r),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}function f(e,t){var n=t.css,r=t.sourceMap;r&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */");var i=new Blob([n],{type:"text/css"}),o=e.href;e.href=URL.createObjectURL(i),o&&URL.revokeObjectURL(o)}var h={},p=function(e){var t;return function(){return void 0===t&&(t=e.apply(this,arguments)),t}},m=p(function(){return/msie [6-9]\b/.test(self.navigator.userAgent.toLowerCase())}),g=p(function(){return document.head||document.getElementsByTagName("head")[0]}),y=null,v=0,_=[];e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=("undefined"==typeof document?"undefined":r(document)))throw new Error("The style-loader cannot be used in a non-browser environment");t=t||{},void 0===t.singleton&&(t.singleton=m()),void 0===t.insertAt&&(t.insertAt="bottom");var o=i(e);return n(o,t),function(e){for(var r=[],a=0;a<o.length;a++){var s=o[a],l=h[s.id];l.refs--,r.push(l)}e&&n(i(e),t);for(var a=0;a<r.length;a++){var l=r[a];if(0===l.refs){for(var u=0;u<l.parts.length;u++)l.parts[u]();delete h[l.id]}}}};var b=function(){var e=[];return function(t,n){return e[t]=n,e.filter(Boolean).join("\n")}}()},function(e,t,n){var r=n(3);"string"==typeof r&&(r=[[e.i,r,""]]),n(4)(r,{sourceMap:!0}),r.locals&&(e.exports=r.locals)},function(e,t){e.exports={name:"@meisterplayer/plugin-watermark",version:"5.1.3",description:"Watermark plugin for Meister",main:"dist/Watermark.js",keywords:["meister","video","plugin","ui"],author:"Triple",license:"Apache-2.0",devDependencies:{"meister-gulp-webpack-tasks":"^1.0.11","meister-js-dev":"^3.1.0","babel-preset-es2015":"^6.24.0","babel-preset-es2017":"^6.22.0",gulp:"^3.9.1"}}},function(e,t,n){e.exports=n(0)}])},function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports=function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/",t(t.s=3)}([function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=function(e){return e&&e.__esModule?e:{default:e}}(r);t.default=i.default},function(e,t,n){function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":r(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":r(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(2),u=function(e){return e&&e.__esModule?e:{default:e}}(l),d=function(e){function t(e,n){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.currentCaptions=[],r.on("requestCaptions",r.onRequestCaptions.bind(r)),r.on("itemUnloaded",r.onItemUnloaded.bind(r)),r}return a(t,e),s(t,[{key:"onItemUnloaded",value:function(){this.meister.playerPlugin&&this.meister.playerPlugin.mediaElement instanceof HTMLMediaElement&&this.removeTracks()}},{key:"removeTracks",value:function(){for(var e=this.meister.playerPlugin.mediaElement.textTracks,t=0;t<e.length;t+=1){var n=e[t];n.default=!1,n.mode="hidden"}for(var r=this.meister.playerPlugin.mediaElement.childNodes,i=0;i<r.length;i+=1){var o=r.item(i);"track"===o.nodeName.toLowerCase()&&this.meister.playerPlugin.mediaElement.removeChild(o)}}},{key:"onRequestCaptions",value:function(e){if("none"===e.newLanguage)return void this.removeTracks();if("webvtt"===e.type){this.removeTracks();var t=document.createElement("track");t.kind="captions",t.label=e.title,t.scrlang=e.lang,t.default=!0,t.src=e.src,t.addEventListener("load",function(){t.mode="showing"}),this.meister.playerPlugin.mediaElement.appendChild(t)}}}],[{key:"pluginName",get:function(){return"WebVtt"}},{key:"pluginVersion",get:function(){return u.default.version}}]),t}(Meister.ParserPlugin);Meister.registerPlugin(d.pluginName,d),Meister.registerPlugin("webvtt",d),t.default=d},function(e,t){e.exports={name:"@meisterplayer/plugin-webvtt",version:"5.1.0",description:"Meister plugin for subtitles with webvtt",main:"dist/WebVtt.js",keywords:["meister","video","plugin"],repository:{type:"git",url:"https://github.com/meisterplayer/parser-webvtt.git"},author:"Triple",license:"Apache-2.0",dependencies:{},devDependencies:{"meister-js-dev":"^3.1.0","meister-gulp-webpack-tasks":"^1.0.6","babel-preset-es2015":"^6.24.0","babel-preset-es2017":"^6.22.0",gulp:"^3.9.1"}}},function(e,t,n){e.exports=n(0)}])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(177),i=function(e){return e&&e.__esModule?e:{default:e}}(r);t.default=i.default},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(132),l=function(e){return e&&e.__esModule?e:{default:e}}(s),u="https://www.meisterplayer.com/static/a.php",d=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),a(t,[{key:"onPlayerPlay",value:function(e){var t="?category=play&referer="+window.location.href;fetch(u+t)}},{key:"onPlayerPause",value:function(){var e="?category=pause&referer="+window.location.href;fetch(u+e)}}],[{key:"pluginName",get:function(){return"DO_NOT_REMOVE_THIS_OR_YOULL_GET_FIRED"}},{key:"pluginVersion",get:function(){return l.default.version}}]),t}(Meister.AnalyticsPlugin);Meister.registerPlugin(d.pluginName,d),t.default=d},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.YoutubePlayer=t.Youtube=void 0;var i=n(179),o=r(i),a=n(180),s=r(a);t.Youtube=o.default,t.YoutubePlayer=s.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(i,o){try{var a=t[i](o),s=a.value}catch(e){return void n(e)}if(!a.done)return Promise.resolve(s).then(function(e){r("next",e)},function(e){r("throw",e)});e(s)}return r("next")})}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},d=n(386),c=r(d),f=n(133),h=r(f),p=function(e){function t(e,n){o(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.player=null,(0,c.default)(e.scriptUrl||"https://www.youtube.com/player_api"),r.onYoutubeApiReadyPromise=new Promise(function(e){r.youtubeApiReadyResolve=e}),window.onYouTubePlayerAPIReady=function(){r.youtubeApiReadyResolve()},r}return s(t,e),l(t,[{key:"isItemSupported",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("youtube"===t.type){e.next=2;break}return e.abrupt("return",{supported:!1,errorCode:Meister.ErrorCodes.WRONG_TYPE});case 2:return e.abrupt("return",{supported:!0});case 3:case"end":return e.stop()}},e,this)}));return e}()},{key:"process",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.onYoutubeApiReadyPromise;case 2:return this.player=this.meister.getPlayerByType("youtube",t),e.abrupt("return",t);case 4:case"end":return e.stop()}},e,this)}));return e}()},{key:"load",value:function(e){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"load",this).call(this,e),this.on("_playerTimeUpdate",this._onPlayerTimeUpdate.bind(this)),this.on("requestSeek",this.onRequestSeek.bind(this)),this.player.currentSrc=e.src}},{key:"_onPlayerTimeUpdate",value:function(){this.meister.trigger("playerTimeUpdate",{currentTime:this.player.currentTime,duration:this.player.duration})}},{key:"onRequestSeek",value:function(e){var t=void 0;isNaN(e.relativePosition)?isNaN(e.timeOffset)||(t=this.player.currentTime+e.timeOffset):t=e.relativePosition*this.player.duration,this.blockSeekForward&&t>this.player.currentTime||Number.isFinite(t)&&(this.player.currentTime=t)}},{key:"duration",get:function(){return this.player?this.player.duration:NaN}},{key:"currentTime",get:function(){return this.player?this.player.currentTime:NaN},set:function(e){this.player&&(this.player.currentTime=e)}}],[{key:"pluginName",get:function(){return"Youtube"}},{key:"pluginVersion",get:function(){return h.default.version}}]),t}(Meister.MediaPlugin);Meister.registerPlugin(p.pluginName,p),t.default=p},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},l=n(383),u=function(e){return e&&e.__esModule?e:{default:e}}(l),d=n(181),c=function(e){function t(e,n){r(this,t);var o=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return o.mediaElement=null,o.heartbeat=null,o.isPlaying=!1,o.playerTime=0,o.videoData=null,o.iframeReadyPromise=new Promise(function(e){o.iframeReadyResolve=e}),window.addEventListener("resize",o.onResize.bind(o)),o}return o(t,e),a(t,[{key:"isTypeSupported",value:function(e){return"youtube"===e}},{key:"preloadContent",value:function(){return Promise.resolve()}},{key:"load",value:function(e){var n=this;s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"load",this).call(this,e),this.mediaElement=document.createElement("div"),this.mediaElement.id=Math.random().toString(),this.wrapper.appendChild(this.mediaElement),this.player=new window.YT.Player(this.mediaElement.id,{height:"360",width:"640",events:{onReady:this.onIframeReady.bind(this),onStateChange:this.onPlayerStateChange.bind(this)},playerVars:{controls:0,autoplay:1,modestbranding:0,rel:0,showinfo:0}}),this.iframeReadyPromise=new Promise(function(e){n.iframeReadyResolve=e})}},{key:"unload",value:function(){this.player=null,this.isPlaying=!1,this.playerTime=0,this.videoData=null,this.heartbeat.kill(),this.heartbeat=null,this.mediaElement=null}},{key:"pause",value:function(){(this.player||this.player.pauseVideo)&&(this.player.pauseVideo(),this.heartbeat&&this.heartbeat.mute())}},{key:"play",value:function(){this.player&&this.player.playVideo&&(this.heartbeat&&this.heartbeat.unmute(),this.player.playVideo())}},{key:"onIframeReady",value:function(e){var t=this;this.iframeReadyResolve(),this.heartbeat=new u.default(.2),this.heartbeat.beat(function(e){return t.onHeartbeat(e)}),this.meister.trigger("itemTimeInfo",{isLive:!1,duration:this.duration}),this.on("requestBitrate",this.onRequestBitrate.bind(this)),this.onResize(),this.meister.trigger("playerCreated")}},{key:"onPlayerStateChange",value:function(e){var t=this;if(e.data===window.YT.PlayerState.PLAYING?(this.isPlaying=!0,this.meister.trigger("playerPlay")):e.data===window.YT.PlayerState.ENDED?(this.isPlaying=!1,this.shouldTriggerReplay=!0,this.meister.trigger("playerEnd")):e.data===window.YT.PlayerState.PAUSED&&(this.isPlaying=!1,this.meister.trigger("playerPause")),!this.videoData&&""!==this.player.getVideoData().title){this.videoData=this.player.getVideoData(),this.videoQualitys=this.player.getAvailableQualityLevels(),this.bitrates=[],this.videoQualitys=(0,d.qualityToKbps)(this.videoQualitys),this.videoQualitys.forEach(function(e,n){return t.bitrates.push({bitrate:e,index:n})});var n=(0,d.qualityToKbps)([this.player.getPlaybackQuality()])[0],r=this.bitrates.findIndex(function(e){return n===e.bitrate});this.meister.trigger("itemMetadata",this.videoData),this.meister.trigger("itemBitrates",{bitrates:this.bitrates,currentIndex:r})}}},{key:"onRequestBitrate",value:function(e){var t=this.bitrates.find(function(t){return t.index===e.bitrateIndex}),n=(0,d.kbpsToQuality)(t.bitrate);this.player.setPlaybackQuality(n)}},{key:"onHeartbeat",value:function(e){this.playerTime=this.player.getCurrentTime(),this.meister.trigger("_playerTimeUpdate")}},{key:"onResize",value:function(){var e=this.meister.container.offsetWidth,t=this.meister.container.offsetHeight;document.webkitFullscreenElement?(e=window.screen.width,t=window.screen.height,this.resetNormalModeAfterFullScreen=!0):this.resetNormalModeAfterFullScreen&&(e=this.beforeFullscreenWidth,t=this.beforeFullscreenHeight,this.resetNormalModeAfterFullScreen=!1),document.webkitFullscreenElement||(this.beforeFullscreenWidth=e,this.beforeFullscreenHeight=t),this.player&&this.player.setSize(e,t-4)}},{key:"currentSrc",set:function(e){var t=this;this.player&&this.iframeReadyPromise.then(function(){e.startsWith("http")?console.error("Please insert a Youtube ID"):t.player.loadVideoById(e)})}},{key:"playing",get:function(){return this.isPlaying}},{key:"currentTime",get:function(){return this.playerTime},set:function(e){this.player.seekTo(e)}},{key:"duration",get:function(){if(this.player&&this.player.getDuration)return this.player.getDuration()}},{key:"volume",get:function(){return this.player.getVolume()/100},set:function(e){this.player&&(this.player.setVolume(100*e),this.meister.trigger("playerVolumeChange"))}},{key:"muted",get:function(){return this.player.isMuted()},set:function(e){e?this.player.mute():this.player.unMute()}}],[{key:"pluginName",get:function(){return"YoutubePlayer"}}]),t}(Meister.PlayerPlugin);Meister.registerPlugin(c.pluginName,c),t.default=c},function(e,t,n){"use strict";function r(e){return e.map(function(e){return o[e]})}function i(e){return Object.keys(o).find(function(t){return o[t]===e})}Object.defineProperty(t,"__esModule",{value:!0}),t.qualityToKbps=r,t.kbpsToQuality=i;var o={highres:1e8,hd2160:35e6,hd1440:16e6,hd1080:8e6,hd720:5e6,large:25e5,medium:1e6,small:4e5,tiny:8e4,auto:0}},function(e,t,n){"use strict";(function(e){function t(e,t,n){e[t]||Object[r](e,t,{writable:!0,configurable:!0,value:n})}if(n(382),n(387),n(183),e._babelPolyfill)throw new Error("only one instance of babel-polyfill is allowed");e._babelPolyfill=!0;var r="defineProperty";t(String.prototype,"padLeft","".padStart),t(String.prototype,"padRight","".padEnd),"pop,reverse,shift,keys,values,entries,indexOf,every,some,forEach,map,filter,find,findIndex,includes,join,slice,concat,push,splice,unshift,sort,lastIndexOf,reduce,reduceRight,copyWithin,fill".split(",").forEach(function(e){[][e]&&t(Array,e,Function.call.bind([][e]))})}).call(t,n(90))},function(e,t,n){"use strict";n(190),e.exports=n(22).RegExp.escape},function(e,t,n){"use strict";var r=n(4),i=n(54),o=n(5)("species");e.exports=function(e){var t;return i(e)&&(t=e.constructor,"function"!=typeof t||t!==Array&&!i(t.prototype)||(t=void 0),r(t)&&null===(t=t[o])&&(t=void 0)),void 0===t?Array:t}},function(e,t,n){"use strict";var r=n(3),i=Date.prototype.getTime,o=Date.prototype.toISOString,a=function(e){return e>9?e:"0"+e};e.exports=r(function(){return"0385-07-25T07:06:39.999Z"!=o.call(new Date(-5e13-1))})||!r(function(){o.call(new Date(NaN))})?function(){if(!isFinite(i.call(this)))throw RangeError("Invalid time value");var e=this,t=e.getUTCFullYear(),n=e.getUTCMilliseconds(),r=t<0?"-":t>9999?"+":"";return r+("00000"+Math.abs(t)).slice(r?-6:-4)+"-"+a(e.getUTCMonth()+1)+"-"+a(e.getUTCDate())+"T"+a(e.getUTCHours())+":"+a(e.getUTCMinutes())+":"+a(e.getUTCSeconds())+"."+(n>99?n:"0"+a(n))+"Z"}:o},function(e,t,n){"use strict";var r=n(1),i=n(26);e.exports=function(e){if("string"!==e&&"number"!==e&&"default"!==e)throw TypeError("Incorrect hint");return i(r(this),"number"!=e)}},function(e,t,n){"use strict";var r=n(37),i=n(58),o=n(49);e.exports=function(e){var t=r(e),n=i.f;if(n)for(var a,s=n(e),l=o.f,u=0;s.length>u;)l.call(e,a=s[u++])&&t.push(a);return t}},function(e,t,n){"use strict";e.exports=function(e,t){var n=t===Object(t)?function(e){return t[e]}:t;return function(t){return String(t).replace(e,n)}}},function(e,t,n){"use strict";e.exports=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}},function(e,t,n){"use strict";var r=n(0),i=n(188)(/[\\^$*+?.()|[\]{}]/g,"\\$&");r(r.S,"RegExp",{escape:function(e){return i(e)}})},function(e,t,n){"use strict";var r=n(0);r(r.P,"Array",{copyWithin:n(96)}),n(30)("copyWithin")},function(e,t,n){"use strict";var r=n(0),i=n(21)(4);r(r.P+r.F*!n(20)([].every,!0),"Array",{every:function(e){return i(this,e,arguments[1])}})},function(e,t,n){"use strict";var r=n(0);r(r.P,"Array",{fill:n(64)}),n(30)("fill")},function(e,t,n){"use strict";var r=n(0),i=n(21)(2);r(r.P+r.F*!n(20)([].filter,!0),"Array",{filter:function(e){return i(this,e,arguments[1])}})},function(e,t,n){"use strict";var r=n(0),i=n(21)(6),o="findIndex",a=!0;o in[]&&Array(1)[o](function(){a=!1}),r(r.P+r.F*a,"Array",{findIndex:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),n(30)(o)},function(e,t,n){"use strict";var r=n(0),i=n(21)(5),o=!0;"find"in[]&&Array(1).find(function(){o=!1}),r(r.P+r.F*o,"Array",{find:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),n(30)("find")},function(e,t,n){"use strict";var r=n(0),i=n(21)(0),o=n(20)([].forEach,!0);r(r.P+r.F*!o,"Array",{forEach:function(e){return i(this,e,arguments[1])}})},function(e,t,n){"use strict";var r=n(19),i=n(0),o=n(9),a=n(107),s=n(72),l=n(8),u=n(66),d=n(88);i(i.S+i.F*!n(56)(function(e){Array.from(e)}),"Array",{from:function(e){var t,n,i,c,f=o(e),h="function"==typeof this?this:Array,p=arguments.length,m=p>1?arguments[1]:void 0,g=void 0!==m,y=0,v=d(f);if(g&&(m=r(m,p>2?arguments[2]:void 0,2)),void 0==v||h==Array&&s(v))for(t=l(f.length),n=new h(t);t>y;y++)u(n,y,g?m(f[y],y):f[y]);else for(c=v.call(f),n=new h;!(i=c.next()).done;y++)u(n,y,g?a(c,m,[i.value,y],!0):i.value);return n.length=y,n}})},function(e,t,n){"use strict";var r=n(0),i=n(50)(!1),o=[].indexOf,a=!!o&&1/[1].indexOf(1,-0)<0;r(r.P+r.F*(a||!n(20)(o)),"Array",{indexOf:function(e){return a?o.apply(this,arguments)||0:i(this,e,arguments[1])}})},function(e,t,n){"use strict";var r=n(0);r(r.S,"Array",{isArray:n(54)})},function(e,t,n){"use strict";var r=n(0),i=n(17),o=[].join;r(r.P+r.F*(n(48)!=Object||!n(20)(o)),"Array",{join:function(e){return o.call(i(this),void 0===e?",":e)}})},function(e,t,n){"use strict";var r=n(0),i=n(17),o=n(25),a=n(8),s=[].lastIndexOf,l=!!s&&1/[1].lastIndexOf(1,-0)<0;r(r.P+r.F*(l||!n(20)(s)),"Array",{lastIndexOf:function(e){if(l)return s.apply(this,arguments)||0;var t=i(this),n=a(t.length),r=n-1;for(arguments.length>1&&(r=Math.min(r,o(arguments[1]))),r<0&&(r=n+r);r>=0;r--)if(r in t&&t[r]===e)return r||0;return-1}})},function(e,t,n){"use strict";var r=n(0),i=n(21)(1);r(r.P+r.F*!n(20)([].map,!0),"Array",{map:function(e){return i(this,e,arguments[1])}})},function(e,t,n){"use strict";var r=n(0),i=n(66);r(r.S+r.F*n(3)(function(){function e(){}return!(Array.of.call(e)instanceof e)}),"Array",{of:function(){for(var e=0,t=arguments.length,n=new("function"==typeof this?this:Array)(t);t>e;)i(n,e,arguments[e++]);return n.length=t,n}})},function(e,t,n){"use strict";var r=n(0),i=n(98);r(r.P+r.F*!n(20)([].reduceRight,!0),"Array",{reduceRight:function(e){return i(this,e,arguments.length,arguments[1],!0)}})},function(e,t,n){"use strict";var r=n(0),i=n(98);r(r.P+r.F*!n(20)([].reduce,!0),"Array",{reduce:function(e){return i(this,e,arguments.length,arguments[1],!1)}})},function(e,t,n){"use strict";var r=n(0),i=n(70),o=n(18),a=n(41),s=n(8),l=[].slice;r(r.P+r.F*n(3)(function(){i&&l.call(i)}),"Array",{slice:function(e,t){var n=s(this.length),r=o(this);if(t=void 0===t?n:t,"Array"==r)return l.call(this,e,t);for(var i=a(e,n),u=a(t,n),d=s(u-i),c=Array(d),f=0;f<d;f++)c[f]="String"==r?this.charAt(i+f):this[i+f];return c}})},function(e,t,n){"use strict";var r=n(0),i=n(21)(3);r(r.P+r.F*!n(20)([].some,!0),"Array",{some:function(e){return i(this,e,arguments[1])}})},function(e,t,n){"use strict";var r=n(0),i=n(10),o=n(9),a=n(3),s=[].sort,l=[1,2,3];r(r.P+r.F*(a(function(){l.sort(void 0)})||!a(function(){l.sort(null)})||!n(20)(s)),"Array",{sort:function(e){return void 0===e?s.call(o(this)):s.call(o(this),i(e))}})},function(e,t,n){"use strict";n(40)("Array")},function(e,t,n){"use strict";var r=n(0);r(r.S,"Date",{now:function(){return(new Date).getTime()}})},function(e,t,n){"use strict";var r=n(0),i=n(185);r(r.P+r.F*(Date.prototype.toISOString!==i),"Date",{toISOString:i})},function(e,t,n){"use strict";var r=n(0),i=n(9),o=n(26);r(r.P+r.F*n(3)(function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}),"Date",{toJSON:function(e){var t=i(this),n=o(t);return"number"!=typeof n||isFinite(n)?t.toISOString():null}})},function(e,t,n){"use strict";var r=n(5)("toPrimitive"),i=Date.prototype;r in i||n(12)(i,r,n(186))},function(e,t,n){"use strict";var r=Date.prototype,i=r.toString,o=r.getTime;new Date(NaN)+""!="Invalid Date"&&n(13)(r,"toString",function(){var e=o.call(this);return e===e?i.call(this):"Invalid Date"})},function(e,t,n){"use strict";var r=n(0);r(r.P,"Function",{bind:n(99)})},function(e,t,n){"use strict";var r=n(4),i=n(16),o=n(5)("hasInstance"),a=Function.prototype;o in a||n(7).f(a,o,{value:function(e){if("function"!=typeof this||!r(e))return!1;if(!r(this.prototype))return e instanceof this;for(;e=i(e);)if(this.prototype===e)return!0;return!1}})},function(e,t,n){"use strict";var r=n(7).f,i=Function.prototype,o=/^\s*function ([^ (]*)/;"name"in i||n(6)&&r(i,"name",{configurable:!0,get:function(){try{return(""+this).match(o)[1]}catch(e){return""}}})},function(e,t,n){"use strict";var r=n(0),i=n(110),o=Math.sqrt,a=Math.acosh;r(r.S+r.F*!(a&&710==Math.floor(a(Number.MAX_VALUE))&&a(1/0)==1/0),"Math",{acosh:function(e){return(e=+e)<1?NaN:e>94906265.62425156?Math.log(e)+Math.LN2:i(e-1+o(e-1)*o(e+1))}})},function(e,t,n){"use strict";function r(e){return isFinite(e=+e)&&0!=e?e<0?-r(-e):Math.log(e+Math.sqrt(e*e+1)):e}var i=n(0),o=Math.asinh;i(i.S+i.F*!(o&&1/o(0)>0),"Math",{asinh:r})},function(e,t,n){"use strict";var r=n(0),i=Math.atanh;r(r.S+r.F*!(i&&1/i(-0)<0),"Math",{atanh:function(e){return 0==(e=+e)?e:Math.log((1+e)/(1-e))/2}})},function(e,t,n){"use strict";var r=n(0),i=n(76);r(r.S,"Math",{cbrt:function(e){return i(e=+e)*Math.pow(Math.abs(e),1/3)}})},function(e,t,n){"use strict";var r=n(0);r(r.S,"Math",{clz32:function(e){return(e>>>=0)?31-Math.floor(Math.log(e+.5)*Math.LOG2E):32}})},function(e,t,n){"use strict";var r=n(0),i=Math.exp;r(r.S,"Math",{cosh:function(e){return(i(e=+e)+i(-e))/2}})},function(e,t,n){"use strict";var r=n(0),i=n(75);r(r.S+r.F*(i!=Math.expm1),"Math",{expm1:i})},function(e,t,n){"use strict";var r=n(0);r(r.S,"Math",{fround:n(109)})},function(e,t,n){"use strict";var r=n(0),i=Math.abs;r(r.S,"Math",{hypot:function(e,t){for(var n,r,o=0,a=0,s=arguments.length,l=0;a<s;)n=i(arguments[a++]),l<n?(r=l/n,o=o*r*r+1,l=n):n>0?(r=n/l,o+=r*r):o+=n;return l===1/0?1/0:l*Math.sqrt(o)}})},function(e,t,n){"use strict";var r=n(0),i=Math.imul;r(r.S+r.F*n(3)(function(){return-5!=i(4294967295,5)||2!=i.length}),"Math",{imul:function(e,t){var n=+e,r=+t,i=65535&n,o=65535&r;return 0|i*o+((65535&n>>>16)*o+i*(65535&r>>>16)<<16>>>0)}})},function(e,t,n){"use strict";var r=n(0);r(r.S,"Math",{log10:function(e){return Math.log(e)*Math.LOG10E}})},function(e,t,n){"use strict";var r=n(0);r(r.S,"Math",{log1p:n(110)})},function(e,t,n){"use strict";var r=n(0);r(r.S,"Math",{log2:function(e){return Math.log(e)/Math.LN2}})},function(e,t,n){"use strict";var r=n(0);r(r.S,"Math",{sign:n(76)})},function(e,t,n){"use strict";var r=n(0),i=n(75),o=Math.exp;r(r.S+r.F*n(3)(function(){return-2e-17!=!Math.sinh(-2e-17)}),"Math",{sinh:function(e){return Math.abs(e=+e)<1?(i(e)-i(-e))/2:(o(e-1)-o(-e-1))*(Math.E/2)}})},function(e,t,n){"use strict";var r=n(0),i=n(75),o=Math.exp;r(r.S,"Math",{tanh:function(e){var t=i(e=+e),n=i(-e);return t==1/0?1:n==1/0?-1:(t-n)/(o(e)+o(-e))}})},function(e,t,n){"use strict";var r=n(0);r(r.S,"Math",{trunc:function(e){return(e>0?Math.floor:Math.ceil)(e)}})},function(e,t,n){"use strict";var r=n(2),i=n(11),o=n(18),a=n(71),s=n(26),l=n(3),u=n(36).f,d=n(15).f,c=n(7).f,f=n(45).trim,h=r.Number,p=h,m=h.prototype,g="Number"==o(n(35)(m)),y="trim"in String.prototype,v=function(e){var t=s(e,!1);if("string"==typeof t&&t.length>2){t=y?t.trim():f(t,3);var n,r,i,o=t.charCodeAt(0);if(43===o||45===o){if(88===(n=t.charCodeAt(2))||120===n)return NaN}else if(48===o){switch(t.charCodeAt(1)){case 66:case 98:r=2,i=49;break;case 79:case 111:r=8,i=55;break;default:return+t}for(var a,l=t.slice(2),u=0,d=l.length;u<d;u++)if((a=l.charCodeAt(u))<48||a>i)return NaN;return parseInt(l,r)}}return+t};if(!h(" 0o1")||!h("0b1")||h("+0x1")){h=function(e){var t=arguments.length<1?0:e,n=this;return n instanceof h&&(g?l(function(){m.valueOf.call(n)}):"Number"!=o(n))?a(new p(v(t)),n,h):v(t)};for(var _,b=n(6)?u(p):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),E=0;b.length>E;E++)i(p,_=b[E])&&!i(h,_)&&c(h,_,d(p,_));h.prototype=m,m.constructor=h,n(13)(r,"Number",h)}},function(e,t,n){"use strict";var r=n(0);r(r.S,"Number",{EPSILON:Math.pow(2,-52)})},function(e,t,n){"use strict";var r=n(0),i=n(2).isFinite;r(r.S,"Number",{isFinite:function(e){return"number"==typeof e&&i(e)}})},function(e,t,n){"use strict";var r=n(0);r(r.S,"Number",{isInteger:n(106)})},function(e,t,n){"use strict";var r=n(0);r(r.S,"Number",{isNaN:function(e){return e!=e}})},function(e,t,n){"use strict";var r=n(0),i=n(106),o=Math.abs;r(r.S,"Number",{isSafeInteger:function(e){return i(e)&&o(e)<=9007199254740991}})},function(e,t,n){"use strict";var r=n(0);r(r.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(e,t,n){"use strict";var r=n(0);r(r.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(e,t,n){"use strict";var r=n(0),i=n(118);r(r.S+r.F*(Number.parseFloat!=i),"Number",{parseFloat:i})},function(e,t,n){"use strict";var r=n(0),i=n(119);r(r.S+r.F*(Number.parseInt!=i),"Number",{parseInt:i})},function(e,t,n){"use strict";var r=n(0),i=n(25),o=n(95),a=n(83),s=1..toFixed,l=Math.floor,u=[0,0,0,0,0,0],d="Number.toFixed: incorrect invocation!",c=function(e,t){for(var n=-1,r=t;++n<6;)r+=e*u[n],u[n]=r%1e7,r=l(r/1e7)},f=function(e){for(var t=6,n=0;--t>=0;)n+=u[t],u[t]=l(n/e),n=n%e*1e7},h=function(){for(var e=6,t="";--e>=0;)if(""!==t||0===e||0!==u[e]){var n=String(u[e]);t=""===t?n:t+a.call("0",7-n.length)+n}return t},p=function e(t,n,r){return 0===n?r:n%2==1?e(t,n-1,r*t):e(t*t,n/2,r)},m=function(e){for(var t=0,n=e;n>=4096;)t+=12,n/=4096;for(;n>=2;)t+=1,n/=2;return t};r(r.P+r.F*(!!s&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!n(3)(function(){s.call({})})),"Number",{toFixed:function(e){var t,n,r,s,l=o(this,d),u=i(e),g="",y="0";if(u<0||u>20)throw RangeError(d);if(l!=l)return"NaN";if(l<=-1e21||l>=1e21)return String(l);if(l<0&&(g="-",l=-l),l>1e-21)if(t=m(l*p(2,69,1))-69,n=t<0?l*p(2,-t,1):l/p(2,t,1),n*=4503599627370496,(t=52-t)>0){for(c(0,n),r=u;r>=7;)c(1e7,0),r-=7;for(c(p(10,r,1),0),r=t-1;r>=23;)f(1<<23),r-=23;f(1<<r),c(1,1),f(2),y=h()}else c(0,n),c(1<<-t,0),y=h()+a.call("0",u);return u>0?(s=y.length,y=g+(s<=u?"0."+a.call("0",u-s)+y:y.slice(0,s-u)+"."+y.slice(s-u))):y=g+y,y}})},function(e,t,n){"use strict";var r=n(0),i=n(3),o=n(95),a=1..toPrecision;r(r.P+r.F*(i(function(){return"1"!==a.call(1,void 0)})||!i(function(){a.call({})})),"Number",{toPrecision:function(e){var t=o(this,"Number#toPrecision: incorrect invocation!");return void 0===e?a.call(t):a.call(t,e)}})},function(e,t,n){"use strict";var r=n(0);r(r.S+r.F,"Object",{assign:n(112)})},function(e,t,n){"use strict";var r=n(0);r(r.S,"Object",{create:n(35)})},function(e,t,n){"use strict";var r=n(0);r(r.S+r.F*!n(6),"Object",{defineProperties:n(113)})},function(e,t,n){"use strict";var r=n(0);r(r.S+r.F*!n(6),"Object",{defineProperty:n(7).f})},function(e,t,n){"use strict";var r=n(4),i=n(31).onFreeze;n(24)("freeze",function(e){return function(t){return e&&r(t)?e(i(t)):t}})},function(e,t,n){"use strict";var r=n(17),i=n(15).f;n(24)("getOwnPropertyDescriptor",function(){return function(e,t){return i(r(e),t)}})},function(e,t,n){"use strict";n(24)("getOwnPropertyNames",function(){return n(114).f})},function(e,t,n){"use strict";var r=n(9),i=n(16);n(24)("getPrototypeOf",function(){return function(e){return i(r(e))}})},function(e,t,n){"use strict";var r=n(4);n(24)("isExtensible",function(e){return function(t){return!!r(t)&&(!e||e(t))}})},function(e,t,n){"use strict";var r=n(4);n(24)("isFrozen",function(e){return function(t){return!r(t)||!!e&&e(t)}})},function(e,t,n){"use strict";var r=n(4);n(24)("isSealed",function(e){return function(t){return!r(t)||!!e&&e(t)}})},function(e,t,n){"use strict";var r=n(0);r(r.S,"Object",{is:n(189)})},function(e,t,n){"use strict";var r=n(9),i=n(37);n(24)("keys",function(){return function(e){return i(r(e))}})},function(e,t,n){"use strict";var r=n(4),i=n(31).onFreeze;n(24)("preventExtensions",function(e){return function(t){return e&&r(t)?e(i(t)):t}})},function(e,t,n){"use strict";var r=n(4),i=n(31).onFreeze;n(24)("seal",function(e){return function(t){return e&&r(t)?e(i(t)):t}})},function(e,t,n){"use strict";var r=n(0);r(r.S,"Object",{setPrototypeOf:n(79).set})},function(e,t,n){"use strict";var r=n(47),i={};i[n(5)("toStringTag")]="z",i+""!="[object z]"&&n(13)(Object.prototype,"toString",function(){return"[object "+r(this)+"]"},!0)},function(e,t,n){"use strict";var r=n(0),i=n(118);r(r.G+r.F*(parseFloat!=i),{parseFloat:i})},function(e,t,n){"use strict";var r=n(0),i=n(119);r(r.G+r.F*(parseInt!=i),{parseInt:i})},function(e,t,n){"use strict";var r,i,o,a,s=n(34),l=n(2),u=n(19),d=n(47),c=n(0),f=n(4),h=n(10),p=n(32),m=n(33),g=n(62),y=n(85).set,v=n(77)(),_=n(78),b=n(120),E=n(121),T=l.TypeError,S=l.process,x=l.Promise,w="process"==d(S),I=function(){},D=i=_.f,R=!!function(){try{var e=x.resolve(1),t=(e.constructor={})[n(5)("species")]=function(e){e(I,I)};return(w||"function"==typeof PromiseRejectionEvent)&&e.then(I)instanceof t}catch(e){}}(),A=function(e){var t;return!(!f(e)||"function"!=typeof(t=e.then))&&t},P=function(e,t){if(!e._n){e._n=!0;var n=e._c;v(function(){for(var r=e._v,i=1==e._s,o=0;n.length>o;)!function(t){var n,o,a=i?t.ok:t.fail,s=t.resolve,l=t.reject,u=t.domain;try{a?(i||(2==e._h&&C(e),e._h=1),!0===a?n=r:(u&&u.enter(),n=a(r),u&&u.exit()),n===t.promise?l(T("Promise-chain cycle")):(o=A(n))?o.call(n,s,l):s(n)):l(r)}catch(e){l(e)}}(n[o++]);e._c=[],e._n=!1,t&&!e._h&&M(e)})}},M=function(e){y.call(l,function(){var t,n,r,i=e._v,o=L(e);if(o&&(t=b(function(){w?S.emit("unhandledRejection",i,e):(n=l.onunhandledrejection)?n({promise:e,reason:i}):(r=l.console)&&r.error&&r.error("Unhandled promise rejection",i)}),e._h=w||L(e)?2:1),e._a=void 0,o&&t.e)throw t.v})},L=function e(t){if(1==t._h)return!1;for(var n,r=t._a||t._c,i=0;r.length>i;)if(n=r[i++],n.fail||!e(n.promise))return!1;return!0},C=function(e){y.call(l,function(){var t;w?S.emit("rejectionHandled",e):(t=l.onrejectionhandled)&&t({promise:e,reason:e._v})})},O=function(e){var t=this;t._d||(t._d=!0,t=t._w||t,t._v=e,t._s=2,t._a||(t._a=t._c.slice()),P(t,!0))},k=function e(t){var n,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===t)throw T("Promise can't be resolved itself");(n=A(t))?v(function(){var i={_w:r,_d:!1};try{n.call(t,u(e,i,1),u(O,i,1))}catch(e){O.call(i,e)}}):(r._v=t,r._s=1,P(r,!1))}catch(e){O.call({_w:r,_d:!1},e)}}};R||(x=function(e){p(this,x,"Promise","_h"),h(e),r.call(this);try{e(u(k,this,1),u(O,this,1))}catch(e){O.call(this,e)}},r=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},r.prototype=n(39)(x.prototype,{then:function(e,t){var n=D(g(this,x));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=w?S.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&P(this,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),o=function(){var e=new r;this.promise=e,this.resolve=u(k,e,1),this.reject=u(O,e,1)},_.f=D=function(e){return e===x||e===a?new o(e):i(e)}),c(c.G+c.W+c.F*!R,{Promise:x}),n(44)(x,"Promise"),n(40)("Promise"),a=n(22).Promise,c(c.S+c.F*!R,"Promise",{reject:function(e){var t=D(this);return(0,t.reject)(e),t.promise}}),c(c.S+c.F*(s||!R),"Promise",{resolve:function(e){return E(s&&this===a?x:this,e)}}),c(c.S+c.F*!(R&&n(56)(function(e){x.all(e).catch(I)})),"Promise",{all:function(e){var t=this,n=D(t),r=n.resolve,i=n.reject,o=b(function(){var n=[],o=0,a=1;m(e,!1,function(e){var s=o++,l=!1;n.push(void 0),a++,t.resolve(e).then(function(e){l||(l=!0,n[s]=e,--a||r(n))},i)}),--a||r(n)});return o.e&&i(o.v),n.promise},race:function(e){var t=this,n=D(t),r=n.reject,i=b(function(){m(e,!1,function(e){t.resolve(e).then(n.resolve,r)})});return i.e&&r(i.v),n.promise}})},function(e,t,n){"use strict";var r=n(0),i=n(10),o=n(1),a=(n(2).Reflect||{}).apply,s=Function.apply;r(r.S+r.F*!n(3)(function(){a(function(){})}),"Reflect",{apply:function(e,t,n){var r=i(e),l=o(n);return a?a(r,t,l):s.call(r,t,l)}})},function(e,t,n){"use strict";var r=n(0),i=n(35),o=n(10),a=n(1),s=n(4),l=n(3),u=n(99),d=(n(2).Reflect||{}).construct,c=l(function(){function e(){}return!(d(function(){},[],e)instanceof e)}),f=!l(function(){d(function(){})});r(r.S+r.F*(c||f),"Reflect",{construct:function(e,t){o(e),a(t);var n=arguments.length<3?e:o(arguments[2]);if(f&&!c)return d(e,t,n);if(e==n){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var r=[null];return r.push.apply(r,t),new(u.apply(e,r))}var l=n.prototype,h=i(s(l)?l:Object.prototype),p=Function.apply.call(e,h,t);return s(p)?p:h}})},function(e,t,n){"use strict";var r=n(7),i=n(0),o=n(1),a=n(26);i(i.S+i.F*n(3)(function(){Reflect.defineProperty(r.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function(e,t,n){o(e),t=a(t,!0),o(n);try{return r.f(e,t,n),!0}catch(e){return!1}}})},function(e,t,n){"use strict";var r=n(0),i=n(15).f,o=n(1);r(r.S,"Reflect",{deleteProperty:function(e,t){var n=i(o(e),t);return!(n&&!n.configurable)&&delete e[t]}})},function(e,t,n){"use strict";var r=n(0),i=n(1),o=function(e){this._t=i(e),this._i=0;var t,n=this._k=[];for(t in e)n.push(t)};n(73)(o,"Object",function(){var e,t=this,n=t._k;do{if(t._i>=n.length)return{value:void 0,done:!0}}while(!((e=n[t._i++])in t._t));return{value:e,done:!1}}),r(r.S,"Reflect",{enumerate:function(e){return new o(e)}})},function(e,t,n){"use strict";var r=n(15),i=n(0),o=n(1);i(i.S,"Reflect",{getOwnPropertyDescriptor:function(e,t){return r.f(o(e),t)}})},function(e,t,n){"use strict";var r=n(0),i=n(16),o=n(1);r(r.S,"Reflect",{getPrototypeOf:function(e){return i(o(e))}})},function(e,t,n){"use strict";function r(e,t){var n,s,d=arguments.length<3?e:arguments[2];return u(e)===d?e[t]:(n=i.f(e,t))?a(n,"value")?n.value:void 0!==n.get?n.get.call(d):void 0:l(s=o(e))?r(s,t,d):void 0}var i=n(15),o=n(16),a=n(11),s=n(0),l=n(4),u=n(1);s(s.S,"Reflect",{get:r})},function(e,t,n){"use strict";var r=n(0);r(r.S,"Reflect",{has:function(e,t){return t in e}})},function(e,t,n){"use strict";var r=n(0),i=n(1),o=Object.isExtensible;r(r.S,"Reflect",{isExtensible:function(e){return i(e),!o||o(e)}})},function(e,t,n){"use strict";var r=n(0);r(r.S,"Reflect",{ownKeys:n(117)})},function(e,t,n){"use strict";var r=n(0),i=n(1),o=Object.preventExtensions;r(r.S,"Reflect",{preventExtensions:function(e){i(e);try{return o&&o(e),!0}catch(e){return!1}}})},function(e,t,n){"use strict";var r=n(0),i=n(79);i&&r(r.S,"Reflect",{setPrototypeOf:function(e,t){i.check(e,t);try{return i.set(e,t),!0}catch(e){return!1}}})},function(e,t,n){"use strict";function r(e,t,n){var l,f,h=arguments.length<4?e:arguments[3],p=o.f(d(e),t);if(!p){if(c(f=a(e)))return r(f,t,n,h);p=u(0)}return s(p,"value")?!(!1===p.writable||!c(h))&&(l=o.f(h,t)||u(0),l.value=n,i.f(h,t,l),!0):void 0!==p.set&&(p.set.call(h,n),!0)}var i=n(7),o=n(15),a=n(16),s=n(11),l=n(0),u=n(38),d=n(1),c=n(4);l(l.S,"Reflect",{set:r})},function(e,t,n){"use strict";var r=n(2),i=n(71),o=n(7).f,a=n(36).f,s=n(55),l=n(53),u=r.RegExp,d=u,c=u.prototype,f=/a/g,h=/a/g,p=new u(f)!==f;if(n(6)&&(!p||n(3)(function(){return h[n(5)("match")]=!1,u(f)!=f||u(h)==h||"/a/i"!=u(f,"i")}))){u=function(e,t){var n=this instanceof u,r=s(e),o=void 0===t;return!n&&r&&e.constructor===u&&o?e:i(p?new d(r&&!o?e.source:e,t):d((r=e instanceof u)?e.source:e,r&&o?l.call(e):t),n?this:c,u)};for(var m=a(d),g=0;m.length>g;)!function(e){e in u||o(u,e,{configurable:!0,get:function(){return d[e]},set:function(t){d[e]=t}})}(m[g++]);c.constructor=u,u.prototype=c,n(13)(r,"RegExp",u)}n(40)("RegExp")},function(e,t,n){"use strict";n(52)("match",1,function(e,t,n){return[function(n){var r=e(this),i=void 0==n?void 0:n[t];return void 0!==i?i.call(n,r):new RegExp(n)[t](String(r))},n]})},function(e,t,n){"use strict";n(52)("replace",2,function(e,t,n){return[function(r,i){var o=e(this),a=void 0==r?void 0:r[t];return void 0!==a?a.call(r,o,i):n.call(String(o),r,i)},n]})},function(e,t,n){"use strict";n(52)("search",1,function(e,t,n){return[function(n){var r=e(this),i=void 0==n?void 0:n[t];return void 0!==i?i.call(n,r):new RegExp(n)[t](String(r))},n]})},function(e,t,n){"use strict";n(52)("split",2,function(e,t,r){var i=n(55),o=r,a=[].push,s="length";if("c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1)[s]||2!="ab".split(/(?:ab)*/)[s]||4!=".".split(/(.?)(.?)/)[s]||".".split(/()()/)[s]>1||"".split(/.?/)[s]){var l=void 0===/()??/.exec("")[1];r=function(e,t){var n=String(this);if(void 0===e&&0===t)return[];if(!i(e))return o.call(n,e,t);var r,u,d,c,f,h=[],p=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),m=0,g=void 0===t?4294967295:t>>>0,y=new RegExp(e.source,p+"g");for(l||(r=new RegExp("^"+y.source+"$(?!\\s)",p));(u=y.exec(n))&&!((d=u.index+u[0][s])>m&&(h.push(n.slice(m,u.index)),!l&&u[s]>1&&u[0].replace(r,function(){for(f=1;f<arguments[s]-2;f++)void 0===arguments[f]&&(u[f]=void 0)}),u[s]>1&&u.index<n[s]&&a.apply(h,u.slice(1)),c=u[0][s],m=d,h[s]>=g));)y.lastIndex===u.index&&y.lastIndex++;return m===n[s]?!c&&y.test("")||h.push(""):h.push(n.slice(m)),h[s]>g?h.slice(0,g):h}}else"0".split(void 0,0)[s]&&(r=function(e,t){return void 0===e&&0===t?[]:o.call(this,e,t)});return[function(n,i){var o=e(this),a=void 0==n?void 0:n[t];return void 0!==a?a.call(n,o,i):r.call(String(o),n,i)},r]})},function(e,t,n){"use strict";n(126);var r=n(1),i=n(53),o=n(6),a=/./.toString,s=function(e){n(13)(RegExp.prototype,"toString",e,!0)};n(3)(function(){return"/a/b"!=a.call({source:"a",flags:"b"})})?s(function(){var e=r(this);return"/".concat(e.source,"/","flags"in e?e.flags:!o&&e instanceof RegExp?i.call(e):void 0)}):"toString"!=a.name&&s(function(){return a.call(this)})},function(e,t,n){"use strict";n(14)("anchor",function(e){return function(t){return e(this,"a","name",t)}})},function(e,t,n){"use strict";n(14)("big",function(e){return function(){return e(this,"big","","")}})},function(e,t,n){"use strict";n(14)("blink",function(e){return function(){return e(this,"blink","","")}})},function(e,t,n){"use strict";n(14)("bold",function(e){return function(){return e(this,"b","","")}})},function(e,t,n){"use strict";var r=n(0),i=n(81)(!1);r(r.P,"String",{codePointAt:function(e){return i(this,e)}})},function(e,t,n){"use strict";var r=n(0),i=n(8),o=n(82),a="".endsWith;r(r.P+r.F*n(69)("endsWith"),"String",{endsWith:function(e){var t=o(this,e,"endsWith"),n=arguments.length>1?arguments[1]:void 0,r=i(t.length),s=void 0===n?r:Math.min(i(n),r),l=String(e);return a?a.call(t,l,s):t.slice(s-l.length,s)===l}})},function(e,t,n){"use strict";n(14)("fixed",function(e){return function(){return e(this,"tt","","")}})},function(e,t,n){"use strict";n(14)("fontcolor",function(e){return function(t){return e(this,"font","color",t)}})},function(e,t,n){"use strict";n(14)("fontsize",function(e){return function(t){return e(this,"font","size",t)}})},function(e,t,n){"use strict";var r=n(0),i=n(41),o=String.fromCharCode,a=String.fromCodePoint;r(r.S+r.F*(!!a&&1!=a.length),"String",{fromCodePoint:function(e){for(var t,n=[],r=arguments.length,a=0;r>a;){if(t=+arguments[a++],i(t,1114111)!==t)throw RangeError(t+" is not a valid code point");n.push(t<65536?o(t):o(55296+((t-=65536)>>10),t%1024+56320))}return n.join("")}})},function(e,t,n){"use strict";var r=n(0),i=n(82);r(r.P+r.F*n(69)("includes"),"String",{includes:function(e){return!!~i(this,e,"includes").indexOf(e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,n){"use strict";n(14)("italics",function(e){return function(){return e(this,"i","","")}})},function(e,t,n){"use strict";var r=n(81)(!0);n(74)(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=r(t,n),this._i+=e.length,{value:e,done:!1})})},function(e,t,n){"use strict";n(14)("link",function(e){return function(t){return e(this,"a","href",t)}})},function(e,t,n){"use strict";var r=n(0),i=n(17),o=n(8);r(r.S,"String",{raw:function(e){for(var t=i(e.raw),n=o(t.length),r=arguments.length,a=[],s=0;n>s;)a.push(String(t[s++])),s<r&&a.push(String(arguments[s]));return a.join("")}})},function(e,t,n){"use strict";var r=n(0);r(r.P,"String",{repeat:n(83)})},function(e,t,n){"use strict";n(14)("small",function(e){return function(){return e(this,"small","","")}})},function(e,t,n){"use strict";var r=n(0),i=n(8),o=n(82),a="".startsWith;r(r.P+r.F*n(69)("startsWith"),"String",{startsWith:function(e){var t=o(this,e,"startsWith"),n=i(Math.min(arguments.length>1?arguments[1]:void 0,t.length)),r=String(e);return a?a.call(t,r,n):t.slice(n,n+r.length)===r}})},function(e,t,n){"use strict";n(14)("strike",function(e){return function(){return e(this,"strike","","")}})},function(e,t,n){"use strict";n(14)("sub",function(e){return function(){return e(this,"sub","","")}})},function(e,t,n){"use strict";n(14)("sup",function(e){return function(){return e(this,"sup","","")}})},function(e,t,n){"use strict";n(45)("trim",function(e){return function(){return e(this,3)}})},function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(2),o=n(11),a=n(6),s=n(0),l=n(13),u=n(31).KEY,d=n(3),c=n(61),f=n(44),h=n(42),p=n(5),m=n(124),g=n(87),y=n(187),v=n(54),_=n(1),b=n(17),E=n(26),T=n(38),S=n(35),x=n(114),w=n(15),I=n(7),D=n(37),R=w.f,A=I.f,P=x.f,M=i.Symbol,L=i.JSON,C=L&&L.stringify,O=p("_hidden"),k=p("toPrimitive"),N={}.propertyIsEnumerable,F=c("symbol-registry"),B=c("symbols"),U=c("op-symbols"),j=Object.prototype,H="function"==typeof M,q=i.QObject,V=!q||!q.prototype||!q.prototype.findChild,G=a&&d(function(){return 7!=S(A({},"a",{get:function(){return A(this,"a",{value:7}).a}})).a})?function(e,t,n){var r=R(j,t);r&&delete j[t],A(e,t,n),r&&e!==j&&A(j,t,r)}:A,K=function(e){var t=B[e]=S(M.prototype);return t._k=e,t},z=H&&"symbol"==r(M.iterator)?function(e){return"symbol"==(void 0===e?"undefined":r(e))}:function(e){return e instanceof M},Y=function(e,t,n){return e===j&&Y(U,t,n),_(e),t=E(t,!0),_(n),o(B,t)?(n.enumerable?(o(e,O)&&e[O][t]&&(e[O][t]=!1),n=S(n,{enumerable:T(0,!1)})):(o(e,O)||A(e,O,T(1,{})),e[O][t]=!0),G(e,t,n)):A(e,t,n)},W=function(e,t){_(e);for(var n,r=y(t=b(t)),i=0,o=r.length;o>i;)Y(e,n=r[i++],t[n]);return e},X=function(e,t){return void 0===t?S(e):W(S(e),t)},Q=function(e){var t=N.call(this,e=E(e,!0));return!(this===j&&o(B,e)&&!o(U,e))&&(!(t||!o(this,e)||!o(B,e)||o(this,O)&&this[O][e])||t)},Z=function(e,t){if(e=b(e),t=E(t,!0),e!==j||!o(B,t)||o(U,t)){var n=R(e,t);return!n||!o(B,t)||o(e,O)&&e[O][t]||(n.enumerable=!0),n}},J=function(e){for(var t,n=P(b(e)),r=[],i=0;n.length>i;)o(B,t=n[i++])||t==O||t==u||r.push(t);return r},$=function(e){for(var t,n=e===j,r=P(n?U:b(e)),i=[],a=0;r.length>a;)!o(B,t=r[a++])||n&&!o(j,t)||i.push(B[t]);return i};H||(M=function(){if(this instanceof M)throw TypeError("Symbol is not a constructor!");var e=h(arguments.length>0?arguments[0]:void 0),t=function t(n){this===j&&t.call(U,n),o(this,O)&&o(this[O],e)&&(this[O][e]=!1),G(this,e,T(1,n))};return a&&V&&G(j,e,{configurable:!0,set:t}),K(e)},l(M.prototype,"toString",function(){return this._k}),w.f=Z,I.f=Y,n(36).f=x.f=J,n(49).f=Q,n(58).f=$,a&&!n(34)&&l(j,"propertyIsEnumerable",Q,!0),m.f=function(e){return K(p(e))}),s(s.G+s.W+s.F*!H,{Symbol:M});for(var ee="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),te=0;ee.length>te;)p(ee[te++]);for(var ne=D(p.store),re=0;ne.length>re;)g(ne[re++]);s(s.S+s.F*!H,"Symbol",{for:function(e){return o(F,e+="")?F[e]:F[e]=M(e)},keyFor:function(e){if(!z(e))throw TypeError(e+" is not a symbol!");for(var t in F)if(F[t]===e)return t},useSetter:function(){V=!0},useSimple:function(){V=!1}}),s(s.S+s.F*!H,"Object",{create:X,defineProperty:Y,defineProperties:W,getOwnPropertyDescriptor:Z,getOwnPropertyNames:J,getOwnPropertySymbols:$}),L&&s(s.S+s.F*(!H||d(function(){var e=M();return"[null]"!=C([e])||"{}"!=C({a:e})||"{}"!=C(Object(e))})),"JSON",{stringify:function(e){if(void 0!==e&&!z(e)){for(var t,n,r=[e],i=1;arguments.length>i;)r.push(arguments[i++]);return t=r[1],"function"==typeof t&&(n=t),!n&&v(t)||(t=function(e,t){if(n&&(t=n.call(this,e,t)),!z(t))return t}),r[1]=t,C.apply(L,r)}}}),M.prototype[k]||n(12)(M.prototype,k,M.prototype.valueOf),f(M,"Symbol"),f(Math,"Math",!0),f(i.JSON,"JSON",!0)},function(e,t,n){"use strict";var r=n(0),i=n(63),o=n(86),a=n(1),s=n(41),l=n(8),u=n(4),d=n(2).ArrayBuffer,c=n(62),f=o.ArrayBuffer,h=o.DataView,p=i.ABV&&d.isView,m=f.prototype.slice,g=i.VIEW;r(r.G+r.W+r.F*(d!==f),{ArrayBuffer:f}),r(r.S+r.F*!i.CONSTR,"ArrayBuffer",{isView:function(e){return p&&p(e)||u(e)&&g in e}}),r(r.P+r.U+r.F*n(3)(function(){return!new f(2).slice(1,void 0).byteLength}),"ArrayBuffer",{slice:function(e,t){if(void 0!==m&&void 0===t)return m.call(a(this),e);for(var n=a(this).byteLength,r=s(e,n),i=s(void 0===t?n:t,n),o=new(c(this,f))(l(i-r)),u=new h(this),d=new h(o),p=0;r<i;)d.setUint8(p++,u.getUint8(r++));return o}}),n(40)("ArrayBuffer")},function(e,t,n){"use strict";var r=n(0);r(r.G+r.W+r.F*!n(63).ABV,{DataView:n(86).DataView})},function(e,t,n){"use strict";n(28)("Float32",4,function(e){return function(t,n,r){return e(this,t,n,r)}})},function(e,t,n){"use strict";n(28)("Float64",8,function(e){return function(t,n,r){return e(this,t,n,r)}})},function(e,t,n){"use strict";n(28)("Int16",2,function(e){return function(t,n,r){return e(this,t,n,r)}})},function(e,t,n){"use strict";n(28)("Int32",4,function(e){return function(t,n,r){return e(this,t,n,r)}})},function(e,t,n){"use strict";n(28)("Int8",1,function(e){return function(t,n,r){return e(this,t,n,r)}})},function(e,t,n){"use strict";n(28)("Uint16",2,function(e){return function(t,n,r){return e(this,t,n,r)}})},function(e,t,n){"use strict";n(28)("Uint32",4,function(e){return function(t,n,r){return e(this,t,n,r)}})},function(e,t,n){"use strict";n(28)("Uint8",1,function(e){return function(t,n,r){return e(this,t,n,r)}})},function(e,t,n){"use strict";n(28)("Uint8",1,function(e){return function(t,n,r){return e(this,t,n,r)}},!0)},function(e,t,n){"use strict";var r=n(102),i=n(46);n(51)("WeakSet",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{add:function(e){return r.def(i(this,"WeakSet"),e,!0)}},r,!1,!0)},function(e,t,n){"use strict";var r=n(0),i=n(103),o=n(9),a=n(8),s=n(10),l=n(65);r(r.P,"Array",{flatMap:function(e){var t,n,r=o(this);return s(e),t=a(r.length),n=l(r,0),i(n,r,r,t,0,1,e,arguments[1]),n}}),n(30)("flatMap")},function(e,t,n){"use strict";var r=n(0),i=n(103),o=n(9),a=n(8),s=n(25),l=n(65);r(r.P,"Array",{flatten:function(){var e=arguments[0],t=o(this),n=a(t.length),r=l(t,0);return i(r,t,t,n,0,void 0===e?1:s(e)),r}}),n(30)("flatten")},function(e,t,n){"use strict";var r=n(0),i=n(50)(!0);r(r.P,"Array",{includes:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),n(30)("includes")},function(e,t,n){"use strict";var r=n(0),i=n(77)(),o=n(2).process,a="process"==n(18)(o);r(r.G,{asap:function(e){var t=a&&o.domain;i(t?t.bind(e):e)}})},function(e,t,n){"use strict";var r=n(0),i=n(18);r(r.S,"Error",{isError:function(e){return"Error"===i(e)}})},function(e,t,n){"use strict";var r=n(0);r(r.G,{global:n(2)})},function(e,t,n){"use strict";n(59)("Map")},function(e,t,n){"use strict";n(60)("Map")},function(e,t,n){"use strict";var r=n(0);r(r.P+r.R,"Map",{toJSON:n(101)("Map")})},function(e,t,n){"use strict";var r=n(0);r(r.S,"Math",{clamp:function(e,t,n){return Math.min(n,Math.max(t,e))}})},function(e,t,n){"use strict";var r=n(0);r(r.S,"Math",{DEG_PER_RAD:Math.PI/180})},function(e,t,n){"use strict";var r=n(0),i=180/Math.PI;r(r.S,"Math",{degrees:function(e){return e*i}})},function(e,t,n){"use strict";var r=n(0),i=n(111),o=n(109);r(r.S,"Math",{fscale:function(e,t,n,r,a){return o(i(e,t,n,r,a))}})},function(e,t,n){"use strict";var r=n(0);r(r.S,"Math",{iaddh:function(e,t,n,r){var i=e>>>0,o=t>>>0,a=n>>>0;return o+(r>>>0)+((i&a|(i|a)&~(i+a>>>0))>>>31)|0}})},function(e,t,n){"use strict";var r=n(0);r(r.S,"Math",{imulh:function(e,t){var n=+e,r=+t,i=65535&n,o=65535&r,a=n>>16,s=r>>16,l=(a*o>>>0)+(i*o>>>16);return a*s+(l>>16)+((i*s>>>0)+(65535&l)>>16)}})},function(e,t,n){"use strict";var r=n(0);r(r.S,"Math",{isubh:function(e,t,n,r){var i=e>>>0,o=t>>>0,a=n>>>0;return o-(r>>>0)-((~i&a|~(i^a)&i-a>>>0)>>>31)|0}})},function(e,t,n){"use strict";var r=n(0);r(r.S,"Math",{RAD_PER_DEG:180/Math.PI})},function(e,t,n){"use strict";var r=n(0),i=Math.PI/180;r(r.S,"Math",{radians:function(e){return e*i}})},function(e,t,n){"use strict";var r=n(0);r(r.S,"Math",{scale:n(111)})},function(e,t,n){"use strict";var r=n(0);r(r.S,"Math",{signbit:function(e){return(e=+e)!=e?e:0==e?1/e==1/0:e>0}})},function(e,t,n){"use strict";var r=n(0);r(r.S,"Math",{umulh:function(e,t){var n=+e,r=+t,i=65535&n,o=65535&r,a=n>>>16,s=r>>>16,l=(a*o>>>0)+(i*o>>>16);return a*s+(l>>>16)+((i*s>>>0)+(65535&l)>>>16)}})},function(e,t,n){"use strict";var r=n(0),i=n(9),o=n(10),a=n(7);n(6)&&r(r.P+n(57),"Object",{__defineGetter__:function(e,t){a.f(i(this),e,{get:o(t),enumerable:!0,configurable:!0})}})},function(e,t,n){"use strict";var r=n(0),i=n(9),o=n(10),a=n(7);n(6)&&r(r.P+n(57),"Object",{__defineSetter__:function(e,t){a.f(i(this),e,{set:o(t),enumerable:!0,configurable:!0})}})},function(e,t,n){"use strict";var r=n(0),i=n(116)(!0);r(r.S,"Object",{entries:function(e){return i(e)}})},function(e,t,n){"use strict";var r=n(0),i=n(117),o=n(17),a=n(15),s=n(66);r(r.S,"Object",{getOwnPropertyDescriptors:function(e){for(var t,n,r=o(e),l=a.f,u=i(r),d={},c=0;u.length>c;)void 0!==(n=l(r,t=u[c++]))&&s(d,t,n);return d}})},function(e,t,n){"use strict";var r=n(0),i=n(9),o=n(26),a=n(16),s=n(15).f;n(6)&&r(r.P+n(57),"Object",{__lookupGetter__:function(e){var t,n=i(this),r=o(e,!0);do{if(t=s(n,r))return t.get}while(n=a(n))}})},function(e,t,n){"use strict";var r=n(0),i=n(9),o=n(26),a=n(16),s=n(15).f;n(6)&&r(r.P+n(57),"Object",{__lookupSetter__:function(e){var t,n=i(this),r=o(e,!0);do{if(t=s(n,r))return t.set}while(n=a(n))}})},function(e,t,n){"use strict";var r=n(0),i=n(116)(!1);r(r.S,"Object",{values:function(e){return i(e)}})},function(e,t,n){"use strict";var r=n(0),i=n(2),o=n(22),a=n(77)(),s=n(5)("observable"),l=n(10),u=n(1),d=n(32),c=n(39),f=n(12),h=n(33),p=h.RETURN,m=function(e){return null==e?void 0:l(e)},g=function(e){var t=e._c;t&&(e._c=void 0,t())},y=function(e){return void 0===e._o},v=function(e){y(e)||(e._o=void 0,g(e))},_=function(e,t){u(e),this._c=void 0,this._o=e,e=new b(this);try{var n=t(e),r=n;null!=n&&("function"==typeof n.unsubscribe?n=function(){r.unsubscribe()}:l(n),this._c=n)}catch(t){return void e.error(t)}y(this)&&g(this)};_.prototype=c({},{unsubscribe:function(){v(this)}});var b=function(e){this._s=e};b.prototype=c({},{next:function(e){var t=this._s;if(!y(t)){var n=t._o;try{var r=m(n.next);if(r)return r.call(n,e)}catch(e){try{v(t)}finally{throw e}}}},error:function(e){var t=this._s;if(y(t))throw e;var n=t._o;t._o=void 0;try{var r=m(n.error);if(!r)throw e;e=r.call(n,e)}catch(e){try{g(t)}finally{throw e}}return g(t),e},complete:function(e){var t=this._s;if(!y(t)){var n=t._o;t._o=void 0;try{var r=m(n.complete);e=r?r.call(n,e):void 0}catch(e){try{g(t)}finally{throw e}}return g(t),e}}});var E=function(e){d(this,E,"Observable","_f")._f=l(e)};c(E.prototype,{subscribe:function(e){return new _(e,this._f)},forEach:function(e){var t=this;return new(o.Promise||i.Promise)(function(n,r){l(e);var i=t.subscribe({next:function(t){try{return e(t)}catch(e){r(e),i.unsubscribe()}},error:r,complete:n})})}}),c(E,{from:function(e){var t="function"==typeof this?this:E,n=m(u(e)[s]);if(n){var r=u(n.call(e));return r.constructor===t?r:new t(function(e){return r.subscribe(e)})}return new t(function(t){var n=!1;return a(function(){if(!n){try{if(h(e,!1,function(e){if(t.next(e),n)return p})===p)return}catch(e){if(n)throw e;return void t.error(e)}t.complete()}}),function(){n=!0}})},of:function(){for(var e=0,t=arguments.length,n=Array(t);e<t;)n[e]=arguments[e++];return new("function"==typeof this?this:E)(function(e){var t=!1;return a(function(){if(!t){for(var r=0;r<n.length;++r)if(e.next(n[r]),t)return;e.complete()}}),function(){t=!0}})}}),f(E.prototype,s,function(){return this}),r(r.G,{Observable:E}),n(40)("Observable")},function(e,t,n){"use strict";var r=n(0),i=n(22),o=n(2),a=n(62),s=n(121);r(r.P+r.R,"Promise",{finally:function(e){var t=a(this,i.Promise||o.Promise),n="function"==typeof e;return this.then(n?function(n){return s(t,e()).then(function(){return n})}:e,n?function(n){return s(t,e()).then(function(){throw n})}:e)}})},function(e,t,n){"use strict";var r=n(0),i=n(78),o=n(120);r(r.S,"Promise",{try:function(e){var t=i.f(this),n=o(e);return(n.e?t.reject:t.resolve)(n.v),t.promise}})},function(e,t,n){"use strict";var r=n(27),i=n(1),o=r.key,a=r.set;r.exp({defineMetadata:function(e,t,n,r){a(e,t,i(n),o(r))}})},function(e,t,n){"use strict";var r=n(27),i=n(1),o=r.key,a=r.map,s=r.store;r.exp({deleteMetadata:function(e,t){var n=arguments.length<3?void 0:o(arguments[2]),r=a(i(t),n,!1);if(void 0===r||!r.delete(e))return!1;if(r.size)return!0;var l=s.get(t);return l.delete(n),!!l.size||s.delete(t)}})},function(e,t,n){"use strict";var r=n(127),i=n(97),o=n(27),a=n(1),s=n(16),l=o.keys,u=o.key,d=function e(t,n){var o=l(t,n),a=s(t);if(null===a)return o;var u=e(a,n);return u.length?o.length?i(new r(o.concat(u))):u:o};o.exp({getMetadataKeys:function(e){return d(a(e),arguments.length<2?void 0:u(arguments[1]))}})},function(e,t,n){"use strict";var r=n(27),i=n(1),o=n(16),a=r.has,s=r.get,l=r.key,u=function e(t,n,r){if(a(t,n,r))return s(t,n,r);var i=o(n);return null!==i?e(t,i,r):void 0};r.exp({getMetadata:function(e,t){return u(e,i(t),arguments.length<3?void 0:l(arguments[2]))}})},function(e,t,n){"use strict";var r=n(27),i=n(1),o=r.keys,a=r.key;r.exp({getOwnMetadataKeys:function(e){return o(i(e),arguments.length<2?void 0:a(arguments[1]))}})},function(e,t,n){"use strict";var r=n(27),i=n(1),o=r.get,a=r.key;r.exp({getOwnMetadata:function(e,t){return o(e,i(t),arguments.length<3?void 0:a(arguments[2]))}})},function(e,t,n){"use strict";var r=n(27),i=n(1),o=n(16),a=r.has,s=r.key,l=function e(t,n,r){if(a(t,n,r))return!0;var i=o(n);return null!==i&&e(t,i,r)};r.exp({hasMetadata:function(e,t){return l(e,i(t),arguments.length<3?void 0:s(arguments[2]))}})},function(e,t,n){"use strict";var r=n(27),i=n(1),o=r.has,a=r.key;r.exp({hasOwnMetadata:function(e,t){return o(e,i(t),arguments.length<3?void 0:a(arguments[2]))}})},function(e,t,n){"use strict";var r=n(27),i=n(1),o=n(10),a=r.key,s=r.set;r.exp({metadata:function(e,t){return function(n,r){s(e,t,(void 0!==r?i:o)(n),a(r))}}})},function(e,t,n){"use strict";n(59)("Set")},function(e,t,n){"use strict";n(60)("Set")},function(e,t,n){"use strict";var r=n(0);r(r.P+r.R,"Set",{toJSON:n(101)("Set")})},function(e,t,n){"use strict";var r=n(0),i=n(81)(!0);r(r.P,"String",{at:function(e){return i(this,e)}})},function(e,t,n){"use strict";var r=n(0),i=n(23),o=n(8),a=n(55),s=n(53),l=RegExp.prototype,u=function(e,t){this._r=e,this._s=t};n(73)(u,"RegExp String",function(){var e=this._r.exec(this._s);return{value:e,done:null===e}}),r(r.P,"String",{matchAll:function(e){if(i(this),!a(e))throw TypeError(e+" is not a regexp!");var t=String(this),n="flags"in l?String(e.flags):s.call(e),r=new RegExp(e.source,~n.indexOf("g")?n:"g"+n);return r.lastIndex=o(e.lastIndex),new u(r,t)}})},function(e,t,n){"use strict";var r=n(0),i=n(122);r(r.P,"String",{padEnd:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0,!1)}})},function(e,t,n){"use strict";var r=n(0),i=n(122);r(r.P,"String",{padStart:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0,!0)}})},function(e,t,n){"use strict";n(45)("trimLeft",function(e){return function(){return e(this,1)}},"trimStart")},function(e,t,n){"use strict";n(45)("trimRight",function(e){return function(){return e(this,2)}},"trimEnd")},function(e,t,n){"use strict";n(87)("asyncIterator")},function(e,t,n){"use strict";n(87)("observable")},function(e,t,n){"use strict";var r=n(0);r(r.S,"System",{global:n(2)})},function(e,t,n){"use strict";n(59)("WeakMap")},function(e,t,n){"use strict";n(60)("WeakMap")},function(e,t,n){"use strict";n(59)("WeakSet")},function(e,t,n){"use strict";n(60)("WeakSet")},function(e,t,n){"use strict";for(var r=n(89),i=n(37),o=n(13),a=n(2),s=n(12),l=n(43),u=n(5),d=u("iterator"),c=u("toStringTag"),f=l.Array,h={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},p=i(h),m=0;m<p.length;m++){var g,y=p[m],v=h[y],_=a[y],b=_&&_.prototype;if(b&&(b[d]||s(b,d,f),b[c]||s(b,c,y),l[y]=f,v))for(g in r)b[g]||o(b,g,r[g],!0)}},function(e,t,n){"use strict";var r=n(0),i=n(85);r(r.G+r.B,{setImmediate:i.set,clearImmediate:i.clear})},function(e,t,n){"use strict";var r=n(2),i=n(0),o=r.navigator,a=[].slice,s=!!o&&/MSIE .\./.test(o.userAgent),l=function(e){return function(t,n){var r=arguments.length>2,i=!!r&&a.call(arguments,2);return e(r?function(){("function"==typeof t?t:Function(t)).apply(this,i)}:t,n)}};i(i.G+i.B+i.F*s,{setTimeout:l(r.setTimeout),setInterval:l(r.setInterval)})},function(e,t,n){"use strict";n(310),n(249),n(251),n(250),n(253),n(255),n(260),n(254),n(252),n(262),n(261),n(257),n(258),n(256),n(248),n(259),n(263),n(264),n(216),n(218),n(217),n(266),n(265),n(236),n(246),n(247),n(237),n(238),n(239),n(240),n(241),n(242),n(243),n(244),n(245),n(219),n(220),n(221),n(222),n(223),n(224),n(225),n(226),n(227),n(228),n(229),n(230),n(231),n(232),n(233),n(234),n(235),n(297),n(302),n(309),n(300),n(292),n(293),n(298),n(303),n(305),n(288),n(289),n(290),n(291),n(294),n(295),n(296),n(299),n(301),n(304),n(306),n(307),n(308),n(211),n(213),n(212),n(215),n(214),n(200),n(198),n(204),n(201),n(207),n(209),n(197),n(203),n(194),n(208),n(192),n(206),n(205),n(199),n(202),n(191),n(193),n(196),n(195),n(210),n(89),n(282),n(287),n(126),n(283),n(284),n(285),n(286),n(267),n(125),n(127),n(128),n(322),n(311),n(312),n(317),n(320),n(321),n(315),n(318),n(316),n(319),n(313),n(314),n(268),n(269),n(270),n(271),n(272),n(275),n(273),n(274),n(276),n(277),n(278),n(279),n(281),n(280),n(325),n(323),n(324),n(366),n(369),n(368),n(370),n(371),n(367),n(372),n(373),n(347),n(350),n(346),n(344),n(345),n(348),n(349),n(331),n(365),n(330),n(364),n(376),n(378),n(329),n(363),n(375),n(377),n(328),n(374),n(327),n(332),n(333),n(334),n(335),n(336),n(338),n(337),n(339),n(340),n(341),n(343),n(342),n(352),n(353),n(354),n(355),n(357),n(356),n(359),n(358),n(360),n(361),n(362),n(326),n(351),n(381),n(380),n(379),e.exports=n(22)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];r(this,e),this.intervalTime=Number.isFinite(t)?1e3*t:5e3,this.debug=n,this.shouldCallCallback=!0,this.lastBeat=0,this.intervalId=0}return i(e,[{key:"beat",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};this.intervalId&&(this.debug&&console.log("Removing previous interval"),clearInterval(this.intervalId)),this.lastBeat=Date.now(),this.intervalId=setInterval(function(){var n=Date.now(),r=n-e.lastBeat;e.lastBeat=n,e.shouldCallCallback&&t(r)},this.intervalTime)}},{key:"mute",value:function(){this.shouldCallCallback=!1}},{key:"unmute",value:function(){this.shouldCallCallback=!0}},{key:"kill",value:function(){clearInterval(this.intervalId)}}]),e}();t.default=o},function(e,t,n){"use strict";function r(){}e.exports=r},function(e,t,n){"use strict";function r(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function o(e){if(c===setTimeout)return setTimeout(e,0);if((c===r||!c)&&setTimeout)return c=setTimeout,setTimeout(e,0);try{return c(e,0)}catch(t){try{return c.call(null,e,0)}catch(t){return c.call(this,e,0)}}}function a(e){if(f===clearTimeout)return clearTimeout(e);if((f===i||!f)&&clearTimeout)return f=clearTimeout,clearTimeout(e);try{return f(e)}catch(t){try{return f.call(null,e)}catch(t){return f.call(this,e)}}}function s(){g&&p&&(g=!1,p.length?m=p.concat(m):y=-1,m.length&&l())}function l(){if(!g){var e=o(s);g=!0;for(var t=m.length;t;){for(p=m,m=[];++y<t;)p&&p[y].run();y=-1,t=m.length}p=null,g=!1,a(e)}}function u(e,t){this.fun=e,this.array=t}function d(){}var c,f,h=e.exports={};!function(){try{c="function"==typeof setTimeout?setTimeout:r}catch(e){c=r}try{f="function"==typeof clearTimeout?clearTimeout:i}catch(e){f=i}}();var p,m=[],g=!1,y=-1;h.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];m.push(new u(e,t)),1!==m.length||g||o(l)},u.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=d,h.addListener=d,h.once=d,h.off=d,h.removeListener=d,h.removeAllListeners=d,h.emit=d,h.prependListener=d,h.prependOnceListener=d,h.listeners=function(e){return[]},h.binding=function(e){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(e){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){return new Promise(function(t,n){var r=document.createElement("script");r.type="text/javascript",r.src=e,r.async=!0,r.addEventListener("load",t),r.addEventListener("error",n),document.body.appendChild(r)})};t.default=r},function(e,t,n){"use strict";(function(e,t){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e){function r(e,t,n,r){var i=t&&t.prototype instanceof o?t:o,a=Object.create(i.prototype),s=new p(r||[]);return a._invoke=d(e,n,s),a}function i(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}function o(){}function a(){}function s(){}function l(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function u(t){function r(e,o,a,s){var l=i(t[e],t,o);if("throw"!==l.type){var u=l.arg,d=u.value;return d&&"object"===(void 0===d?"undefined":n(d))&&_.call(d,"__await")?Promise.resolve(d.__await).then(function(e){r("next",e,a,s)},function(e){r("throw",e,a,s)}):Promise.resolve(d).then(function(e){u.value=e,a(u)},s)}s(l.arg)}function o(e,t){function n(){return new Promise(function(n,i){r(e,t,n,i)})}return a=a?a.then(n,n):n()}"object"===n(e.process)&&e.process.domain&&(r=e.process.domain.bind(r));var a;this._invoke=o}function d(e,t,n){var r=I;return function(o,a){if(r===R)throw new Error("Generator is already running");if(r===A){if("throw"===o)throw a;return g()}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var l=c(s,n);if(l){if(l===P)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===I)throw r=A,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=R;var u=i(e,t,n);if("normal"===u.type){if(r=n.done?A:D,u.arg===P)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r=A,n.method="throw",n.arg=u.arg)}}}function c(e,t){var n=e.iterator[t.method];if(n===y){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=y,c(e,t),"throw"===t.method))return P;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return P}var r=i(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,P;var o=r.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=y),t.delegate=null,P):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,P)}function f(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function h(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function p(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(f,this),this.reset(!0)}function m(e){if(e){var t=e[E];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(_.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=y,t.done=!0,t};return r.next=r}}return{next:g}}function g(){return{value:y,done:!0}}var y,v=Object.prototype,_=v.hasOwnProperty,b="function"==typeof Symbol?Symbol:{},E=b.iterator||"@@iterator",T=b.asyncIterator||"@@asyncIterator",S=b.toStringTag||"@@toStringTag",x="object"===n(t),w=e.regeneratorRuntime;if(w)return void(x&&(t.exports=w));w=e.regeneratorRuntime=x?t.exports:{},w.wrap=r;var I="suspendedStart",D="suspendedYield",R="executing",A="completed",P={},M={};M[E]=function(){return this};var L=Object.getPrototypeOf,C=L&&L(L(m([])));C&&C!==v&&_.call(C,E)&&(M=C);var O=s.prototype=o.prototype=Object.create(M);a.prototype=O.constructor=s,s.constructor=a,s[S]=a.displayName="GeneratorFunction",w.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===a||"GeneratorFunction"===(t.displayName||t.name))},w.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,S in e||(e[S]="GeneratorFunction")),e.prototype=Object.create(O),e},w.awrap=function(e){return{__await:e}},l(u.prototype),u.prototype[T]=function(){return this},w.AsyncIterator=u,w.async=function(e,t,n,i){var o=new u(r(e,t,n,i));return w.isGeneratorFunction(t)?o:o.next().then(function(e){return e.done?e.value:o.next()})},l(O),O[S]="Generator",O[E]=function(){return this},O.toString=function(){return"[object Generator]"},w.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},w.values=m,p.prototype={constructor:p,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=y,this.done=!1,this.delegate=null,this.method="next",this.arg=y,this.tryEntries.forEach(h),!e)for(var t in this)"t"===t.charAt(0)&&_.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=y)},stop:function(){this.done=!0;var e=this.tryEntries[0],t=e.completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){function t(t,r){return o.type="throw",o.arg=e,n.next=t,r&&(n.method="next",n.arg=y),!!r}if(this.done)throw e;for(var n=this,r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r],o=i.completion;if("root"===i.tryLoc)return t("end");if(i.tryLoc<=this.prev){var a=_.call(i,"catchLoc"),s=_.call(i,"finallyLoc");if(a&&s){if(this.prev<i.catchLoc)return t(i.catchLoc,!0);if(this.prev<i.finallyLoc)return t(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return t(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return t(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&_.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,P):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),P},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),h(n),P}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;h(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:m(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=y),P}}}("object"===(void 0===e?"undefined":n(e))?e:"object"===("undefined"==typeof window?"undefined":n(window))?window:"object"===("undefined"==typeof self?"undefined":n(self))?self:void 0)}).call(t,n(90),n(389)(e))},function(e,t,n){"use strict";(function(e,t){!function(e,n){function r(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var r={callback:e,args:t};return u[l]=r,s(l),l++}function i(e){delete u[e]}function o(e){var t=e.callback,r=e.args;switch(r.length){case 0:t();break;case 1:t(r[0]);break;case 2:t(r[0],r[1]);break;case 3:t(r[0],r[1],r[2]);break;default:t.apply(n,r)}}function a(e){if(d)setTimeout(a,0,e);else{var t=u[e];if(t){d=!0;try{o(t)}finally{i(e),d=!1}}}}if(!e.setImmediate){var s,l=1,u={},d=!1,c=e.document,f=Object.getPrototypeOf&&Object.getPrototypeOf(e);f=f&&f.setTimeout?f:e,"[object process]"==={}.toString.call(e.process)?function(){s=function(e){t.nextTick(function(){a(e)})}}():function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?function(){var t="setImmediate$"+Math.random()+"$",n=function(n){n.source===e&&"string"==typeof n.data&&0===n.data.indexOf(t)&&a(+n.data.slice(t.length))};e.addEventListener?e.addEventListener("message",n,!1):e.attachEvent("onmessage",n),s=function(n){e.postMessage(t+n,"*")}}():e.MessageChannel?function(){var e=new MessageChannel;e.port1.onmessage=function(e){a(e.data)},s=function(t){e.port2.postMessage(t)}}():c&&"onreadystatechange"in c.createElement("script")?function(){var e=c.documentElement;s=function(t){var n=c.createElement("script");n.onreadystatechange=function(){a(t),n.onreadystatechange=null,e.removeChild(n),n=null},e.appendChild(n)}}():function(){s=function(e){setTimeout(a,0,e)}}(),f.setImmediate=r,f.clearImmediate=i}}("undefined"==typeof self?void 0===e?void 0:e:self)}).call(t,n(90),n(385))},function(e,t,n){"use strict";e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var o;n(182);var a=n(134),s=r(a),l=n(165),u=r(l),d=n(169),c=r(d),f=n(167),h=r(f),p=n(172),m=r(p),g=n(168),y=r(g),v=n(178),_=n(166),b=r(_),E=n(171),T=r(E),S=n(175),x=r(S),w=n(173),I=r(w),D=n(176),R=r(D),A=n(174),P=r(A),M=n(170),L=r(M);s.default.builtIn=(o={},i(o,c.default.pluginName,{}),i(o,u.default.pluginName,{}),i(o,m.default.pluginName,{}),i(o,y.default.pluginName,{}),i(o,b.default.pluginName,{}),i(o,I.default.pluginName,{}),i(o,T.default.pluginName,{}),i(o,x.default.pluginName,{}),i(o,h.default.pluginName,{}),i(o,R.default.pluginName,{}),i(o,v.Youtube.pluginName,{}),i(o,v.YoutubePlayer.pluginName,{}),i(o,L.default.pluginName,{}),i(o,P.default.pluginName,{iconUrl:"https://www.meisterplayer.com/static/media/logotype-meister-invert-mini.png",style:{maxWidth:"65px"}}),o),s.default.Configuration.overwrite(s.default.builtIn)},function(e,t,n){e.exports=n(130)}])});